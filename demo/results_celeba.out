<class 'data.celeba_embeddings.CelebaEmbeddings'>
random seeds :  [42, 32, 22]
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load embedding of CelebA: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/celeba/RN50/clip.json
Load Data Loader (train, validation, test)
Load embedding of CelebA: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/celeba/RN50/clip.json
Load Data Loader (train, validation, test)
Training target : class (non-blond hair(0) / blond hair(1))
f=============Iteration : 1/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[4] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
/home/jinsu/anaconda3/envs/dl_mmd/lib/python3.8/site-packages/umap/distances.py:1063: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/home/jinsu/anaconda3/envs/dl_mmd/lib/python3.8/site-packages/umap/distances.py:1071: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/home/jinsu/anaconda3/envs/dl_mmd/lib/python3.8/site-packages/umap/distances.py:1086: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
/home/jinsu/anaconda3/envs/dl_mmd/lib/python3.8/site-packages/umap/umap_.py:660: NumbaDeprecationWarning: The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
  @numba.jit()
Train-1 (Feature Learning): {'worst_acc': 0.3079, 'acc_0_0': 0.9458, 'acc_0_1': 0.9944, 'acc_1_0': 0.8455, 'acc_1_1': 0.3079, 'mean_acc': 0.9462}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2308, 'acc_0_0': 0.9634, 'acc_0_1': 0.9973, 'acc_1_0': 0.8246, 'acc_1_1': 0.2308, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.2722, 'acc_0_0': 0.9671, 'acc_0_1': 0.9969, 'acc_1_0': 0.8065, 'acc_1_1': 0.2722, 'mean_acc': 0.9522}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.336, 'acc_0_0': 0.9515, 'acc_0_1': 0.9955, 'acc_1_0': 0.856, 'acc_1_1': 0.336, 'mean_acc': 0.9509}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2198, 'acc_0_0': 0.9625, 'acc_0_1': 0.9976, 'acc_1_0': 0.81, 'acc_1_1': 0.2198, 'mean_acc': 0.9483}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2722, 'acc_0_0': 0.9673, 'acc_0_1': 0.9977, 'acc_1_0': 0.8109, 'acc_1_1': 0.2722, 'mean_acc': 0.9531}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3663, 'acc_0_0': 0.9539, 'acc_0_1': 0.9958, 'acc_1_0': 0.8619, 'acc_1_1': 0.3663, 'mean_acc': 0.9532}
Val(class): {'weighted_mean_acc': 0.9434, 'worst_acc': 0.2967, 'acc_0_0': 0.9096, 'acc_0_1': 0.9966, 'acc_1_0': 0.9332, 'acc_1_1': 0.2967, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3389, 'acc_0_0': 0.9258, 'acc_0_1': 0.9955, 'acc_1_0': 0.9242, 'acc_1_1': 0.3389, 'mean_acc': 0.9466}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.372, 'acc_0_0': 0.9548, 'acc_0_1': 0.9956, 'acc_1_0': 0.862, 'acc_1_1': 0.372, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.4615, 'acc_0_0': 0.9431, 'acc_0_1': 0.9942, 'acc_1_0': 0.8956, 'acc_1_1': 0.4615, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4389, 'acc_0_0': 0.9478, 'acc_0_1': 0.994, 'acc_1_0': 0.8911, 'acc_1_1': 0.4389, 'mean_acc': 0.9536}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3958, 'acc_0_0': 0.9553, 'acc_0_1': 0.9955, 'acc_1_0': 0.8641, 'acc_1_1': 0.3958, 'mean_acc': 0.9542}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2857, 'acc_0_0': 0.9499, 'acc_0_1': 0.9966, 'acc_1_0': 0.8796, 'acc_1_1': 0.2857, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3111, 'acc_0_0': 0.9542, 'acc_0_1': 0.9971, 'acc_1_0': 0.8698, 'acc_1_1': 0.3111, 'mean_acc': 0.9541}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4189, 'acc_0_0': 0.956, 'acc_0_1': 0.9956, 'acc_1_0': 0.8632, 'acc_1_1': 0.4189, 'mean_acc': 0.9546}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.1538, 'acc_0_0': 0.9597, 'acc_0_1': 0.9986, 'acc_1_0': 0.8553, 'acc_1_1': 0.1538, 'mean_acc': 0.9534}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.2667, 'acc_0_0': 0.9621, 'acc_0_1': 0.9981, 'acc_1_0': 0.8488, 'acc_1_1': 0.2667, 'mean_acc': 0.9554}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4247, 'acc_0_0': 0.9571, 'acc_0_1': 0.9958, 'acc_1_0': 0.866, 'acc_1_1': 0.4247, 'mean_acc': 0.9556}
Val(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.3187, 'acc_0_0': 0.9541, 'acc_0_1': 0.9964, 'acc_1_0': 0.8553, 'acc_1_1': 0.3187, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3611, 'acc_0_0': 0.9595, 'acc_0_1': 0.9962, 'acc_1_0': 0.8524, 'acc_1_1': 0.3611, 'mean_acc': 0.9546}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4463, 'acc_0_0': 0.9579, 'acc_0_1': 0.9956, 'acc_1_0': 0.868, 'acc_1_1': 0.4463, 'mean_acc': 0.9564}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.2967, 'acc_0_0': 0.9569, 'acc_0_1': 0.9976, 'acc_1_0': 0.858, 'acc_1_1': 0.2967, 'mean_acc': 0.9535}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3944, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.852, 'acc_1_1': 0.3944, 'mean_acc': 0.9538}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4506, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.8725, 'acc_1_1': 0.4506, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.2527, 'acc_0_0': 0.9698, 'acc_0_1': 0.9966, 'acc_1_0': 0.794, 'acc_1_1': 0.2527, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.2889, 'acc_0_0': 0.9728, 'acc_0_1': 0.9976, 'acc_1_0': 0.7802, 'acc_1_1': 0.2889, 'mean_acc': 0.9521}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.447, 'acc_0_0': 0.9587, 'acc_0_1': 0.9956, 'acc_1_0': 0.8716, 'acc_1_1': 0.447, 'mean_acc': 0.9573}
Val(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.2747, 'acc_0_0': 0.9578, 'acc_0_1': 0.9983, 'acc_1_0': 0.8629, 'acc_1_1': 0.2747, 'mean_acc': 0.9547}
Test(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.3056, 'acc_0_0': 0.9601, 'acc_0_1': 0.9964, 'acc_1_0': 0.8508, 'acc_1_1': 0.3056, 'mean_acc': 0.9543}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9594, 'acc_0_1': 0.9959, 'acc_1_0': 0.8753, 'acc_1_1': 0.4845, 'mean_acc': 0.9586}
Val(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2308, 'acc_0_0': 0.9616, 'acc_0_1': 0.9983, 'acc_1_0': 0.8295, 'acc_1_1': 0.2308, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3444, 'acc_0_0': 0.9669, 'acc_0_1': 0.9969, 'acc_1_0': 0.8222, 'acc_1_1': 0.3444, 'mean_acc': 0.9547}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9597, 'acc_0_1': 0.9956, 'acc_1_0': 0.874, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3956, 'acc_0_0': 0.9503, 'acc_0_1': 0.9954, 'acc_1_0': 0.8643, 'acc_1_1': 0.3956, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.4222, 'acc_0_0': 0.9568, 'acc_0_1': 0.9935, 'acc_1_0': 0.8593, 'acc_1_1': 0.4222, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5076, 'acc_0_0': 0.9604, 'acc_0_1': 0.9957, 'acc_1_0': 0.8768, 'acc_1_1': 0.5076, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.4945, 'acc_0_0': 0.9496, 'acc_0_1': 0.9935, 'acc_1_0': 0.8685, 'acc_1_1': 0.4945, 'mean_acc': 0.952}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.45, 'acc_0_0': 0.9566, 'acc_0_1': 0.9926, 'acc_1_0': 0.8657, 'acc_1_1': 0.45, 'mean_acc': 0.9543}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5133, 'acc_0_0': 0.9598, 'acc_0_1': 0.9957, 'acc_1_0': 0.8791, 'acc_1_1': 0.5133, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3297, 'acc_0_0': 0.9536, 'acc_0_1': 0.9969, 'acc_1_0': 0.8518, 'acc_1_1': 0.3297, 'mean_acc': 0.9512}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3556, 'acc_0_0': 0.9588, 'acc_0_1': 0.9955, 'acc_1_0': 0.846, 'acc_1_1': 0.3556, 'mean_acc': 0.9532}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.54, 'acc_0_0': 0.9608, 'acc_0_1': 0.9956, 'acc_1_0': 0.8799, 'acc_1_1': 0.54, 'mean_acc': 0.9602}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3297, 'acc_0_0': 0.9677, 'acc_0_1': 0.9964, 'acc_1_0': 0.7947, 'acc_1_1': 0.3297, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.3611, 'acc_0_0': 0.9699, 'acc_0_1': 0.995, 'acc_1_0': 0.7859, 'acc_1_1': 0.3611, 'mean_acc': 0.951}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9611, 'acc_0_1': 0.9958, 'acc_1_0': 0.8798, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.2418, 'acc_0_0': 0.9592, 'acc_0_1': 0.9978, 'acc_1_0': 0.8399, 'acc_1_1': 0.2418, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.3444, 'acc_0_0': 0.9624, 'acc_0_1': 0.9972, 'acc_1_0': 0.8335, 'acc_1_1': 0.3444, 'mean_acc': 0.954}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5544, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.8812, 'acc_1_1': 0.5544, 'mean_acc': 0.9607}
Val(class): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.1758, 'acc_0_0': 0.9756, 'acc_0_1': 0.9983, 'acc_1_0': 0.7314, 'acc_1_1': 0.1758, 'mean_acc': 0.9424}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2389, 'acc_0_0': 0.9777, 'acc_0_1': 0.9981, 'acc_1_0': 0.7246, 'acc_1_1': 0.2389, 'mean_acc': 0.9473}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.558, 'acc_0_0': 0.9615, 'acc_0_1': 0.996, 'acc_1_0': 0.8826, 'acc_1_1': 0.558, 'mean_acc': 0.9612}
Val(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.4176, 'acc_0_0': 0.9515, 'acc_0_1': 0.9937, 'acc_1_0': 0.8706, 'acc_1_1': 0.4176, 'mean_acc': 0.9525}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.4056, 'acc_0_0': 0.9572, 'acc_0_1': 0.9947, 'acc_1_0': 0.8609, 'acc_1_1': 0.4056, 'mean_acc': 0.9544}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5847, 'acc_0_0': 0.9623, 'acc_0_1': 0.9958, 'acc_1_0': 0.8834, 'acc_1_1': 0.5847, 'mean_acc': 0.9618}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.4176, 'acc_0_0': 0.937, 'acc_0_1': 0.9937, 'acc_1_0': 0.8831, 'acc_1_1': 0.4176, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9457, 'acc_0_1': 0.9926, 'acc_1_0': 0.8819, 'acc_1_1': 0.4556, 'mean_acc': 0.9511}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5811, 'acc_0_0': 0.9626, 'acc_0_1': 0.9959, 'acc_1_0': 0.887, 'acc_1_1': 0.5811, 'mean_acc': 0.9624}
Val(class): {'weighted_mean_acc': 0.9512, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9935, 'acc_1_0': 0.8434, 'acc_1_1': 0.3846, 'mean_acc': 0.9506}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4222, 'acc_0_0': 0.962, 'acc_0_1': 0.9931, 'acc_1_0': 0.8323, 'acc_1_1': 0.4222, 'mean_acc': 0.9528}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9634, 'acc_0_1': 0.9956, 'acc_1_0': 0.8852, 'acc_1_1': 0.5926, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.3516, 'acc_0_0': 0.9576, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.3516, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3889, 'acc_0_0': 0.9604, 'acc_0_1': 0.9951, 'acc_1_0': 0.8343, 'acc_1_1': 0.3889, 'mean_acc': 0.9527}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.6157, 'acc_0_0': 0.9635, 'acc_0_1': 0.9959, 'acc_1_0': 0.8902, 'acc_1_1': 0.6157, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9466, 'worst_acc': 0.4396, 'acc_0_0': 0.9306, 'acc_0_1': 0.994, 'acc_1_0': 0.8887, 'acc_1_1': 0.4396, 'mean_acc': 0.9464}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.4722, 'acc_0_0': 0.9446, 'acc_0_1': 0.9918, 'acc_1_0': 0.877, 'acc_1_1': 0.4722, 'mean_acc': 0.9498}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.6128, 'acc_0_0': 0.9635, 'acc_0_1': 0.9961, 'acc_1_0': 0.8885, 'acc_1_1': 0.6128, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3407, 'acc_0_0': 0.9623, 'acc_0_1': 0.9925, 'acc_1_0': 0.8191, 'acc_1_1': 0.3407, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3833, 'acc_0_0': 0.9664, 'acc_0_1': 0.994, 'acc_1_0': 0.8169, 'acc_1_1': 0.3833, 'mean_acc': 0.953}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.6172, 'acc_0_0': 0.964, 'acc_0_1': 0.9958, 'acc_1_0': 0.8887, 'acc_1_1': 0.6172, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.2527, 'acc_0_0': 0.9456, 'acc_0_1': 0.9983, 'acc_1_0': 0.8706, 'acc_1_1': 0.2527, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.35, 'acc_0_0': 0.9515, 'acc_0_1': 0.9972, 'acc_1_0': 0.8613, 'acc_1_1': 0.35, 'mean_acc': 0.9521}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9637, 'acc_0_1': 0.9959, 'acc_1_0': 0.8886, 'acc_1_1': 0.62, 'mean_acc': 0.9634}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2857, 'acc_0_0': 0.9625, 'acc_0_1': 0.9969, 'acc_1_0': 0.8086, 'acc_1_1': 0.2857, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3222, 'acc_0_0': 0.9656, 'acc_0_1': 0.9958, 'acc_1_0': 0.8056, 'acc_1_1': 0.3222, 'mean_acc': 0.9513}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6222, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.8909, 'acc_1_1': 0.6222, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.4286, 'acc_0_0': 0.9426, 'acc_0_1': 0.9937, 'acc_1_0': 0.8754, 'acc_1_1': 0.4286, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4556, 'acc_0_0': 0.9478, 'acc_0_1': 0.9922, 'acc_1_0': 0.8641, 'acc_1_1': 0.4556, 'mean_acc': 0.9497}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6561, 'acc_0_0': 0.965, 'acc_0_1': 0.9962, 'acc_1_0': 0.8942, 'acc_1_1': 0.6561, 'mean_acc': 0.9652}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.2747, 'acc_0_0': 0.9405, 'acc_0_1': 0.9973, 'acc_1_0': 0.8852, 'acc_1_1': 0.2747, 'mean_acc': 0.9501}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3167, 'acc_0_0': 0.9483, 'acc_0_1': 0.9956, 'acc_1_0': 0.873, 'acc_1_1': 0.3167, 'mean_acc': 0.9511}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6431, 'acc_0_0': 0.9654, 'acc_0_1': 0.996, 'acc_1_0': 0.8925, 'acc_1_1': 0.6431, 'mean_acc': 0.965}
Val(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.4725, 'acc_0_0': 0.9386, 'acc_0_1': 0.993, 'acc_1_0': 0.8747, 'acc_1_1': 0.4725, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.4778, 'acc_0_0': 0.9495, 'acc_0_1': 0.9926, 'acc_1_0': 0.8681, 'acc_1_1': 0.4778, 'mean_acc': 0.9514}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6402, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.892, 'acc_1_1': 0.6402, 'mean_acc': 0.9646}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2527, 'acc_0_0': 0.9536, 'acc_0_1': 0.9961, 'acc_1_0': 0.8281, 'acc_1_1': 0.2527, 'mean_acc': 0.9467}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3833, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8335, 'acc_1_1': 0.3833, 'mean_acc': 0.9516}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6655, 'acc_0_0': 0.9653, 'acc_0_1': 0.9962, 'acc_1_0': 0.8916, 'acc_1_1': 0.6655, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3846, 'acc_0_0': 0.9632, 'acc_0_1': 0.9925, 'acc_1_0': 0.8267, 'acc_1_1': 0.3846, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.4444, 'acc_0_0': 0.9637, 'acc_0_1': 0.992, 'acc_1_0': 0.8165, 'acc_1_1': 0.4444, 'mean_acc': 0.9514}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6597, 'acc_0_0': 0.9658, 'acc_0_1': 0.9963, 'acc_1_0': 0.8945, 'acc_1_1': 0.6597, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.3846, 'acc_0_0': 0.9372, 'acc_0_1': 0.9942, 'acc_1_0': 0.8775, 'acc_1_1': 0.3846, 'mean_acc': 0.9473}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4889, 'acc_0_0': 0.9454, 'acc_0_1': 0.9919, 'acc_1_0': 0.881, 'acc_1_1': 0.4889, 'mean_acc': 0.9509}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6626, 'acc_0_0': 0.9663, 'acc_0_1': 0.9962, 'acc_1_0': 0.8943, 'acc_1_1': 0.6626, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3846, 'acc_0_0': 0.9499, 'acc_0_1': 0.9949, 'acc_1_0': 0.8483, 'acc_1_1': 0.3846, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4389, 'acc_0_0': 0.9554, 'acc_0_1': 0.9932, 'acc_1_0': 0.8335, 'acc_1_1': 0.4389, 'mean_acc': 0.9499}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6806, 'acc_0_0': 0.9669, 'acc_0_1': 0.9961, 'acc_1_0': 0.8973, 'acc_1_1': 0.6806, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2418, 'acc_0_0': 0.9452, 'acc_0_1': 0.9973, 'acc_1_0': 0.8518, 'acc_1_1': 0.2418, 'mean_acc': 0.9469}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3222, 'acc_0_0': 0.9501, 'acc_0_1': 0.9946, 'acc_1_0': 0.8431, 'acc_1_1': 0.3222, 'mean_acc': 0.948}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6792, 'acc_0_0': 0.9668, 'acc_0_1': 0.9962, 'acc_1_0': 0.8991, 'acc_1_1': 0.6792, 'mean_acc': 0.9669}
Val(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3407, 'acc_0_0': 0.9419, 'acc_0_1': 0.9949, 'acc_1_0': 0.8782, 'acc_1_1': 0.3407, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4056, 'acc_0_0': 0.9486, 'acc_0_1': 0.9938, 'acc_1_0': 0.873, 'acc_1_1': 0.4056, 'mean_acc': 0.9514}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6799, 'acc_0_0': 0.9673, 'acc_0_1': 0.9963, 'acc_1_0': 0.9003, 'acc_1_1': 0.6799, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.2747, 'acc_0_0': 0.9332, 'acc_0_1': 0.9964, 'acc_1_0': 0.8817, 'acc_1_1': 0.2747, 'mean_acc': 0.946}
Test(class): {'weighted_mean_acc': 0.9495, 'worst_acc': 0.3167, 'acc_0_0': 0.9457, 'acc_0_1': 0.9948, 'acc_1_0': 0.8669, 'acc_1_1': 0.3167, 'mean_acc': 0.9488}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6763, 'acc_0_0': 0.9663, 'acc_0_1': 0.9965, 'acc_1_0': 0.8969, 'acc_1_1': 0.6763, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.3626, 'acc_0_0': 0.9567, 'acc_0_1': 0.9913, 'acc_1_0': 0.8114, 'acc_1_1': 0.3626, 'mean_acc': 0.9446}
Test(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.4, 'acc_0_0': 0.9634, 'acc_0_1': 0.992, 'acc_1_0': 0.8081, 'acc_1_1': 0.4, 'mean_acc': 0.9499}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.695, 'acc_0_0': 0.9675, 'acc_0_1': 0.9964, 'acc_1_0': 0.8981, 'acc_1_1': 0.695, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.3187, 'acc_0_0': 0.9213, 'acc_0_1': 0.9949, 'acc_1_0': 0.9019, 'acc_1_1': 0.3187, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4222, 'acc_0_0': 0.9339, 'acc_0_1': 0.9947, 'acc_1_0': 0.898, 'acc_1_1': 0.4222, 'mean_acc': 0.9478}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6986, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.8998, 'acc_1_1': 0.6986, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3626, 'acc_0_0': 0.9618, 'acc_0_1': 0.9957, 'acc_1_0': 0.8093, 'acc_1_1': 0.3626, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3667, 'acc_0_0': 0.964, 'acc_0_1': 0.994, 'acc_1_0': 0.7988, 'acc_1_1': 0.3667, 'mean_acc': 0.9494}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7073, 'acc_0_0': 0.9682, 'acc_0_1': 0.9965, 'acc_1_0': 0.8998, 'acc_1_1': 0.7073, 'mean_acc': 0.968}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.5165, 'acc_0_0': 0.9473, 'acc_0_1': 0.9894, 'acc_1_0': 0.8594, 'acc_1_1': 0.5165, 'mean_acc': 0.9482}
Test(class): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.5389, 'acc_0_0': 0.9498, 'acc_0_1': 0.9877, 'acc_1_0': 0.85, 'acc_1_1': 0.5389, 'mean_acc': 0.948}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6914, 'acc_0_0': 0.9686, 'acc_0_1': 0.9965, 'acc_1_0': 0.9014, 'acc_1_1': 0.6914, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9959, 'acc_1_0': 0.8072, 'acc_1_1': 0.3077, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.3944, 'acc_0_0': 0.9615, 'acc_0_1': 0.9944, 'acc_1_0': 0.804, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3407, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.5714, 'acc_1_1': 0.3407, 'mean_acc': 0.728}
Val(class)(new adapter): {'weighted_mean_acc': 0.9398, 'worst_acc': 0.7033, 'acc_0_0': 0.9274, 'acc_0_1': 0.9797, 'acc_1_0': 0.8761, 'acc_1_1': 0.7033, 'mean_acc': 0.9397}
Test(class)(new adapter): {'weighted_mean_acc': 0.9405, 'worst_acc': 0.7056, 'acc_0_0': 0.9385, 'acc_0_1': 0.9733, 'acc_1_0': 0.8653, 'acc_1_1': 0.7056, 'mean_acc': 0.9404}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7802, 'acc_0_0': 0.9341, 'acc_0_1': 0.7802, 'acc_1_0': 0.8462, 'acc_1_1': 0.9231, 'mean_acc': 0.8709}
Val(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.8022, 'acc_0_0': 0.891, 'acc_0_1': 0.9657, 'acc_1_0': 0.936, 'acc_1_1': 0.8022, 'mean_acc': 0.9278}
Test(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.7333, 'acc_0_0': 0.9091, 'acc_0_1': 0.962, 'acc_1_0': 0.9246, 'acc_1_1': 0.7333, 'mean_acc': 0.9294}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8571, 'acc_0_0': 0.8571, 'acc_0_1': 0.9451, 'acc_1_0': 0.9341, 'acc_1_1': 0.9121, 'mean_acc': 0.9121}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.8571, 'acc_0_0': 0.8885, 'acc_0_1': 0.9456, 'acc_1_0': 0.9346, 'acc_1_1': 0.8571, 'mean_acc': 0.9187}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.8278, 'acc_0_0': 0.9025, 'acc_0_1': 0.9435, 'acc_1_0': 0.9242, 'acc_1_1': 0.8278, 'mean_acc': 0.92}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6484, 'acc_0_0': 0.6484, 'acc_0_1': 0.9231, 'acc_1_0': 0.7582, 'acc_1_1': 0.8681, 'mean_acc': 0.7995}
Val(class)(new adapter): {'weighted_mean_acc': 0.6853, 'worst_acc': 0.5773, 'acc_0_0': 0.6821, 'acc_0_1': 0.5773, 'acc_1_0': 0.9916, 'acc_1_1': 1.0, 'mean_acc': 0.6861}
Test(class)(new adapter): {'weighted_mean_acc': 0.7085, 'worst_acc': 0.5643, 'acc_0_0': 0.7476, 'acc_0_1': 0.5643, 'acc_1_0': 0.9915, 'acc_1_1': 0.9778, 'mean_acc': 0.7108}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9341, 'acc_0_1': 0.9121, 'acc_1_0': 0.989, 'acc_1_1': 0.9341, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.8462, 'acc_0_0': 0.8859, 'acc_0_1': 0.9294, 'acc_1_0': 0.9569, 'acc_1_1': 0.8462, 'mean_acc': 0.9139}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.8556, 'acc_0_0': 0.902, 'acc_0_1': 0.9297, 'acc_1_0': 0.9407, 'acc_1_1': 0.8556, 'mean_acc': 0.9168}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.956, 'acc_1_0': 0.9231, 'acc_1_1': 0.956, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.8183, 'worst_acc': 0.7489, 'acc_0_0': 0.8294, 'acc_0_1': 0.7489, 'acc_1_0': 0.9756, 'acc_1_1': 0.989, 'mean_acc': 0.8185}
Test(class)(new adapter): {'weighted_mean_acc': 0.832, 'worst_acc': 0.7537, 'acc_0_0': 0.8592, 'acc_0_1': 0.7537, 'acc_1_0': 0.9669, 'acc_1_1': 0.9722, 'mean_acc': 0.8338}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.9451, 'acc_1_0': 0.9451, 'acc_1_1': 0.967, 'mean_acc': 0.9505}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8681, 'acc_0_0': 0.8957, 'acc_0_1': 0.9227, 'acc_1_0': 0.9304, 'acc_1_1': 0.8681, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.8833, 'acc_0_0': 0.9111, 'acc_0_1': 0.9201, 'acc_1_0': 0.921, 'acc_1_1': 0.8833, 'mean_acc': 0.9155}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.956, 'acc_0_1': 0.9341, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.8971, 'worst_acc': 0.8871, 'acc_0_0': 0.8936, 'acc_0_1': 0.8871, 'acc_1_0': 0.936, 'acc_1_1': 0.9121, 'mean_acc': 0.8972}
Test(class)(new adapter): {'weighted_mean_acc': 0.8971, 'worst_acc': 0.878, 'acc_0_0': 0.904, 'acc_0_1': 0.878, 'acc_1_0': 0.9319, 'acc_1_1': 0.8889, 'mean_acc': 0.8975}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.956, 'acc_1_0': 0.978, 'acc_1_1': 0.967, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.8681, 'acc_0_0': 0.8908, 'acc_0_1': 0.9468, 'acc_1_0': 0.9485, 'acc_1_1': 0.8681, 'mean_acc': 0.9223}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.85, 'acc_0_0': 0.9058, 'acc_0_1': 0.9445, 'acc_1_0': 0.9387, 'acc_1_1': 0.85, 'mean_acc': 0.924}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.967, 'acc_1_0': 0.956, 'acc_1_1': 0.967, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8928, 'worst_acc': 0.8433, 'acc_0_0': 0.8433, 'acc_0_1': 0.9207, 'acc_1_0': 0.968, 'acc_1_1': 0.8681, 'mean_acc': 0.8938}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.8722, 'acc_0_0': 0.8722, 'acc_0_1': 0.9173, 'acc_1_0': 0.9605, 'acc_1_1': 0.9111, 'mean_acc': 0.9006}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.956, 'acc_0_0': 0.956, 'acc_0_1': 0.978, 'acc_1_0': 0.967, 'acc_1_1': 0.978, 'mean_acc': 0.9698}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.8988, 'acc_0_0': 0.8988, 'acc_0_1': 0.9149, 'acc_1_0': 0.9367, 'acc_1_1': 0.9011, 'mean_acc': 0.911}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.9, 'acc_0_0': 0.9172, 'acc_0_1': 0.9111, 'acc_1_0': 0.9149, 'acc_1_1': 0.9, 'mean_acc': 0.9144}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.967, 'acc_0_1': 0.9231, 'acc_1_0': 1.0, 'acc_1_1': 0.978, 'mean_acc': 0.967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.7802, 'acc_0_0': 0.9157, 'acc_0_1': 0.9613, 'acc_1_0': 0.881, 'acc_1_1': 0.7802, 'mean_acc': 0.9284}
Test(class)(new adapter): {'weighted_mean_acc': 0.9323, 'worst_acc': 0.7556, 'acc_0_0': 0.9287, 'acc_0_1': 0.9591, 'acc_1_0': 0.8754, 'acc_1_1': 0.7556, 'mean_acc': 0.932}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.956, 'acc_0_0': 0.956, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.9725}
Val(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.8404, 'acc_0_0': 0.8404, 'acc_0_1': 0.9292, 'acc_1_0': 0.9645, 'acc_1_1': 0.8571, 'mean_acc': 0.8955}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.8444, 'acc_0_0': 0.8706, 'acc_0_1': 0.9262, 'acc_1_0': 0.9524, 'acc_1_1': 0.8444, 'mean_acc': 0.9015}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.956, 'acc_1_0': 0.956, 'acc_1_1': 0.967, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.858, 'acc_0_0': 0.9391, 'acc_0_1': 0.9128, 'acc_1_0': 0.858, 'acc_1_1': 0.8791, 'mean_acc': 0.9158}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.8484, 'acc_0_0': 0.9505, 'acc_0_1': 0.9151, 'acc_1_0': 0.8484, 'acc_1_1': 0.8556, 'mean_acc': 0.9236}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.967, 'acc_0_1': 0.967, 'acc_1_0': 0.9121, 'acc_1_1': 0.989, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.8728, 'acc_0_0': 0.8728, 'acc_0_1': 0.9493, 'acc_1_0': 0.9569, 'acc_1_1': 0.8791, 'mean_acc': 0.9169}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.85, 'acc_0_0': 0.8902, 'acc_0_1': 0.9384, 'acc_1_0': 0.9488, 'acc_1_1': 0.85, 'mean_acc': 0.9153}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.978, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.8681, 'acc_0_0': 0.9213, 'acc_0_1': 0.9316, 'acc_1_0': 0.8998, 'acc_1_1': 0.8681, 'mean_acc': 0.922}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8444, 'acc_0_0': 0.9354, 'acc_0_1': 0.925, 'acc_1_0': 0.8944, 'acc_1_1': 0.8444, 'mean_acc': 0.9256}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.989, 'acc_1_0': 0.967, 'acc_1_1': 1.0, 'mean_acc': 0.9753}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8462, 'acc_0_0': 0.9037, 'acc_0_1': 0.9551, 'acc_1_0': 0.9311, 'acc_1_1': 0.8462, 'mean_acc': 0.9285}
Test(class)(new adapter): {'weighted_mean_acc': 0.9317, 'worst_acc': 0.8, 'acc_0_0': 0.9212, 'acc_0_1': 0.951, 'acc_1_0': 0.9165, 'acc_1_1': 0.8, 'mean_acc': 0.9308}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.956, 'acc_0_0': 0.967, 'acc_0_1': 0.956, 'acc_1_0': 0.989, 'acc_1_1': 0.956, 'mean_acc': 0.967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8738, 'worst_acc': 0.8519, 'acc_0_0': 0.8662, 'acc_0_1': 0.8519, 'acc_1_0': 0.9576, 'acc_1_1': 0.9451, 'mean_acc': 0.8742}
Test(class)(new adapter): {'weighted_mean_acc': 0.8793, 'worst_acc': 0.8446, 'acc_0_0': 0.8877, 'acc_0_1': 0.8446, 'acc_1_0': 0.9512, 'acc_1_1': 0.9333, 'mean_acc': 0.8797}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.956, 'acc_0_0': 0.978, 'acc_0_1': 0.956, 'acc_1_0': 0.967, 'acc_1_1': 1.0, 'mean_acc': 0.9753}
Val(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.8784, 'acc_0_0': 0.8784, 'acc_0_1': 0.9159, 'acc_1_0': 0.9506, 'acc_1_1': 0.8791, 'mean_acc': 0.9045}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.8889, 'acc_0_0': 0.8973, 'acc_0_1': 0.9113, 'acc_1_0': 0.9435, 'acc_1_1': 0.8889, 'mean_acc': 0.9083}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.967, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.8765, 'worst_acc': 0.7648, 'acc_0_0': 0.7648, 'acc_0_1': 0.9594, 'acc_1_0': 0.9875, 'acc_1_1': 0.8242, 'mean_acc': 0.8786}
Test(class)(new adapter): {'weighted_mean_acc': 0.8904, 'worst_acc': 0.7667, 'acc_0_0': 0.8073, 'acc_0_1': 0.9498, 'acc_1_0': 0.9843, 'acc_1_1': 0.7667, 'mean_acc': 0.8827}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 1.0, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.9698}
Val(class)(new adapter): {'weighted_mean_acc': 0.8871, 'worst_acc': 0.809, 'acc_0_0': 0.809, 'acc_0_1': 0.9372, 'acc_1_0': 0.9861, 'acc_1_1': 0.8681, 'mean_acc': 0.8886}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.8416, 'acc_0_0': 0.8416, 'acc_0_1': 0.9285, 'acc_1_0': 0.9774, 'acc_1_1': 0.8611, 'mean_acc': 0.8914}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.967, 'acc_1_0': 0.9341, 'acc_1_1': 0.967, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.8702, 'worst_acc': 0.7969, 'acc_0_0': 0.7969, 'acc_0_1': 0.9087, 'acc_1_0': 0.9854, 'acc_1_1': 0.9011, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8807, 'worst_acc': 0.831, 'acc_0_0': 0.831, 'acc_0_1': 0.8994, 'acc_1_0': 0.9798, 'acc_1_1': 0.9167, 'mean_acc': 0.8761}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.989, 'acc_1_0': 0.978, 'acc_1_1': 1.0, 'mean_acc': 0.9698}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.8681, 'acc_0_0': 0.8807, 'acc_0_1': 0.9442, 'acc_1_0': 0.9485, 'acc_1_1': 0.8681, 'mean_acc': 0.9169}
Test(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.8611, 'acc_0_0': 0.893, 'acc_0_1': 0.9311, 'acc_1_0': 0.9476, 'acc_1_1': 0.8611, 'mean_acc': 0.9139}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9451, 'acc_0_1': 0.989, 'acc_1_0': 0.9231, 'acc_1_1': 0.956, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.8594, 'acc_0_0': 0.8594, 'acc_0_1': 0.9111, 'acc_1_0': 0.9638, 'acc_1_1': 0.9121, 'mean_acc': 0.8965}
Test(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.8751, 'acc_0_0': 0.8751, 'acc_0_1': 0.9005, 'acc_1_0': 0.9613, 'acc_1_1': 0.9111, 'mean_acc': 0.8957}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.967, 'acc_1_0': 0.967, 'acc_1_1': 1.0, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.873, 'acc_0_0': 0.873, 'acc_0_1': 0.9183, 'acc_1_0': 0.9562, 'acc_1_1': 0.9121, 'mean_acc': 0.9043}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.8874, 'acc_0_0': 0.8874, 'acc_0_1': 0.91, 'acc_1_0': 0.952, 'acc_1_1': 0.9167, 'mean_acc': 0.9042}
========================================================================
> end of training. 

best epoch : 51
best training accuracy on [class]: {'worst_acc': 0.956, 'acc_0_0': 0.956, 'acc_0_1': 0.978, 'acc_1_0': 0.967, 'acc_1_1': 0.978, 'mean_acc': 0.9698}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9108, 'worst_acc': 0.8988, 'acc_0_0': 0.8988, 'acc_0_1': 0.9149, 'acc_1_0': 0.9367, 'acc_1_1': 0.9011, 'mean_acc': 0.911}
best test accuracy on [class]: {'weighted_mean_acc': 0.9142, 'worst_acc': 0.9, 'acc_0_0': 0.9172, 'acc_0_1': 0.9111, 'acc_1_0': 0.9149, 'acc_1_1': 0.9, 'mean_acc': 0.9144}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.9, 'acc_0_0': 0.9172, 'acc_0_1': 0.9111, 'acc_1_0': 0.9149, 'acc_1_1': 0.9, 'mean_acc': 0.9144}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.9358, 'acc_0_0': 0.9358, 'acc_0_1': 0.9895, 'acc_1_0': 0.9786, 'acc_1_1': 0.9833, 'mean_acc': 0.9618}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
f=============Iteration : 2/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[4] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3028, 'acc_0_0': 0.9456, 'acc_0_1': 0.9945, 'acc_1_0': 0.8457, 'acc_1_1': 0.3028, 'mean_acc': 0.9461}
Val(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3516, 'acc_0_0': 0.9649, 'acc_0_1': 0.9964, 'acc_1_0': 0.8253, 'acc_1_1': 0.3516, 'mean_acc': 0.9522}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3667, 'acc_0_0': 0.9684, 'acc_0_1': 0.9965, 'acc_1_0': 0.8125, 'acc_1_1': 0.3667, 'mean_acc': 0.9542}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.349, 'acc_0_0': 0.9517, 'acc_0_1': 0.9954, 'acc_1_0': 0.8544, 'acc_1_1': 0.349, 'mean_acc': 0.9508}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9949, 'acc_1_0': 0.8838, 'acc_1_1': 0.3956, 'mean_acc': 0.9532}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.4278, 'acc_0_0': 0.9511, 'acc_0_1': 0.995, 'acc_1_0': 0.8815, 'acc_1_1': 0.4278, 'mean_acc': 0.9543}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3583, 'acc_0_0': 0.9539, 'acc_0_1': 0.9952, 'acc_1_0': 0.861, 'acc_1_1': 0.3583, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9957, 'acc_1_0': 0.881, 'acc_1_1': 0.3956, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.4167, 'acc_0_0': 0.9553, 'acc_0_1': 0.994, 'acc_1_0': 0.8714, 'acc_1_1': 0.4167, 'mean_acc': 0.9546}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3879, 'acc_0_0': 0.9555, 'acc_0_1': 0.9957, 'acc_1_0': 0.8647, 'acc_1_1': 0.3879, 'mean_acc': 0.9544}
Val(class): {'weighted_mean_acc': 0.9472, 'worst_acc': 0.2308, 'acc_0_0': 0.9663, 'acc_0_1': 0.9966, 'acc_1_0': 0.7864, 'acc_1_1': 0.2308, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.35, 'acc_0_0': 0.9707, 'acc_0_1': 0.996, 'acc_1_0': 0.7827, 'acc_1_1': 0.35, 'mean_acc': 0.9513}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3965, 'acc_0_0': 0.9565, 'acc_0_1': 0.9957, 'acc_1_0': 0.8656, 'acc_1_1': 0.3965, 'mean_acc': 0.9551}
Val(class): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.1978, 'acc_0_0': 0.9738, 'acc_0_1': 0.9976, 'acc_1_0': 0.7523, 'acc_1_1': 0.1978, 'mean_acc': 0.9445}
Test(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.2333, 'acc_0_0': 0.9787, 'acc_0_1': 0.9987, 'acc_1_0': 0.7391, 'acc_1_1': 0.2333, 'mean_acc': 0.9498}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4239, 'acc_0_0': 0.9559, 'acc_0_1': 0.9957, 'acc_1_0': 0.8682, 'acc_1_1': 0.4239, 'mean_acc': 0.9554}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2418, 'acc_0_0': 0.962, 'acc_0_1': 0.9966, 'acc_1_0': 0.8302, 'acc_1_1': 0.2418, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3444, 'acc_0_0': 0.9684, 'acc_0_1': 0.9969, 'acc_1_0': 0.823, 'acc_1_1': 0.3444, 'mean_acc': 0.9555}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4362, 'acc_0_0': 0.9573, 'acc_0_1': 0.9955, 'acc_1_0': 0.8696, 'acc_1_1': 0.4362, 'mean_acc': 0.9562}
Val(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.3846, 'acc_0_0': 0.9342, 'acc_0_1': 0.9947, 'acc_1_0': 0.904, 'acc_1_1': 0.3846, 'mean_acc': 0.95}
Test(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4278, 'acc_0_0': 0.9429, 'acc_0_1': 0.9934, 'acc_1_0': 0.894, 'acc_1_1': 0.4278, 'mean_acc': 0.9512}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4521, 'acc_0_0': 0.9583, 'acc_0_1': 0.9956, 'acc_1_0': 0.8706, 'acc_1_1': 0.4521, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.2857, 'acc_0_0': 0.9475, 'acc_0_1': 0.9969, 'acc_1_0': 0.872, 'acc_1_1': 0.2857, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.3389, 'acc_0_0': 0.9569, 'acc_0_1': 0.9972, 'acc_1_0': 0.8706, 'acc_1_1': 0.3389, 'mean_acc': 0.9558}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4722, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8715, 'acc_1_1': 0.4722, 'mean_acc': 0.9572}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.2527, 'acc_0_0': 0.9623, 'acc_0_1': 0.9969, 'acc_1_0': 0.8072, 'acc_1_1': 0.2527, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3111, 'acc_0_0': 0.9632, 'acc_0_1': 0.9964, 'acc_1_0': 0.8173, 'acc_1_1': 0.3111, 'mean_acc': 0.9518}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.4758, 'acc_0_0': 0.9594, 'acc_0_1': 0.9955, 'acc_1_0': 0.8713, 'acc_1_1': 0.4758, 'mean_acc': 0.9577}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.2418, 'acc_0_0': 0.9538, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.2418, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3222, 'acc_0_0': 0.961, 'acc_0_1': 0.9969, 'acc_1_0': 0.8484, 'acc_1_1': 0.3222, 'mean_acc': 0.9548}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9595, 'acc_0_1': 0.9957, 'acc_1_0': 0.8747, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.9548, 'acc_0_1': 0.9949, 'acc_1_0': 0.8615, 'acc_1_1': 0.3956, 'mean_acc': 0.9529}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3889, 'acc_0_0': 0.9595, 'acc_0_1': 0.9934, 'acc_1_0': 0.848, 'acc_1_1': 0.3889, 'mean_acc': 0.9533}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5004, 'acc_0_0': 0.9593, 'acc_0_1': 0.9955, 'acc_1_0': 0.875, 'acc_1_1': 0.5004, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4615, 'acc_0_0': 0.947, 'acc_0_1': 0.9954, 'acc_1_0': 0.8692, 'acc_1_1': 0.4615, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9538, 'worst_acc': 0.4333, 'acc_0_0': 0.9543, 'acc_0_1': 0.9915, 'acc_1_0': 0.8738, 'acc_1_1': 0.4333, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5126, 'acc_0_0': 0.9605, 'acc_0_1': 0.9956, 'acc_1_0': 0.8763, 'acc_1_1': 0.5126, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4286, 'acc_0_0': 0.9567, 'acc_0_1': 0.9954, 'acc_1_0': 0.8309, 'acc_1_1': 0.4286, 'mean_acc': 0.9498}
Test(class): {'weighted_mean_acc': 0.9532, 'worst_acc': 0.4389, 'acc_0_0': 0.9655, 'acc_0_1': 0.9934, 'acc_1_0': 0.8282, 'acc_1_1': 0.4389, 'mean_acc': 0.9542}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5184, 'acc_0_0': 0.9609, 'acc_0_1': 0.9954, 'acc_1_0': 0.8763, 'acc_1_1': 0.5184, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.2967, 'acc_0_0': 0.9517, 'acc_0_1': 0.9957, 'acc_1_0': 0.8525, 'acc_1_1': 0.2967, 'mean_acc': 0.9497}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.35, 'acc_0_0': 0.9607, 'acc_0_1': 0.996, 'acc_1_0': 0.8524, 'acc_1_1': 0.35, 'mean_acc': 0.9551}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5458, 'acc_0_0': 0.9614, 'acc_0_1': 0.9958, 'acc_1_0': 0.8799, 'acc_1_1': 0.5458, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.4286, 'acc_0_0': 0.9506, 'acc_0_1': 0.9935, 'acc_1_0': 0.8636, 'acc_1_1': 0.4286, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.4889, 'acc_0_0': 0.9547, 'acc_0_1': 0.9906, 'acc_1_0': 0.8593, 'acc_1_1': 0.4889, 'mean_acc': 0.9522}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9608, 'acc_0_1': 0.996, 'acc_1_0': 0.8796, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9947, 'acc_1_0': 0.8309, 'acc_1_1': 0.3077, 'mean_acc': 0.9492}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3778, 'acc_0_0': 0.9642, 'acc_0_1': 0.9951, 'acc_1_0': 0.8302, 'acc_1_1': 0.3778, 'mean_acc': 0.9539}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5523, 'acc_0_0': 0.9622, 'acc_0_1': 0.9958, 'acc_1_0': 0.8812, 'acc_1_1': 0.5523, 'mean_acc': 0.9611}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.2088, 'acc_0_0': 0.9414, 'acc_0_1': 0.9976, 'acc_1_0': 0.881, 'acc_1_1': 0.2088, 'mean_acc': 0.9494}
Test(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.2611, 'acc_0_0': 0.9514, 'acc_0_1': 0.9968, 'acc_1_0': 0.869, 'acc_1_1': 0.2611, 'mean_acc': 0.9521}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.5501, 'acc_0_0': 0.9627, 'acc_0_1': 0.9958, 'acc_1_0': 0.8835, 'acc_1_1': 0.5501, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.5714, 'acc_0_0': 0.9239, 'acc_0_1': 0.9896, 'acc_1_0': 0.9172, 'acc_1_1': 0.5714, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.5278, 'acc_0_0': 0.9336, 'acc_0_1': 0.9857, 'acc_1_0': 0.9081, 'acc_1_1': 0.5278, 'mean_acc': 0.9464}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5789, 'acc_0_0': 0.9632, 'acc_0_1': 0.9961, 'acc_1_0': 0.8858, 'acc_1_1': 0.5789, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9473, 'worst_acc': 0.2198, 'acc_0_0': 0.9649, 'acc_0_1': 0.9978, 'acc_1_0': 0.7884, 'acc_1_1': 0.2198, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.2444, 'acc_0_0': 0.9704, 'acc_0_1': 0.9973, 'acc_1_0': 0.7835, 'acc_1_1': 0.2444, 'mean_acc': 0.9508}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5833, 'acc_0_0': 0.9633, 'acc_0_1': 0.9958, 'acc_1_0': 0.8822, 'acc_1_1': 0.5833, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.3297, 'acc_0_0': 0.9342, 'acc_0_1': 0.9981, 'acc_1_0': 0.8845, 'acc_1_1': 0.3297, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3167, 'acc_0_0': 0.9442, 'acc_0_1': 0.9964, 'acc_1_0': 0.8786, 'acc_1_1': 0.3167, 'mean_acc': 0.9501}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9629, 'acc_0_1': 0.9959, 'acc_1_0': 0.8868, 'acc_1_1': 0.5926, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2967, 'acc_0_0': 0.9515, 'acc_0_1': 0.9959, 'acc_1_0': 0.833, 'acc_1_1': 0.2967, 'mean_acc': 0.9468}
Test(class): {'weighted_mean_acc': 0.9514, 'worst_acc': 0.3556, 'acc_0_0': 0.9622, 'acc_0_1': 0.9947, 'acc_1_0': 0.8274, 'acc_1_1': 0.3556, 'mean_acc': 0.9523}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.5941, 'acc_0_0': 0.9637, 'acc_0_1': 0.9957, 'acc_1_0': 0.8863, 'acc_1_1': 0.5941, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9451, 'worst_acc': 0.4286, 'acc_0_0': 0.937, 'acc_0_1': 0.9918, 'acc_1_0': 0.8657, 'acc_1_1': 0.4286, 'mean_acc': 0.9448}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9462, 'acc_0_1': 0.9906, 'acc_1_0': 0.873, 'acc_1_1': 0.4722, 'mean_acc': 0.9496}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.5955, 'acc_0_0': 0.9645, 'acc_0_1': 0.996, 'acc_1_0': 0.8858, 'acc_1_1': 0.5955, 'mean_acc': 0.9632}
Val(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2418, 'acc_0_0': 0.9358, 'acc_0_1': 0.9986, 'acc_1_0': 0.8873, 'acc_1_1': 0.2418, 'mean_acc': 0.9486}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3222, 'acc_0_0': 0.9446, 'acc_0_1': 0.9963, 'acc_1_0': 0.8827, 'acc_1_1': 0.3222, 'mean_acc': 0.9508}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9645, 'acc_0_1': 0.9959, 'acc_1_0': 0.8903, 'acc_1_1': 0.62, 'mean_acc': 0.964}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.4066, 'acc_0_0': 0.9545, 'acc_0_1': 0.9899, 'acc_1_0': 0.8525, 'acc_1_1': 0.4066, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4889, 'acc_0_0': 0.9599, 'acc_0_1': 0.987, 'acc_1_0': 0.8419, 'acc_1_1': 0.4889, 'mean_acc': 0.9512}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.6345, 'acc_0_0': 0.9647, 'acc_0_1': 0.9957, 'acc_1_0': 0.8888, 'acc_1_1': 0.6345, 'mean_acc': 0.9639}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3077, 'acc_0_0': 0.9456, 'acc_0_1': 0.9964, 'acc_1_0': 0.8615, 'acc_1_1': 0.3077, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3778, 'acc_0_0': 0.9545, 'acc_0_1': 0.9932, 'acc_1_0': 0.85, 'acc_1_1': 0.3778, 'mean_acc': 0.951}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6244, 'acc_0_0': 0.9654, 'acc_0_1': 0.9962, 'acc_1_0': 0.8895, 'acc_1_1': 0.6244, 'mean_acc': 0.9645}
Val(class): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9932, 'acc_1_0': 0.817, 'acc_1_1': 0.3846, 'mean_acc': 0.9466}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9625, 'acc_0_1': 0.992, 'acc_1_0': 0.831, 'acc_1_1': 0.4556, 'mean_acc': 0.9528}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6482, 'acc_0_0': 0.9648, 'acc_0_1': 0.996, 'acc_1_0': 0.89, 'acc_1_1': 0.6482, 'mean_acc': 0.9644}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4725, 'acc_0_0': 0.9302, 'acc_0_1': 0.9906, 'acc_1_0': 0.9019, 'acc_1_1': 0.4725, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4222, 'acc_0_0': 0.9433, 'acc_0_1': 0.991, 'acc_1_0': 0.8948, 'acc_1_1': 0.4222, 'mean_acc': 0.9506}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.646, 'acc_0_0': 0.9653, 'acc_0_1': 0.9963, 'acc_1_0': 0.8909, 'acc_1_1': 0.646, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.4505, 'acc_0_0': 0.9482, 'acc_0_1': 0.9915, 'acc_1_0': 0.8664, 'acc_1_1': 0.4505, 'mean_acc': 0.9499}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9534, 'acc_0_1': 0.9893, 'acc_1_0': 0.8544, 'acc_1_1': 0.4722, 'mean_acc': 0.9503}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9658, 'acc_0_1': 0.9959, 'acc_1_0': 0.8924, 'acc_1_1': 0.6467, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.1978, 'acc_0_0': 0.9618, 'acc_0_1': 0.9954, 'acc_1_0': 0.833, 'acc_1_1': 0.1978, 'mean_acc': 0.9502}
Test(class): {'weighted_mean_acc': 0.9484, 'worst_acc': 0.2944, 'acc_0_0': 0.9639, 'acc_0_1': 0.995, 'acc_1_0': 0.8032, 'acc_1_1': 0.2944, 'mean_acc': 0.9496}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6568, 'acc_0_0': 0.9668, 'acc_0_1': 0.9961, 'acc_1_0': 0.8913, 'acc_1_1': 0.6568, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4176, 'acc_0_0': 0.9503, 'acc_0_1': 0.9949, 'acc_1_0': 0.8664, 'acc_1_1': 0.4176, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.3611, 'acc_0_0': 0.955, 'acc_0_1': 0.9931, 'acc_1_0': 0.8548, 'acc_1_1': 0.3611, 'mean_acc': 0.9516}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6676, 'acc_0_0': 0.9661, 'acc_0_1': 0.9964, 'acc_1_0': 0.8928, 'acc_1_1': 0.6676, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.3407, 'acc_0_0': 0.9299, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.3407, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9487, 'worst_acc': 0.3889, 'acc_0_0': 0.9396, 'acc_0_1': 0.9942, 'acc_1_0': 0.8786, 'acc_1_1': 0.3889, 'mean_acc': 0.9477}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6583, 'acc_0_0': 0.9664, 'acc_0_1': 0.9959, 'acc_1_0': 0.8948, 'acc_1_1': 0.6583, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.1648, 'acc_0_0': 0.9515, 'acc_0_1': 0.9981, 'acc_1_0': 0.8309, 'acc_1_1': 0.1648, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3, 'acc_0_0': 0.9562, 'acc_0_1': 0.9971, 'acc_1_0': 0.8323, 'acc_1_1': 0.3, 'mean_acc': 0.9503}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6683, 'acc_0_0': 0.967, 'acc_0_1': 0.9965, 'acc_1_0': 0.8934, 'acc_1_1': 0.6683, 'mean_acc': 0.9662}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.4286, 'acc_0_0': 0.9616, 'acc_0_1': 0.9894, 'acc_1_0': 0.8246, 'acc_1_1': 0.4286, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4833, 'acc_0_0': 0.9633, 'acc_0_1': 0.987, 'acc_1_0': 0.8077, 'acc_1_1': 0.4833, 'mean_acc': 0.9486}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6741, 'acc_0_0': 0.9669, 'acc_0_1': 0.9962, 'acc_1_0': 0.8967, 'acc_1_1': 0.6741, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.4945, 'acc_0_0': 0.9447, 'acc_0_1': 0.9915, 'acc_1_0': 0.8657, 'acc_1_1': 0.4945, 'mean_acc': 0.9487}
Test(class): {'weighted_mean_acc': 0.9507, 'worst_acc': 0.4833, 'acc_0_0': 0.9502, 'acc_0_1': 0.9894, 'acc_1_0': 0.8677, 'acc_1_1': 0.4833, 'mean_acc': 0.9506}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6669, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.895, 'acc_1_1': 0.6669, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.2857, 'acc_0_0': 0.9351, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.2857, 'mean_acc': 0.9479}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.3944, 'acc_0_0': 0.9425, 'acc_0_1': 0.9944, 'acc_1_0': 0.8911, 'acc_1_1': 0.3944, 'mean_acc': 0.9508}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6727, 'acc_0_0': 0.9672, 'acc_0_1': 0.9962, 'acc_1_0': 0.897, 'acc_1_1': 0.6727, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9422, 'worst_acc': 0.5165, 'acc_0_0': 0.9182, 'acc_0_1': 0.9889, 'acc_1_0': 0.9068, 'acc_1_1': 0.5165, 'mean_acc': 0.9423}
Test(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.5222, 'acc_0_0': 0.9333, 'acc_0_1': 0.9867, 'acc_1_0': 0.8923, 'acc_1_1': 0.5222, 'mean_acc': 0.9447}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.6907, 'acc_0_0': 0.9675, 'acc_0_1': 0.996, 'acc_1_0': 0.8972, 'acc_1_1': 0.6907, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.1978, 'acc_0_0': 0.9597, 'acc_0_1': 0.9957, 'acc_1_0': 0.826, 'acc_1_1': 0.1978, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.3222, 'acc_0_0': 0.9622, 'acc_0_1': 0.9959, 'acc_1_0': 0.8052, 'acc_1_1': 0.3222, 'mean_acc': 0.9497}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6849, 'acc_0_0': 0.9681, 'acc_0_1': 0.9965, 'acc_1_0': 0.8984, 'acc_1_1': 0.6849, 'mean_acc': 0.9676}
Val(class): {'weighted_mean_acc': 0.9455, 'worst_acc': 0.3956, 'acc_0_0': 0.9405, 'acc_0_1': 0.9886, 'acc_1_0': 0.8685, 'acc_1_1': 0.3956, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.4333, 'acc_0_0': 0.9455, 'acc_0_1': 0.9894, 'acc_1_0': 0.8722, 'acc_1_1': 0.4333, 'mean_acc': 0.9484}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.682, 'acc_0_0': 0.9676, 'acc_0_1': 0.9964, 'acc_1_0': 0.8993, 'acc_1_1': 0.682, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3516, 'acc_0_0': 0.9583, 'acc_0_1': 0.9932, 'acc_1_0': 0.8316, 'acc_1_1': 0.3516, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3944, 'acc_0_0': 0.9607, 'acc_0_1': 0.9923, 'acc_1_0': 0.8137, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9681, 'acc_0_1': 0.9964, 'acc_1_0': 0.8997, 'acc_1_1': 0.6957, 'mean_acc': 0.9678}
Val(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.3297, 'acc_0_0': 0.9585, 'acc_0_1': 0.9942, 'acc_1_0': 0.8031, 'acc_1_1': 0.3297, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9468, 'worst_acc': 0.3333, 'acc_0_0': 0.9609, 'acc_0_1': 0.9939, 'acc_1_0': 0.802, 'acc_1_1': 0.3333, 'mean_acc': 0.948}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3626, 'acc_0_0': 0.989, 'acc_0_1': 1.0, 'acc_1_0': 0.6813, 'acc_1_1': 0.3626, 'mean_acc': 0.7582}
Val(class)(new adapter): {'weighted_mean_acc': 0.9377, 'worst_acc': 0.7143, 'acc_0_0': 0.9276, 'acc_0_1': 0.9763, 'acc_1_0': 0.8699, 'acc_1_1': 0.7143, 'mean_acc': 0.9376}
Test(class)(new adapter): {'weighted_mean_acc': 0.9401, 'worst_acc': 0.6333, 'acc_0_0': 0.938, 'acc_0_1': 0.9748, 'acc_1_0': 0.8641, 'acc_1_1': 0.6333, 'mean_acc': 0.9399}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.9121, 'acc_0_1': 0.9341, 'acc_1_0': 0.8681, 'acc_1_1': 0.8791, 'mean_acc': 0.8984}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.8132, 'acc_0_0': 0.914, 'acc_0_1': 0.9509, 'acc_1_0': 0.9047, 'acc_1_1': 0.8132, 'mean_acc': 0.9271}
Test(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.7667, 'acc_0_0': 0.9241, 'acc_0_1': 0.9486, 'acc_1_0': 0.896, 'acc_1_1': 0.7667, 'mean_acc': 0.9285}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.9121, 'acc_0_1': 0.8791, 'acc_1_0': 0.9231, 'acc_1_1': 0.9121, 'mean_acc': 0.9066}
Val(class)(new adapter): {'weighted_mean_acc': 0.8561, 'worst_acc': 0.8093, 'acc_0_0': 0.8093, 'acc_0_1': 0.8673, 'acc_1_0': 0.9652, 'acc_1_1': 0.9341, 'mean_acc': 0.8572}
Test(class)(new adapter): {'weighted_mean_acc': 0.8671, 'worst_acc': 0.8434, 'acc_0_0': 0.8434, 'acc_0_1': 0.8616, 'acc_1_0': 0.954, 'acc_1_1': 0.9222, 'mean_acc': 0.8647}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8462, 'acc_0_0': 0.8901, 'acc_0_1': 0.8681, 'acc_1_0': 0.8462, 'acc_1_1': 0.9231, 'mean_acc': 0.8819}
Val(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.4066, 'acc_0_0': 0.8559, 'acc_0_1': 0.9952, 'acc_1_0': 0.9374, 'acc_1_1': 0.4066, 'mean_acc': 0.9216}
Test(class)(new adapter): {'weighted_mean_acc': 0.9342, 'worst_acc': 0.2722, 'acc_0_0': 0.8886, 'acc_0_1': 0.9967, 'acc_1_0': 0.9343, 'acc_1_1': 0.2722, 'mean_acc': 0.9295}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.967, 'acc_0_1': 0.956, 'acc_1_0': 0.956, 'acc_1_1': 0.8901, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.8636, 'acc_0_0': 0.8636, 'acc_0_1': 0.9154, 'acc_1_0': 0.952, 'acc_1_1': 0.9341, 'mean_acc': 0.8986}
Test(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8888, 'acc_0_0': 0.8888, 'acc_0_1': 0.905, 'acc_1_0': 0.9411, 'acc_1_1': 0.9, 'mean_acc': 0.9015}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.8791, 'acc_0_1': 0.9341, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9258}
Val(class)(new adapter): {'weighted_mean_acc': 0.9355, 'worst_acc': 0.7473, 'acc_0_0': 0.9213, 'acc_0_1': 0.9737, 'acc_1_0': 0.8796, 'acc_1_1': 0.7473, 'mean_acc': 0.9355}
Test(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.6, 'acc_0_0': 0.9314, 'acc_0_1': 0.9731, 'acc_1_0': 0.8597, 'acc_1_1': 0.6, 'mean_acc': 0.9352}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.978, 'acc_1_0': 0.9341, 'acc_1_1': 0.967, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.8896, 'acc_0_0': 0.8896, 'acc_0_1': 0.9203, 'acc_1_0': 0.9402, 'acc_1_1': 0.9231, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.8889, 'acc_0_0': 0.9028, 'acc_0_1': 0.9141, 'acc_1_0': 0.9266, 'acc_1_1': 0.8889, 'mean_acc': 0.9099}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.956, 'acc_0_1': 0.989, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.938, 'worst_acc': 0.8462, 'acc_0_0': 0.9356, 'acc_0_1': 0.9654, 'acc_1_0': 0.8713, 'acc_1_1': 0.8462, 'mean_acc': 0.9379}
Test(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.7444, 'acc_0_0': 0.94, 'acc_0_1': 0.9587, 'acc_1_0': 0.8657, 'acc_1_1': 0.7444, 'mean_acc': 0.9361}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.967, 'acc_1_0': 0.956, 'acc_1_1': 0.978, 'mean_acc': 0.9615}
Val(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.8194, 'acc_0_0': 0.8194, 'acc_0_1': 0.9381, 'acc_1_0': 0.9763, 'acc_1_1': 0.8901, 'mean_acc': 0.8922}
Test(class)(new adapter): {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8478, 'acc_0_0': 0.8478, 'acc_0_1': 0.9293, 'acc_1_0': 0.9758, 'acc_1_1': 0.8722, 'mean_acc': 0.8946}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.967, 'acc_0_0': 0.967, 'acc_0_1': 0.967, 'acc_1_0': 0.967, 'acc_1_1': 0.989, 'mean_acc': 0.9725}
Val(class)(new adapter): {'weighted_mean_acc': 0.9305, 'worst_acc': 0.7582, 'acc_0_0': 0.896, 'acc_0_1': 0.9674, 'acc_1_0': 0.9415, 'acc_1_1': 0.7582, 'mean_acc': 0.931}
Test(class)(new adapter): {'weighted_mean_acc': 0.9345, 'worst_acc': 0.6611, 'acc_0_0': 0.9126, 'acc_0_1': 0.9646, 'acc_1_0': 0.9319, 'acc_1_1': 0.6611, 'mean_acc': 0.9323}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.978, 'acc_0_0': 0.978, 'acc_0_1': 0.989, 'acc_1_0': 0.989, 'acc_1_1': 0.978, 'mean_acc': 0.9835}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.8775, 'acc_0_0': 0.8775, 'acc_0_1': 0.927, 'acc_1_0': 0.9506, 'acc_1_1': 0.8791, 'mean_acc': 0.9087}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.8167, 'acc_0_0': 0.8973, 'acc_0_1': 0.9226, 'acc_1_0': 0.9452, 'acc_1_1': 0.8167, 'mean_acc': 0.9121}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8877, 'worst_acc': 0.8034, 'acc_0_0': 0.8034, 'acc_0_1': 0.9447, 'acc_1_0': 0.9861, 'acc_1_1': 0.8681, 'mean_acc': 0.8893}
Test(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.8333, 'acc_0_0': 0.8465, 'acc_0_1': 0.9388, 'acc_1_0': 0.9778, 'acc_1_1': 0.8333, 'mean_acc': 0.8976}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.978, 'acc_1_0': 0.9451, 'acc_1_1': 0.978, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.8791, 'acc_0_0': 0.9297, 'acc_0_1': 0.9384, 'acc_1_0': 0.8831, 'acc_1_1': 0.8791, 'mean_acc': 0.9261}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8611, 'acc_0_0': 0.9439, 'acc_0_1': 0.9214, 'acc_1_0': 0.8722, 'acc_1_1': 0.8611, 'mean_acc': 0.9258}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.967, 'acc_0_1': 0.9341, 'acc_1_0': 0.978, 'acc_1_1': 0.978, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.8571, 'acc_0_0': 0.877, 'acc_0_1': 0.9427, 'acc_1_0': 0.9506, 'acc_1_1': 0.8571, 'mean_acc': 0.9148}
Test(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.85, 'acc_0_0': 0.8947, 'acc_0_1': 0.9328, 'acc_1_0': 0.9387, 'acc_1_1': 0.85, 'mean_acc': 0.9142}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 1.0, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.8791, 'acc_0_0': 0.9269, 'acc_0_1': 0.9369, 'acc_1_0': 0.9019, 'acc_1_1': 0.8791, 'mean_acc': 0.927}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.85, 'acc_0_0': 0.9347, 'acc_0_1': 0.9282, 'acc_1_0': 0.8806, 'acc_1_1': 0.85, 'mean_acc': 0.9248}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.956, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9007, 'worst_acc': 0.8318, 'acc_0_0': 0.8318, 'acc_0_1': 0.949, 'acc_1_0': 0.9784, 'acc_1_1': 0.8462, 'mean_acc': 0.902}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7722, 'acc_0_0': 0.8627, 'acc_0_1': 0.9468, 'acc_1_0': 0.969, 'acc_1_1': 0.7722, 'mean_acc': 0.9068}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.978, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.8681, 'acc_0_0': 0.9065, 'acc_0_1': 0.9244, 'acc_1_0': 0.9054, 'acc_1_1': 0.8681, 'mean_acc': 0.9134}
Test(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.8333, 'acc_0_0': 0.923, 'acc_0_1': 0.9192, 'acc_1_0': 0.9048, 'acc_1_1': 0.8333, 'mean_acc': 0.9185}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.967, 'acc_1_0': 0.978, 'acc_1_1': 0.978, 'mean_acc': 0.967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8681, 'worst_acc': 0.7748, 'acc_0_0': 0.7748, 'acc_0_1': 0.9265, 'acc_1_0': 0.9889, 'acc_1_1': 0.8791, 'mean_acc': 0.8699}
Test(class)(new adapter): {'weighted_mean_acc': 0.8831, 'worst_acc': 0.8159, 'acc_0_0': 0.8159, 'acc_0_1': 0.922, 'acc_1_0': 0.9839, 'acc_1_1': 0.8222, 'mean_acc': 0.8769}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.967, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.8571, 'acc_0_0': 0.9356, 'acc_0_1': 0.942, 'acc_1_0': 0.8761, 'acc_1_1': 0.8571, 'mean_acc': 0.9289}
Test(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7556, 'acc_0_0': 0.9418, 'acc_0_1': 0.9382, 'acc_1_0': 0.8589, 'acc_1_1': 0.7556, 'mean_acc': 0.9285}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.956, 'acc_1_0': 0.9451, 'acc_1_1': 0.9451, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.881, 'worst_acc': 0.8308, 'acc_0_0': 0.8308, 'acc_0_1': 0.9014, 'acc_1_0': 0.9756, 'acc_1_1': 0.9231, 'mean_acc': 0.882}
Test(class)(new adapter): {'weighted_mean_acc': 0.8923, 'worst_acc': 0.8599, 'acc_0_0': 0.8599, 'acc_0_1': 0.8991, 'acc_1_0': 0.9746, 'acc_1_1': 0.8722, 'mean_acc': 0.8891}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.978, 'acc_1_0': 0.9341, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.8782, 'acc_0_0': 0.9299, 'acc_0_1': 0.9241, 'acc_1_0': 0.8782, 'acc_1_1': 0.9121, 'mean_acc': 0.9199}
Test(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.8389, 'acc_0_0': 0.9389, 'acc_0_1': 0.9232, 'acc_1_0': 0.8577, 'acc_1_1': 0.8389, 'mean_acc': 0.922}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.956, 'acc_0_1': 0.956, 'acc_1_0': 0.9451, 'acc_1_1': 0.956, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.7473, 'acc_0_0': 0.9466, 'acc_0_1': 0.9756, 'acc_1_0': 0.8539, 'acc_1_1': 0.7473, 'mean_acc': 0.9434}
Test(class)(new adapter): {'weighted_mean_acc': 0.9455, 'worst_acc': 0.6167, 'acc_0_0': 0.9539, 'acc_0_1': 0.9792, 'acc_1_0': 0.8407, 'acc_1_1': 0.6167, 'mean_acc': 0.9463}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.956, 'acc_0_1': 0.989, 'acc_1_0': 0.9121, 'acc_1_1': 0.989, 'mean_acc': 0.9615}
Val(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.8571, 'acc_0_0': 0.8709, 'acc_0_1': 0.9495, 'acc_1_0': 0.9582, 'acc_1_1': 0.8571, 'mean_acc': 0.9161}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.8111, 'acc_0_0': 0.8946, 'acc_0_1': 0.9452, 'acc_1_0': 0.9532, 'acc_1_1': 0.8111, 'mean_acc': 0.9202}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.967, 'acc_0_0': 0.967, 'acc_0_1': 0.978, 'acc_1_0': 0.978, 'acc_1_1': 1.0, 'mean_acc': 0.9808}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.8022, 'acc_0_0': 0.9105, 'acc_0_1': 0.9635, 'acc_1_0': 0.9311, 'acc_1_1': 0.8022, 'mean_acc': 0.9346}
Test(class)(new adapter): {'weighted_mean_acc': 0.9364, 'worst_acc': 0.7556, 'acc_0_0': 0.9252, 'acc_0_1': 0.9606, 'acc_1_0': 0.9121, 'acc_1_1': 0.7556, 'mean_acc': 0.9354}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 1.0, 'acc_0_1': 0.967, 'acc_1_0': 0.9011, 'acc_1_1': 0.956, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9367, 'worst_acc': 0.8022, 'acc_0_0': 0.91, 'acc_0_1': 0.9703, 'acc_1_0': 0.9304, 'acc_1_1': 0.8022, 'mean_acc': 0.9371}
Test(class)(new adapter): {'weighted_mean_acc': 0.9388, 'worst_acc': 0.6944, 'acc_0_0': 0.9235, 'acc_0_1': 0.9692, 'acc_1_0': 0.9125, 'acc_1_1': 0.6944, 'mean_acc': 0.9373}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.978, 'acc_1_0': 0.9341, 'acc_1_1': 0.967, 'mean_acc': 0.9478}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9096, 'worst_acc': 0.8896, 'acc_0_0': 0.8896, 'acc_0_1': 0.9203, 'acc_1_0': 0.9402, 'acc_1_1': 0.9231, 'mean_acc': 0.91}
best test accuracy on [class]: {'weighted_mean_acc': 0.9107, 'worst_acc': 0.8889, 'acc_0_0': 0.9028, 'acc_0_1': 0.9141, 'acc_1_0': 0.9266, 'acc_1_1': 0.8889, 'mean_acc': 0.9099}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.8889, 'acc_0_0': 0.9028, 'acc_0_1': 0.9141, 'acc_1_0': 0.9266, 'acc_1_1': 0.8889, 'mean_acc': 0.9099}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9837, 'worst_acc': 0.8778, 'acc_0_0': 0.9974, 'acc_0_1': 0.9667, 'acc_1_0': 0.9968, 'acc_1_1': 0.8778, 'mean_acc': 0.9847}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9142     0.9000   0.9172  ...   0.9149   0.9000    0.9144
2                       0.9107     0.8889   0.9028  ...   0.9266   0.8889    0.9099
test_mean               0.9124     0.8944   0.9100  ...   0.9208   0.8944    0.9122
test_std                0.0018     0.0055   0.0072  ...   0.0058   0.0055    0.0022
1                       0.9643     0.9358   0.9358  ...   0.9786   0.9833    0.9618
2                       0.9837     0.8778   0.9974  ...   0.9968   0.8778    0.9847
zs_spu_mean             0.9740     0.9068   0.9666  ...   0.9877   0.9306    0.9732
zs_spu_std              0.0097     0.0290   0.0308  ...   0.0091   0.0527    0.0115
1                          NaN     0.9560   0.9560  ...   0.9670   0.9780    0.9698
2                          NaN     0.9121   0.9121  ...   0.9341   0.9670    0.9478
tr_mean                    NaN     0.9340   0.9340  ...   0.9506   0.9725    0.9588
tr_std                     NaN     0.0219   0.0219  ...   0.0164   0.0055    0.0110
1                       0.9108     0.8988   0.8988  ...   0.9367   0.9011    0.9110
2                       0.9096     0.8896   0.8896  ...   0.9402   0.9231    0.9100
val_mean                0.9102     0.8942   0.8942  ...   0.9384   0.9121    0.9105
val_std                 0.0006     0.0046   0.0046  ...   0.0018   0.0110    0.0005
1                       0.9142     0.9000   0.9172  ...   0.9149   0.9000    0.9144
2                       0.9107     0.8889   0.9028  ...   0.9266   0.8889    0.9099
zs_tg_mean              0.9124     0.8944   0.9100  ...   0.9208   0.8944    0.9122
zs_tg_std               0.0018     0.0055   0.0072  ...   0.0058   0.0055    0.0022

[20 rows x 7 columns]
Save to:  results_iterative/ds_celeba_tl_adapter_reg_seq_alter_bs_1024_lr_0.1_lrr1.0_bsr4_balval_MA+rn.csv
f=============Iteration : 1/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[8] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3079, 'acc_0_0': 0.9458, 'acc_0_1': 0.9944, 'acc_1_0': 0.8455, 'acc_1_1': 0.3079, 'mean_acc': 0.9462}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2308, 'acc_0_0': 0.9634, 'acc_0_1': 0.9973, 'acc_1_0': 0.8246, 'acc_1_1': 0.2308, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.2722, 'acc_0_0': 0.9671, 'acc_0_1': 0.9969, 'acc_1_0': 0.8065, 'acc_1_1': 0.2722, 'mean_acc': 0.9522}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.336, 'acc_0_0': 0.9515, 'acc_0_1': 0.9955, 'acc_1_0': 0.856, 'acc_1_1': 0.336, 'mean_acc': 0.9509}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2198, 'acc_0_0': 0.9625, 'acc_0_1': 0.9976, 'acc_1_0': 0.81, 'acc_1_1': 0.2198, 'mean_acc': 0.9483}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2722, 'acc_0_0': 0.9673, 'acc_0_1': 0.9977, 'acc_1_0': 0.8109, 'acc_1_1': 0.2722, 'mean_acc': 0.9531}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3663, 'acc_0_0': 0.9539, 'acc_0_1': 0.9958, 'acc_1_0': 0.8619, 'acc_1_1': 0.3663, 'mean_acc': 0.9532}
Val(class): {'weighted_mean_acc': 0.9434, 'worst_acc': 0.2967, 'acc_0_0': 0.9096, 'acc_0_1': 0.9966, 'acc_1_0': 0.9332, 'acc_1_1': 0.2967, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3389, 'acc_0_0': 0.9258, 'acc_0_1': 0.9955, 'acc_1_0': 0.9242, 'acc_1_1': 0.3389, 'mean_acc': 0.9466}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.372, 'acc_0_0': 0.9548, 'acc_0_1': 0.9956, 'acc_1_0': 0.862, 'acc_1_1': 0.372, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.4615, 'acc_0_0': 0.9431, 'acc_0_1': 0.9942, 'acc_1_0': 0.8956, 'acc_1_1': 0.4615, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4389, 'acc_0_0': 0.9478, 'acc_0_1': 0.994, 'acc_1_0': 0.8911, 'acc_1_1': 0.4389, 'mean_acc': 0.9536}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3958, 'acc_0_0': 0.9553, 'acc_0_1': 0.9955, 'acc_1_0': 0.8641, 'acc_1_1': 0.3958, 'mean_acc': 0.9542}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2857, 'acc_0_0': 0.9499, 'acc_0_1': 0.9966, 'acc_1_0': 0.8796, 'acc_1_1': 0.2857, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3111, 'acc_0_0': 0.9542, 'acc_0_1': 0.9971, 'acc_1_0': 0.8698, 'acc_1_1': 0.3111, 'mean_acc': 0.9541}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4189, 'acc_0_0': 0.956, 'acc_0_1': 0.9956, 'acc_1_0': 0.8632, 'acc_1_1': 0.4189, 'mean_acc': 0.9546}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.1538, 'acc_0_0': 0.9597, 'acc_0_1': 0.9986, 'acc_1_0': 0.8553, 'acc_1_1': 0.1538, 'mean_acc': 0.9534}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.2667, 'acc_0_0': 0.9621, 'acc_0_1': 0.9981, 'acc_1_0': 0.8488, 'acc_1_1': 0.2667, 'mean_acc': 0.9554}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4247, 'acc_0_0': 0.9571, 'acc_0_1': 0.9958, 'acc_1_0': 0.866, 'acc_1_1': 0.4247, 'mean_acc': 0.9556}
Val(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.3187, 'acc_0_0': 0.9541, 'acc_0_1': 0.9964, 'acc_1_0': 0.8553, 'acc_1_1': 0.3187, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3611, 'acc_0_0': 0.9595, 'acc_0_1': 0.9962, 'acc_1_0': 0.8524, 'acc_1_1': 0.3611, 'mean_acc': 0.9546}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4463, 'acc_0_0': 0.9579, 'acc_0_1': 0.9956, 'acc_1_0': 0.868, 'acc_1_1': 0.4463, 'mean_acc': 0.9564}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.2967, 'acc_0_0': 0.9569, 'acc_0_1': 0.9976, 'acc_1_0': 0.858, 'acc_1_1': 0.2967, 'mean_acc': 0.9535}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3944, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.852, 'acc_1_1': 0.3944, 'mean_acc': 0.9538}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4506, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.8725, 'acc_1_1': 0.4506, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.2527, 'acc_0_0': 0.9698, 'acc_0_1': 0.9966, 'acc_1_0': 0.794, 'acc_1_1': 0.2527, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.2889, 'acc_0_0': 0.9728, 'acc_0_1': 0.9976, 'acc_1_0': 0.7802, 'acc_1_1': 0.2889, 'mean_acc': 0.9521}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.447, 'acc_0_0': 0.9587, 'acc_0_1': 0.9956, 'acc_1_0': 0.8716, 'acc_1_1': 0.447, 'mean_acc': 0.9573}
Val(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.2747, 'acc_0_0': 0.9578, 'acc_0_1': 0.9983, 'acc_1_0': 0.8629, 'acc_1_1': 0.2747, 'mean_acc': 0.9547}
Test(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.3056, 'acc_0_0': 0.9601, 'acc_0_1': 0.9964, 'acc_1_0': 0.8508, 'acc_1_1': 0.3056, 'mean_acc': 0.9543}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9594, 'acc_0_1': 0.9959, 'acc_1_0': 0.8753, 'acc_1_1': 0.4845, 'mean_acc': 0.9586}
Val(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2308, 'acc_0_0': 0.9616, 'acc_0_1': 0.9983, 'acc_1_0': 0.8295, 'acc_1_1': 0.2308, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3444, 'acc_0_0': 0.9669, 'acc_0_1': 0.9969, 'acc_1_0': 0.8222, 'acc_1_1': 0.3444, 'mean_acc': 0.9547}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9597, 'acc_0_1': 0.9956, 'acc_1_0': 0.874, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3956, 'acc_0_0': 0.9503, 'acc_0_1': 0.9954, 'acc_1_0': 0.8643, 'acc_1_1': 0.3956, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.4222, 'acc_0_0': 0.9568, 'acc_0_1': 0.9935, 'acc_1_0': 0.8593, 'acc_1_1': 0.4222, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5076, 'acc_0_0': 0.9604, 'acc_0_1': 0.9957, 'acc_1_0': 0.8768, 'acc_1_1': 0.5076, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.4945, 'acc_0_0': 0.9496, 'acc_0_1': 0.9935, 'acc_1_0': 0.8685, 'acc_1_1': 0.4945, 'mean_acc': 0.952}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.45, 'acc_0_0': 0.9566, 'acc_0_1': 0.9926, 'acc_1_0': 0.8657, 'acc_1_1': 0.45, 'mean_acc': 0.9543}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5133, 'acc_0_0': 0.9598, 'acc_0_1': 0.9957, 'acc_1_0': 0.8791, 'acc_1_1': 0.5133, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3297, 'acc_0_0': 0.9536, 'acc_0_1': 0.9969, 'acc_1_0': 0.8518, 'acc_1_1': 0.3297, 'mean_acc': 0.9512}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3556, 'acc_0_0': 0.9588, 'acc_0_1': 0.9955, 'acc_1_0': 0.846, 'acc_1_1': 0.3556, 'mean_acc': 0.9532}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.54, 'acc_0_0': 0.9608, 'acc_0_1': 0.9956, 'acc_1_0': 0.8799, 'acc_1_1': 0.54, 'mean_acc': 0.9602}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3297, 'acc_0_0': 0.9677, 'acc_0_1': 0.9964, 'acc_1_0': 0.7947, 'acc_1_1': 0.3297, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.3611, 'acc_0_0': 0.9699, 'acc_0_1': 0.995, 'acc_1_0': 0.7859, 'acc_1_1': 0.3611, 'mean_acc': 0.951}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9611, 'acc_0_1': 0.9958, 'acc_1_0': 0.8798, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.2418, 'acc_0_0': 0.9592, 'acc_0_1': 0.9978, 'acc_1_0': 0.8399, 'acc_1_1': 0.2418, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.3444, 'acc_0_0': 0.9624, 'acc_0_1': 0.9972, 'acc_1_0': 0.8335, 'acc_1_1': 0.3444, 'mean_acc': 0.954}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5544, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.8812, 'acc_1_1': 0.5544, 'mean_acc': 0.9607}
Val(class): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.1758, 'acc_0_0': 0.9756, 'acc_0_1': 0.9983, 'acc_1_0': 0.7314, 'acc_1_1': 0.1758, 'mean_acc': 0.9424}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2389, 'acc_0_0': 0.9777, 'acc_0_1': 0.9981, 'acc_1_0': 0.7246, 'acc_1_1': 0.2389, 'mean_acc': 0.9473}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.558, 'acc_0_0': 0.9615, 'acc_0_1': 0.996, 'acc_1_0': 0.8826, 'acc_1_1': 0.558, 'mean_acc': 0.9612}
Val(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.4176, 'acc_0_0': 0.9515, 'acc_0_1': 0.9937, 'acc_1_0': 0.8706, 'acc_1_1': 0.4176, 'mean_acc': 0.9525}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.4056, 'acc_0_0': 0.9572, 'acc_0_1': 0.9947, 'acc_1_0': 0.8609, 'acc_1_1': 0.4056, 'mean_acc': 0.9544}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5847, 'acc_0_0': 0.9623, 'acc_0_1': 0.9958, 'acc_1_0': 0.8834, 'acc_1_1': 0.5847, 'mean_acc': 0.9618}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.4176, 'acc_0_0': 0.937, 'acc_0_1': 0.9937, 'acc_1_0': 0.8831, 'acc_1_1': 0.4176, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9457, 'acc_0_1': 0.9926, 'acc_1_0': 0.8819, 'acc_1_1': 0.4556, 'mean_acc': 0.9511}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5811, 'acc_0_0': 0.9626, 'acc_0_1': 0.9959, 'acc_1_0': 0.887, 'acc_1_1': 0.5811, 'mean_acc': 0.9624}
Val(class): {'weighted_mean_acc': 0.9512, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9935, 'acc_1_0': 0.8434, 'acc_1_1': 0.3846, 'mean_acc': 0.9506}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4222, 'acc_0_0': 0.962, 'acc_0_1': 0.9931, 'acc_1_0': 0.8323, 'acc_1_1': 0.4222, 'mean_acc': 0.9528}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9634, 'acc_0_1': 0.9956, 'acc_1_0': 0.8852, 'acc_1_1': 0.5926, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.3516, 'acc_0_0': 0.9576, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.3516, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3889, 'acc_0_0': 0.9604, 'acc_0_1': 0.9951, 'acc_1_0': 0.8343, 'acc_1_1': 0.3889, 'mean_acc': 0.9527}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.6157, 'acc_0_0': 0.9635, 'acc_0_1': 0.9959, 'acc_1_0': 0.8902, 'acc_1_1': 0.6157, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9466, 'worst_acc': 0.4396, 'acc_0_0': 0.9306, 'acc_0_1': 0.994, 'acc_1_0': 0.8887, 'acc_1_1': 0.4396, 'mean_acc': 0.9464}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.4722, 'acc_0_0': 0.9446, 'acc_0_1': 0.9918, 'acc_1_0': 0.877, 'acc_1_1': 0.4722, 'mean_acc': 0.9498}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.6128, 'acc_0_0': 0.9635, 'acc_0_1': 0.9961, 'acc_1_0': 0.8885, 'acc_1_1': 0.6128, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3407, 'acc_0_0': 0.9623, 'acc_0_1': 0.9925, 'acc_1_0': 0.8191, 'acc_1_1': 0.3407, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3833, 'acc_0_0': 0.9664, 'acc_0_1': 0.994, 'acc_1_0': 0.8169, 'acc_1_1': 0.3833, 'mean_acc': 0.953}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.6172, 'acc_0_0': 0.964, 'acc_0_1': 0.9958, 'acc_1_0': 0.8887, 'acc_1_1': 0.6172, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.2527, 'acc_0_0': 0.9456, 'acc_0_1': 0.9983, 'acc_1_0': 0.8706, 'acc_1_1': 0.2527, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.35, 'acc_0_0': 0.9515, 'acc_0_1': 0.9972, 'acc_1_0': 0.8613, 'acc_1_1': 0.35, 'mean_acc': 0.9521}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9637, 'acc_0_1': 0.9959, 'acc_1_0': 0.8886, 'acc_1_1': 0.62, 'mean_acc': 0.9634}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2857, 'acc_0_0': 0.9625, 'acc_0_1': 0.9969, 'acc_1_0': 0.8086, 'acc_1_1': 0.2857, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3222, 'acc_0_0': 0.9656, 'acc_0_1': 0.9958, 'acc_1_0': 0.8056, 'acc_1_1': 0.3222, 'mean_acc': 0.9513}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6222, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.8909, 'acc_1_1': 0.6222, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.4286, 'acc_0_0': 0.9426, 'acc_0_1': 0.9937, 'acc_1_0': 0.8754, 'acc_1_1': 0.4286, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4556, 'acc_0_0': 0.9478, 'acc_0_1': 0.9922, 'acc_1_0': 0.8641, 'acc_1_1': 0.4556, 'mean_acc': 0.9497}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6561, 'acc_0_0': 0.965, 'acc_0_1': 0.9962, 'acc_1_0': 0.8942, 'acc_1_1': 0.6561, 'mean_acc': 0.9652}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.2747, 'acc_0_0': 0.9405, 'acc_0_1': 0.9973, 'acc_1_0': 0.8852, 'acc_1_1': 0.2747, 'mean_acc': 0.9501}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3167, 'acc_0_0': 0.9483, 'acc_0_1': 0.9956, 'acc_1_0': 0.873, 'acc_1_1': 0.3167, 'mean_acc': 0.9511}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6431, 'acc_0_0': 0.9654, 'acc_0_1': 0.996, 'acc_1_0': 0.8925, 'acc_1_1': 0.6431, 'mean_acc': 0.965}
Val(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.4725, 'acc_0_0': 0.9386, 'acc_0_1': 0.993, 'acc_1_0': 0.8747, 'acc_1_1': 0.4725, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.4778, 'acc_0_0': 0.9495, 'acc_0_1': 0.9926, 'acc_1_0': 0.8681, 'acc_1_1': 0.4778, 'mean_acc': 0.9514}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6402, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.892, 'acc_1_1': 0.6402, 'mean_acc': 0.9646}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2527, 'acc_0_0': 0.9536, 'acc_0_1': 0.9961, 'acc_1_0': 0.8281, 'acc_1_1': 0.2527, 'mean_acc': 0.9467}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3833, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8335, 'acc_1_1': 0.3833, 'mean_acc': 0.9516}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6655, 'acc_0_0': 0.9653, 'acc_0_1': 0.9962, 'acc_1_0': 0.8916, 'acc_1_1': 0.6655, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3846, 'acc_0_0': 0.9632, 'acc_0_1': 0.9925, 'acc_1_0': 0.8267, 'acc_1_1': 0.3846, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.4444, 'acc_0_0': 0.9637, 'acc_0_1': 0.992, 'acc_1_0': 0.8165, 'acc_1_1': 0.4444, 'mean_acc': 0.9514}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6597, 'acc_0_0': 0.9658, 'acc_0_1': 0.9963, 'acc_1_0': 0.8945, 'acc_1_1': 0.6597, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.3846, 'acc_0_0': 0.9372, 'acc_0_1': 0.9942, 'acc_1_0': 0.8775, 'acc_1_1': 0.3846, 'mean_acc': 0.9473}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4889, 'acc_0_0': 0.9454, 'acc_0_1': 0.9919, 'acc_1_0': 0.881, 'acc_1_1': 0.4889, 'mean_acc': 0.9509}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6626, 'acc_0_0': 0.9663, 'acc_0_1': 0.9962, 'acc_1_0': 0.8943, 'acc_1_1': 0.6626, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3846, 'acc_0_0': 0.9499, 'acc_0_1': 0.9949, 'acc_1_0': 0.8483, 'acc_1_1': 0.3846, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4389, 'acc_0_0': 0.9554, 'acc_0_1': 0.9932, 'acc_1_0': 0.8335, 'acc_1_1': 0.4389, 'mean_acc': 0.9499}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6806, 'acc_0_0': 0.9669, 'acc_0_1': 0.9961, 'acc_1_0': 0.8973, 'acc_1_1': 0.6806, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2418, 'acc_0_0': 0.9452, 'acc_0_1': 0.9973, 'acc_1_0': 0.8518, 'acc_1_1': 0.2418, 'mean_acc': 0.9469}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3222, 'acc_0_0': 0.9501, 'acc_0_1': 0.9946, 'acc_1_0': 0.8431, 'acc_1_1': 0.3222, 'mean_acc': 0.948}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6792, 'acc_0_0': 0.9668, 'acc_0_1': 0.9962, 'acc_1_0': 0.8991, 'acc_1_1': 0.6792, 'mean_acc': 0.9669}
Val(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3407, 'acc_0_0': 0.9419, 'acc_0_1': 0.9949, 'acc_1_0': 0.8782, 'acc_1_1': 0.3407, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4056, 'acc_0_0': 0.9486, 'acc_0_1': 0.9938, 'acc_1_0': 0.873, 'acc_1_1': 0.4056, 'mean_acc': 0.9514}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6799, 'acc_0_0': 0.9673, 'acc_0_1': 0.9963, 'acc_1_0': 0.9003, 'acc_1_1': 0.6799, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.2747, 'acc_0_0': 0.9332, 'acc_0_1': 0.9964, 'acc_1_0': 0.8817, 'acc_1_1': 0.2747, 'mean_acc': 0.946}
Test(class): {'weighted_mean_acc': 0.9495, 'worst_acc': 0.3167, 'acc_0_0': 0.9457, 'acc_0_1': 0.9948, 'acc_1_0': 0.8669, 'acc_1_1': 0.3167, 'mean_acc': 0.9488}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6763, 'acc_0_0': 0.9663, 'acc_0_1': 0.9965, 'acc_1_0': 0.8969, 'acc_1_1': 0.6763, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.3626, 'acc_0_0': 0.9567, 'acc_0_1': 0.9913, 'acc_1_0': 0.8114, 'acc_1_1': 0.3626, 'mean_acc': 0.9446}
Test(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.4, 'acc_0_0': 0.9634, 'acc_0_1': 0.992, 'acc_1_0': 0.8081, 'acc_1_1': 0.4, 'mean_acc': 0.9499}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.695, 'acc_0_0': 0.9675, 'acc_0_1': 0.9964, 'acc_1_0': 0.8981, 'acc_1_1': 0.695, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.3187, 'acc_0_0': 0.9213, 'acc_0_1': 0.9949, 'acc_1_0': 0.9019, 'acc_1_1': 0.3187, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4222, 'acc_0_0': 0.9339, 'acc_0_1': 0.9947, 'acc_1_0': 0.898, 'acc_1_1': 0.4222, 'mean_acc': 0.9478}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6986, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.8998, 'acc_1_1': 0.6986, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3626, 'acc_0_0': 0.9618, 'acc_0_1': 0.9957, 'acc_1_0': 0.8093, 'acc_1_1': 0.3626, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3667, 'acc_0_0': 0.964, 'acc_0_1': 0.994, 'acc_1_0': 0.7988, 'acc_1_1': 0.3667, 'mean_acc': 0.9494}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7073, 'acc_0_0': 0.9682, 'acc_0_1': 0.9965, 'acc_1_0': 0.8998, 'acc_1_1': 0.7073, 'mean_acc': 0.968}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.5165, 'acc_0_0': 0.9473, 'acc_0_1': 0.9894, 'acc_1_0': 0.8594, 'acc_1_1': 0.5165, 'mean_acc': 0.9482}
Test(class): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.5389, 'acc_0_0': 0.9498, 'acc_0_1': 0.9877, 'acc_1_0': 0.85, 'acc_1_1': 0.5389, 'mean_acc': 0.948}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6914, 'acc_0_0': 0.9686, 'acc_0_1': 0.9965, 'acc_1_0': 0.9014, 'acc_1_1': 0.6914, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9959, 'acc_1_0': 0.8072, 'acc_1_1': 0.3077, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.3944, 'acc_0_0': 0.9615, 'acc_0_1': 0.9944, 'acc_1_0': 0.804, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.2747, 'acc_0_0': 0.989, 'acc_0_1': 1.0, 'acc_1_0': 0.6044, 'acc_1_1': 0.2747, 'mean_acc': 0.717}
Val(class)(new adapter): {'weighted_mean_acc': 0.946, 'worst_acc': 0.5604, 'acc_0_0': 0.9569, 'acc_0_1': 0.9913, 'acc_1_0': 0.8031, 'acc_1_1': 0.5604, 'mean_acc': 0.9453}
Test(class)(new adapter): {'weighted_mean_acc': 0.945, 'worst_acc': 0.5222, 'acc_0_0': 0.9616, 'acc_0_1': 0.9881, 'acc_1_0': 0.7927, 'acc_1_1': 0.5222, 'mean_acc': 0.9466}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6593, 'acc_0_0': 0.956, 'acc_0_1': 0.6593, 'acc_1_0': 0.8242, 'acc_1_1': 0.7802, 'mean_acc': 0.8049}
Val(class)(new adapter): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.7582, 'acc_0_0': 0.9194, 'acc_0_1': 0.9734, 'acc_1_0': 0.8949, 'acc_1_1': 0.7582, 'mean_acc': 0.9369}
Test(class)(new adapter): {'weighted_mean_acc': 0.9388, 'worst_acc': 0.7056, 'acc_0_0': 0.9337, 'acc_0_1': 0.9688, 'acc_1_0': 0.881, 'acc_1_1': 0.7056, 'mean_acc': 0.9383}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.8681, 'acc_0_1': 0.967, 'acc_1_0': 0.8901, 'acc_1_1': 0.967, 'mean_acc': 0.9231}
Val(class)(new adapter): {'weighted_mean_acc': 0.894, 'worst_acc': 0.883, 'acc_0_0': 0.8953, 'acc_0_1': 0.883, 'acc_1_0': 0.9207, 'acc_1_1': 0.9231, 'mean_acc': 0.8941}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.881, 'acc_0_0': 0.9106, 'acc_0_1': 0.881, 'acc_1_0': 0.9149, 'acc_1_1': 0.9222, 'mean_acc': 0.9001}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7692, 'acc_0_0': 0.7692, 'acc_0_1': 0.8571, 'acc_1_0': 0.9011, 'acc_1_1': 0.9011, 'mean_acc': 0.8571}
Val(class)(new adapter): {'weighted_mean_acc': 0.8533, 'worst_acc': 0.0146, 'acc_0_0': 0.9993, 'acc_0_1': 0.9889, 'acc_1_0': 0.0146, 'acc_1_1': 0.6154, 'mean_acc': 0.849}
Test(class)(new adapter): {'weighted_mean_acc': 0.8504, 'worst_acc': 0.0117, 'acc_0_0': 0.9996, 'acc_0_1': 0.9859, 'acc_1_0': 0.0117, 'acc_1_1': 0.45, 'mean_acc': 0.8667}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8132, 'acc_0_0': 0.8901, 'acc_0_1': 0.9011, 'acc_1_0': 0.8132, 'acc_1_1': 0.9011, 'mean_acc': 0.8764}
Val(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.8462, 'acc_0_0': 0.8889, 'acc_0_1': 0.929, 'acc_1_0': 0.9464, 'acc_1_1': 0.8462, 'mean_acc': 0.9135}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.8444, 'acc_0_0': 0.9036, 'acc_0_1': 0.9222, 'acc_1_0': 0.9363, 'acc_1_1': 0.8444, 'mean_acc': 0.9141}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7912, 'acc_0_0': 0.7912, 'acc_0_1': 0.8901, 'acc_1_0': 0.9121, 'acc_1_1': 0.9451, 'mean_acc': 0.8846}
Val(class)(new adapter): {'weighted_mean_acc': 0.8696, 'worst_acc': 0.2122, 'acc_0_0': 0.9951, 'acc_0_1': 0.9623, 'acc_1_0': 0.2122, 'acc_1_1': 0.7692, 'mean_acc': 0.8661}
Test(class)(new adapter): {'weighted_mean_acc': 0.867, 'worst_acc': 0.1903, 'acc_0_0': 0.9954, 'acc_0_1': 0.9644, 'acc_1_0': 0.1903, 'acc_1_1': 0.7, 'mean_acc': 0.881}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8352, 'acc_0_0': 0.9341, 'acc_0_1': 0.9231, 'acc_1_0': 0.8352, 'acc_1_1': 0.9341, 'mean_acc': 0.9066}
Val(class)(new adapter): {'weighted_mean_acc': 0.9024, 'worst_acc': 0.8571, 'acc_0_0': 0.8606, 'acc_0_1': 0.9302, 'acc_1_0': 0.9548, 'acc_1_1': 0.8571, 'mean_acc': 0.9032}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.8667, 'acc_0_0': 0.8815, 'acc_0_1': 0.9283, 'acc_1_0': 0.9448, 'acc_1_1': 0.8667, 'mean_acc': 0.9069}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.9341, 'acc_1_0': 0.9341, 'acc_1_1': 0.956, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.6841, 'acc_0_0': 0.9716, 'acc_0_1': 0.977, 'acc_1_0': 0.6841, 'acc_1_1': 0.7473, 'mean_acc': 0.9302}
Test(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.6601, 'acc_0_0': 0.9784, 'acc_0_1': 0.9741, 'acc_1_0': 0.6601, 'acc_1_1': 0.6778, 'mean_acc': 0.9345}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.956, 'acc_0_1': 0.978, 'acc_1_0': 0.956, 'acc_1_1': 0.9341, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.8681, 'acc_0_0': 0.881, 'acc_0_1': 0.9362, 'acc_1_0': 0.9548, 'acc_1_1': 0.8681, 'mean_acc': 0.9145}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.8722, 'acc_0_0': 0.8988, 'acc_0_1': 0.9305, 'acc_1_0': 0.9403, 'acc_1_1': 0.8722, 'mean_acc': 0.9157}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.9451, 'acc_1_0': 0.9341, 'acc_1_1': 0.989, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9383, 'worst_acc': 0.7912, 'acc_0_0': 0.9405, 'acc_0_1': 0.9611, 'acc_1_0': 0.874, 'acc_1_1': 0.7912, 'mean_acc': 0.9381}
Test(class)(new adapter): {'weighted_mean_acc': 0.9401, 'worst_acc': 0.7722, 'acc_0_0': 0.9524, 'acc_0_1': 0.9589, 'acc_1_0': 0.8573, 'acc_1_1': 0.7722, 'mean_acc': 0.9414}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.956, 'acc_1_0': 0.956, 'acc_1_1': 0.956, 'mean_acc': 0.9505}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.8957, 'acc_0_0': 0.8957, 'acc_0_1': 0.9038, 'acc_1_0': 0.9408, 'acc_1_1': 0.9011, 'mean_acc': 0.9057}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.8948, 'acc_0_0': 0.9147, 'acc_0_1': 0.8948, 'acc_1_0': 0.9306, 'acc_1_1': 0.9278, 'mean_acc': 0.9093}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9341, 'acc_0_1': 0.9231, 'acc_1_0': 0.989, 'acc_1_1': 0.989, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.8267, 'acc_0_0': 0.9557, 'acc_0_1': 0.9534, 'acc_1_0': 0.8267, 'acc_1_1': 0.8352, 'mean_acc': 0.935}
Test(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.7833, 'acc_0_0': 0.9619, 'acc_0_1': 0.9514, 'acc_1_0': 0.8073, 'acc_1_1': 0.7833, 'mean_acc': 0.9371}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9341, 'acc_0_1': 0.978, 'acc_1_0': 0.9231, 'acc_1_1': 0.978, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.9, 'acc_0_0': 0.9, 'acc_0_1': 0.9137, 'acc_1_0': 0.945, 'acc_1_1': 0.9121, 'mean_acc': 0.9123}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.8944, 'acc_0_0': 0.9157, 'acc_0_1': 0.9094, 'acc_1_0': 0.9315, 'acc_1_1': 0.8944, 'mean_acc': 0.9151}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.9451, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9319, 'worst_acc': 0.8462, 'acc_0_0': 0.9255, 'acc_0_1': 0.9493, 'acc_1_0': 0.9068, 'acc_1_1': 0.8462, 'mean_acc': 0.932}
Test(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.8, 'acc_0_0': 0.9397, 'acc_0_1': 0.9477, 'acc_1_0': 0.8923, 'acc_1_1': 0.8, 'mean_acc': 0.9356}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9231, 'acc_0_1': 0.956, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.8351, 'acc_0_0': 0.8351, 'acc_0_1': 0.9459, 'acc_1_0': 0.9749, 'acc_1_1': 0.9011, 'mean_acc': 0.9021}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.85, 'acc_0_0': 0.8619, 'acc_0_1': 0.9347, 'acc_1_0': 0.9669, 'acc_1_1': 0.85, 'mean_acc': 0.9023}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.8791, 'acc_0_1': 0.956, 'acc_1_0': 0.9121, 'acc_1_1': 0.956, 'mean_acc': 0.9258}
Val(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.8571, 'acc_0_0': 0.9398, 'acc_0_1': 0.949, 'acc_1_0': 0.8706, 'acc_1_1': 0.8571, 'mean_acc': 0.9329}
Test(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.8389, 'acc_0_0': 0.9496, 'acc_0_1': 0.9407, 'acc_1_0': 0.8581, 'acc_1_1': 0.8389, 'mean_acc': 0.9339}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.978, 'acc_1_0': 0.9341, 'acc_1_1': 0.989, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.8681, 'acc_0_0': 0.8887, 'acc_0_1': 0.9403, 'acc_1_0': 0.9513, 'acc_1_1': 0.8681, 'mean_acc': 0.9191}
Test(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.8778, 'acc_0_0': 0.9066, 'acc_0_1': 0.9294, 'acc_1_0': 0.944, 'acc_1_1': 0.8778, 'mean_acc': 0.9196}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.956, 'acc_0_0': 0.956, 'acc_0_1': 0.967, 'acc_1_0': 0.978, 'acc_1_1': 0.978, 'mean_acc': 0.9698}
Val(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.9011, 'acc_0_0': 0.9131, 'acc_0_1': 0.9132, 'acc_1_0': 0.9318, 'acc_1_1': 0.9011, 'mean_acc': 0.9157}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8778, 'acc_0_0': 0.9295, 'acc_0_1': 0.9117, 'acc_1_0': 0.9105, 'acc_1_1': 0.8778, 'mean_acc': 0.9199}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.956, 'acc_0_1': 0.9231, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.8571, 'acc_0_0': 0.8798, 'acc_0_1': 0.9522, 'acc_1_0': 0.9569, 'acc_1_1': 0.8571, 'mean_acc': 0.9209}
Test(class)(new adapter): {'weighted_mean_acc': 0.9244, 'worst_acc': 0.8167, 'acc_0_0': 0.8988, 'acc_0_1': 0.9464, 'acc_1_0': 0.9468, 'acc_1_1': 0.8167, 'mean_acc': 0.922}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.956, 'acc_1_0': 0.9231, 'acc_1_1': 0.978, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.8352, 'acc_0_0': 0.885, 'acc_0_1': 0.9703, 'acc_1_0': 0.9541, 'acc_1_1': 0.8352, 'mean_acc': 0.93}
Test(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7556, 'acc_0_0': 0.9012, 'acc_0_1': 0.9615, 'acc_1_0': 0.9407, 'acc_1_1': 0.7556, 'mean_acc': 0.9276}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 1.0, 'acc_1_0': 0.9341, 'acc_1_1': 0.978, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8864, 'worst_acc': 0.8341, 'acc_0_0': 0.8341, 'acc_0_1': 0.9103, 'acc_1_0': 0.9784, 'acc_1_1': 0.9121, 'mean_acc': 0.8875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8926, 'worst_acc': 0.8633, 'acc_0_0': 0.8633, 'acc_0_1': 0.8977, 'acc_1_0': 0.9677, 'acc_1_1': 0.9222, 'mean_acc': 0.8898}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.9451, 'acc_1_0': 0.9341, 'acc_1_1': 0.978, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.8414, 'acc_0_0': 0.8414, 'acc_0_1': 0.9425, 'acc_1_0': 0.9722, 'acc_1_1': 0.8901, 'mean_acc': 0.9029}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.85, 'acc_0_0': 0.8653, 'acc_0_1': 0.9331, 'acc_1_0': 0.9669, 'acc_1_1': 0.85, 'mean_acc': 0.9034}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8571, 'acc_0_0': 0.8571, 'acc_0_1': 0.967, 'acc_1_0': 0.9231, 'acc_1_1': 1.0, 'mean_acc': 0.9368}
Val(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.8681, 'acc_0_0': 0.8843, 'acc_0_1': 0.9476, 'acc_1_0': 0.9499, 'acc_1_1': 0.8681, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.8389, 'acc_0_0': 0.8985, 'acc_0_1': 0.9408, 'acc_1_0': 0.9452, 'acc_1_1': 0.8389, 'mean_acc': 0.9197}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.978, 'acc_1_0': 0.9231, 'acc_1_1': 0.978, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.8681, 'acc_0_0': 0.8948, 'acc_0_1': 0.9466, 'acc_1_0': 0.9429, 'acc_1_1': 0.8681, 'mean_acc': 0.9231}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.8333, 'acc_0_0': 0.9054, 'acc_0_1': 0.9364, 'acc_1_0': 0.9411, 'acc_1_1': 0.8333, 'mean_acc': 0.9209}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 1.0, 'mean_acc': 0.967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8791, 'acc_0_0': 0.8939, 'acc_0_1': 0.9495, 'acc_1_0': 0.9457, 'acc_1_1': 0.8791, 'mean_acc': 0.9244}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8278, 'acc_0_0': 0.9065, 'acc_0_1': 0.9392, 'acc_1_0': 0.9367, 'acc_1_1': 0.8278, 'mean_acc': 0.9219}
========================================================================
> end of training. 

best epoch : 58
best training accuracy on [class]: {'worst_acc': 0.956, 'acc_0_0': 0.956, 'acc_0_1': 0.967, 'acc_1_0': 0.978, 'acc_1_1': 0.978, 'mean_acc': 0.9698}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9157, 'worst_acc': 0.9011, 'acc_0_0': 0.9131, 'acc_0_1': 0.9132, 'acc_1_0': 0.9318, 'acc_1_1': 0.9011, 'mean_acc': 0.9157}
best test accuracy on [class]: {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8778, 'acc_0_0': 0.9295, 'acc_0_1': 0.9117, 'acc_1_0': 0.9105, 'acc_1_1': 0.8778, 'mean_acc': 0.9199}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8778, 'acc_0_0': 0.9295, 'acc_0_1': 0.9117, 'acc_1_0': 0.9105, 'acc_1_1': 0.8778, 'mean_acc': 0.9199}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9862, 'worst_acc': 0.9333, 'acc_0_0': 0.9847, 'acc_0_1': 0.9875, 'acc_1_0': 0.9903, 'acc_1_1': 0.9333, 'mean_acc': 0.986}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
f=============Iteration : 2/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[8] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3028, 'acc_0_0': 0.9456, 'acc_0_1': 0.9945, 'acc_1_0': 0.8457, 'acc_1_1': 0.3028, 'mean_acc': 0.9461}
Val(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3516, 'acc_0_0': 0.9649, 'acc_0_1': 0.9964, 'acc_1_0': 0.8253, 'acc_1_1': 0.3516, 'mean_acc': 0.9522}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3667, 'acc_0_0': 0.9684, 'acc_0_1': 0.9965, 'acc_1_0': 0.8125, 'acc_1_1': 0.3667, 'mean_acc': 0.9542}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.349, 'acc_0_0': 0.9517, 'acc_0_1': 0.9954, 'acc_1_0': 0.8544, 'acc_1_1': 0.349, 'mean_acc': 0.9508}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9949, 'acc_1_0': 0.8838, 'acc_1_1': 0.3956, 'mean_acc': 0.9532}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.4278, 'acc_0_0': 0.9511, 'acc_0_1': 0.995, 'acc_1_0': 0.8815, 'acc_1_1': 0.4278, 'mean_acc': 0.9543}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3583, 'acc_0_0': 0.9539, 'acc_0_1': 0.9952, 'acc_1_0': 0.861, 'acc_1_1': 0.3583, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9957, 'acc_1_0': 0.881, 'acc_1_1': 0.3956, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.4167, 'acc_0_0': 0.9553, 'acc_0_1': 0.994, 'acc_1_0': 0.8714, 'acc_1_1': 0.4167, 'mean_acc': 0.9546}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3879, 'acc_0_0': 0.9555, 'acc_0_1': 0.9957, 'acc_1_0': 0.8647, 'acc_1_1': 0.3879, 'mean_acc': 0.9544}
Val(class): {'weighted_mean_acc': 0.9472, 'worst_acc': 0.2308, 'acc_0_0': 0.9663, 'acc_0_1': 0.9966, 'acc_1_0': 0.7864, 'acc_1_1': 0.2308, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.35, 'acc_0_0': 0.9707, 'acc_0_1': 0.996, 'acc_1_0': 0.7827, 'acc_1_1': 0.35, 'mean_acc': 0.9513}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3965, 'acc_0_0': 0.9565, 'acc_0_1': 0.9957, 'acc_1_0': 0.8656, 'acc_1_1': 0.3965, 'mean_acc': 0.9551}
Val(class): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.1978, 'acc_0_0': 0.9738, 'acc_0_1': 0.9976, 'acc_1_0': 0.7523, 'acc_1_1': 0.1978, 'mean_acc': 0.9445}
Test(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.2333, 'acc_0_0': 0.9787, 'acc_0_1': 0.9987, 'acc_1_0': 0.7391, 'acc_1_1': 0.2333, 'mean_acc': 0.9498}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4239, 'acc_0_0': 0.9559, 'acc_0_1': 0.9957, 'acc_1_0': 0.8682, 'acc_1_1': 0.4239, 'mean_acc': 0.9554}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2418, 'acc_0_0': 0.962, 'acc_0_1': 0.9966, 'acc_1_0': 0.8302, 'acc_1_1': 0.2418, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3444, 'acc_0_0': 0.9684, 'acc_0_1': 0.9969, 'acc_1_0': 0.823, 'acc_1_1': 0.3444, 'mean_acc': 0.9555}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4362, 'acc_0_0': 0.9573, 'acc_0_1': 0.9955, 'acc_1_0': 0.8696, 'acc_1_1': 0.4362, 'mean_acc': 0.9562}
Val(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.3846, 'acc_0_0': 0.9342, 'acc_0_1': 0.9947, 'acc_1_0': 0.904, 'acc_1_1': 0.3846, 'mean_acc': 0.95}
Test(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4278, 'acc_0_0': 0.9429, 'acc_0_1': 0.9934, 'acc_1_0': 0.894, 'acc_1_1': 0.4278, 'mean_acc': 0.9512}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4521, 'acc_0_0': 0.9583, 'acc_0_1': 0.9956, 'acc_1_0': 0.8706, 'acc_1_1': 0.4521, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.2857, 'acc_0_0': 0.9475, 'acc_0_1': 0.9969, 'acc_1_0': 0.872, 'acc_1_1': 0.2857, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.3389, 'acc_0_0': 0.9569, 'acc_0_1': 0.9972, 'acc_1_0': 0.8706, 'acc_1_1': 0.3389, 'mean_acc': 0.9558}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4722, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8715, 'acc_1_1': 0.4722, 'mean_acc': 0.9572}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.2527, 'acc_0_0': 0.9623, 'acc_0_1': 0.9969, 'acc_1_0': 0.8072, 'acc_1_1': 0.2527, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3111, 'acc_0_0': 0.9632, 'acc_0_1': 0.9964, 'acc_1_0': 0.8173, 'acc_1_1': 0.3111, 'mean_acc': 0.9518}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.4758, 'acc_0_0': 0.9594, 'acc_0_1': 0.9955, 'acc_1_0': 0.8713, 'acc_1_1': 0.4758, 'mean_acc': 0.9577}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.2418, 'acc_0_0': 0.9538, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.2418, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3222, 'acc_0_0': 0.961, 'acc_0_1': 0.9969, 'acc_1_0': 0.8484, 'acc_1_1': 0.3222, 'mean_acc': 0.9548}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9595, 'acc_0_1': 0.9957, 'acc_1_0': 0.8747, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.9548, 'acc_0_1': 0.9949, 'acc_1_0': 0.8615, 'acc_1_1': 0.3956, 'mean_acc': 0.9529}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3889, 'acc_0_0': 0.9595, 'acc_0_1': 0.9934, 'acc_1_0': 0.848, 'acc_1_1': 0.3889, 'mean_acc': 0.9533}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5004, 'acc_0_0': 0.9593, 'acc_0_1': 0.9955, 'acc_1_0': 0.875, 'acc_1_1': 0.5004, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4615, 'acc_0_0': 0.947, 'acc_0_1': 0.9954, 'acc_1_0': 0.8692, 'acc_1_1': 0.4615, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9538, 'worst_acc': 0.4333, 'acc_0_0': 0.9543, 'acc_0_1': 0.9915, 'acc_1_0': 0.8738, 'acc_1_1': 0.4333, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5126, 'acc_0_0': 0.9605, 'acc_0_1': 0.9956, 'acc_1_0': 0.8763, 'acc_1_1': 0.5126, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4286, 'acc_0_0': 0.9567, 'acc_0_1': 0.9954, 'acc_1_0': 0.8309, 'acc_1_1': 0.4286, 'mean_acc': 0.9498}
Test(class): {'weighted_mean_acc': 0.9532, 'worst_acc': 0.4389, 'acc_0_0': 0.9655, 'acc_0_1': 0.9934, 'acc_1_0': 0.8282, 'acc_1_1': 0.4389, 'mean_acc': 0.9542}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5184, 'acc_0_0': 0.9609, 'acc_0_1': 0.9954, 'acc_1_0': 0.8763, 'acc_1_1': 0.5184, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.2967, 'acc_0_0': 0.9517, 'acc_0_1': 0.9957, 'acc_1_0': 0.8525, 'acc_1_1': 0.2967, 'mean_acc': 0.9497}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.35, 'acc_0_0': 0.9607, 'acc_0_1': 0.996, 'acc_1_0': 0.8524, 'acc_1_1': 0.35, 'mean_acc': 0.9551}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5458, 'acc_0_0': 0.9614, 'acc_0_1': 0.9958, 'acc_1_0': 0.8799, 'acc_1_1': 0.5458, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.4286, 'acc_0_0': 0.9506, 'acc_0_1': 0.9935, 'acc_1_0': 0.8636, 'acc_1_1': 0.4286, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.4889, 'acc_0_0': 0.9547, 'acc_0_1': 0.9906, 'acc_1_0': 0.8593, 'acc_1_1': 0.4889, 'mean_acc': 0.9522}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9608, 'acc_0_1': 0.996, 'acc_1_0': 0.8796, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9947, 'acc_1_0': 0.8309, 'acc_1_1': 0.3077, 'mean_acc': 0.9492}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3778, 'acc_0_0': 0.9642, 'acc_0_1': 0.9951, 'acc_1_0': 0.8302, 'acc_1_1': 0.3778, 'mean_acc': 0.9539}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5523, 'acc_0_0': 0.9622, 'acc_0_1': 0.9958, 'acc_1_0': 0.8812, 'acc_1_1': 0.5523, 'mean_acc': 0.9611}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.2088, 'acc_0_0': 0.9414, 'acc_0_1': 0.9976, 'acc_1_0': 0.881, 'acc_1_1': 0.2088, 'mean_acc': 0.9494}
Test(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.2611, 'acc_0_0': 0.9514, 'acc_0_1': 0.9968, 'acc_1_0': 0.869, 'acc_1_1': 0.2611, 'mean_acc': 0.9521}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.5501, 'acc_0_0': 0.9627, 'acc_0_1': 0.9958, 'acc_1_0': 0.8835, 'acc_1_1': 0.5501, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.5714, 'acc_0_0': 0.9239, 'acc_0_1': 0.9896, 'acc_1_0': 0.9172, 'acc_1_1': 0.5714, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.5278, 'acc_0_0': 0.9336, 'acc_0_1': 0.9857, 'acc_1_0': 0.9081, 'acc_1_1': 0.5278, 'mean_acc': 0.9464}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5789, 'acc_0_0': 0.9632, 'acc_0_1': 0.9961, 'acc_1_0': 0.8858, 'acc_1_1': 0.5789, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9473, 'worst_acc': 0.2198, 'acc_0_0': 0.9649, 'acc_0_1': 0.9978, 'acc_1_0': 0.7884, 'acc_1_1': 0.2198, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.2444, 'acc_0_0': 0.9704, 'acc_0_1': 0.9973, 'acc_1_0': 0.7835, 'acc_1_1': 0.2444, 'mean_acc': 0.9508}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5833, 'acc_0_0': 0.9633, 'acc_0_1': 0.9958, 'acc_1_0': 0.8822, 'acc_1_1': 0.5833, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.3297, 'acc_0_0': 0.9342, 'acc_0_1': 0.9981, 'acc_1_0': 0.8845, 'acc_1_1': 0.3297, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3167, 'acc_0_0': 0.9442, 'acc_0_1': 0.9964, 'acc_1_0': 0.8786, 'acc_1_1': 0.3167, 'mean_acc': 0.9501}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9629, 'acc_0_1': 0.9959, 'acc_1_0': 0.8868, 'acc_1_1': 0.5926, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2967, 'acc_0_0': 0.9515, 'acc_0_1': 0.9959, 'acc_1_0': 0.833, 'acc_1_1': 0.2967, 'mean_acc': 0.9468}
Test(class): {'weighted_mean_acc': 0.9514, 'worst_acc': 0.3556, 'acc_0_0': 0.9622, 'acc_0_1': 0.9947, 'acc_1_0': 0.8274, 'acc_1_1': 0.3556, 'mean_acc': 0.9523}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.5941, 'acc_0_0': 0.9637, 'acc_0_1': 0.9957, 'acc_1_0': 0.8863, 'acc_1_1': 0.5941, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9451, 'worst_acc': 0.4286, 'acc_0_0': 0.937, 'acc_0_1': 0.9918, 'acc_1_0': 0.8657, 'acc_1_1': 0.4286, 'mean_acc': 0.9448}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9462, 'acc_0_1': 0.9906, 'acc_1_0': 0.873, 'acc_1_1': 0.4722, 'mean_acc': 0.9496}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.5955, 'acc_0_0': 0.9645, 'acc_0_1': 0.996, 'acc_1_0': 0.8858, 'acc_1_1': 0.5955, 'mean_acc': 0.9632}
Val(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2418, 'acc_0_0': 0.9358, 'acc_0_1': 0.9986, 'acc_1_0': 0.8873, 'acc_1_1': 0.2418, 'mean_acc': 0.9486}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3222, 'acc_0_0': 0.9446, 'acc_0_1': 0.9963, 'acc_1_0': 0.8827, 'acc_1_1': 0.3222, 'mean_acc': 0.9508}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9645, 'acc_0_1': 0.9959, 'acc_1_0': 0.8903, 'acc_1_1': 0.62, 'mean_acc': 0.964}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.4066, 'acc_0_0': 0.9545, 'acc_0_1': 0.9899, 'acc_1_0': 0.8525, 'acc_1_1': 0.4066, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4889, 'acc_0_0': 0.9599, 'acc_0_1': 0.987, 'acc_1_0': 0.8419, 'acc_1_1': 0.4889, 'mean_acc': 0.9512}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.6345, 'acc_0_0': 0.9647, 'acc_0_1': 0.9957, 'acc_1_0': 0.8888, 'acc_1_1': 0.6345, 'mean_acc': 0.9639}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3077, 'acc_0_0': 0.9456, 'acc_0_1': 0.9964, 'acc_1_0': 0.8615, 'acc_1_1': 0.3077, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3778, 'acc_0_0': 0.9545, 'acc_0_1': 0.9932, 'acc_1_0': 0.85, 'acc_1_1': 0.3778, 'mean_acc': 0.951}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6244, 'acc_0_0': 0.9654, 'acc_0_1': 0.9962, 'acc_1_0': 0.8895, 'acc_1_1': 0.6244, 'mean_acc': 0.9645}
Val(class): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9932, 'acc_1_0': 0.817, 'acc_1_1': 0.3846, 'mean_acc': 0.9466}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9625, 'acc_0_1': 0.992, 'acc_1_0': 0.831, 'acc_1_1': 0.4556, 'mean_acc': 0.9528}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6482, 'acc_0_0': 0.9648, 'acc_0_1': 0.996, 'acc_1_0': 0.89, 'acc_1_1': 0.6482, 'mean_acc': 0.9644}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4725, 'acc_0_0': 0.9302, 'acc_0_1': 0.9906, 'acc_1_0': 0.9019, 'acc_1_1': 0.4725, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4222, 'acc_0_0': 0.9433, 'acc_0_1': 0.991, 'acc_1_0': 0.8948, 'acc_1_1': 0.4222, 'mean_acc': 0.9506}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.646, 'acc_0_0': 0.9653, 'acc_0_1': 0.9963, 'acc_1_0': 0.8909, 'acc_1_1': 0.646, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.4505, 'acc_0_0': 0.9482, 'acc_0_1': 0.9915, 'acc_1_0': 0.8664, 'acc_1_1': 0.4505, 'mean_acc': 0.9499}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9534, 'acc_0_1': 0.9893, 'acc_1_0': 0.8544, 'acc_1_1': 0.4722, 'mean_acc': 0.9503}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9658, 'acc_0_1': 0.9959, 'acc_1_0': 0.8924, 'acc_1_1': 0.6467, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.1978, 'acc_0_0': 0.9618, 'acc_0_1': 0.9954, 'acc_1_0': 0.833, 'acc_1_1': 0.1978, 'mean_acc': 0.9502}
Test(class): {'weighted_mean_acc': 0.9484, 'worst_acc': 0.2944, 'acc_0_0': 0.9639, 'acc_0_1': 0.995, 'acc_1_0': 0.8032, 'acc_1_1': 0.2944, 'mean_acc': 0.9496}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6568, 'acc_0_0': 0.9668, 'acc_0_1': 0.9961, 'acc_1_0': 0.8913, 'acc_1_1': 0.6568, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4176, 'acc_0_0': 0.9503, 'acc_0_1': 0.9949, 'acc_1_0': 0.8664, 'acc_1_1': 0.4176, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.3611, 'acc_0_0': 0.955, 'acc_0_1': 0.9931, 'acc_1_0': 0.8548, 'acc_1_1': 0.3611, 'mean_acc': 0.9516}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6676, 'acc_0_0': 0.9661, 'acc_0_1': 0.9964, 'acc_1_0': 0.8928, 'acc_1_1': 0.6676, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.3407, 'acc_0_0': 0.9299, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.3407, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9487, 'worst_acc': 0.3889, 'acc_0_0': 0.9396, 'acc_0_1': 0.9942, 'acc_1_0': 0.8786, 'acc_1_1': 0.3889, 'mean_acc': 0.9477}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6583, 'acc_0_0': 0.9664, 'acc_0_1': 0.9959, 'acc_1_0': 0.8948, 'acc_1_1': 0.6583, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.1648, 'acc_0_0': 0.9515, 'acc_0_1': 0.9981, 'acc_1_0': 0.8309, 'acc_1_1': 0.1648, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3, 'acc_0_0': 0.9562, 'acc_0_1': 0.9971, 'acc_1_0': 0.8323, 'acc_1_1': 0.3, 'mean_acc': 0.9503}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6683, 'acc_0_0': 0.967, 'acc_0_1': 0.9965, 'acc_1_0': 0.8934, 'acc_1_1': 0.6683, 'mean_acc': 0.9662}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.4286, 'acc_0_0': 0.9616, 'acc_0_1': 0.9894, 'acc_1_0': 0.8246, 'acc_1_1': 0.4286, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4833, 'acc_0_0': 0.9633, 'acc_0_1': 0.987, 'acc_1_0': 0.8077, 'acc_1_1': 0.4833, 'mean_acc': 0.9486}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6741, 'acc_0_0': 0.9669, 'acc_0_1': 0.9962, 'acc_1_0': 0.8967, 'acc_1_1': 0.6741, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.4945, 'acc_0_0': 0.9447, 'acc_0_1': 0.9915, 'acc_1_0': 0.8657, 'acc_1_1': 0.4945, 'mean_acc': 0.9487}
Test(class): {'weighted_mean_acc': 0.9507, 'worst_acc': 0.4833, 'acc_0_0': 0.9502, 'acc_0_1': 0.9894, 'acc_1_0': 0.8677, 'acc_1_1': 0.4833, 'mean_acc': 0.9506}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6669, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.895, 'acc_1_1': 0.6669, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.2857, 'acc_0_0': 0.9351, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.2857, 'mean_acc': 0.9479}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.3944, 'acc_0_0': 0.9425, 'acc_0_1': 0.9944, 'acc_1_0': 0.8911, 'acc_1_1': 0.3944, 'mean_acc': 0.9508}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6727, 'acc_0_0': 0.9672, 'acc_0_1': 0.9962, 'acc_1_0': 0.897, 'acc_1_1': 0.6727, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9422, 'worst_acc': 0.5165, 'acc_0_0': 0.9182, 'acc_0_1': 0.9889, 'acc_1_0': 0.9068, 'acc_1_1': 0.5165, 'mean_acc': 0.9423}
Test(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.5222, 'acc_0_0': 0.9333, 'acc_0_1': 0.9867, 'acc_1_0': 0.8923, 'acc_1_1': 0.5222, 'mean_acc': 0.9447}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.6907, 'acc_0_0': 0.9675, 'acc_0_1': 0.996, 'acc_1_0': 0.8972, 'acc_1_1': 0.6907, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.1978, 'acc_0_0': 0.9597, 'acc_0_1': 0.9957, 'acc_1_0': 0.826, 'acc_1_1': 0.1978, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.3222, 'acc_0_0': 0.9622, 'acc_0_1': 0.9959, 'acc_1_0': 0.8052, 'acc_1_1': 0.3222, 'mean_acc': 0.9497}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6849, 'acc_0_0': 0.9681, 'acc_0_1': 0.9965, 'acc_1_0': 0.8984, 'acc_1_1': 0.6849, 'mean_acc': 0.9676}
Val(class): {'weighted_mean_acc': 0.9455, 'worst_acc': 0.3956, 'acc_0_0': 0.9405, 'acc_0_1': 0.9886, 'acc_1_0': 0.8685, 'acc_1_1': 0.3956, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.4333, 'acc_0_0': 0.9455, 'acc_0_1': 0.9894, 'acc_1_0': 0.8722, 'acc_1_1': 0.4333, 'mean_acc': 0.9484}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.682, 'acc_0_0': 0.9676, 'acc_0_1': 0.9964, 'acc_1_0': 0.8993, 'acc_1_1': 0.682, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3516, 'acc_0_0': 0.9583, 'acc_0_1': 0.9932, 'acc_1_0': 0.8316, 'acc_1_1': 0.3516, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3944, 'acc_0_0': 0.9607, 'acc_0_1': 0.9923, 'acc_1_0': 0.8137, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9681, 'acc_0_1': 0.9964, 'acc_1_0': 0.8997, 'acc_1_1': 0.6957, 'mean_acc': 0.9678}
Val(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.3297, 'acc_0_0': 0.9585, 'acc_0_1': 0.9942, 'acc_1_0': 0.8031, 'acc_1_1': 0.3297, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9468, 'worst_acc': 0.3333, 'acc_0_0': 0.9609, 'acc_0_1': 0.9939, 'acc_1_0': 0.802, 'acc_1_1': 0.3333, 'mean_acc': 0.948}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.2747, 'acc_0_0': 0.978, 'acc_0_1': 1.0, 'acc_1_0': 0.7582, 'acc_1_1': 0.2747, 'mean_acc': 0.7527}
Val(class)(new adapter): {'weighted_mean_acc': 0.938, 'worst_acc': 0.5385, 'acc_0_0': 0.9672, 'acc_0_1': 0.9906, 'acc_1_0': 0.7175, 'acc_1_1': 0.5385, 'mean_acc': 0.9369}
Test(class)(new adapter): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.4056, 'acc_0_0': 0.9713, 'acc_0_1': 0.9902, 'acc_1_0': 0.7101, 'acc_1_1': 0.4056, 'mean_acc': 0.9409}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7143, 'acc_0_0': 0.9121, 'acc_0_1': 0.8901, 'acc_1_0': 0.7363, 'acc_1_1': 0.7143, 'mean_acc': 0.8132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9344, 'worst_acc': 0.7802, 'acc_0_0': 0.9295, 'acc_0_1': 0.9645, 'acc_1_0': 0.8713, 'acc_1_1': 0.7802, 'mean_acc': 0.9343}
Test(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.7222, 'acc_0_0': 0.9366, 'acc_0_1': 0.9636, 'acc_1_0': 0.8665, 'acc_1_1': 0.7222, 'mean_acc': 0.9362}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.9231, 'acc_1_0': 0.9231, 'acc_1_1': 0.9451, 'mean_acc': 0.9258}
Val(class)(new adapter): {'weighted_mean_acc': 0.8472, 'worst_acc': 0.8238, 'acc_0_0': 0.8318, 'acc_0_1': 0.8238, 'acc_1_0': 0.9576, 'acc_1_1': 0.956, 'mean_acc': 0.8478}
Test(class)(new adapter): {'weighted_mean_acc': 0.8529, 'worst_acc': 0.8089, 'acc_0_0': 0.8632, 'acc_0_1': 0.8089, 'acc_1_0': 0.9435, 'acc_1_1': 0.9444, 'mean_acc': 0.8534}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7692, 'acc_0_0': 0.8791, 'acc_0_1': 0.7692, 'acc_1_0': 0.8681, 'acc_1_1': 0.956, 'mean_acc': 0.8681}
Val(class)(new adapter): {'weighted_mean_acc': 0.9445, 'worst_acc': 0.2088, 'acc_0_0': 0.9475, 'acc_0_1': 0.9983, 'acc_1_0': 0.8225, 'acc_1_1': 0.2088, 'mean_acc': 0.9438}
Test(class)(new adapter): {'weighted_mean_acc': 0.9473, 'worst_acc': 0.2, 'acc_0_0': 0.9552, 'acc_0_1': 0.9985, 'acc_1_0': 0.8185, 'acc_1_1': 0.2, 'mean_acc': 0.9478}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8571, 'acc_0_0': 0.9451, 'acc_0_1': 0.9121, 'acc_1_0': 0.9451, 'acc_1_1': 0.8571, 'mean_acc': 0.9148}
Val(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.8681, 'acc_0_0': 0.8915, 'acc_0_1': 0.9386, 'acc_1_0': 0.9269, 'acc_1_1': 0.8681, 'mean_acc': 0.916}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.8167, 'acc_0_0': 0.9118, 'acc_0_1': 0.9359, 'acc_1_0': 0.9109, 'acc_1_1': 0.8167, 'mean_acc': 0.9199}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8462, 'acc_0_0': 0.8462, 'acc_0_1': 0.9451, 'acc_1_0': 0.8791, 'acc_1_1': 0.956, 'mean_acc': 0.9066}
Val(class)(new adapter): {'weighted_mean_acc': 0.9374, 'worst_acc': 0.6264, 'acc_0_0': 0.9721, 'acc_0_1': 0.9877, 'acc_1_0': 0.7008, 'acc_1_1': 0.6264, 'mean_acc': 0.9362}
Test(class)(new adapter): {'weighted_mean_acc': 0.9359, 'worst_acc': 0.4, 'acc_0_0': 0.9787, 'acc_0_1': 0.9895, 'acc_1_0': 0.6778, 'acc_1_1': 0.4, 'mean_acc': 0.9402}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.9341, 'acc_1_0': 0.8901, 'acc_1_1': 0.956, 'mean_acc': 0.9176}
Val(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.8901, 'acc_0_0': 0.8997, 'acc_0_1': 0.9372, 'acc_1_0': 0.9311, 'acc_1_1': 0.8901, 'mean_acc': 0.9198}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.85, 'acc_0_0': 0.9144, 'acc_0_1': 0.9318, 'acc_1_0': 0.9202, 'acc_1_1': 0.85, 'mean_acc': 0.9211}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.8791, 'acc_0_1': 0.9231, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9427, 'worst_acc': 0.6923, 'acc_0_0': 0.9616, 'acc_0_1': 0.9804, 'acc_1_0': 0.7884, 'acc_1_1': 0.6923, 'mean_acc': 0.9419}
Test(class)(new adapter): {'weighted_mean_acc': 0.9429, 'worst_acc': 0.5278, 'acc_0_0': 0.9664, 'acc_0_1': 0.9829, 'acc_1_0': 0.7774, 'acc_1_1': 0.5278, 'mean_acc': 0.9452}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.9341, 'acc_0_1': 0.967, 'acc_1_0': 0.8791, 'acc_1_1': 0.978, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.8496, 'acc_0_0': 0.8496, 'acc_0_1': 0.9374, 'acc_1_0': 0.968, 'acc_1_1': 0.8791, 'mean_acc': 0.9036}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.8556, 'acc_0_0': 0.8732, 'acc_0_1': 0.9301, 'acc_1_0': 0.9597, 'acc_1_1': 0.8556, 'mean_acc': 0.9053}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.967, 'acc_1_0': 0.9451, 'acc_1_1': 1.0, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.8022, 'acc_0_0': 0.8831, 'acc_0_1': 0.9674, 'acc_1_0': 0.952, 'acc_1_1': 0.8022, 'mean_acc': 0.9274}
Test(class)(new adapter): {'weighted_mean_acc': 0.9313, 'worst_acc': 0.6889, 'acc_0_0': 0.8992, 'acc_0_1': 0.9666, 'acc_1_0': 0.9435, 'acc_1_1': 0.6889, 'mean_acc': 0.9282}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.9451, 'acc_0_1': 0.967, 'acc_1_0': 0.956, 'acc_1_1': 0.967, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.8571, 'acc_0_0': 0.8843, 'acc_0_1': 0.9369, 'acc_1_0': 0.9415, 'acc_1_1': 0.8571, 'mean_acc': 0.9142}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7944, 'acc_0_0': 0.8972, 'acc_0_1': 0.9331, 'acc_1_0': 0.9391, 'acc_1_1': 0.7944, 'mean_acc': 0.915}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.956, 'acc_1_0': 0.9231, 'acc_1_1': 0.978, 'mean_acc': 0.9368}
Val(class)(new adapter): {'weighted_mean_acc': 0.8792, 'worst_acc': 0.7924, 'acc_0_0': 0.7924, 'acc_0_1': 0.9355, 'acc_1_0': 0.9861, 'acc_1_1': 0.8791, 'mean_acc': 0.8808}
Test(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8322, 'acc_0_0': 0.8322, 'acc_0_1': 0.9286, 'acc_1_0': 0.9835, 'acc_1_1': 0.8444, 'mean_acc': 0.8875}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.956, 'acc_1_0': 0.9341, 'acc_1_1': 0.967, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.8462, 'acc_0_0': 0.8976, 'acc_0_1': 0.9529, 'acc_1_0': 0.9464, 'acc_1_1': 0.8462, 'mean_acc': 0.9272}
Test(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.8111, 'acc_0_0': 0.9128, 'acc_0_1': 0.9449, 'acc_1_0': 0.9339, 'acc_1_1': 0.8111, 'mean_acc': 0.9266}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.9341, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.8242, 'acc_0_0': 0.9199, 'acc_0_1': 0.9613, 'acc_1_0': 0.9179, 'acc_1_1': 0.8242, 'mean_acc': 0.936}
Test(class)(new adapter): {'weighted_mean_acc': 0.9364, 'worst_acc': 0.7778, 'acc_0_0': 0.9324, 'acc_0_1': 0.9532, 'acc_1_0': 0.9093, 'acc_1_1': 0.7778, 'mean_acc': 0.936}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.989, 'acc_1_0': 0.9341, 'acc_1_1': 1.0, 'mean_acc': 0.9615}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.8791, 'acc_0_0': 0.9222, 'acc_0_1': 0.9456, 'acc_1_0': 0.9116, 'acc_1_1': 0.8791, 'mean_acc': 0.93}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.8278, 'acc_0_0': 0.9338, 'acc_0_1': 0.9347, 'acc_1_0': 0.8956, 'acc_1_1': 0.8278, 'mean_acc': 0.9284}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9121, 'acc_0_1': 0.956, 'acc_1_0': 0.9011, 'acc_1_1': 0.989, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.8462, 'acc_0_0': 0.8592, 'acc_0_1': 0.958, 'acc_1_0': 0.9722, 'acc_1_1': 0.8462, 'mean_acc': 0.9165}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7778, 'acc_0_0': 0.8804, 'acc_0_1': 0.9502, 'acc_1_0': 0.9641, 'acc_1_1': 0.7778, 'mean_acc': 0.9162}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.978, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.9121, 'acc_0_0': 0.9192, 'acc_0_1': 0.9314, 'acc_1_0': 0.9172, 'acc_1_1': 0.9121, 'mean_acc': 0.9239}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.8722, 'acc_0_0': 0.9288, 'acc_0_1': 0.9198, 'acc_1_0': 0.9081, 'acc_1_1': 0.8722, 'mean_acc': 0.9224}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9451, 'acc_0_0': 0.956, 'acc_0_1': 0.978, 'acc_1_0': 0.9451, 'acc_1_1': 0.978, 'mean_acc': 0.9643}
Val(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.8772, 'acc_0_0': 0.8772, 'acc_0_1': 0.9203, 'acc_1_0': 0.9631, 'acc_1_1': 0.9121, 'mean_acc': 0.9079}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.8722, 'acc_0_0': 0.8928, 'acc_0_1': 0.9113, 'acc_1_0': 0.9548, 'acc_1_1': 0.8722, 'mean_acc': 0.9073}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9367, 'worst_acc': 0.8135, 'acc_0_0': 0.9588, 'acc_0_1': 0.9572, 'acc_1_0': 0.8135, 'acc_1_1': 0.8352, 'mean_acc': 0.936}
Test(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.7722, 'acc_0_0': 0.9638, 'acc_0_1': 0.9533, 'acc_1_0': 0.7899, 'acc_1_1': 0.7722, 'mean_acc': 0.9365}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.956, 'acc_1_0': 0.9121, 'acc_1_1': 0.989, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9388, 'worst_acc': 0.8242, 'acc_0_0': 0.9335, 'acc_0_1': 0.9638, 'acc_1_0': 0.8894, 'acc_1_1': 0.8242, 'mean_acc': 0.9387}
Test(class)(new adapter): {'weighted_mean_acc': 0.9394, 'worst_acc': 0.7278, 'acc_0_0': 0.9439, 'acc_0_1': 0.9598, 'acc_1_0': 0.8782, 'acc_1_1': 0.7278, 'mean_acc': 0.9398}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.956, 'acc_1_0': 0.9341, 'acc_1_1': 0.989, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.8351, 'acc_0_0': 0.9541, 'acc_0_1': 0.956, 'acc_1_0': 0.8351, 'acc_1_1': 0.8791, 'mean_acc': 0.937}
Test(class)(new adapter): {'weighted_mean_acc': 0.935, 'worst_acc': 0.7778, 'acc_0_0': 0.9583, 'acc_0_1': 0.9549, 'acc_1_0': 0.8133, 'acc_1_1': 0.7778, 'mean_acc': 0.9374}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.967, 'acc_1_0': 0.9341, 'acc_1_1': 0.956, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7578, 'acc_0_0': 0.9691, 'acc_0_1': 0.9468, 'acc_1_0': 0.7578, 'acc_1_1': 0.8352, 'mean_acc': 0.928}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7363, 'acc_0_0': 0.9732, 'acc_0_1': 0.9417, 'acc_1_0': 0.7363, 'acc_1_1': 0.8111, 'mean_acc': 0.9304}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.9341, 'acc_0_1': 0.9341, 'acc_1_0': 0.8791, 'acc_1_1': 1.0, 'mean_acc': 0.9368}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.8462, 'acc_0_0': 0.9299, 'acc_0_1': 0.9256, 'acc_1_0': 0.9012, 'acc_1_1': 0.8462, 'mean_acc': 0.9232}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.8444, 'acc_0_0': 0.9399, 'acc_0_1': 0.9248, 'acc_1_0': 0.8879, 'acc_1_1': 0.8444, 'mean_acc': 0.9269}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.967, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.8352, 'acc_0_0': 0.9276, 'acc_0_1': 0.943, 'acc_1_0': 0.9019, 'acc_1_1': 0.8352, 'mean_acc': 0.9294}
Test(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.8278, 'acc_0_0': 0.94, 'acc_0_1': 0.9387, 'acc_1_0': 0.8944, 'acc_1_1': 0.8278, 'mean_acc': 0.9328}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.956, 'acc_0_1': 0.956, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.8352, 'acc_0_0': 0.9391, 'acc_0_1': 0.9526, 'acc_1_0': 0.881, 'acc_1_1': 0.8352, 'mean_acc': 0.9354}
Test(class)(new adapter): {'weighted_mean_acc': 0.9346, 'worst_acc': 0.7778, 'acc_0_0': 0.9466, 'acc_0_1': 0.947, 'acc_1_0': 0.8706, 'acc_1_1': 0.7778, 'mean_acc': 0.9358}
========================================================================
> end of training. 

best epoch : 57
best training accuracy on [class]: {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.978, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9533}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9238, 'worst_acc': 0.9121, 'acc_0_0': 0.9192, 'acc_0_1': 0.9314, 'acc_1_0': 0.9172, 'acc_1_1': 0.9121, 'mean_acc': 0.9239}
best test accuracy on [class]: {'weighted_mean_acc': 0.9217, 'worst_acc': 0.8722, 'acc_0_0': 0.9288, 'acc_0_1': 0.9198, 'acc_1_0': 0.9081, 'acc_1_1': 0.8722, 'mean_acc': 0.9224}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.8722, 'acc_0_0': 0.9288, 'acc_0_1': 0.9198, 'acc_1_0': 0.9081, 'acc_1_1': 0.8722, 'mean_acc': 0.9224}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9878, 'worst_acc': 0.9, 'acc_0_0': 0.9962, 'acc_0_1': 0.9788, 'acc_1_0': 0.9935, 'acc_1_1': 0.9, 'mean_acc': 0.9884}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9191     0.8778   0.9295  ...   0.9105   0.8778    0.9199
2                       0.9217     0.8722   0.9288  ...   0.9081   0.8722    0.9224
test_mean               0.9204     0.8750   0.9292  ...   0.9093   0.8750    0.9212
test_std                0.0013     0.0028   0.0004  ...   0.0012   0.0028    0.0012
1                       0.9862     0.9333   0.9847  ...   0.9903   0.9333    0.9860
2                       0.9878     0.9000   0.9962  ...   0.9935   0.9000    0.9884
zs_spu_mean             0.9870     0.9166   0.9904  ...   0.9919   0.9166    0.9872
zs_spu_std              0.0008     0.0166   0.0057  ...   0.0016   0.0166    0.0012
1                          NaN     0.9560   0.9560  ...   0.9780   0.9780    0.9698
2                          NaN     0.9231   0.9231  ...   0.9231   0.9890    0.9533
tr_mean                    NaN     0.9396   0.9396  ...   0.9506   0.9835    0.9616
tr_std                     NaN     0.0164   0.0164  ...   0.0274   0.0055    0.0082
1                       0.9157     0.9011   0.9131  ...   0.9318   0.9011    0.9157
2                       0.9238     0.9121   0.9192  ...   0.9172   0.9121    0.9239
val_mean                0.9198     0.9066   0.9162  ...   0.9245   0.9066    0.9198
val_std                 0.0040     0.0055   0.0030  ...   0.0073   0.0055    0.0041
1                       0.9191     0.8778   0.9295  ...   0.9105   0.8778    0.9199
2                       0.9217     0.8722   0.9288  ...   0.9081   0.8722    0.9224
zs_tg_mean              0.9204     0.8750   0.9292  ...   0.9093   0.8750    0.9212
zs_tg_std               0.0013     0.0028   0.0004  ...   0.0012   0.0028    0.0012

[20 rows x 7 columns]
Save to:  results_iterative/ds_celeba_tl_adapter_reg_seq_alter_bs_1024_lr_0.1_lrr1.0_bsr8_balval_MA+rn.csv
f=============Iteration : 1/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[16] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3079, 'acc_0_0': 0.9458, 'acc_0_1': 0.9944, 'acc_1_0': 0.8455, 'acc_1_1': 0.3079, 'mean_acc': 0.9462}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2308, 'acc_0_0': 0.9634, 'acc_0_1': 0.9973, 'acc_1_0': 0.8246, 'acc_1_1': 0.2308, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.2722, 'acc_0_0': 0.9671, 'acc_0_1': 0.9969, 'acc_1_0': 0.8065, 'acc_1_1': 0.2722, 'mean_acc': 0.9522}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.336, 'acc_0_0': 0.9515, 'acc_0_1': 0.9955, 'acc_1_0': 0.856, 'acc_1_1': 0.336, 'mean_acc': 0.9509}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2198, 'acc_0_0': 0.9625, 'acc_0_1': 0.9976, 'acc_1_0': 0.81, 'acc_1_1': 0.2198, 'mean_acc': 0.9483}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2722, 'acc_0_0': 0.9673, 'acc_0_1': 0.9977, 'acc_1_0': 0.8109, 'acc_1_1': 0.2722, 'mean_acc': 0.9531}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3663, 'acc_0_0': 0.9539, 'acc_0_1': 0.9958, 'acc_1_0': 0.8619, 'acc_1_1': 0.3663, 'mean_acc': 0.9532}
Val(class): {'weighted_mean_acc': 0.9434, 'worst_acc': 0.2967, 'acc_0_0': 0.9096, 'acc_0_1': 0.9966, 'acc_1_0': 0.9332, 'acc_1_1': 0.2967, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3389, 'acc_0_0': 0.9258, 'acc_0_1': 0.9955, 'acc_1_0': 0.9242, 'acc_1_1': 0.3389, 'mean_acc': 0.9466}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.372, 'acc_0_0': 0.9548, 'acc_0_1': 0.9956, 'acc_1_0': 0.862, 'acc_1_1': 0.372, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.4615, 'acc_0_0': 0.9431, 'acc_0_1': 0.9942, 'acc_1_0': 0.8956, 'acc_1_1': 0.4615, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4389, 'acc_0_0': 0.9478, 'acc_0_1': 0.994, 'acc_1_0': 0.8911, 'acc_1_1': 0.4389, 'mean_acc': 0.9536}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3958, 'acc_0_0': 0.9553, 'acc_0_1': 0.9955, 'acc_1_0': 0.8641, 'acc_1_1': 0.3958, 'mean_acc': 0.9542}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2857, 'acc_0_0': 0.9499, 'acc_0_1': 0.9966, 'acc_1_0': 0.8796, 'acc_1_1': 0.2857, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3111, 'acc_0_0': 0.9542, 'acc_0_1': 0.9971, 'acc_1_0': 0.8698, 'acc_1_1': 0.3111, 'mean_acc': 0.9541}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4189, 'acc_0_0': 0.956, 'acc_0_1': 0.9956, 'acc_1_0': 0.8632, 'acc_1_1': 0.4189, 'mean_acc': 0.9546}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.1538, 'acc_0_0': 0.9597, 'acc_0_1': 0.9986, 'acc_1_0': 0.8553, 'acc_1_1': 0.1538, 'mean_acc': 0.9534}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.2667, 'acc_0_0': 0.9621, 'acc_0_1': 0.9981, 'acc_1_0': 0.8488, 'acc_1_1': 0.2667, 'mean_acc': 0.9554}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4247, 'acc_0_0': 0.9571, 'acc_0_1': 0.9958, 'acc_1_0': 0.866, 'acc_1_1': 0.4247, 'mean_acc': 0.9556}
Val(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.3187, 'acc_0_0': 0.9541, 'acc_0_1': 0.9964, 'acc_1_0': 0.8553, 'acc_1_1': 0.3187, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3611, 'acc_0_0': 0.9595, 'acc_0_1': 0.9962, 'acc_1_0': 0.8524, 'acc_1_1': 0.3611, 'mean_acc': 0.9546}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4463, 'acc_0_0': 0.9579, 'acc_0_1': 0.9956, 'acc_1_0': 0.868, 'acc_1_1': 0.4463, 'mean_acc': 0.9564}
Val(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.2967, 'acc_0_0': 0.9569, 'acc_0_1': 0.9976, 'acc_1_0': 0.858, 'acc_1_1': 0.2967, 'mean_acc': 0.9535}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3944, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.852, 'acc_1_1': 0.3944, 'mean_acc': 0.9538}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4506, 'acc_0_0': 0.9578, 'acc_0_1': 0.9955, 'acc_1_0': 0.8725, 'acc_1_1': 0.4506, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.2527, 'acc_0_0': 0.9698, 'acc_0_1': 0.9966, 'acc_1_0': 0.794, 'acc_1_1': 0.2527, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.2889, 'acc_0_0': 0.9728, 'acc_0_1': 0.9976, 'acc_1_0': 0.7802, 'acc_1_1': 0.2889, 'mean_acc': 0.9521}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.447, 'acc_0_0': 0.9587, 'acc_0_1': 0.9956, 'acc_1_0': 0.8716, 'acc_1_1': 0.447, 'mean_acc': 0.9573}
Val(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.2747, 'acc_0_0': 0.9578, 'acc_0_1': 0.9983, 'acc_1_0': 0.8629, 'acc_1_1': 0.2747, 'mean_acc': 0.9547}
Test(class): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.3056, 'acc_0_0': 0.9601, 'acc_0_1': 0.9964, 'acc_1_0': 0.8508, 'acc_1_1': 0.3056, 'mean_acc': 0.9543}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9594, 'acc_0_1': 0.9959, 'acc_1_0': 0.8753, 'acc_1_1': 0.4845, 'mean_acc': 0.9586}
Val(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.2308, 'acc_0_0': 0.9616, 'acc_0_1': 0.9983, 'acc_1_0': 0.8295, 'acc_1_1': 0.2308, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.3444, 'acc_0_0': 0.9669, 'acc_0_1': 0.9969, 'acc_1_0': 0.8222, 'acc_1_1': 0.3444, 'mean_acc': 0.9547}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9597, 'acc_0_1': 0.9956, 'acc_1_0': 0.874, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3956, 'acc_0_0': 0.9503, 'acc_0_1': 0.9954, 'acc_1_0': 0.8643, 'acc_1_1': 0.3956, 'mean_acc': 0.9516}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.4222, 'acc_0_0': 0.9568, 'acc_0_1': 0.9935, 'acc_1_0': 0.8593, 'acc_1_1': 0.4222, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5076, 'acc_0_0': 0.9604, 'acc_0_1': 0.9957, 'acc_1_0': 0.8768, 'acc_1_1': 0.5076, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.4945, 'acc_0_0': 0.9496, 'acc_0_1': 0.9935, 'acc_1_0': 0.8685, 'acc_1_1': 0.4945, 'mean_acc': 0.952}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.45, 'acc_0_0': 0.9566, 'acc_0_1': 0.9926, 'acc_1_0': 0.8657, 'acc_1_1': 0.45, 'mean_acc': 0.9543}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5133, 'acc_0_0': 0.9598, 'acc_0_1': 0.9957, 'acc_1_0': 0.8791, 'acc_1_1': 0.5133, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3297, 'acc_0_0': 0.9536, 'acc_0_1': 0.9969, 'acc_1_0': 0.8518, 'acc_1_1': 0.3297, 'mean_acc': 0.9512}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3556, 'acc_0_0': 0.9588, 'acc_0_1': 0.9955, 'acc_1_0': 0.846, 'acc_1_1': 0.3556, 'mean_acc': 0.9532}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.54, 'acc_0_0': 0.9608, 'acc_0_1': 0.9956, 'acc_1_0': 0.8799, 'acc_1_1': 0.54, 'mean_acc': 0.9602}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3297, 'acc_0_0': 0.9677, 'acc_0_1': 0.9964, 'acc_1_0': 0.7947, 'acc_1_1': 0.3297, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.3611, 'acc_0_0': 0.9699, 'acc_0_1': 0.995, 'acc_1_0': 0.7859, 'acc_1_1': 0.3611, 'mean_acc': 0.951}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9611, 'acc_0_1': 0.9958, 'acc_1_0': 0.8798, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.2418, 'acc_0_0': 0.9592, 'acc_0_1': 0.9978, 'acc_1_0': 0.8399, 'acc_1_1': 0.2418, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.3444, 'acc_0_0': 0.9624, 'acc_0_1': 0.9972, 'acc_1_0': 0.8335, 'acc_1_1': 0.3444, 'mean_acc': 0.954}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5544, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.8812, 'acc_1_1': 0.5544, 'mean_acc': 0.9607}
Val(class): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.1758, 'acc_0_0': 0.9756, 'acc_0_1': 0.9983, 'acc_1_0': 0.7314, 'acc_1_1': 0.1758, 'mean_acc': 0.9424}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2389, 'acc_0_0': 0.9777, 'acc_0_1': 0.9981, 'acc_1_0': 0.7246, 'acc_1_1': 0.2389, 'mean_acc': 0.9473}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.558, 'acc_0_0': 0.9615, 'acc_0_1': 0.996, 'acc_1_0': 0.8826, 'acc_1_1': 0.558, 'mean_acc': 0.9612}
Val(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.4176, 'acc_0_0': 0.9515, 'acc_0_1': 0.9937, 'acc_1_0': 0.8706, 'acc_1_1': 0.4176, 'mean_acc': 0.9525}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.4056, 'acc_0_0': 0.9572, 'acc_0_1': 0.9947, 'acc_1_0': 0.8609, 'acc_1_1': 0.4056, 'mean_acc': 0.9544}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5847, 'acc_0_0': 0.9623, 'acc_0_1': 0.9958, 'acc_1_0': 0.8834, 'acc_1_1': 0.5847, 'mean_acc': 0.9618}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.4176, 'acc_0_0': 0.937, 'acc_0_1': 0.9937, 'acc_1_0': 0.8831, 'acc_1_1': 0.4176, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9457, 'acc_0_1': 0.9926, 'acc_1_0': 0.8819, 'acc_1_1': 0.4556, 'mean_acc': 0.9511}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5811, 'acc_0_0': 0.9626, 'acc_0_1': 0.9959, 'acc_1_0': 0.887, 'acc_1_1': 0.5811, 'mean_acc': 0.9624}
Val(class): {'weighted_mean_acc': 0.9512, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9935, 'acc_1_0': 0.8434, 'acc_1_1': 0.3846, 'mean_acc': 0.9506}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4222, 'acc_0_0': 0.962, 'acc_0_1': 0.9931, 'acc_1_0': 0.8323, 'acc_1_1': 0.4222, 'mean_acc': 0.9528}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9634, 'acc_0_1': 0.9956, 'acc_1_0': 0.8852, 'acc_1_1': 0.5926, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.3516, 'acc_0_0': 0.9576, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.3516, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3889, 'acc_0_0': 0.9604, 'acc_0_1': 0.9951, 'acc_1_0': 0.8343, 'acc_1_1': 0.3889, 'mean_acc': 0.9527}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.6157, 'acc_0_0': 0.9635, 'acc_0_1': 0.9959, 'acc_1_0': 0.8902, 'acc_1_1': 0.6157, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9466, 'worst_acc': 0.4396, 'acc_0_0': 0.9306, 'acc_0_1': 0.994, 'acc_1_0': 0.8887, 'acc_1_1': 0.4396, 'mean_acc': 0.9464}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.4722, 'acc_0_0': 0.9446, 'acc_0_1': 0.9918, 'acc_1_0': 0.877, 'acc_1_1': 0.4722, 'mean_acc': 0.9498}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.6128, 'acc_0_0': 0.9635, 'acc_0_1': 0.9961, 'acc_1_0': 0.8885, 'acc_1_1': 0.6128, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3407, 'acc_0_0': 0.9623, 'acc_0_1': 0.9925, 'acc_1_0': 0.8191, 'acc_1_1': 0.3407, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3833, 'acc_0_0': 0.9664, 'acc_0_1': 0.994, 'acc_1_0': 0.8169, 'acc_1_1': 0.3833, 'mean_acc': 0.953}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.6172, 'acc_0_0': 0.964, 'acc_0_1': 0.9958, 'acc_1_0': 0.8887, 'acc_1_1': 0.6172, 'mean_acc': 0.9635}
Val(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.2527, 'acc_0_0': 0.9456, 'acc_0_1': 0.9983, 'acc_1_0': 0.8706, 'acc_1_1': 0.2527, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.35, 'acc_0_0': 0.9515, 'acc_0_1': 0.9972, 'acc_1_0': 0.8613, 'acc_1_1': 0.35, 'mean_acc': 0.9521}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9637, 'acc_0_1': 0.9959, 'acc_1_0': 0.8886, 'acc_1_1': 0.62, 'mean_acc': 0.9634}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.2857, 'acc_0_0': 0.9625, 'acc_0_1': 0.9969, 'acc_1_0': 0.8086, 'acc_1_1': 0.2857, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3222, 'acc_0_0': 0.9656, 'acc_0_1': 0.9958, 'acc_1_0': 0.8056, 'acc_1_1': 0.3222, 'mean_acc': 0.9513}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6222, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.8909, 'acc_1_1': 0.6222, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.4286, 'acc_0_0': 0.9426, 'acc_0_1': 0.9937, 'acc_1_0': 0.8754, 'acc_1_1': 0.4286, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4556, 'acc_0_0': 0.9478, 'acc_0_1': 0.9922, 'acc_1_0': 0.8641, 'acc_1_1': 0.4556, 'mean_acc': 0.9497}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6561, 'acc_0_0': 0.965, 'acc_0_1': 0.9962, 'acc_1_0': 0.8942, 'acc_1_1': 0.6561, 'mean_acc': 0.9652}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.2747, 'acc_0_0': 0.9405, 'acc_0_1': 0.9973, 'acc_1_0': 0.8852, 'acc_1_1': 0.2747, 'mean_acc': 0.9501}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3167, 'acc_0_0': 0.9483, 'acc_0_1': 0.9956, 'acc_1_0': 0.873, 'acc_1_1': 0.3167, 'mean_acc': 0.9511}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6431, 'acc_0_0': 0.9654, 'acc_0_1': 0.996, 'acc_1_0': 0.8925, 'acc_1_1': 0.6431, 'mean_acc': 0.965}
Val(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.4725, 'acc_0_0': 0.9386, 'acc_0_1': 0.993, 'acc_1_0': 0.8747, 'acc_1_1': 0.4725, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.4778, 'acc_0_0': 0.9495, 'acc_0_1': 0.9926, 'acc_1_0': 0.8681, 'acc_1_1': 0.4778, 'mean_acc': 0.9514}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6402, 'acc_0_0': 0.9647, 'acc_0_1': 0.9961, 'acc_1_0': 0.892, 'acc_1_1': 0.6402, 'mean_acc': 0.9646}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2527, 'acc_0_0': 0.9536, 'acc_0_1': 0.9961, 'acc_1_0': 0.8281, 'acc_1_1': 0.2527, 'mean_acc': 0.9467}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3833, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8335, 'acc_1_1': 0.3833, 'mean_acc': 0.9516}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6655, 'acc_0_0': 0.9653, 'acc_0_1': 0.9962, 'acc_1_0': 0.8916, 'acc_1_1': 0.6655, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3846, 'acc_0_0': 0.9632, 'acc_0_1': 0.9925, 'acc_1_0': 0.8267, 'acc_1_1': 0.3846, 'mean_acc': 0.9504}
Test(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.4444, 'acc_0_0': 0.9637, 'acc_0_1': 0.992, 'acc_1_0': 0.8165, 'acc_1_1': 0.4444, 'mean_acc': 0.9514}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6597, 'acc_0_0': 0.9658, 'acc_0_1': 0.9963, 'acc_1_0': 0.8945, 'acc_1_1': 0.6597, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.3846, 'acc_0_0': 0.9372, 'acc_0_1': 0.9942, 'acc_1_0': 0.8775, 'acc_1_1': 0.3846, 'mean_acc': 0.9473}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4889, 'acc_0_0': 0.9454, 'acc_0_1': 0.9919, 'acc_1_0': 0.881, 'acc_1_1': 0.4889, 'mean_acc': 0.9509}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6626, 'acc_0_0': 0.9663, 'acc_0_1': 0.9962, 'acc_1_0': 0.8943, 'acc_1_1': 0.6626, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3846, 'acc_0_0': 0.9499, 'acc_0_1': 0.9949, 'acc_1_0': 0.8483, 'acc_1_1': 0.3846, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4389, 'acc_0_0': 0.9554, 'acc_0_1': 0.9932, 'acc_1_0': 0.8335, 'acc_1_1': 0.4389, 'mean_acc': 0.9499}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6806, 'acc_0_0': 0.9669, 'acc_0_1': 0.9961, 'acc_1_0': 0.8973, 'acc_1_1': 0.6806, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2418, 'acc_0_0': 0.9452, 'acc_0_1': 0.9973, 'acc_1_0': 0.8518, 'acc_1_1': 0.2418, 'mean_acc': 0.9469}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3222, 'acc_0_0': 0.9501, 'acc_0_1': 0.9946, 'acc_1_0': 0.8431, 'acc_1_1': 0.3222, 'mean_acc': 0.948}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6792, 'acc_0_0': 0.9668, 'acc_0_1': 0.9962, 'acc_1_0': 0.8991, 'acc_1_1': 0.6792, 'mean_acc': 0.9669}
Val(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3407, 'acc_0_0': 0.9419, 'acc_0_1': 0.9949, 'acc_1_0': 0.8782, 'acc_1_1': 0.3407, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.4056, 'acc_0_0': 0.9486, 'acc_0_1': 0.9938, 'acc_1_0': 0.873, 'acc_1_1': 0.4056, 'mean_acc': 0.9514}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6799, 'acc_0_0': 0.9673, 'acc_0_1': 0.9963, 'acc_1_0': 0.9003, 'acc_1_1': 0.6799, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.2747, 'acc_0_0': 0.9332, 'acc_0_1': 0.9964, 'acc_1_0': 0.8817, 'acc_1_1': 0.2747, 'mean_acc': 0.946}
Test(class): {'weighted_mean_acc': 0.9495, 'worst_acc': 0.3167, 'acc_0_0': 0.9457, 'acc_0_1': 0.9948, 'acc_1_0': 0.8669, 'acc_1_1': 0.3167, 'mean_acc': 0.9488}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6763, 'acc_0_0': 0.9663, 'acc_0_1': 0.9965, 'acc_1_0': 0.8969, 'acc_1_1': 0.6763, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.3626, 'acc_0_0': 0.9567, 'acc_0_1': 0.9913, 'acc_1_0': 0.8114, 'acc_1_1': 0.3626, 'mean_acc': 0.9446}
Test(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.4, 'acc_0_0': 0.9634, 'acc_0_1': 0.992, 'acc_1_0': 0.8081, 'acc_1_1': 0.4, 'mean_acc': 0.9499}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.695, 'acc_0_0': 0.9675, 'acc_0_1': 0.9964, 'acc_1_0': 0.8981, 'acc_1_1': 0.695, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.3187, 'acc_0_0': 0.9213, 'acc_0_1': 0.9949, 'acc_1_0': 0.9019, 'acc_1_1': 0.3187, 'mean_acc': 0.9436}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.4222, 'acc_0_0': 0.9339, 'acc_0_1': 0.9947, 'acc_1_0': 0.898, 'acc_1_1': 0.4222, 'mean_acc': 0.9478}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6986, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.8998, 'acc_1_1': 0.6986, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3626, 'acc_0_0': 0.9618, 'acc_0_1': 0.9957, 'acc_1_0': 0.8093, 'acc_1_1': 0.3626, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.948, 'worst_acc': 0.3667, 'acc_0_0': 0.964, 'acc_0_1': 0.994, 'acc_1_0': 0.7988, 'acc_1_1': 0.3667, 'mean_acc': 0.9494}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7073, 'acc_0_0': 0.9682, 'acc_0_1': 0.9965, 'acc_1_0': 0.8998, 'acc_1_1': 0.7073, 'mean_acc': 0.968}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.5165, 'acc_0_0': 0.9473, 'acc_0_1': 0.9894, 'acc_1_0': 0.8594, 'acc_1_1': 0.5165, 'mean_acc': 0.9482}
Test(class): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.5389, 'acc_0_0': 0.9498, 'acc_0_1': 0.9877, 'acc_1_0': 0.85, 'acc_1_1': 0.5389, 'mean_acc': 0.948}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6914, 'acc_0_0': 0.9686, 'acc_0_1': 0.9965, 'acc_1_0': 0.9014, 'acc_1_1': 0.6914, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9959, 'acc_1_0': 0.8072, 'acc_1_1': 0.3077, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.3944, 'acc_0_0': 0.9615, 'acc_0_1': 0.9944, 'acc_1_0': 0.804, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.2308, 'acc_0_0': 0.978, 'acc_0_1': 1.0, 'acc_1_0': 0.5824, 'acc_1_1': 0.2308, 'mean_acc': 0.6978}
Val(class)(new adapter): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.3626, 'acc_0_0': 0.9651, 'acc_0_1': 0.9959, 'acc_1_0': 0.7745, 'acc_1_1': 0.3626, 'mean_acc': 0.9448}
Test(class)(new adapter): {'weighted_mean_acc': 0.946, 'worst_acc': 0.3778, 'acc_0_0': 0.9696, 'acc_0_1': 0.995, 'acc_1_0': 0.7637, 'acc_1_1': 0.3778, 'mean_acc': 0.9483}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3187, 'acc_0_0': 0.967, 'acc_0_1': 0.3187, 'acc_1_0': 0.5934, 'acc_1_1': 0.5604, 'mean_acc': 0.6099}
Val(class)(new adapter): {'weighted_mean_acc': 0.9431, 'worst_acc': 0.6484, 'acc_0_0': 0.9459, 'acc_0_1': 0.9816, 'acc_1_0': 0.8399, 'acc_1_1': 0.6484, 'mean_acc': 0.9427}
Test(class)(new adapter): {'weighted_mean_acc': 0.943, 'worst_acc': 0.6611, 'acc_0_0': 0.9546, 'acc_0_1': 0.9781, 'acc_1_0': 0.8214, 'acc_1_1': 0.6611, 'mean_acc': 0.9443}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.1868, 'acc_0_0': 0.1868, 'acc_0_1': 0.4615, 'acc_1_0': 1.0, 'acc_1_1': 0.978, 'mean_acc': 0.6566}
Val(class)(new adapter): {'weighted_mean_acc': 0.6815, 'worst_acc': 0.608, 'acc_0_0': 0.608, 'acc_0_1': 0.6472, 'acc_1_0': 0.993, 'acc_1_1': 0.989, 'mean_acc': 0.6835}
Test(class)(new adapter): {'weighted_mean_acc': 0.7051, 'worst_acc': 0.6192, 'acc_0_0': 0.6876, 'acc_0_1': 0.6192, 'acc_1_0': 0.994, 'acc_1_1': 0.9778, 'mean_acc': 0.7025}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.0, 'acc_0_1': 0.1319, 'acc_1_0': 1.0, 'acc_1_1': 0.989, 'mean_acc': 0.5302}
Val(class)(new adapter): {'weighted_mean_acc': 0.8636, 'worst_acc': 0.0856, 'acc_0_0': 0.9993, 'acc_0_1': 0.9908, 'acc_1_0': 0.0856, 'acc_1_1': 0.5604, 'mean_acc': 0.8596}
Test(class)(new adapter): {'weighted_mean_acc': 0.8591, 'worst_acc': 0.0685, 'acc_0_0': 0.9996, 'acc_0_1': 0.9878, 'acc_1_0': 0.0685, 'acc_1_1': 0.4444, 'mean_acc': 0.8745}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3407, 'acc_0_0': 1.0, 'acc_0_1': 0.989, 'acc_1_0': 0.3407, 'acc_1_1': 0.7363, 'mean_acc': 0.7665}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.8462, 'acc_0_0': 0.9121, 'acc_0_1': 0.9217, 'acc_1_0': 0.8991, 'acc_1_1': 0.8462, 'mean_acc': 0.9136}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.8722, 'acc_0_0': 0.9212, 'acc_0_1': 0.9153, 'acc_1_0': 0.8948, 'acc_1_1': 0.8722, 'mean_acc': 0.9152}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2637, 'acc_0_0': 0.2637, 'acc_0_1': 0.8571, 'acc_1_0': 0.989, 'acc_1_1': 0.978, 'mean_acc': 0.772}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.4099, 'acc_0_0': 0.993, 'acc_0_1': 0.9734, 'acc_1_0': 0.4099, 'acc_1_1': 0.8132, 'mean_acc': 0.8988}
Test(class)(new adapter): {'weighted_mean_acc': 0.8952, 'worst_acc': 0.3758, 'acc_0_0': 0.9939, 'acc_0_1': 0.9709, 'acc_1_0': 0.3758, 'acc_1_1': 0.7111, 'mean_acc': 0.9059}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5495, 'acc_0_0': 0.956, 'acc_0_1': 0.9341, 'acc_1_0': 0.5495, 'acc_1_1': 0.9011, 'mean_acc': 0.8352}
Val(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.8462, 'acc_0_0': 0.9224, 'acc_0_1': 0.9476, 'acc_1_0': 0.8984, 'acc_1_1': 0.8462, 'mean_acc': 0.9287}
Test(class)(new adapter): {'weighted_mean_acc': 0.929, 'worst_acc': 0.8278, 'acc_0_0': 0.9294, 'acc_0_1': 0.9443, 'acc_1_0': 0.8895, 'acc_1_1': 0.8278, 'mean_acc': 0.9291}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8132, 'acc_0_0': 0.8132, 'acc_0_1': 0.9231, 'acc_1_0': 0.967, 'acc_1_1': 0.978, 'mean_acc': 0.9203}
Val(class)(new adapter): {'weighted_mean_acc': 0.9349, 'worst_acc': 0.8242, 'acc_0_0': 0.9288, 'acc_0_1': 0.9587, 'acc_1_0': 0.8914, 'acc_1_1': 0.8242, 'mean_acc': 0.9349}
Test(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.75, 'acc_0_0': 0.9362, 'acc_0_1': 0.9608, 'acc_1_0': 0.8782, 'acc_1_1': 0.75, 'mean_acc': 0.9366}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.9451, 'acc_0_1': 0.9451, 'acc_1_0': 0.8901, 'acc_1_1': 0.956, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.8462, 'acc_0_0': 0.8805, 'acc_0_1': 0.9466, 'acc_1_0': 0.9485, 'acc_1_1': 0.8462, 'mean_acc': 0.9176}
Test(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.8444, 'acc_0_0': 0.8959, 'acc_0_1': 0.9409, 'acc_1_0': 0.9411, 'acc_1_1': 0.8444, 'mean_acc': 0.918}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8462, 'acc_0_0': 0.8462, 'acc_0_1': 0.9451, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.8462, 'acc_0_0': 0.9063, 'acc_0_1': 0.9461, 'acc_1_0': 0.9318, 'acc_1_1': 0.8462, 'mean_acc': 0.926}
Test(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.8333, 'acc_0_0': 0.9197, 'acc_0_1': 0.9413, 'acc_1_0': 0.9169, 'acc_1_1': 0.8333, 'mean_acc': 0.9268}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.978, 'acc_1_0': 0.9451, 'acc_1_1': 0.978, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.8462, 'acc_0_0': 0.8786, 'acc_0_1': 0.9401, 'acc_1_0': 0.9541, 'acc_1_1': 0.8462, 'mean_acc': 0.9148}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.8556, 'acc_0_0': 0.8981, 'acc_0_1': 0.9346, 'acc_1_0': 0.9427, 'acc_1_1': 0.8556, 'mean_acc': 0.917}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9341, 'acc_0_1': 0.9011, 'acc_1_0': 0.9341, 'acc_1_1': 0.956, 'mean_acc': 0.9313}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.8571, 'acc_0_0': 0.8807, 'acc_0_1': 0.9241, 'acc_1_0': 0.952, 'acc_1_1': 0.8571, 'mean_acc': 0.9089}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.8111, 'acc_0_0': 0.8996, 'acc_0_1': 0.9172, 'acc_1_0': 0.9423, 'acc_1_1': 0.8111, 'mean_acc': 0.9107}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.9341, 'acc_1_0': 0.978, 'acc_1_1': 0.978, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.8571, 'acc_0_0': 0.9044, 'acc_0_1': 0.9241, 'acc_1_0': 0.9304, 'acc_1_1': 0.8571, 'mean_acc': 0.9159}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.8389, 'acc_0_0': 0.9143, 'acc_0_1': 0.9149, 'acc_1_0': 0.9226, 'acc_1_1': 0.8389, 'mean_acc': 0.9149}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9231, 'acc_0_1': 0.9451, 'acc_1_0': 0.9231, 'acc_1_1': 1.0, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9285, 'worst_acc': 0.8242, 'acc_0_0': 0.9157, 'acc_0_1': 0.9488, 'acc_1_0': 0.9158, 'acc_1_1': 0.8242, 'mean_acc': 0.9286}
Test(class)(new adapter): {'weighted_mean_acc': 0.9302, 'worst_acc': 0.7944, 'acc_0_0': 0.9244, 'acc_0_1': 0.9463, 'acc_1_0': 0.9093, 'acc_1_1': 0.7944, 'mean_acc': 0.9296}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9341, 'acc_0_1': 0.9121, 'acc_1_0': 0.9231, 'acc_1_1': 0.978, 'mean_acc': 0.9368}
Val(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.8533, 'acc_0_0': 0.8533, 'acc_0_1': 0.9299, 'acc_1_0': 0.9673, 'acc_1_1': 0.8681, 'mean_acc': 0.9019}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.871, 'acc_0_0': 0.871, 'acc_0_1': 0.9196, 'acc_1_0': 0.9569, 'acc_1_1': 0.8722, 'mean_acc': 0.9}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.8681, 'acc_0_1': 0.956, 'acc_1_0': 0.9341, 'acc_1_1': 0.967, 'mean_acc': 0.9313}
Val(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.8132, 'acc_0_0': 0.9117, 'acc_0_1': 0.9514, 'acc_1_0': 0.9228, 'acc_1_1': 0.8132, 'mean_acc': 0.9289}
Test(class)(new adapter): {'weighted_mean_acc': 0.929, 'worst_acc': 0.7889, 'acc_0_0': 0.9212, 'acc_0_1': 0.9452, 'acc_1_0': 0.9145, 'acc_1_1': 0.7889, 'mean_acc': 0.9282}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.967, 'acc_1_0': 0.9451, 'acc_1_1': 0.967, 'mean_acc': 0.9451}
Val(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.8681, 'acc_0_0': 0.8854, 'acc_0_1': 0.9292, 'acc_1_0': 0.9485, 'acc_1_1': 0.8681, 'mean_acc': 0.9126}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.85, 'acc_0_0': 0.9004, 'acc_0_1': 0.9204, 'acc_1_0': 0.9403, 'acc_1_1': 0.85, 'mean_acc': 0.9124}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.9341, 'acc_1_0': 0.978, 'acc_1_1': 0.989, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.8242, 'acc_0_0': 0.8768, 'acc_0_1': 0.9456, 'acc_1_0': 0.9541, 'acc_1_1': 0.8242, 'mean_acc': 0.9161}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.8056, 'acc_0_0': 0.8961, 'acc_0_1': 0.9425, 'acc_1_0': 0.9472, 'acc_1_1': 0.8056, 'mean_acc': 0.9191}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9231, 'acc_0_0': 0.9451, 'acc_0_1': 0.9231, 'acc_1_0': 0.978, 'acc_1_1': 0.967, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.8242, 'acc_0_0': 0.8892, 'acc_0_1': 0.9447, 'acc_1_0': 0.9471, 'acc_1_1': 0.8242, 'mean_acc': 0.9201}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.8222, 'acc_0_0': 0.9039, 'acc_0_1': 0.9409, 'acc_1_0': 0.9363, 'acc_1_1': 0.8222, 'mean_acc': 0.9212}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.967, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.8352, 'acc_0_0': 0.8763, 'acc_0_1': 0.9517, 'acc_1_0': 0.9555, 'acc_1_1': 0.8352, 'mean_acc': 0.9188}
Test(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7944, 'acc_0_0': 0.8931, 'acc_0_1': 0.9489, 'acc_1_0': 0.9444, 'acc_1_1': 0.7944, 'mean_acc': 0.9196}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.8791, 'acc_0_0': 0.88, 'acc_0_1': 0.9386, 'acc_1_0': 0.9513, 'acc_1_1': 0.8791, 'mean_acc': 0.9147}
Test(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.8611, 'acc_0_0': 0.8942, 'acc_0_1': 0.9318, 'acc_1_0': 0.9448, 'acc_1_1': 0.8611, 'mean_acc': 0.9144}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.9341, 'acc_1_0': 0.9451, 'acc_1_1': 0.9341, 'mean_acc': 0.9286}
Val(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.8765, 'acc_0_0': 0.8765, 'acc_0_1': 0.9294, 'acc_1_0': 0.9582, 'acc_1_1': 0.8901, 'mean_acc': 0.9105}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.8914, 'acc_0_0': 0.8914, 'acc_0_1': 0.9212, 'acc_1_0': 0.9492, 'acc_1_1': 0.9, 'mean_acc': 0.9099}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.9231, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9313}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8791, 'acc_0_0': 0.8866, 'acc_0_1': 0.9331, 'acc_1_0': 0.9485, 'acc_1_1': 0.8791, 'mean_acc': 0.9148}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.8889, 'acc_0_0': 0.8984, 'acc_0_1': 0.9283, 'acc_1_0': 0.9407, 'acc_1_1': 0.8889, 'mean_acc': 0.9149}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.8791, 'acc_0_1': 0.956, 'acc_1_0': 0.9451, 'acc_1_1': 0.989, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.8791, 'acc_0_0': 0.8885, 'acc_0_1': 0.9369, 'acc_1_0': 0.9478, 'acc_1_1': 0.8791, 'mean_acc': 0.9172}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8667, 'acc_0_0': 0.9011, 'acc_0_1': 0.9324, 'acc_1_0': 0.9399, 'acc_1_1': 0.8667, 'mean_acc': 0.9174}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.8681, 'acc_0_1': 0.978, 'acc_1_0': 0.989, 'acc_1_1': 1.0, 'mean_acc': 0.9588}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.8791, 'acc_0_0': 0.8833, 'acc_0_1': 0.9362, 'acc_1_0': 0.9506, 'acc_1_1': 0.8791, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.8778, 'acc_0_0': 0.8989, 'acc_0_1': 0.9293, 'acc_1_0': 0.9435, 'acc_1_1': 0.8778, 'mean_acc': 0.9157}
========================================================================
> end of training. 

best epoch : 61
best training accuracy on [class]: {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.989, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.956}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9141, 'worst_acc': 0.8791, 'acc_0_0': 0.88, 'acc_0_1': 0.9386, 'acc_1_0': 0.9513, 'acc_1_1': 0.8791, 'mean_acc': 0.9147}
best test accuracy on [class]: {'weighted_mean_acc': 0.9165, 'worst_acc': 0.8611, 'acc_0_0': 0.8942, 'acc_0_1': 0.9318, 'acc_1_0': 0.9448, 'acc_1_1': 0.8611, 'mean_acc': 0.9144}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.8611, 'acc_0_0': 0.8942, 'acc_0_1': 0.9318, 'acc_1_0': 0.9448, 'acc_1_1': 0.8611, 'mean_acc': 0.9144}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9887, 'worst_acc': 0.9111, 'acc_0_0': 0.9917, 'acc_0_1': 0.9855, 'acc_1_0': 0.9931, 'acc_1_1': 0.9111, 'mean_acc': 0.9888}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
f=============Iteration : 2/2=============
====== TL:[adapter_reg_seq_alter] LR:[0.1] BS:[1024] BSr:[16] ======
> Simply copy the data loader ... 
Using [Balanced] Validation loader for regularized training
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3028, 'acc_0_0': 0.9456, 'acc_0_1': 0.9945, 'acc_1_0': 0.8457, 'acc_1_1': 0.3028, 'mean_acc': 0.9461}
Val(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3516, 'acc_0_0': 0.9649, 'acc_0_1': 0.9964, 'acc_1_0': 0.8253, 'acc_1_1': 0.3516, 'mean_acc': 0.9522}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3667, 'acc_0_0': 0.9684, 'acc_0_1': 0.9965, 'acc_1_0': 0.8125, 'acc_1_1': 0.3667, 'mean_acc': 0.9542}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.349, 'acc_0_0': 0.9517, 'acc_0_1': 0.9954, 'acc_1_0': 0.8544, 'acc_1_1': 0.349, 'mean_acc': 0.9508}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9949, 'acc_1_0': 0.8838, 'acc_1_1': 0.3956, 'mean_acc': 0.9532}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.4278, 'acc_0_0': 0.9511, 'acc_0_1': 0.995, 'acc_1_0': 0.8815, 'acc_1_1': 0.4278, 'mean_acc': 0.9543}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3583, 'acc_0_0': 0.9539, 'acc_0_1': 0.9952, 'acc_1_0': 0.861, 'acc_1_1': 0.3583, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.948, 'acc_0_1': 0.9957, 'acc_1_0': 0.881, 'acc_1_1': 0.3956, 'mean_acc': 0.9531}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.4167, 'acc_0_0': 0.9553, 'acc_0_1': 0.994, 'acc_1_0': 0.8714, 'acc_1_1': 0.4167, 'mean_acc': 0.9546}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3879, 'acc_0_0': 0.9555, 'acc_0_1': 0.9957, 'acc_1_0': 0.8647, 'acc_1_1': 0.3879, 'mean_acc': 0.9544}
Val(class): {'weighted_mean_acc': 0.9472, 'worst_acc': 0.2308, 'acc_0_0': 0.9663, 'acc_0_1': 0.9966, 'acc_1_0': 0.7864, 'acc_1_1': 0.2308, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.35, 'acc_0_0': 0.9707, 'acc_0_1': 0.996, 'acc_1_0': 0.7827, 'acc_1_1': 0.35, 'mean_acc': 0.9513}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3965, 'acc_0_0': 0.9565, 'acc_0_1': 0.9957, 'acc_1_0': 0.8656, 'acc_1_1': 0.3965, 'mean_acc': 0.9551}
Val(class): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.1978, 'acc_0_0': 0.9738, 'acc_0_1': 0.9976, 'acc_1_0': 0.7523, 'acc_1_1': 0.1978, 'mean_acc': 0.9445}
Test(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.2333, 'acc_0_0': 0.9787, 'acc_0_1': 0.9987, 'acc_1_0': 0.7391, 'acc_1_1': 0.2333, 'mean_acc': 0.9498}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4239, 'acc_0_0': 0.9559, 'acc_0_1': 0.9957, 'acc_1_0': 0.8682, 'acc_1_1': 0.4239, 'mean_acc': 0.9554}
Val(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.2418, 'acc_0_0': 0.962, 'acc_0_1': 0.9966, 'acc_1_0': 0.8302, 'acc_1_1': 0.2418, 'mean_acc': 0.9508}
Test(class): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.3444, 'acc_0_0': 0.9684, 'acc_0_1': 0.9969, 'acc_1_0': 0.823, 'acc_1_1': 0.3444, 'mean_acc': 0.9555}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.4362, 'acc_0_0': 0.9573, 'acc_0_1': 0.9955, 'acc_1_0': 0.8696, 'acc_1_1': 0.4362, 'mean_acc': 0.9562}
Val(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.3846, 'acc_0_0': 0.9342, 'acc_0_1': 0.9947, 'acc_1_0': 0.904, 'acc_1_1': 0.3846, 'mean_acc': 0.95}
Test(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4278, 'acc_0_0': 0.9429, 'acc_0_1': 0.9934, 'acc_1_0': 0.894, 'acc_1_1': 0.4278, 'mean_acc': 0.9512}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4521, 'acc_0_0': 0.9583, 'acc_0_1': 0.9956, 'acc_1_0': 0.8706, 'acc_1_1': 0.4521, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.2857, 'acc_0_0': 0.9475, 'acc_0_1': 0.9969, 'acc_1_0': 0.872, 'acc_1_1': 0.2857, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.3389, 'acc_0_0': 0.9569, 'acc_0_1': 0.9972, 'acc_1_0': 0.8706, 'acc_1_1': 0.3389, 'mean_acc': 0.9558}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4722, 'acc_0_0': 0.9581, 'acc_0_1': 0.9956, 'acc_1_0': 0.8715, 'acc_1_1': 0.4722, 'mean_acc': 0.9572}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.2527, 'acc_0_0': 0.9623, 'acc_0_1': 0.9969, 'acc_1_0': 0.8072, 'acc_1_1': 0.2527, 'mean_acc': 0.9478}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3111, 'acc_0_0': 0.9632, 'acc_0_1': 0.9964, 'acc_1_0': 0.8173, 'acc_1_1': 0.3111, 'mean_acc': 0.9518}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.4758, 'acc_0_0': 0.9594, 'acc_0_1': 0.9955, 'acc_1_0': 0.8713, 'acc_1_1': 0.4758, 'mean_acc': 0.9577}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.2418, 'acc_0_0': 0.9538, 'acc_0_1': 0.9969, 'acc_1_0': 0.8434, 'acc_1_1': 0.2418, 'mean_acc': 0.9493}
Test(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.3222, 'acc_0_0': 0.961, 'acc_0_1': 0.9969, 'acc_1_0': 0.8484, 'acc_1_1': 0.3222, 'mean_acc': 0.9548}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4845, 'acc_0_0': 0.9595, 'acc_0_1': 0.9957, 'acc_1_0': 0.8747, 'acc_1_1': 0.4845, 'mean_acc': 0.9584}
Val(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.3956, 'acc_0_0': 0.9548, 'acc_0_1': 0.9949, 'acc_1_0': 0.8615, 'acc_1_1': 0.3956, 'mean_acc': 0.9529}
Test(class): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.3889, 'acc_0_0': 0.9595, 'acc_0_1': 0.9934, 'acc_1_0': 0.848, 'acc_1_1': 0.3889, 'mean_acc': 0.9533}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5004, 'acc_0_0': 0.9593, 'acc_0_1': 0.9955, 'acc_1_0': 0.875, 'acc_1_1': 0.5004, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4615, 'acc_0_0': 0.947, 'acc_0_1': 0.9954, 'acc_1_0': 0.8692, 'acc_1_1': 0.4615, 'mean_acc': 0.9515}
Test(class): {'weighted_mean_acc': 0.9538, 'worst_acc': 0.4333, 'acc_0_0': 0.9543, 'acc_0_1': 0.9915, 'acc_1_0': 0.8738, 'acc_1_1': 0.4333, 'mean_acc': 0.9537}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5126, 'acc_0_0': 0.9605, 'acc_0_1': 0.9956, 'acc_1_0': 0.8763, 'acc_1_1': 0.5126, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4286, 'acc_0_0': 0.9567, 'acc_0_1': 0.9954, 'acc_1_0': 0.8309, 'acc_1_1': 0.4286, 'mean_acc': 0.9498}
Test(class): {'weighted_mean_acc': 0.9532, 'worst_acc': 0.4389, 'acc_0_0': 0.9655, 'acc_0_1': 0.9934, 'acc_1_0': 0.8282, 'acc_1_1': 0.4389, 'mean_acc': 0.9542}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.5184, 'acc_0_0': 0.9609, 'acc_0_1': 0.9954, 'acc_1_0': 0.8763, 'acc_1_1': 0.5184, 'mean_acc': 0.9594}
Val(class): {'weighted_mean_acc': 0.9502, 'worst_acc': 0.2967, 'acc_0_0': 0.9517, 'acc_0_1': 0.9957, 'acc_1_0': 0.8525, 'acc_1_1': 0.2967, 'mean_acc': 0.9497}
Test(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.35, 'acc_0_0': 0.9607, 'acc_0_1': 0.996, 'acc_1_0': 0.8524, 'acc_1_1': 0.35, 'mean_acc': 0.9551}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5458, 'acc_0_0': 0.9614, 'acc_0_1': 0.9958, 'acc_1_0': 0.8799, 'acc_1_1': 0.5458, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.4286, 'acc_0_0': 0.9506, 'acc_0_1': 0.9935, 'acc_1_0': 0.8636, 'acc_1_1': 0.4286, 'mean_acc': 0.9511}
Test(class): {'weighted_mean_acc': 0.9521, 'worst_acc': 0.4889, 'acc_0_0': 0.9547, 'acc_0_1': 0.9906, 'acc_1_0': 0.8593, 'acc_1_1': 0.4889, 'mean_acc': 0.9522}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.5422, 'acc_0_0': 0.9608, 'acc_0_1': 0.996, 'acc_1_0': 0.8796, 'acc_1_1': 0.5422, 'mean_acc': 0.9603}
Val(class): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.3077, 'acc_0_0': 0.9585, 'acc_0_1': 0.9947, 'acc_1_0': 0.8309, 'acc_1_1': 0.3077, 'mean_acc': 0.9492}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.3778, 'acc_0_0': 0.9642, 'acc_0_1': 0.9951, 'acc_1_0': 0.8302, 'acc_1_1': 0.3778, 'mean_acc': 0.9539}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.5523, 'acc_0_0': 0.9622, 'acc_0_1': 0.9958, 'acc_1_0': 0.8812, 'acc_1_1': 0.5523, 'mean_acc': 0.9611}
Val(class): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.2088, 'acc_0_0': 0.9414, 'acc_0_1': 0.9976, 'acc_1_0': 0.881, 'acc_1_1': 0.2088, 'mean_acc': 0.9494}
Test(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.2611, 'acc_0_0': 0.9514, 'acc_0_1': 0.9968, 'acc_1_0': 0.869, 'acc_1_1': 0.2611, 'mean_acc': 0.9521}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.5501, 'acc_0_0': 0.9627, 'acc_0_1': 0.9958, 'acc_1_0': 0.8835, 'acc_1_1': 0.5501, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9469, 'worst_acc': 0.5714, 'acc_0_0': 0.9239, 'acc_0_1': 0.9896, 'acc_1_0': 0.9172, 'acc_1_1': 0.5714, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.5278, 'acc_0_0': 0.9336, 'acc_0_1': 0.9857, 'acc_1_0': 0.9081, 'acc_1_1': 0.5278, 'mean_acc': 0.9464}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.5789, 'acc_0_0': 0.9632, 'acc_0_1': 0.9961, 'acc_1_0': 0.8858, 'acc_1_1': 0.5789, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9473, 'worst_acc': 0.2198, 'acc_0_0': 0.9649, 'acc_0_1': 0.9978, 'acc_1_0': 0.7884, 'acc_1_1': 0.2198, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.2444, 'acc_0_0': 0.9704, 'acc_0_1': 0.9973, 'acc_1_0': 0.7835, 'acc_1_1': 0.2444, 'mean_acc': 0.9508}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.5833, 'acc_0_0': 0.9633, 'acc_0_1': 0.9958, 'acc_1_0': 0.8822, 'acc_1_1': 0.5833, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.3297, 'acc_0_0': 0.9342, 'acc_0_1': 0.9981, 'acc_1_0': 0.8845, 'acc_1_1': 0.3297, 'mean_acc': 0.9481}
Test(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.3167, 'acc_0_0': 0.9442, 'acc_0_1': 0.9964, 'acc_1_0': 0.8786, 'acc_1_1': 0.3167, 'mean_acc': 0.9501}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.5926, 'acc_0_0': 0.9629, 'acc_0_1': 0.9959, 'acc_1_0': 0.8868, 'acc_1_1': 0.5926, 'mean_acc': 0.9626}
Val(class): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2967, 'acc_0_0': 0.9515, 'acc_0_1': 0.9959, 'acc_1_0': 0.833, 'acc_1_1': 0.2967, 'mean_acc': 0.9468}
Test(class): {'weighted_mean_acc': 0.9514, 'worst_acc': 0.3556, 'acc_0_0': 0.9622, 'acc_0_1': 0.9947, 'acc_1_0': 0.8274, 'acc_1_1': 0.3556, 'mean_acc': 0.9523}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.5941, 'acc_0_0': 0.9637, 'acc_0_1': 0.9957, 'acc_1_0': 0.8863, 'acc_1_1': 0.5941, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9451, 'worst_acc': 0.4286, 'acc_0_0': 0.937, 'acc_0_1': 0.9918, 'acc_1_0': 0.8657, 'acc_1_1': 0.4286, 'mean_acc': 0.9448}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9462, 'acc_0_1': 0.9906, 'acc_1_0': 0.873, 'acc_1_1': 0.4722, 'mean_acc': 0.9496}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.5955, 'acc_0_0': 0.9645, 'acc_0_1': 0.996, 'acc_1_0': 0.8858, 'acc_1_1': 0.5955, 'mean_acc': 0.9632}
Val(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2418, 'acc_0_0': 0.9358, 'acc_0_1': 0.9986, 'acc_1_0': 0.8873, 'acc_1_1': 0.2418, 'mean_acc': 0.9486}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.3222, 'acc_0_0': 0.9446, 'acc_0_1': 0.9963, 'acc_1_0': 0.8827, 'acc_1_1': 0.3222, 'mean_acc': 0.9508}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.62, 'acc_0_0': 0.9645, 'acc_0_1': 0.9959, 'acc_1_0': 0.8903, 'acc_1_1': 0.62, 'mean_acc': 0.964}
Val(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.4066, 'acc_0_0': 0.9545, 'acc_0_1': 0.9899, 'acc_1_0': 0.8525, 'acc_1_1': 0.4066, 'mean_acc': 0.9495}
Test(class): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.4889, 'acc_0_0': 0.9599, 'acc_0_1': 0.987, 'acc_1_0': 0.8419, 'acc_1_1': 0.4889, 'mean_acc': 0.9512}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.6345, 'acc_0_0': 0.9647, 'acc_0_1': 0.9957, 'acc_1_0': 0.8888, 'acc_1_1': 0.6345, 'mean_acc': 0.9639}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.3077, 'acc_0_0': 0.9456, 'acc_0_1': 0.9964, 'acc_1_0': 0.8615, 'acc_1_1': 0.3077, 'mean_acc': 0.9488}
Test(class): {'weighted_mean_acc': 0.9508, 'worst_acc': 0.3778, 'acc_0_0': 0.9545, 'acc_0_1': 0.9932, 'acc_1_0': 0.85, 'acc_1_1': 0.3778, 'mean_acc': 0.951}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.6244, 'acc_0_0': 0.9654, 'acc_0_1': 0.9962, 'acc_1_0': 0.8895, 'acc_1_1': 0.6244, 'mean_acc': 0.9645}
Val(class): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.3846, 'acc_0_0': 0.9571, 'acc_0_1': 0.9932, 'acc_1_0': 0.817, 'acc_1_1': 0.3846, 'mean_acc': 0.9466}
Test(class): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.4556, 'acc_0_0': 0.9625, 'acc_0_1': 0.992, 'acc_1_0': 0.831, 'acc_1_1': 0.4556, 'mean_acc': 0.9528}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.6482, 'acc_0_0': 0.9648, 'acc_0_1': 0.996, 'acc_1_0': 0.89, 'acc_1_1': 0.6482, 'mean_acc': 0.9644}
Val(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4725, 'acc_0_0': 0.9302, 'acc_0_1': 0.9906, 'acc_1_0': 0.9019, 'acc_1_1': 0.4725, 'mean_acc': 0.9471}
Test(class): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.4222, 'acc_0_0': 0.9433, 'acc_0_1': 0.991, 'acc_1_0': 0.8948, 'acc_1_1': 0.4222, 'mean_acc': 0.9506}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.646, 'acc_0_0': 0.9653, 'acc_0_1': 0.9963, 'acc_1_0': 0.8909, 'acc_1_1': 0.646, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.4505, 'acc_0_0': 0.9482, 'acc_0_1': 0.9915, 'acc_1_0': 0.8664, 'acc_1_1': 0.4505, 'mean_acc': 0.9499}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.4722, 'acc_0_0': 0.9534, 'acc_0_1': 0.9893, 'acc_1_0': 0.8544, 'acc_1_1': 0.4722, 'mean_acc': 0.9503}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9658, 'acc_0_1': 0.9959, 'acc_1_0': 0.8924, 'acc_1_1': 0.6467, 'mean_acc': 0.9651}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.1978, 'acc_0_0': 0.9618, 'acc_0_1': 0.9954, 'acc_1_0': 0.833, 'acc_1_1': 0.1978, 'mean_acc': 0.9502}
Test(class): {'weighted_mean_acc': 0.9484, 'worst_acc': 0.2944, 'acc_0_0': 0.9639, 'acc_0_1': 0.995, 'acc_1_0': 0.8032, 'acc_1_1': 0.2944, 'mean_acc': 0.9496}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.6568, 'acc_0_0': 0.9668, 'acc_0_1': 0.9961, 'acc_1_0': 0.8913, 'acc_1_1': 0.6568, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9523, 'worst_acc': 0.4176, 'acc_0_0': 0.9503, 'acc_0_1': 0.9949, 'acc_1_0': 0.8664, 'acc_1_1': 0.4176, 'mean_acc': 0.9519}
Test(class): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.3611, 'acc_0_0': 0.955, 'acc_0_1': 0.9931, 'acc_1_0': 0.8548, 'acc_1_1': 0.3611, 'mean_acc': 0.9516}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.6676, 'acc_0_0': 0.9661, 'acc_0_1': 0.9964, 'acc_1_0': 0.8928, 'acc_1_1': 0.6676, 'mean_acc': 0.9657}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.3407, 'acc_0_0': 0.9299, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.3407, 'mean_acc': 0.9461}
Test(class): {'weighted_mean_acc': 0.9487, 'worst_acc': 0.3889, 'acc_0_0': 0.9396, 'acc_0_1': 0.9942, 'acc_1_0': 0.8786, 'acc_1_1': 0.3889, 'mean_acc': 0.9477}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.6583, 'acc_0_0': 0.9664, 'acc_0_1': 0.9959, 'acc_1_0': 0.8948, 'acc_1_1': 0.6583, 'mean_acc': 0.9659}
Val(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.1648, 'acc_0_0': 0.9515, 'acc_0_1': 0.9981, 'acc_1_0': 0.8309, 'acc_1_1': 0.1648, 'mean_acc': 0.9462}
Test(class): {'weighted_mean_acc': 0.95, 'worst_acc': 0.3, 'acc_0_0': 0.9562, 'acc_0_1': 0.9971, 'acc_1_0': 0.8323, 'acc_1_1': 0.3, 'mean_acc': 0.9503}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.6683, 'acc_0_0': 0.967, 'acc_0_1': 0.9965, 'acc_1_0': 0.8934, 'acc_1_1': 0.6683, 'mean_acc': 0.9662}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.4286, 'acc_0_0': 0.9616, 'acc_0_1': 0.9894, 'acc_1_0': 0.8246, 'acc_1_1': 0.4286, 'mean_acc': 0.9485}
Test(class): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.4833, 'acc_0_0': 0.9633, 'acc_0_1': 0.987, 'acc_1_0': 0.8077, 'acc_1_1': 0.4833, 'mean_acc': 0.9486}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.6741, 'acc_0_0': 0.9669, 'acc_0_1': 0.9962, 'acc_1_0': 0.8967, 'acc_1_1': 0.6741, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.949, 'worst_acc': 0.4945, 'acc_0_0': 0.9447, 'acc_0_1': 0.9915, 'acc_1_0': 0.8657, 'acc_1_1': 0.4945, 'mean_acc': 0.9487}
Test(class): {'weighted_mean_acc': 0.9507, 'worst_acc': 0.4833, 'acc_0_0': 0.9502, 'acc_0_1': 0.9894, 'acc_1_0': 0.8677, 'acc_1_1': 0.4833, 'mean_acc': 0.9506}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.6669, 'acc_0_0': 0.9671, 'acc_0_1': 0.9964, 'acc_1_0': 0.895, 'acc_1_1': 0.6669, 'mean_acc': 0.9665}
Val(class): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.2857, 'acc_0_0': 0.9351, 'acc_0_1': 0.9957, 'acc_1_0': 0.89, 'acc_1_1': 0.2857, 'mean_acc': 0.9479}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.3944, 'acc_0_0': 0.9425, 'acc_0_1': 0.9944, 'acc_1_0': 0.8911, 'acc_1_1': 0.3944, 'mean_acc': 0.9508}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.6727, 'acc_0_0': 0.9672, 'acc_0_1': 0.9962, 'acc_1_0': 0.897, 'acc_1_1': 0.6727, 'mean_acc': 0.9667}
Val(class): {'weighted_mean_acc': 0.9422, 'worst_acc': 0.5165, 'acc_0_0': 0.9182, 'acc_0_1': 0.9889, 'acc_1_0': 0.9068, 'acc_1_1': 0.5165, 'mean_acc': 0.9423}
Test(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.5222, 'acc_0_0': 0.9333, 'acc_0_1': 0.9867, 'acc_1_0': 0.8923, 'acc_1_1': 0.5222, 'mean_acc': 0.9447}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.6907, 'acc_0_0': 0.9675, 'acc_0_1': 0.996, 'acc_1_0': 0.8972, 'acc_1_1': 0.6907, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.1978, 'acc_0_0': 0.9597, 'acc_0_1': 0.9957, 'acc_1_0': 0.826, 'acc_1_1': 0.1978, 'mean_acc': 0.9484}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.3222, 'acc_0_0': 0.9622, 'acc_0_1': 0.9959, 'acc_1_0': 0.8052, 'acc_1_1': 0.3222, 'mean_acc': 0.9497}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6849, 'acc_0_0': 0.9681, 'acc_0_1': 0.9965, 'acc_1_0': 0.8984, 'acc_1_1': 0.6849, 'mean_acc': 0.9676}
Val(class): {'weighted_mean_acc': 0.9455, 'worst_acc': 0.3956, 'acc_0_0': 0.9405, 'acc_0_1': 0.9886, 'acc_1_0': 0.8685, 'acc_1_1': 0.3956, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.4333, 'acc_0_0': 0.9455, 'acc_0_1': 0.9894, 'acc_1_0': 0.8722, 'acc_1_1': 0.4333, 'mean_acc': 0.9484}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.682, 'acc_0_0': 0.9676, 'acc_0_1': 0.9964, 'acc_1_0': 0.8993, 'acc_1_1': 0.682, 'mean_acc': 0.9674}
Val(class): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.3516, 'acc_0_0': 0.9583, 'acc_0_1': 0.9932, 'acc_1_0': 0.8316, 'acc_1_1': 0.3516, 'mean_acc': 0.949}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3944, 'acc_0_0': 0.9607, 'acc_0_1': 0.9923, 'acc_1_0': 0.8137, 'acc_1_1': 0.3944, 'mean_acc': 0.9493}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9681, 'acc_0_1': 0.9964, 'acc_1_0': 0.8997, 'acc_1_1': 0.6957, 'mean_acc': 0.9678}
Val(class): {'weighted_mean_acc': 0.946, 'worst_acc': 0.3297, 'acc_0_0': 0.9585, 'acc_0_1': 0.9942, 'acc_1_0': 0.8031, 'acc_1_1': 0.3297, 'mean_acc': 0.9451}
Test(class): {'weighted_mean_acc': 0.9468, 'worst_acc': 0.3333, 'acc_0_0': 0.9609, 'acc_0_1': 0.9939, 'acc_1_0': 0.802, 'acc_1_1': 0.3333, 'mean_acc': 0.948}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.2198, 'acc_0_0': 0.978, 'acc_0_1': 1.0, 'acc_1_0': 0.7692, 'acc_1_1': 0.2198, 'mean_acc': 0.7418}
Val(class)(new adapter): {'weighted_mean_acc': 0.9336, 'worst_acc': 0.2857, 'acc_0_0': 0.9813, 'acc_0_1': 0.9976, 'acc_1_0': 0.6367, 'acc_1_1': 0.2857, 'mean_acc': 0.9319}
Test(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.1833, 'acc_0_0': 0.9836, 'acc_0_1': 0.9973, 'acc_1_0': 0.6081, 'acc_1_1': 0.1833, 'mean_acc': 0.9349}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5055, 'acc_0_0': 0.8571, 'acc_0_1': 0.8242, 'acc_1_0': 0.5934, 'acc_1_1': 0.5055, 'mean_acc': 0.6951}
Val(class)(new adapter): {'weighted_mean_acc': 0.9383, 'worst_acc': 0.6703, 'acc_0_0': 0.9499, 'acc_0_1': 0.9799, 'acc_1_0': 0.7968, 'acc_1_1': 0.6703, 'mean_acc': 0.9377}
Test(class)(new adapter): {'weighted_mean_acc': 0.9396, 'worst_acc': 0.6, 'acc_0_0': 0.9584, 'acc_0_1': 0.9781, 'acc_1_0': 0.7887, 'acc_1_1': 0.6, 'mean_acc': 0.9415}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.2308, 'acc_0_0': 0.4176, 'acc_0_1': 0.2308, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.6621}
Val(class)(new adapter): {'weighted_mean_acc': 0.6788, 'worst_acc': 0.4277, 'acc_0_0': 0.813, 'acc_0_1': 0.4277, 'acc_1_0': 0.9729, 'acc_1_1': 1.0, 'mean_acc': 0.6774}
Test(class)(new adapter): {'weighted_mean_acc': 0.698, 'worst_acc': 0.4386, 'acc_0_0': 0.8484, 'acc_0_1': 0.4386, 'acc_1_0': 0.9673, 'acc_1_1': 0.9944, 'mean_acc': 0.7098}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.1648, 'acc_0_1': 0.0, 'acc_1_0': 1.0, 'acc_1_1': 0.989, 'mean_acc': 0.5385}
Val(class)(new adapter): {'weighted_mean_acc': 0.8397, 'worst_acc': 0.0348, 'acc_0_0': 1.0, 'acc_0_1': 0.9437, 'acc_1_0': 0.0348, 'acc_1_1': 0.8242, 'mean_acc': 0.8353}
Test(class)(new adapter): {'weighted_mean_acc': 0.8344, 'worst_acc': 0.0282, 'acc_0_0': 0.999, 'acc_0_1': 0.9363, 'acc_1_0': 0.0282, 'acc_1_1': 0.7167, 'mean_acc': 0.8522}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3297, 'acc_0_0': 1.0, 'acc_0_1': 0.978, 'acc_1_0': 0.3297, 'acc_1_1': 0.7912, 'mean_acc': 0.7747}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.8128, 'acc_0_0': 0.9515, 'acc_0_1': 0.9408, 'acc_1_0': 0.8128, 'acc_1_1': 0.8352, 'mean_acc': 0.9259}
Test(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.8101, 'acc_0_0': 0.9582, 'acc_0_1': 0.9339, 'acc_1_0': 0.8101, 'acc_1_1': 0.8111, 'mean_acc': 0.9293}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6264, 'acc_0_0': 0.6264, 'acc_0_1': 0.7143, 'acc_1_0': 0.989, 'acc_1_1': 0.967, 'mean_acc': 0.8242}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.4396, 'acc_0_0': 0.9803, 'acc_0_1': 0.9918, 'acc_1_0': 0.6521, 'acc_1_1': 0.4396, 'mean_acc': 0.9327}
Test(class)(new adapter): {'weighted_mean_acc': 0.9338, 'worst_acc': 0.3611, 'acc_0_0': 0.9828, 'acc_0_1': 0.9946, 'acc_1_0': 0.6375, 'acc_1_1': 0.3611, 'mean_acc': 0.9387}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7033, 'acc_0_0': 0.956, 'acc_0_1': 0.956, 'acc_1_0': 0.7033, 'acc_1_1': 0.8681, 'mean_acc': 0.8709}
Val(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.9014, 'acc_0_0': 0.9021, 'acc_0_1': 0.9014, 'acc_1_0': 0.9318, 'acc_1_1': 0.9231, 'mean_acc': 0.9063}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.8833, 'acc_0_0': 0.9111, 'acc_0_1': 0.8905, 'acc_1_0': 0.9185, 'acc_1_1': 0.8833, 'mean_acc': 0.904}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8352, 'acc_0_0': 0.8352, 'acc_0_1': 0.8571, 'acc_1_0': 0.967, 'acc_1_1': 0.989, 'mean_acc': 0.9121}
Val(class)(new adapter): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.7802, 'acc_0_0': 0.9325, 'acc_0_1': 0.9729, 'acc_1_0': 0.8817, 'acc_1_1': 0.7802, 'mean_acc': 0.9406}
Test(class)(new adapter): {'weighted_mean_acc': 0.941, 'worst_acc': 0.6667, 'acc_0_0': 0.9372, 'acc_0_1': 0.972, 'acc_1_0': 0.879, 'acc_1_1': 0.6667, 'mean_acc': 0.9407}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.967, 'acc_0_1': 0.978, 'acc_1_0': 0.8681, 'acc_1_1': 0.9121, 'mean_acc': 0.9313}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.8791, 'acc_0_0': 0.9014, 'acc_0_1': 0.9362, 'acc_1_0': 0.9346, 'acc_1_1': 0.8791, 'mean_acc': 0.9205}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.8444, 'acc_0_0': 0.9111, 'acc_0_1': 0.9277, 'acc_1_0': 0.9298, 'acc_1_1': 0.8444, 'mean_acc': 0.9191}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.978, 'acc_1_0': 0.956, 'acc_1_1': 0.978, 'mean_acc': 0.9505}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.8571, 'acc_0_0': 0.858, 'acc_0_1': 0.9456, 'acc_1_0': 0.9555, 'acc_1_1': 0.8571, 'mean_acc': 0.9086}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.8111, 'acc_0_0': 0.8764, 'acc_0_1': 0.9378, 'acc_1_0': 0.9488, 'acc_1_1': 0.8111, 'mean_acc': 0.908}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.967, 'acc_1_0': 0.956, 'acc_1_1': 0.989, 'mean_acc': 0.956}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.8462, 'acc_0_0': 0.9098, 'acc_0_1': 0.949, 'acc_1_0': 0.92, 'acc_1_1': 0.8462, 'mean_acc': 0.927}
Test(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.8111, 'acc_0_0': 0.918, 'acc_0_1': 0.9421, 'acc_1_0': 0.9121, 'acc_1_1': 0.8111, 'mean_acc': 0.9254}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.956, 'acc_1_0': 0.9451, 'acc_1_1': 0.956, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.8462, 'acc_0_0': 0.869, 'acc_0_1': 0.9514, 'acc_1_0': 0.9576, 'acc_1_1': 0.8462, 'mean_acc': 0.9159}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.8, 'acc_0_0': 0.8885, 'acc_0_1': 0.9428, 'acc_1_0': 0.9524, 'acc_1_1': 0.8, 'mean_acc': 0.9161}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9341, 'acc_0_0': 0.9341, 'acc_0_1': 0.9451, 'acc_1_0': 0.956, 'acc_1_1': 0.956, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.8571, 'acc_0_0': 0.8789, 'acc_0_1': 0.9509, 'acc_1_0': 0.9513, 'acc_1_1': 0.8571, 'mean_acc': 0.9192}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.8, 'acc_0_0': 0.899, 'acc_0_1': 0.944, 'acc_1_0': 0.946, 'acc_1_1': 0.8, 'mean_acc': 0.9209}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8791, 'acc_0_0': 0.8791, 'acc_0_1': 0.9341, 'acc_1_0': 0.9121, 'acc_1_1': 0.978, 'mean_acc': 0.9258}
Val(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.8462, 'acc_0_0': 0.8941, 'acc_0_1': 0.9507, 'acc_1_0': 0.9353, 'acc_1_1': 0.8462, 'mean_acc': 0.9232}
Test(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.8, 'acc_0_0': 0.9133, 'acc_0_1': 0.9431, 'acc_1_0': 0.9306, 'acc_1_1': 0.8, 'mean_acc': 0.9257}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.989, 'acc_1_0': 0.9121, 'acc_1_1': 0.989, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.8791, 'acc_0_0': 0.9182, 'acc_0_1': 0.9374, 'acc_1_0': 0.9005, 'acc_1_1': 0.8791, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.8722, 'acc_0_0': 0.9323, 'acc_0_1': 0.927, 'acc_1_0': 0.9028, 'acc_1_1': 0.8722, 'mean_acc': 0.9261}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.9011, 'acc_0_1': 0.978, 'acc_1_0': 0.8681, 'acc_1_1': 0.989, 'mean_acc': 0.9341}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.8352, 'acc_0_0': 0.8871, 'acc_0_1': 0.9495, 'acc_1_0': 0.9395, 'acc_1_1': 0.8352, 'mean_acc': 0.9202}
Test(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.8056, 'acc_0_0': 0.9088, 'acc_0_1': 0.9443, 'acc_1_0': 0.9383, 'acc_1_1': 0.8056, 'mean_acc': 0.9249}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8571, 'acc_0_0': 0.8571, 'acc_0_1': 0.978, 'acc_1_0': 0.956, 'acc_1_1': 1.0, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.8791, 'acc_0_0': 0.9224, 'acc_0_1': 0.9406, 'acc_1_0': 0.9054, 'acc_1_1': 0.8791, 'mean_acc': 0.9271}
Test(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.85, 'acc_0_0': 0.9355, 'acc_0_1': 0.9327, 'acc_1_0': 0.9004, 'acc_1_1': 0.85, 'mean_acc': 0.9293}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9121, 'acc_0_1': 0.9451, 'acc_1_0': 0.967, 'acc_1_1': 0.967, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.8132, 'acc_0_0': 0.9178, 'acc_0_1': 0.957, 'acc_1_0': 0.9116, 'acc_1_1': 0.8132, 'mean_acc': 0.9323}
Test(class)(new adapter): {'weighted_mean_acc': 0.935, 'worst_acc': 0.7722, 'acc_0_0': 0.9311, 'acc_0_1': 0.9521, 'acc_1_0': 0.9073, 'acc_1_1': 0.7722, 'mean_acc': 0.9346}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8901, 'acc_0_0': 0.8901, 'acc_0_1': 0.956, 'acc_1_0': 0.9341, 'acc_1_1': 0.978, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.8352, 'acc_0_0': 0.903, 'acc_0_1': 0.9485, 'acc_1_0': 0.929, 'acc_1_1': 0.8352, 'mean_acc': 0.9251}
Test(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8, 'acc_0_0': 0.92, 'acc_0_1': 0.9423, 'acc_1_0': 0.9234, 'acc_1_1': 0.8, 'mean_acc': 0.9278}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9121, 'acc_0_1': 0.9341, 'acc_1_0': 0.9011, 'acc_1_1': 0.967, 'mean_acc': 0.9286}
Val(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.8352, 'acc_0_0': 0.896, 'acc_0_1': 0.9563, 'acc_1_0': 0.9325, 'acc_1_1': 0.8352, 'mean_acc': 0.9258}
Test(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.7778, 'acc_0_0': 0.9133, 'acc_0_1': 0.947, 'acc_1_0': 0.9319, 'acc_1_1': 0.7778, 'mean_acc': 0.9271}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.8681, 'acc_0_1': 0.989, 'acc_1_0': 0.9341, 'acc_1_1': 0.978, 'mean_acc': 0.9423}
Val(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.8681, 'acc_0_0': 0.9053, 'acc_0_1': 0.9493, 'acc_1_0': 0.9221, 'acc_1_1': 0.8681, 'mean_acc': 0.9257}
Test(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.8056, 'acc_0_0': 0.919, 'acc_0_1': 0.9419, 'acc_1_0': 0.9218, 'acc_1_1': 0.8056, 'mean_acc': 0.927}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9011, 'acc_0_0': 0.9011, 'acc_0_1': 0.978, 'acc_1_0': 0.9231, 'acc_1_1': 0.989, 'mean_acc': 0.9478}
Val(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.8132, 'acc_0_0': 0.9325, 'acc_0_1': 0.9558, 'acc_1_0': 0.89, 'acc_1_1': 0.8132, 'mean_acc': 0.935}
Test(class)(new adapter): {'weighted_mean_acc': 0.9353, 'worst_acc': 0.8, 'acc_0_0': 0.9382, 'acc_0_1': 0.9517, 'acc_1_0': 0.8863, 'acc_1_1': 0.8, 'mean_acc': 0.9356}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9121, 'acc_0_0': 0.9231, 'acc_0_1': 0.9231, 'acc_1_0': 0.9121, 'acc_1_1': 1.0, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.8462, 'acc_0_0': 0.9192, 'acc_0_1': 0.9536, 'acc_1_0': 0.9158, 'acc_1_1': 0.8462, 'mean_acc': 0.9324}
Test(class)(new adapter): {'weighted_mean_acc': 0.9338, 'worst_acc': 0.7944, 'acc_0_0': 0.9289, 'acc_0_1': 0.9498, 'acc_1_0': 0.9109, 'acc_1_1': 0.7944, 'mean_acc': 0.9334}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.9231, 'acc_0_1': 0.978, 'acc_1_0': 0.8681, 'acc_1_1': 0.989, 'mean_acc': 0.9396}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.8462, 'acc_0_0': 0.9187, 'acc_0_1': 0.9536, 'acc_1_0': 0.9102, 'acc_1_1': 0.8462, 'mean_acc': 0.9313}
Test(class)(new adapter): {'weighted_mean_acc': 0.9339, 'worst_acc': 0.7944, 'acc_0_0': 0.9297, 'acc_0_1': 0.9497, 'acc_1_0': 0.9097, 'acc_1_1': 0.7944, 'mean_acc': 0.9335}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8681, 'acc_0_0': 0.9231, 'acc_0_1': 0.9451, 'acc_1_0': 0.8681, 'acc_1_1': 0.989, 'mean_acc': 0.9313}
Val(class)(new adapter): {'weighted_mean_acc': 0.9377, 'worst_acc': 0.8132, 'acc_0_0': 0.9306, 'acc_0_1': 0.9628, 'acc_1_0': 0.8942, 'acc_1_1': 0.8132, 'mean_acc': 0.9377}
Test(class)(new adapter): {'weighted_mean_acc': 0.9384, 'worst_acc': 0.7722, 'acc_0_0': 0.9391, 'acc_0_1': 0.9589, 'acc_1_0': 0.8867, 'acc_1_1': 0.7722, 'mean_acc': 0.9385}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.7033, 'acc_0_0': 0.956, 'acc_0_1': 0.956, 'acc_1_0': 0.7033, 'acc_1_1': 0.8681, 'mean_acc': 0.8709}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9062, 'worst_acc': 0.9014, 'acc_0_0': 0.9021, 'acc_0_1': 0.9014, 'acc_1_0': 0.9318, 'acc_1_1': 0.9231, 'mean_acc': 0.9063}
best test accuracy on [class]: {'weighted_mean_acc': 0.9035, 'worst_acc': 0.8833, 'acc_0_0': 0.9111, 'acc_0_1': 0.8905, 'acc_1_0': 0.9185, 'acc_1_1': 0.8833, 'mean_acc': 0.904}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.8833, 'acc_0_0': 0.9111, 'acc_0_1': 0.8905, 'acc_1_0': 0.9185, 'acc_1_1': 0.8833, 'mean_acc': 0.904}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9891, 'worst_acc': 0.9167, 'acc_0_0': 0.9947, 'acc_0_1': 0.9829, 'acc_1_0': 0.994, 'acc_1_1': 0.9167, 'mean_acc': 0.9894}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9165     0.8611   0.8942  ...   0.9448   0.8611    0.9144
2                       0.9035     0.8833   0.9111  ...   0.9185   0.8833    0.9040
test_mean               0.9100     0.8722   0.9026  ...   0.9316   0.8722    0.9092
test_std                0.0065     0.0111   0.0085  ...   0.0131   0.0111    0.0052
1                       0.9887     0.9111   0.9917  ...   0.9931   0.9111    0.9888
2                       0.9891     0.9167   0.9947  ...   0.9940   0.9167    0.9894
zs_spu_mean             0.9889     0.9139   0.9932  ...   0.9936   0.9139    0.9891
zs_spu_std              0.0002     0.0028   0.0015  ...   0.0005   0.0028    0.0003
1                          NaN     0.8901   0.8901  ...   0.9560   0.9890    0.9560
2                          NaN     0.7033   0.9560  ...   0.7033   0.8681    0.8709
tr_mean                    NaN     0.7967   0.9230  ...   0.8296   0.9286    0.9134
tr_std                     NaN     0.0934   0.0329  ...   0.1263   0.0604    0.0425
1                       0.9141     0.8791   0.8800  ...   0.9513   0.8791    0.9147
2                       0.9062     0.9014   0.9021  ...   0.9318   0.9231    0.9063
val_mean                0.9102     0.8902   0.8910  ...   0.9416   0.9011    0.9105
val_std                 0.0040     0.0111   0.0111  ...   0.0098   0.0220    0.0042
1                       0.9165     0.8611   0.8942  ...   0.9448   0.8611    0.9144
2                       0.9035     0.8833   0.9111  ...   0.9185   0.8833    0.9040
zs_tg_mean              0.9100     0.8722   0.9026  ...   0.9316   0.8722    0.9092
zs_tg_std               0.0065     0.0111   0.0085  ...   0.0131   0.0111    0.0052

[20 rows x 7 columns]
Save to:  results_iterative/ds_celeba_tl_adapter_reg_seq_alter_bs_1024_lr_0.1_lrr1.0_bsr16_balval_MA+rn.csv

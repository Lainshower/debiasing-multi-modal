random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3696, 'acc_0_0': 0.9337, 'acc_0_1': 0.3696, 'acc_1_0': 0.5357, 'acc_1_1': 0.7228, 'mean_acc': 0.8609}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4034, 'acc_0_0': 1.0, 'acc_0_1': 0.4034, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.3605, 'acc_0_0': 0.9925, 'acc_0_1': 0.3605, 'acc_1_0': 0.5592, 'acc_1_1': 0.9548, 'mean_acc': 0.6943}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9946, 'acc_0_1': 0.5707, 'acc_1_0': 0.4821, 'acc_1_1': 0.9158, 'mean_acc': 0.955}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3734, 'acc_0_0': 0.9915, 'acc_0_1': 0.3734, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.71}
Test(class): {'weighted_mean_acc': 0.9542, 'worst_acc': 0.3729, 'acc_0_0': 0.9854, 'acc_0_1': 0.3729, 'acc_1_0': 0.6386, 'acc_1_1': 0.9688, 'mean_acc': 0.7068}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6141, 'acc_0_0': 0.9883, 'acc_0_1': 0.6141, 'acc_1_0': 0.6607, 'acc_1_1': 0.9499, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9889, 'acc_0_1': 0.7565, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8488}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9929, 'acc_0_1': 0.7446, 'acc_1_0': 0.6786, 'acc_1_1': 0.9385, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.5751, 'acc_0_0': 0.9957, 'acc_0_1': 0.5751, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.5525, 'acc_0_0': 0.9831, 'acc_0_1': 0.5525, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.7794}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9923, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9593, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6044, 'acc_0_0': 0.992, 'acc_0_1': 0.6816, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8215}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.996, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9574, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.6142, 'acc_0_0': 0.9889, 'acc_0_1': 0.6142, 'acc_1_0': 0.6386, 'acc_1_1': 0.9393, 'mean_acc': 0.7988}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9963, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9631, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6153, 'acc_0_0': 0.9907, 'acc_0_1': 0.6993, 'acc_1_0': 0.6153, 'acc_1_1': 0.9299, 'mean_acc': 0.829}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9949, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9612, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6417, 'acc_0_0': 0.9894, 'acc_0_1': 0.6891, 'acc_1_0': 0.6417, 'acc_1_1': 0.933, 'mean_acc': 0.8278}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9954, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8293}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6226, 'acc_0_0': 0.9889, 'acc_0_1': 0.6226, 'acc_1_0': 0.6464, 'acc_1_1': 0.9393, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9963, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9707, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7055, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8298}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9974, 'acc_0_1': 0.7717, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.6616, 'acc_1_0': 0.6246, 'acc_1_1': 0.9377, 'mean_acc': 0.8162}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.998, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.9678, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.6355, 'acc_0_0': 0.9889, 'acc_0_1': 0.6727, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8203}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9974, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9811, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6168, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6168, 'acc_1_1': 0.9268, 'mean_acc': 0.836}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9991, 'acc_0_1': 0.8098, 'acc_1_0': 0.7321, 'acc_1_1': 0.9688, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.639, 'acc_0_0': 0.9867, 'acc_0_1': 0.639, 'acc_1_0': 0.6449, 'acc_1_1': 0.9393, 'mean_acc': 0.8082}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9983, 'acc_0_1': 0.7826, 'acc_1_0': 0.8571, 'acc_1_1': 0.9811, 'mean_acc': 0.9846}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6137, 'acc_0_0': 0.9894, 'acc_0_1': 0.7268, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.839}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6009, 'acc_0_0': 0.9829, 'acc_0_1': 0.6009, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.604, 'acc_0_0': 0.9854, 'acc_0_1': 0.604, 'acc_1_0': 0.6573, 'acc_1_1': 0.9439, 'mean_acc': 0.796}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7811, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5717, 'acc_0_0': 0.9925, 'acc_0_1': 0.757, 'acc_1_0': 0.5717, 'acc_1_1': 0.9237, 'mean_acc': 0.8466}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9983, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9839, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.741, 'acc_1_0': 0.5763, 'acc_1_1': 0.9221, 'mean_acc': 0.8405}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9991, 'acc_0_1': 0.8696, 'acc_1_0': 0.875, 'acc_1_1': 0.9849, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6137, 'acc_0_0': 0.9871, 'acc_0_1': 0.7029, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.829}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9997, 'acc_0_1': 0.8913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.662, 'acc_0_0': 0.984, 'acc_0_1': 0.6647, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8191}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6418, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6371, 'acc_0_0': 0.9858, 'acc_0_1': 0.6749, 'acc_1_0': 0.6371, 'acc_1_1': 0.9361, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6701, 'acc_1_0': 0.634, 'acc_1_1': 0.9346, 'mean_acc': 0.8188}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5903, 'acc_0_0': 0.9902, 'acc_0_1': 0.7406, 'acc_1_0': 0.5903, 'acc_1_1': 0.9237, 'mean_acc': 0.8414}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9885, 'acc_0_1': 0.7011, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.8262}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6012, 'acc_0_0': 0.9898, 'acc_0_1': 0.7286, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8381}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9728, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5935, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.5935, 'acc_1_1': 0.933, 'mean_acc': 0.8221}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9997, 'acc_0_1': 0.9348, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9962}
Val(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6866, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6866, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6402, 'acc_0_0': 0.9845, 'acc_0_1': 0.7282, 'acc_1_0': 0.6402, 'acc_1_1': 0.933, 'mean_acc': 0.8409}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.5997, 'acc_0_0': 0.9898, 'acc_0_1': 0.6772, 'acc_1_0': 0.5997, 'acc_1_1': 0.9408, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.7361, 'acc_1_0': 0.5763, 'acc_1_1': 0.9252, 'mean_acc': 0.839}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9643, 'acc_1_1': 0.9972, 'mean_acc': 0.9981}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.729, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8393}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6137, 'acc_0_0': 0.9885, 'acc_0_1': 0.7255, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8376}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5966, 'acc_0_0': 0.9898, 'acc_0_1': 0.7082, 'acc_1_0': 0.5966, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9985}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6433, 'acc_0_0': 0.9827, 'acc_0_1': 0.6439, 'acc_1_0': 0.6433, 'acc_1_1': 0.9455, 'mean_acc': 0.8091}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.648, 'acc_0_0': 0.9845, 'acc_0_1': 0.6851, 'acc_1_0': 0.648, 'acc_1_1': 0.9439, 'mean_acc': 0.8262}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.8157}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9981, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5888, 'acc_0_0': 0.9925, 'acc_0_1': 0.7401, 'acc_1_0': 0.5888, 'acc_1_1': 0.9237, 'mean_acc': 0.8419}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5919, 'acc_0_0': 0.9902, 'acc_0_1': 0.7086, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8298}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.609, 'acc_0_0': 0.9889, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8284}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6519, 'acc_0_0': 0.9827, 'acc_0_1': 0.6519, 'acc_1_0': 0.6573, 'acc_1_1': 0.9377, 'mean_acc': 0.8129}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9785, 'acc_0_1': 0.8627, 'acc_1_0': 0.4394, 'acc_1_1': 0.8209, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.897, 'acc_1_0': 0.6716, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9477, 'worst_acc': 0.6916, 'acc_0_0': 0.9823, 'acc_0_1': 0.8998, 'acc_1_0': 0.6916, 'acc_1_1': 0.8551, 'mean_acc': 0.9039}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4242, 'acc_0_0': 0.8755, 'acc_0_1': 0.7253, 'acc_1_0': 0.4242, 'acc_1_1': 0.7761, 'mean_acc': 0.7563}
Val(class)(new adapter): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4592, 'acc_0_0': 0.9872, 'acc_0_1': 0.4592, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7417}
Test(class)(new adapter): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.4692, 'acc_0_0': 0.9858, 'acc_0_1': 0.4692, 'acc_1_0': 0.6573, 'acc_1_1': 0.9564, 'mean_acc': 0.7451}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9742, 'acc_0_1': 0.867, 'acc_1_0': 0.6667, 'acc_1_1': 0.806, 'mean_acc': 0.8798}
Val(class)(new adapter): {'weighted_mean_acc': 0.8149, 'worst_acc': 0.6061, 'acc_0_0': 0.8718, 'acc_0_1': 0.9185, 'acc_1_0': 0.8657, 'acc_1_1': 0.6061, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.7946, 'worst_acc': 0.5452, 'acc_0_0': 0.8603, 'acc_0_1': 0.945, 'acc_1_0': 0.905, 'acc_1_1': 0.5452, 'mean_acc': 0.8633}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3881, 'acc_0_0': 0.8627, 'acc_0_1': 0.9142, 'acc_1_0': 0.9091, 'acc_1_1': 0.3881, 'mean_acc': 0.8347}
Val(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.6309, 'acc_0_0': 0.906, 'acc_0_1': 0.6309, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.6488, 'acc_0_0': 0.9011, 'acc_0_1': 0.6488, 'acc_1_0': 0.8738, 'acc_1_1': 0.9486, 'mean_acc': 0.8051}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9871, 'acc_0_1': 0.9313, 'acc_1_0': 0.7424, 'acc_1_1': 0.8806, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.8869, 'worst_acc': 0.6567, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.6567, 'acc_1_1': 0.6667, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8696, 'worst_acc': 0.5467, 'acc_0_0': 0.9641, 'acc_0_1': 0.98, 'acc_1_0': 0.6963, 'acc_1_1': 0.5467, 'mean_acc': 0.8944}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5224, 'acc_0_0': 0.9056, 'acc_0_1': 0.97, 'acc_1_0': 0.7727, 'acc_1_1': 0.5224, 'mean_acc': 0.8731}
Val(class)(new adapter): {'weighted_mean_acc': 0.8802, 'worst_acc': 0.6009, 'acc_0_0': 0.8632, 'acc_0_1': 0.6009, 'acc_1_0': 0.8806, 'acc_1_1': 0.9848, 'mean_acc': 0.7767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8809, 'worst_acc': 0.6208, 'acc_0_0': 0.8718, 'acc_0_1': 0.6208, 'acc_1_0': 0.905, 'acc_1_1': 0.9548, 'mean_acc': 0.787}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9571, 'acc_0_1': 0.9099, 'acc_1_0': 0.7121, 'acc_1_1': 0.9254, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7121, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.7164, 'acc_1_1': 0.7121, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8851, 'worst_acc': 0.5779, 'acc_0_0': 0.9756, 'acc_0_1': 0.9774, 'acc_1_0': 0.729, 'acc_1_1': 0.5779, 'mean_acc': 0.9049}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5821, 'acc_0_0': 0.9099, 'acc_0_1': 0.9099, 'acc_1_0': 0.8182, 'acc_1_1': 0.5821, 'mean_acc': 0.8631}
Val(class)(new adapter): {'weighted_mean_acc': 0.8712, 'worst_acc': 0.7682, 'acc_0_0': 0.8419, 'acc_0_1': 0.7682, 'acc_1_0': 0.8955, 'acc_1_1': 0.9848, 'mean_acc': 0.835}
Test(class)(new adapter): {'weighted_mean_acc': 0.8601, 'worst_acc': 0.7796, 'acc_0_0': 0.8435, 'acc_0_1': 0.7796, 'acc_1_0': 0.9019, 'acc_1_1': 0.9268, 'mean_acc': 0.8343}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9399, 'acc_0_1': 0.9227, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.6418, 'acc_0_0': 0.9701, 'acc_0_1': 0.9485, 'acc_1_0': 0.6418, 'acc_1_1': 0.803, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9249, 'worst_acc': 0.6807, 'acc_0_0': 0.984, 'acc_0_1': 0.9561, 'acc_1_0': 0.6807, 'acc_1_1': 0.7368, 'mean_acc': 0.9122}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9528, 'acc_0_1': 0.9528, 'acc_1_0': 0.697, 'acc_1_1': 0.7463, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.8436, 'worst_acc': 0.8248, 'acc_0_0': 0.8248, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.8939, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8235, 'worst_acc': 0.8115, 'acc_0_0': 0.8217, 'acc_0_1': 0.9002, 'acc_1_0': 0.9097, 'acc_1_1': 0.8115, 'mean_acc': 0.8609}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9185, 'acc_0_1': 0.9528, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.9657, 'acc_1_0': 0.5373, 'acc_1_1': 0.7121, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.6059, 'acc_0_0': 0.9885, 'acc_0_1': 0.9685, 'acc_1_0': 0.6589, 'acc_1_1': 0.6059, 'mean_acc': 0.9018}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.7576, 'acc_1_1': 0.8955, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.8358, 'acc_0_0': 0.9188, 'acc_0_1': 0.8541, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.874, 'worst_acc': 0.8396, 'acc_0_0': 0.8843, 'acc_0_1': 0.8754, 'acc_1_0': 0.8801, 'acc_1_1': 0.8396, 'mean_acc': 0.8754}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9528, 'acc_0_0': 0.9528, 'acc_0_1': 0.9871, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7632, 'acc_0_0': 0.9534, 'acc_0_1': 0.9455, 'acc_1_0': 0.8131, 'acc_1_1': 0.7632, 'mean_acc': 0.9137}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9258, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7523, 'acc_0_0': 0.965, 'acc_0_1': 0.9508, 'acc_1_0': 0.7773, 'acc_1_1': 0.7523, 'mean_acc': 0.9151}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7539, 'acc_0_0': 0.9557, 'acc_0_1': 0.9441, 'acc_1_0': 0.7928, 'acc_1_1': 0.7539, 'mean_acc': 0.9108}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7539, 'acc_0_0': 0.949, 'acc_0_1': 0.9432, 'acc_1_0': 0.7975, 'acc_1_1': 0.7539, 'mean_acc': 0.9084}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7461, 'acc_0_0': 0.9525, 'acc_0_1': 0.9441, 'acc_1_0': 0.796, 'acc_1_1': 0.7461, 'mean_acc': 0.909}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7882, 'acc_0_0': 0.9534, 'acc_0_1': 0.9277, 'acc_1_0': 0.7882, 'acc_1_1': 0.7882, 'mean_acc': 0.9068}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7944, 'acc_0_0': 0.9494, 'acc_0_1': 0.9184, 'acc_1_0': 0.7944, 'acc_1_1': 0.8053, 'mean_acc': 0.9042}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.8037, 'acc_0_0': 0.9392, 'acc_0_1': 0.9122, 'acc_1_0': 0.8037, 'acc_1_1': 0.81, 'mean_acc': 0.8994}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.7882, 'acc_0_0': 0.941, 'acc_0_1': 0.9149, 'acc_1_0': 0.8022, 'acc_1_1': 0.7882, 'mean_acc': 0.8985}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7601, 'acc_0_0': 0.9486, 'acc_0_1': 0.9264, 'acc_1_0': 0.7882, 'acc_1_1': 0.7601, 'mean_acc': 0.9013}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7523, 'acc_0_0': 0.9499, 'acc_0_1': 0.9308, 'acc_1_0': 0.7804, 'acc_1_1': 0.7523, 'mean_acc': 0.9018}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9024, 'worst_acc': 0.7679, 'acc_0_0': 0.9437, 'acc_0_1': 0.9228, 'acc_1_0': 0.796, 'acc_1_1': 0.7679, 'mean_acc': 0.8997}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7741, 'acc_0_0': 0.9441, 'acc_0_1': 0.9224, 'acc_1_0': 0.7913, 'acc_1_1': 0.7741, 'mean_acc': 0.8999}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8999, 'worst_acc': 0.7788, 'acc_0_0': 0.937, 'acc_0_1': 0.9171, 'acc_1_0': 0.8069, 'acc_1_1': 0.7788, 'mean_acc': 0.8973}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.757, 'acc_0_0': 0.9539, 'acc_0_1': 0.933, 'acc_1_0': 0.7866, 'acc_1_1': 0.757, 'mean_acc': 0.9054}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7648, 'acc_0_0': 0.9512, 'acc_0_1': 0.9286, 'acc_1_0': 0.7866, 'acc_1_1': 0.7648, 'mean_acc': 0.9035}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7461, 'acc_0_0': 0.9579, 'acc_0_1': 0.9401, 'acc_1_0': 0.7741, 'acc_1_1': 0.7461, 'mean_acc': 0.9071}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7695, 'acc_0_0': 0.9579, 'acc_0_1': 0.929, 'acc_1_0': 0.7757, 'acc_1_1': 0.7695, 'mean_acc': 0.9056}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.6716, 'acc_0_0': 0.9573, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7445, 'acc_0_0': 0.969, 'acc_0_1': 0.9432, 'acc_1_0': 0.7445, 'acc_1_1': 0.7477, 'mean_acc': 0.9096}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9433, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.8584, 'acc_1_0': 0.6866, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9359, 'worst_acc': 0.7492, 'acc_0_0': 0.969, 'acc_0_1': 0.8554, 'acc_1_0': 0.7492, 'acc_1_1': 0.8505, 'mean_acc': 0.8873}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9397, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7492, 'acc_0_0': 0.9659, 'acc_0_1': 0.9326, 'acc_1_0': 0.7492, 'acc_1_1': 0.757, 'mean_acc': 0.9058}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.6716, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.6716, 'acc_1_1': 0.803, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8976, 'worst_acc': 0.662, 'acc_0_0': 0.9681, 'acc_0_1': 0.9596, 'acc_1_0': 0.7399, 'acc_1_1': 0.662, 'mean_acc': 0.9056}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.7227, 'acc_0_0': 0.9596, 'acc_0_1': 0.9459, 'acc_1_0': 0.771, 'acc_1_1': 0.7227, 'mean_acc': 0.9071}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.715, 'acc_0_0': 0.9619, 'acc_0_1': 0.9503, 'acc_1_0': 0.7632, 'acc_1_1': 0.715, 'mean_acc': 0.908}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7383, 'acc_0_0': 0.9592, 'acc_0_1': 0.9424, 'acc_1_0': 0.7679, 'acc_1_1': 0.7383, 'mean_acc': 0.907}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7492, 'acc_0_0': 0.957, 'acc_0_1': 0.9357, 'acc_1_0': 0.7726, 'acc_1_1': 0.7492, 'mean_acc': 0.9052}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7477, 'acc_0_0': 0.9596, 'acc_0_1': 0.9375, 'acc_1_0': 0.7648, 'acc_1_1': 0.7477, 'mean_acc': 0.9059}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7321, 'acc_0_0': 0.961, 'acc_0_1': 0.9459, 'acc_1_0': 0.757, 'acc_1_1': 0.7321, 'mean_acc': 0.9071}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7632, 'acc_0_0': 0.9592, 'acc_0_1': 0.9322, 'acc_1_0': 0.7664, 'acc_1_1': 0.7632, 'mean_acc': 0.9056}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7664, 'acc_0_0': 0.9605, 'acc_0_1': 0.9317, 'acc_1_0': 0.7664, 'acc_1_1': 0.7664, 'mean_acc': 0.9063}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7726, 'acc_0_0': 0.9548, 'acc_0_1': 0.9264, 'acc_1_0': 0.7819, 'acc_1_1': 0.7726, 'mean_acc': 0.9044}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7726, 'acc_0_0': 0.9539, 'acc_0_1': 0.9246, 'acc_1_0': 0.7897, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7664, 'acc_0_0': 0.9548, 'acc_0_1': 0.9299, 'acc_1_0': 0.785, 'acc_1_1': 0.7664, 'mean_acc': 0.9054}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.771, 'acc_0_0': 0.953, 'acc_0_1': 0.9268, 'acc_1_0': 0.7928, 'acc_1_1': 0.771, 'mean_acc': 0.9049}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9302, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7664, 'acc_0_0': 0.9548, 'acc_0_1': 0.9286, 'acc_1_0': 0.7819, 'acc_1_1': 0.7664, 'mean_acc': 0.9046}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7679, 'acc_0_0': 0.957, 'acc_0_1': 0.9259, 'acc_1_0': 0.7804, 'acc_1_1': 0.7679, 'mean_acc': 0.9044}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7664, 'acc_0_0': 0.9534, 'acc_0_1': 0.9268, 'acc_1_0': 0.7882, 'acc_1_1': 0.7664, 'mean_acc': 0.904}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7664, 'acc_0_0': 0.9525, 'acc_0_1': 0.9268, 'acc_1_0': 0.7866, 'acc_1_1': 0.7664, 'mean_acc': 0.9035}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9339, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.9394, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7726, 'acc_0_0': 0.9508, 'acc_0_1': 0.9242, 'acc_1_0': 0.7944, 'acc_1_1': 0.7726, 'mean_acc': 0.9033}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.771, 'acc_0_0': 0.9534, 'acc_0_1': 0.9268, 'acc_1_0': 0.7897, 'acc_1_1': 0.771, 'mean_acc': 0.9047}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7523, 'acc_0_0': 0.9552, 'acc_0_1': 0.933, 'acc_1_0': 0.7819, 'acc_1_1': 0.7523, 'mean_acc': 0.9049}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7586, 'acc_0_0': 0.9543, 'acc_0_1': 0.9313, 'acc_1_0': 0.7866, 'acc_1_1': 0.7586, 'mean_acc': 0.9051}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7648, 'acc_0_0': 0.9557, 'acc_0_1': 0.9286, 'acc_1_0': 0.7788, 'acc_1_1': 0.7648, 'mean_acc': 0.9044}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9367, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.9394, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7788, 'acc_0_0': 0.9517, 'acc_0_1': 0.9215, 'acc_1_0': 0.796, 'acc_1_1': 0.7788, 'mean_acc': 0.9035}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7632, 'acc_0_0': 0.9543, 'acc_0_1': 0.9282, 'acc_1_0': 0.7835, 'acc_1_1': 0.7632, 'mean_acc': 0.904}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9397, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7632, 'acc_0_0': 0.9614, 'acc_0_1': 0.9326, 'acc_1_0': 0.7664, 'acc_1_1': 0.7632, 'mean_acc': 0.9066}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7632, 'acc_0_0': 0.9557, 'acc_0_1': 0.929, 'acc_1_0': 0.7819, 'acc_1_1': 0.7632, 'mean_acc': 0.9047}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7477, 'acc_0_0': 0.961, 'acc_0_1': 0.9384, 'acc_1_0': 0.7679, 'acc_1_1': 0.7477, 'mean_acc': 0.9071}
========================================================================
> end of training. 

best epoch : 52
best training accuracy on [class]: {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.7576, 'acc_1_1': 0.8955, 'mean_acc': 0.9549}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9232, 'worst_acc': 0.8358, 'acc_0_0': 0.9188, 'acc_0_1': 0.8541, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8883}
best test accuracy on [class]: {'weighted_mean_acc': 0.874, 'worst_acc': 0.8396, 'acc_0_0': 0.8843, 'acc_0_1': 0.8754, 'acc_1_0': 0.8801, 'acc_1_1': 0.8396, 'mean_acc': 0.8754}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.874, 'worst_acc': 0.8396, 'acc_0_0': 0.8843, 'acc_0_1': 0.8754, 'acc_1_0': 0.8801, 'acc_1_1': 0.8396, 'mean_acc': 0.8754}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5436, 'acc_0_0': 0.9729, 'acc_0_1': 0.8137, 'acc_1_0': 0.5436, 'acc_1_1': 0.9798, 'mean_acc': 0.8642}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 52': {'Train': {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.7576, 'acc_1_1': 0.8955, 'mean_acc': 0.9549}, 'Val': {'weighted_mean_acc': 0.9232, 'worst_acc': 0.8358, 'acc_0_0': 0.9188, 'acc_0_1': 0.8541, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8883}, 'Test': {'weighted_mean_acc': 0.874, 'worst_acc': 0.8396, 'acc_0_0': 0.8843, 'acc_0_1': 0.8754, 'acc_1_0': 0.8801, 'acc_1_1': 0.8396, 'mean_acc': 0.8754}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.874, 'worst_acc': 0.8396, 'acc_0_0': 0.8843, 'acc_0_1': 0.8754, 'acc_1_0': 0.8801, 'acc_1_1': 0.8396, 'mean_acc': 0.8754}, 'spurious': {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5436, 'acc_0_0': 0.9729, 'acc_0_1': 0.8137, 'acc_1_0': 0.5436, 'acc_1_1': 0.9798, 'mean_acc': 0.8642}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9231, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.6433, 'mean_acc': 0.8375}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.1588, 'acc_0_0': 0.9786, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6317}
Test(class): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.1512, 'acc_0_0': 0.9641, 'acc_0_1': 0.1512, 'acc_1_0': 0.6916, 'acc_1_1': 0.9798, 'mean_acc': 0.6193}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9974, 'acc_0_1': 0.587, 'acc_1_0': 0.4286, 'acc_1_1': 0.9101, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.3476, 'acc_0_0': 0.9957, 'acc_0_1': 0.3476, 'acc_1_0': 0.597, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.3228, 'acc_0_0': 0.9796, 'acc_0_1': 0.3228, 'acc_1_0': 0.6121, 'acc_1_1': 0.9642, 'mean_acc': 0.6816}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4837, 'acc_0_0': 0.9857, 'acc_0_1': 0.4837, 'acc_1_0': 0.6607, 'acc_1_1': 0.9763, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.4592, 'acc_0_0': 0.9872, 'acc_0_1': 0.4592, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.4288, 'acc_0_0': 0.9712, 'acc_0_1': 0.4288, 'acc_1_0': 0.7118, 'acc_1_1': 0.9626, 'mean_acc': 0.7304}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9883, 'acc_0_1': 0.7011, 'acc_1_0': 0.6607, 'acc_1_1': 0.9177, 'mean_acc': 0.9579}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6215, 'acc_0_0': 0.984, 'acc_0_1': 0.6568, 'acc_1_0': 0.6215, 'acc_1_1': 0.9346, 'mean_acc': 0.811}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5652, 'acc_0_0': 0.9877, 'acc_0_1': 0.5652, 'acc_1_0': 0.6964, 'acc_1_1': 0.9697, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.533, 'acc_0_0': 0.9858, 'acc_0_1': 0.533, 'acc_1_0': 0.6199, 'acc_1_1': 0.9533, 'mean_acc': 0.7654}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9957, 'acc_0_1': 0.6739, 'acc_1_0': 0.6429, 'acc_1_1': 0.9584, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5888, 'acc_0_0': 0.9894, 'acc_0_1': 0.6186, 'acc_1_0': 0.5888, 'acc_1_1': 0.9424, 'mean_acc': 0.7955}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9934, 'acc_0_1': 0.6467, 'acc_1_0': 0.6607, 'acc_1_1': 0.9697, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9659, 'worst_acc': 0.5622, 'acc_0_0': 0.9915, 'acc_0_1': 0.5622, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5605, 'acc_0_0': 0.9871, 'acc_0_1': 0.5605, 'acc_1_0': 0.6246, 'acc_1_1': 0.9502, 'mean_acc': 0.7768}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9951, 'acc_0_1': 0.7228, 'acc_1_0': 0.6964, 'acc_1_1': 0.9622, 'mean_acc': 0.9739}
Val(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.6399, 'acc_1_0': 0.6137, 'acc_1_1': 0.9408, 'mean_acc': 0.8058}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9954, 'acc_0_1': 0.7228, 'acc_1_0': 0.7321, 'acc_1_1': 0.9697, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6059, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6059, 'acc_1_1': 0.9393, 'mean_acc': 0.8084}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9951, 'acc_0_1': 0.7011, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.609, 'acc_0_0': 0.9902, 'acc_0_1': 0.6678, 'acc_1_0': 0.609, 'acc_1_1': 0.9377, 'mean_acc': 0.8167}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.7554, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6246, 'acc_1_1': 0.9424, 'mean_acc': 0.8133}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9949, 'acc_0_1': 0.712, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6639, 'acc_1_0': 0.6153, 'acc_1_1': 0.9408, 'mean_acc': 0.8155}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.7663, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6012, 'acc_0_0': 0.988, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9346, 'mean_acc': 0.8208}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9969, 'acc_0_1': 0.7446, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6106, 'acc_0_0': 0.9889, 'acc_0_1': 0.6776, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8202}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.998, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6776, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8203}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9971, 'acc_0_1': 0.7826, 'acc_1_0': 0.8036, 'acc_1_1': 0.9782, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6012, 'acc_0_0': 0.9894, 'acc_0_1': 0.7073, 'acc_1_0': 0.6012, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8315, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6433, 'acc_0_0': 0.9876, 'acc_0_1': 0.6763, 'acc_1_0': 0.6433, 'acc_1_1': 0.9393, 'mean_acc': 0.8229}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8587, 'acc_1_0': 0.8036, 'acc_1_1': 0.965, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6749, 'acc_1_0': 0.634, 'acc_1_1': 0.9439, 'mean_acc': 0.8217}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9957, 'acc_0_1': 0.7446, 'acc_1_0': 0.875, 'acc_1_1': 0.982, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.662, 'acc_0_0': 0.9863, 'acc_0_1': 0.6683, 'acc_1_0': 0.662, 'acc_1_1': 0.9455, 'mean_acc': 0.8221}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.9022, 'acc_1_0': 0.8393, 'acc_1_1': 0.9745, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.6371, 'acc_1_1': 0.9424, 'mean_acc': 0.8246}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6215, 'acc_0_0': 0.988, 'acc_0_1': 0.7073, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9991, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6075, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6075, 'acc_1_1': 0.9393, 'mean_acc': 0.8269}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9989, 'acc_0_1': 0.8641, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6293, 'acc_0_0': 0.9871, 'acc_0_1': 0.6976, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8295}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9701, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6568, 'acc_1_0': 0.6371, 'acc_1_1': 0.9502, 'mean_acc': 0.816}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5919, 'acc_0_0': 0.9916, 'acc_0_1': 0.7676, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8533}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9565, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.995}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.6223, 'acc_0_0': 0.9872, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6284, 'acc_0_0': 0.9858, 'acc_0_1': 0.6284, 'acc_1_0': 0.6713, 'acc_1_1': 0.9517, 'mean_acc': 0.8081}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9565, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9682, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6324, 'acc_0_0': 0.9898, 'acc_0_1': 0.7184, 'acc_1_0': 0.6324, 'acc_1_1': 0.9361, 'mean_acc': 0.8386}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9565, 'acc_0_0': 1.0, 'acc_0_1': 0.9565, 'acc_1_0': 0.9643, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.6059, 'acc_0_0': 0.9911, 'acc_0_1': 0.6971, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.8288}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9674, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.634, 'acc_0_0': 0.9876, 'acc_0_1': 0.6736, 'acc_1_0': 0.634, 'acc_1_1': 0.9486, 'mean_acc': 0.8219}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9643, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.7069, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8338}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.6475, 'acc_1_0': 0.6153, 'acc_1_1': 0.9486, 'mean_acc': 0.8103}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6293, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6293, 'acc_1_1': 0.9408, 'mean_acc': 0.8295}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9979}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6277, 'acc_0_0': 0.9894, 'acc_0_1': 0.7392, 'acc_1_0': 0.6277, 'acc_1_1': 0.9361, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.6967, 'acc_1_0': 0.6044, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7468, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5935, 'acc_0_0': 0.9907, 'acc_0_1': 0.7512, 'acc_1_0': 0.5935, 'acc_1_1': 0.9346, 'mean_acc': 0.8473}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6976, 'acc_1_0': 0.6464, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7029, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8315}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6215, 'acc_0_0': 0.9907, 'acc_0_1': 0.7118, 'acc_1_0': 0.6215, 'acc_1_1': 0.9408, 'mean_acc': 0.8357}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6277, 'acc_0_0': 0.9898, 'acc_0_1': 0.7171, 'acc_1_0': 0.6277, 'acc_1_1': 0.9408, 'mean_acc': 0.8381}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6293, 'acc_0_0': 0.9902, 'acc_0_1': 0.6922, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.829}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9914, 'acc_0_1': 0.8584, 'acc_1_0': 0.5455, 'acc_1_1': 0.7612, 'mean_acc': 0.8648}
Val(class)(new adapter): {'weighted_mean_acc': 0.938, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.9399, 'acc_1_0': 0.6567, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.6854, 'acc_0_0': 0.9885, 'acc_0_1': 0.9384, 'acc_1_0': 0.6854, 'acc_1_1': 0.7741, 'mean_acc': 0.9116}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3485, 'acc_0_0': 0.8884, 'acc_0_1': 0.7468, 'acc_1_0': 0.3485, 'acc_1_1': 0.8209, 'mean_acc': 0.7663}
Val(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.2747, 'acc_0_0': 0.9487, 'acc_0_1': 0.2747, 'acc_1_0': 0.7761, 'acc_1_1': 1.0, 'mean_acc': 0.6733}
Test(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.2763, 'acc_0_0': 0.9601, 'acc_0_1': 0.2763, 'acc_1_0': 0.7882, 'acc_1_1': 0.9813, 'mean_acc': 0.6773}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9571, 'acc_0_1': 0.867, 'acc_1_0': 0.7576, 'acc_1_1': 0.6866, 'mean_acc': 0.8698}
Val(class)(new adapter): {'weighted_mean_acc': 0.7931, 'worst_acc': 0.4697, 'acc_0_0': 0.8803, 'acc_0_1': 0.9657, 'acc_1_0': 0.8806, 'acc_1_1': 0.4697, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.7872, 'worst_acc': 0.4206, 'acc_0_0': 0.8869, 'acc_0_1': 0.9676, 'acc_1_0': 0.8879, 'acc_1_1': 0.4206, 'mean_acc': 0.8668}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.8841, 'acc_0_1': 0.9099, 'acc_1_0': 0.8939, 'acc_1_1': 0.403, 'mean_acc': 0.8414}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.6266, 'acc_0_0': 0.9145, 'acc_0_1': 0.6266, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.5938, 'acc_0_0': 0.9011, 'acc_0_1': 0.5938, 'acc_1_0': 0.8785, 'acc_1_1': 0.9579, 'mean_acc': 0.7853}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9914, 'acc_0_1': 0.8712, 'acc_1_0': 0.7727, 'acc_1_1': 0.9403, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.8546, 'worst_acc': 0.5303, 'acc_0_0': 0.9487, 'acc_0_1': 0.9828, 'acc_1_0': 0.6716, 'acc_1_1': 0.5303, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8539, 'worst_acc': 0.4268, 'acc_0_0': 0.9778, 'acc_0_1': 0.9894, 'acc_1_0': 0.7259, 'acc_1_1': 0.4268, 'mean_acc': 0.8933}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.867, 'acc_0_1': 0.9871, 'acc_1_0': 0.803, 'acc_1_1': 0.403, 'mean_acc': 0.8548}
Val(class)(new adapter): {'weighted_mean_acc': 0.8978, 'worst_acc': 0.7468, 'acc_0_0': 0.8889, 'acc_0_1': 0.7468, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7206, 'acc_0_0': 0.8896, 'acc_0_1': 0.7206, 'acc_1_0': 0.8879, 'acc_1_1': 0.9439, 'mean_acc': 0.8297}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.897, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.9442, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9392, 'worst_acc': 0.6417, 'acc_0_0': 0.9929, 'acc_0_1': 0.9388, 'acc_1_0': 0.6417, 'acc_1_1': 0.7773, 'mean_acc': 0.909}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4179, 'acc_0_0': 0.8369, 'acc_0_1': 0.8884, 'acc_1_0': 0.6364, 'acc_1_1': 0.4179, 'mean_acc': 0.788}
Val(class)(new adapter): {'weighted_mean_acc': 0.8794, 'worst_acc': 0.8197, 'acc_0_0': 0.8547, 'acc_0_1': 0.8197, 'acc_1_0': 0.9104, 'acc_1_1': 0.9697, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8448, 'worst_acc': 0.8195, 'acc_0_0': 0.8217, 'acc_0_1': 0.8195, 'acc_1_0': 0.9128, 'acc_1_1': 0.9221, 'mean_acc': 0.8421}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9442, 'acc_0_1': 0.9571, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.937, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9342, 'worst_acc': 0.7788, 'acc_0_0': 0.9778, 'acc_0_1': 0.9375, 'acc_1_0': 0.7788, 'acc_1_1': 0.7975, 'mean_acc': 0.9201}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9742, 'acc_0_1': 0.9571, 'acc_1_0': 0.6061, 'acc_1_1': 0.8507, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7975, 'acc_0_0': 0.9486, 'acc_0_1': 0.9388, 'acc_1_0': 0.8427, 'acc_1_1': 0.7975, 'mean_acc': 0.9163}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9442, 'acc_0_0': 0.9442, 'acc_0_1': 0.97, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7586, 'acc_0_0': 0.9601, 'acc_0_1': 0.961, 'acc_1_0': 0.8069, 'acc_1_1': 0.7586, 'mean_acc': 0.9211}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7879, 'acc_0_0': 0.9402, 'acc_0_1': 0.9614, 'acc_1_0': 0.806, 'acc_1_1': 0.7879, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7305, 'acc_0_0': 0.957, 'acc_0_1': 0.9645, 'acc_1_0': 0.8146, 'acc_1_1': 0.7305, 'mean_acc': 0.9191}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7804, 'acc_0_0': 0.9663, 'acc_0_1': 0.9375, 'acc_1_0': 0.8006, 'acc_1_1': 0.7804, 'mean_acc': 0.9161}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.8006, 'acc_0_0': 0.9614, 'acc_0_1': 0.9237, 'acc_1_0': 0.8115, 'acc_1_1': 0.8006, 'mean_acc': 0.9123}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7913, 'acc_0_0': 0.9588, 'acc_0_1': 0.9295, 'acc_1_0': 0.7913, 'acc_1_1': 0.7928, 'mean_acc': 0.9104}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.8006, 'acc_0_0': 0.9557, 'acc_0_1': 0.9246, 'acc_1_0': 0.8006, 'acc_1_1': 0.8084, 'mean_acc': 0.9101}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7928, 'acc_0_0': 0.9565, 'acc_0_1': 0.929, 'acc_1_0': 0.7928, 'acc_1_1': 0.796, 'mean_acc': 0.9099}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7975, 'acc_0_0': 0.9557, 'acc_0_1': 0.9242, 'acc_1_0': 0.7975, 'acc_1_1': 0.8053, 'mean_acc': 0.9092}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.8022, 'acc_0_0': 0.9543, 'acc_0_1': 0.9233, 'acc_1_0': 0.8022, 'acc_1_1': 0.8022, 'mean_acc': 0.9085}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.8037, 'acc_0_0': 0.9512, 'acc_0_1': 0.9171, 'acc_1_0': 0.8037, 'acc_1_1': 0.81, 'mean_acc': 0.9059}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.7975, 'acc_0_0': 0.9557, 'acc_0_1': 0.9286, 'acc_1_0': 0.7975, 'acc_1_1': 0.8037, 'mean_acc': 0.9108}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.796, 'acc_0_0': 0.9552, 'acc_0_1': 0.9242, 'acc_1_0': 0.796, 'acc_1_1': 0.8069, 'mean_acc': 0.909}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7897, 'acc_0_0': 0.9539, 'acc_0_1': 0.9228, 'acc_1_0': 0.7897, 'acc_1_1': 0.8131, 'mean_acc': 0.908}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.785, 'acc_0_0': 0.9517, 'acc_0_1': 0.9242, 'acc_1_0': 0.785, 'acc_1_1': 0.7991, 'mean_acc': 0.9056}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7726, 'acc_0_0': 0.9583, 'acc_0_1': 0.9326, 'acc_1_0': 0.7726, 'acc_1_1': 0.7897, 'mean_acc': 0.909}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7897, 'acc_0_0': 0.9539, 'acc_0_1': 0.9246, 'acc_1_0': 0.7897, 'acc_1_1': 0.7975, 'mean_acc': 0.907}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7835, 'acc_0_0': 0.9552, 'acc_0_1': 0.9339, 'acc_1_0': 0.7944, 'acc_1_1': 0.7835, 'mean_acc': 0.9101}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.8162, 'acc_0_0': 0.9446, 'acc_0_1': 0.8989, 'acc_1_0': 0.8162, 'acc_1_1': 0.8271, 'mean_acc': 0.8996}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.7879, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.715, 'acc_0_0': 0.9632, 'acc_0_1': 0.9659, 'acc_1_0': 0.757, 'acc_1_1': 0.715, 'mean_acc': 0.9139}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.8069, 'acc_0_0': 0.9472, 'acc_0_1': 0.9135, 'acc_1_0': 0.8069, 'acc_1_1': 0.81, 'mean_acc': 0.9033}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.8162, 'acc_0_0': 0.9446, 'acc_0_1': 0.9038, 'acc_1_0': 0.8162, 'acc_1_1': 0.8302, 'mean_acc': 0.9018}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8146, 'acc_0_0': 0.9304, 'acc_0_1': 0.9073, 'acc_1_0': 0.8396, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9276, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.785, 'acc_0_0': 0.9379, 'acc_0_1': 0.9282, 'acc_1_0': 0.8193, 'acc_1_1': 0.785, 'mean_acc': 0.904}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9394, 'worst_acc': 0.7015, 'acc_0_0': 0.9615, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7399, 'acc_0_0': 0.9738, 'acc_0_1': 0.9499, 'acc_1_0': 0.7492, 'acc_1_1': 0.7399, 'mean_acc': 0.9137}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9363, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7617, 'acc_0_0': 0.9694, 'acc_0_1': 0.9428, 'acc_1_0': 0.7617, 'acc_1_1': 0.7632, 'mean_acc': 0.9132}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.933, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7726, 'acc_0_0': 0.9654, 'acc_0_1': 0.9392, 'acc_1_0': 0.7726, 'acc_1_1': 0.7726, 'mean_acc': 0.9125}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7804, 'acc_0_0': 0.9605, 'acc_0_1': 0.9326, 'acc_1_0': 0.7866, 'acc_1_1': 0.7804, 'mean_acc': 0.9104}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7819, 'acc_0_0': 0.9592, 'acc_0_1': 0.9353, 'acc_1_0': 0.785, 'acc_1_1': 0.7819, 'mean_acc': 0.9109}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7819, 'acc_0_0': 0.9565, 'acc_0_1': 0.9339, 'acc_1_0': 0.7944, 'acc_1_1': 0.7819, 'mean_acc': 0.9104}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7835, 'acc_0_0': 0.9508, 'acc_0_1': 0.9326, 'acc_1_0': 0.7975, 'acc_1_1': 0.7835, 'mean_acc': 0.9082}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7788, 'acc_0_0': 0.9548, 'acc_0_1': 0.9335, 'acc_1_0': 0.7928, 'acc_1_1': 0.7788, 'mean_acc': 0.909}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9336, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7819, 'acc_0_0': 0.9565, 'acc_0_1': 0.9353, 'acc_1_0': 0.7913, 'acc_1_1': 0.7819, 'mean_acc': 0.9106}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7586, 'acc_0_0': 0.9601, 'acc_0_1': 0.9455, 'acc_1_0': 0.7741, 'acc_1_1': 0.7586, 'mean_acc': 0.9115}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7819, 'acc_0_0': 0.9468, 'acc_0_1': 0.9326, 'acc_1_0': 0.7991, 'acc_1_1': 0.7819, 'mean_acc': 0.9066}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7913, 'acc_0_0': 0.9401, 'acc_0_1': 0.922, 'acc_1_0': 0.81, 'acc_1_1': 0.7913, 'mean_acc': 0.9021}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.7773, 'acc_0_0': 0.9419, 'acc_0_1': 0.933, 'acc_1_0': 0.8037, 'acc_1_1': 0.7773, 'mean_acc': 0.9049}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7773, 'acc_0_0': 0.9392, 'acc_0_1': 0.9322, 'acc_1_0': 0.81, 'acc_1_1': 0.7773, 'mean_acc': 0.9042}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7741, 'acc_0_0': 0.9419, 'acc_0_1': 0.9335, 'acc_1_0': 0.8037, 'acc_1_1': 0.7741, 'mean_acc': 0.9047}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7741, 'acc_0_0': 0.9432, 'acc_0_1': 0.9357, 'acc_1_0': 0.8037, 'acc_1_1': 0.7741, 'mean_acc': 0.9061}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.7664, 'acc_0_0': 0.945, 'acc_0_1': 0.9392, 'acc_1_0': 0.7991, 'acc_1_1': 0.7664, 'mean_acc': 0.9068}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7695, 'acc_0_0': 0.9441, 'acc_0_1': 0.9357, 'acc_1_0': 0.8006, 'acc_1_1': 0.7695, 'mean_acc': 0.9056}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7757, 'acc_0_0': 0.9428, 'acc_0_1': 0.9308, 'acc_1_0': 0.81, 'acc_1_1': 0.7757, 'mean_acc': 0.9049}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.7664, 'acc_0_0': 0.949, 'acc_0_1': 0.941, 'acc_1_0': 0.7882, 'acc_1_1': 0.7664, 'mean_acc': 0.9078}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7508, 'acc_0_0': 0.9534, 'acc_0_1': 0.945, 'acc_1_0': 0.7866, 'acc_1_1': 0.7508, 'mean_acc': 0.9092}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.7726, 'acc_0_0': 0.9468, 'acc_0_1': 0.9366, 'acc_1_0': 0.7913, 'acc_1_1': 0.7726, 'mean_acc': 0.9063}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7664, 'acc_0_0': 0.9463, 'acc_0_1': 0.9392, 'acc_1_0': 0.7913, 'acc_1_1': 0.7664, 'mean_acc': 0.9065}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.7726, 'acc_0_0': 0.9468, 'acc_0_1': 0.9357, 'acc_1_0': 0.7944, 'acc_1_1': 0.7726, 'mean_acc': 0.9063}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7601, 'acc_0_0': 0.9468, 'acc_0_1': 0.941, 'acc_1_0': 0.7913, 'acc_1_1': 0.7601, 'mean_acc': 0.9066}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7726, 'acc_0_0': 0.9477, 'acc_0_1': 0.9353, 'acc_1_0': 0.7944, 'acc_1_1': 0.7726, 'mean_acc': 0.9065}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7679, 'acc_0_0': 0.9463, 'acc_0_1': 0.9375, 'acc_1_0': 0.7928, 'acc_1_1': 0.7679, 'mean_acc': 0.9061}
========================================================================
> end of training. 

best epoch : 72
best training accuracy on [class]: {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}
best test accuracy on [class]: {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8146, 'acc_0_0': 0.9304, 'acc_0_1': 0.9073, 'acc_1_0': 0.8396, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8146, 'acc_0_0': 0.9304, 'acc_0_1': 0.9073, 'acc_1_0': 0.8396, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6994, 'acc_0_0': 0.9583, 'acc_0_1': 0.9149, 'acc_1_0': 0.6994, 'acc_1_1': 0.9798, 'mean_acc': 0.9151}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 72': {'Train': {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}, 'Val': {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}, 'Test': {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8146, 'acc_0_0': 0.9304, 'acc_0_1': 0.9073, 'acc_1_0': 0.8396, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9029, 'worst_acc': 0.8146, 'acc_0_0': 0.9304, 'acc_0_1': 0.9073, 'acc_1_0': 0.8396, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}, 'spurious': {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6994, 'acc_0_0': 0.9583, 'acc_0_1': 0.9149, 'acc_1_0': 0.6994, 'acc_1_1': 0.9798, 'mean_acc': 0.9151}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3859, 'acc_0_0': 0.9483, 'acc_0_1': 0.3859, 'acc_1_0': 0.4286, 'acc_1_1': 0.7739, 'mean_acc': 0.8822}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.3433, 'acc_0_0': 0.9957, 'acc_0_1': 0.4592, 'acc_1_0': 0.3433, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9539, 'worst_acc': 0.2804, 'acc_0_0': 0.9982, 'acc_0_1': 0.4182, 'acc_1_0': 0.2804, 'acc_1_1': 0.9361, 'mean_acc': 0.6861}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9883, 'acc_0_1': 0.4946, 'acc_1_0': 0.4286, 'acc_1_1': 0.9413, 'mean_acc': 0.9525}
Val(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.2661, 'acc_0_0': 0.9573, 'acc_0_1': 0.2661, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.6683}
Test(class): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.2213, 'acc_0_0': 0.9503, 'acc_0_1': 0.2213, 'acc_1_0': 0.7523, 'acc_1_1': 0.9798, 'mean_acc': 0.6479}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9886, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.8855, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5751, 'acc_0_0': 0.9872, 'acc_0_1': 0.5751, 'acc_1_0': 0.7164, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.5357, 'acc_0_0': 0.9756, 'acc_0_1': 0.5357, 'acc_1_0': 0.6947, 'acc_1_1': 0.9455, 'mean_acc': 0.7699}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9823, 'acc_0_1': 0.6957, 'acc_1_0': 0.6607, 'acc_1_1': 0.9413, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5075, 'acc_0_0': 0.9957, 'acc_0_1': 0.7639, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.5312, 'acc_0_0': 0.9956, 'acc_0_1': 0.7388, 'acc_1_0': 0.5312, 'acc_1_1': 0.9065, 'mean_acc': 0.8343}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.663, 'acc_1_0': 0.5893, 'acc_1_1': 0.9442, 'mean_acc': 0.9658}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.7833}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5743, 'acc_0_0': 0.9929, 'acc_0_1': 0.5743, 'acc_1_0': 0.5763, 'acc_1_1': 0.9455, 'mean_acc': 0.7786}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9949, 'acc_0_1': 0.6739, 'acc_1_0': 0.5536, 'acc_1_1': 0.9461, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5639, 'acc_0_0': 0.9938, 'acc_0_1': 0.6142, 'acc_1_0': 0.5639, 'acc_1_1': 0.9361, 'mean_acc': 0.792}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.6522, 'acc_1_0': 0.5893, 'acc_1_1': 0.9574, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.5779, 'acc_0_0': 0.9933, 'acc_0_1': 0.6217, 'acc_1_0': 0.5779, 'acc_1_1': 0.9408, 'mean_acc': 0.7969}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9963, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9451, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6438, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6059, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.7994}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9949, 'acc_0_1': 0.7446, 'acc_1_0': 0.625, 'acc_1_1': 0.9499, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6031, 'acc_0_0': 0.9916, 'acc_0_1': 0.6031, 'acc_1_0': 0.6184, 'acc_1_1': 0.9486, 'mean_acc': 0.7943}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9546, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5826, 'acc_0_0': 0.9938, 'acc_0_1': 0.6545, 'acc_1_0': 0.5826, 'acc_1_1': 0.9393, 'mean_acc': 0.8101}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9951, 'acc_0_1': 0.7446, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5483, 'acc_0_0': 0.9956, 'acc_0_1': 0.7268, 'acc_1_0': 0.5483, 'acc_1_1': 0.9283, 'mean_acc': 0.834}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.996, 'acc_0_1': 0.75, 'acc_1_0': 0.6429, 'acc_1_1': 0.9555, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5654, 'acc_0_0': 0.9942, 'acc_0_1': 0.6927, 'acc_1_0': 0.5654, 'acc_1_1': 0.9377, 'mean_acc': 0.8231}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.6896, 'acc_1_0': 0.5794, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.7826, 'acc_1_0': 0.6786, 'acc_1_1': 0.9697, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5075, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.567, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.567, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9977, 'acc_0_1': 0.7989, 'acc_1_0': 0.6786, 'acc_1_1': 0.964, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6004, 'acc_0_0': 0.9894, 'acc_0_1': 0.6004, 'acc_1_0': 0.6153, 'acc_1_1': 0.9455, 'mean_acc': 0.7917}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7854, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5607, 'acc_0_0': 0.9942, 'acc_0_1': 0.761, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8483}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9966, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7086, 'acc_1_0': 0.5654, 'acc_1_1': 0.9346, 'mean_acc': 0.8288}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9991, 'acc_0_1': 0.8859, 'acc_1_0': 0.7679, 'acc_1_1': 0.9584, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6075, 'acc_0_0': 0.9925, 'acc_0_1': 0.6177, 'acc_1_0': 0.6075, 'acc_1_1': 0.947, 'mean_acc': 0.7989}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.983, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9942, 'acc_0_1': 0.7933, 'acc_1_0': 0.5545, 'acc_1_1': 0.919, 'mean_acc': 0.859}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.8214, 'acc_1_1': 0.983, 'mean_acc': 0.9881}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7682, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5654, 'acc_1_1': 0.9206, 'mean_acc': 0.8533}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.8967, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7425, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6044, 'acc_0_0': 0.9911, 'acc_0_1': 0.733, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8416}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.8929, 'acc_1_1': 0.9763, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6119, 'acc_0_0': 0.9786, 'acc_0_1': 0.6395, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5981, 'acc_0_0': 0.9925, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9502, 'mean_acc': 0.8098}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9896, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7983, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5748, 'acc_0_0': 0.9938, 'acc_0_1': 0.8231, 'acc_1_0': 0.5748, 'acc_1_1': 0.9065, 'mean_acc': 0.8712}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.9076, 'acc_1_0': 0.8571, 'acc_1_1': 0.9886, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.6867, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6106, 'acc_0_0': 0.9894, 'acc_0_1': 0.6927, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9868, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6215, 'acc_0_0': 0.9894, 'acc_0_1': 0.7282, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.841}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9989, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9962, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.7548, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8485}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9185, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6215, 'acc_0_0': 0.9876, 'acc_0_1': 0.7042, 'acc_1_0': 0.6215, 'acc_1_1': 0.9377, 'mean_acc': 0.8312}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7255, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8397}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9107, 'acc_1_1': 0.9953, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9732, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.5623, 'acc_0_0': 0.9956, 'acc_0_1': 0.7437, 'acc_1_0': 0.5623, 'acc_1_1': 0.9268, 'mean_acc': 0.8419}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.9022, 'acc_1_0': 0.8929, 'acc_1_1': 0.9915, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6355, 'acc_0_0': 0.9854, 'acc_0_1': 0.745, 'acc_1_0': 0.6355, 'acc_1_1': 0.919, 'mean_acc': 0.8457}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9956}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.6269, 'acc_0_0': 0.9744, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6573, 'acc_0_0': 0.9867, 'acc_0_1': 0.6962, 'acc_1_0': 0.6573, 'acc_1_1': 0.9361, 'mean_acc': 0.8315}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.9286, 'acc_1_1': 0.9905, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6781, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6324, 'acc_0_0': 0.9867, 'acc_0_1': 0.6914, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.8272}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9674, 'acc_1_0': 0.9464, 'acc_1_1': 0.9943, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.721, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6199, 'acc_0_0': 0.9925, 'acc_0_1': 0.7499, 'acc_1_0': 0.6199, 'acc_1_1': 0.9252, 'mean_acc': 0.8493}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9286, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5966, 'acc_0_0': 0.9744, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.5863, 'acc_0_0': 0.9778, 'acc_0_1': 0.5863, 'acc_1_0': 0.6636, 'acc_1_1': 0.9517, 'mean_acc': 0.7877}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.7752, 'acc_1_0': 0.609, 'acc_1_1': 0.9206, 'mean_acc': 0.8567}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6542, 'acc_0_0': 0.9836, 'acc_0_1': 0.6625, 'acc_1_0': 0.6542, 'acc_1_1': 0.9439, 'mean_acc': 0.8177}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9981, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5623, 'acc_0_0': 0.9969, 'acc_0_1': 0.8284, 'acc_1_0': 0.5623, 'acc_1_1': 0.905, 'mean_acc': 0.873}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6352, 'acc_0_0': 0.9829, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.6381, 'acc_0_0': 0.9796, 'acc_0_1': 0.6381, 'acc_1_0': 0.6573, 'acc_1_1': 0.9533, 'mean_acc': 0.8081}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.7344, 'acc_1_0': 0.6277, 'acc_1_1': 0.9299, 'mean_acc': 0.8426}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6542, 'acc_0_0': 0.9858, 'acc_0_1': 0.7007, 'acc_1_0': 0.6542, 'acc_1_1': 0.9408, 'mean_acc': 0.8331}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9785, 'acc_0_1': 0.8755, 'acc_1_0': 0.5455, 'acc_1_1': 0.8507, 'mean_acc': 0.8765}
Val(class)(new adapter): {'weighted_mean_acc': 0.9353, 'worst_acc': 0.7612, 'acc_0_0': 0.9615, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.785, 'acc_0_0': 0.9765, 'acc_0_1': 0.9082, 'acc_1_0': 0.785, 'acc_1_1': 0.8178, 'mean_acc': 0.9111}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3182, 'acc_0_0': 0.8841, 'acc_0_1': 0.7253, 'acc_1_0': 0.3182, 'acc_1_1': 0.8209, 'mean_acc': 0.7529}
Val(class)(new adapter): {'weighted_mean_acc': 0.9466, 'worst_acc': 0.4206, 'acc_0_0': 0.9615, 'acc_0_1': 0.4206, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.73}
Test(class)(new adapter): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.3933, 'acc_0_0': 0.9761, 'acc_0_1': 0.3933, 'acc_1_0': 0.7477, 'acc_1_1': 0.9782, 'mean_acc': 0.7242}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9657, 'acc_0_1': 0.8498, 'acc_1_0': 0.6061, 'acc_1_1': 0.6716, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.8083, 'worst_acc': 0.7121, 'acc_0_0': 0.8291, 'acc_0_1': 0.9313, 'acc_1_0': 0.9254, 'acc_1_1': 0.7121, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.7672, 'worst_acc': 0.6075, 'acc_0_0': 0.804, 'acc_0_1': 0.9361, 'acc_1_0': 0.9252, 'acc_1_1': 0.6075, 'mean_acc': 0.8471}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5224, 'acc_0_0': 0.8627, 'acc_0_1': 0.927, 'acc_1_0': 0.8333, 'acc_1_1': 0.5224, 'mean_acc': 0.8464}
Val(class)(new adapter): {'weighted_mean_acc': 0.888, 'worst_acc': 0.5708, 'acc_0_0': 0.8803, 'acc_0_1': 0.5708, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.5548, 'acc_0_0': 0.9144, 'acc_0_1': 0.5548, 'acc_1_0': 0.8707, 'acc_1_1': 0.9564, 'mean_acc': 0.7742}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9828, 'acc_0_1': 0.8884, 'acc_1_0': 0.7273, 'acc_1_1': 0.8209, 'mean_acc': 0.8998}
Val(class)(new adapter): {'weighted_mean_acc': 0.8017, 'worst_acc': 0.5606, 'acc_0_0': 0.8675, 'acc_0_1': 0.9742, 'acc_1_0': 0.6716, 'acc_1_1': 0.5606, 'mean_acc': 0.8533}
Test(class)(new adapter): {'weighted_mean_acc': 0.8111, 'worst_acc': 0.4657, 'acc_0_0': 0.9064, 'acc_0_1': 0.9858, 'acc_1_0': 0.7975, 'acc_1_1': 0.4657, 'mean_acc': 0.8764}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.597, 'acc_0_0': 0.8712, 'acc_0_1': 0.9356, 'acc_1_0': 0.9545, 'acc_1_1': 0.597, 'mean_acc': 0.8748}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.6223, 'acc_0_0': 0.9359, 'acc_0_1': 0.6223, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.805}
Test(class)(new adapter): {'weighted_mean_acc': 0.9373, 'worst_acc': 0.6328, 'acc_0_0': 0.9503, 'acc_0_1': 0.6328, 'acc_1_0': 0.852, 'acc_1_1': 0.9517, 'mean_acc': 0.816}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9871, 'acc_0_1': 0.897, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7601, 'acc_0_0': 0.9774, 'acc_0_1': 0.9468, 'acc_1_0': 0.7819, 'acc_1_1': 0.7601, 'mean_acc': 0.9197}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.7879, 'acc_1_1': 0.6418, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.8852, 'worst_acc': 0.8507, 'acc_0_0': 0.8761, 'acc_0_1': 0.9313, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.87, 'worst_acc': 0.8131, 'acc_0_0': 0.8838, 'acc_0_1': 0.9268, 'acc_1_0': 0.8956, 'acc_1_1': 0.8131, 'mean_acc': 0.894}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.927, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.5224, 'acc_0_0': 0.9872, 'acc_0_1': 0.97, 'acc_1_0': 0.5224, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.5623, 'acc_0_0': 0.9951, 'acc_0_1': 0.9747, 'acc_1_0': 0.5623, 'acc_1_1': 0.7383, 'mean_acc': 0.9108}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9828, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.9254, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.94, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9251, 'worst_acc': 0.7928, 'acc_0_0': 0.9557, 'acc_0_1': 0.9295, 'acc_1_0': 0.7928, 'acc_1_1': 0.8302, 'mean_acc': 0.9135}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.893, 'worst_acc': 0.8209, 'acc_0_0': 0.8889, 'acc_0_1': 0.9013, 'acc_1_0': 0.8209, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8727, 'worst_acc': 0.8022, 'acc_0_0': 0.8914, 'acc_0_1': 0.929, 'acc_1_0': 0.8567, 'acc_1_1': 0.8022, 'mean_acc': 0.8923}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9104, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.94, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.7352, 'acc_0_0': 0.9756, 'acc_0_1': 0.9264, 'acc_1_0': 0.7352, 'acc_1_1': 0.8022, 'mean_acc': 0.9106}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.838, 'acc_0_0': 0.9326, 'acc_0_1': 0.8989, 'acc_1_0': 0.8396, 'acc_1_1': 0.838, 'mean_acc': 0.8987}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.9242, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9388, 'worst_acc': 0.7445, 'acc_0_0': 0.9725, 'acc_0_1': 0.9184, 'acc_1_0': 0.7445, 'acc_1_1': 0.8411, 'mean_acc': 0.9116}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9307, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.7196, 'acc_0_0': 0.9756, 'acc_0_1': 0.9432, 'acc_1_0': 0.7196, 'acc_1_1': 0.8022, 'mean_acc': 0.9154}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9614, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.8209, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.8209, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.8162, 'acc_0_0': 0.9561, 'acc_0_1': 0.9224, 'acc_1_0': 0.8162, 'acc_1_1': 0.8333, 'mean_acc': 0.9139}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8965, 'worst_acc': 0.806, 'acc_0_0': 0.9017, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.8131, 'acc_0_0': 0.9184, 'acc_0_1': 0.9273, 'acc_1_0': 0.8458, 'acc_1_1': 0.8131, 'mean_acc': 0.9021}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.7445, 'acc_0_0': 0.9392, 'acc_0_1': 0.9468, 'acc_1_0': 0.7975, 'acc_1_1': 0.7445, 'mean_acc': 0.9049}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7383, 'acc_0_0': 0.9525, 'acc_0_1': 0.9525, 'acc_1_0': 0.7523, 'acc_1_1': 0.7383, 'mean_acc': 0.9066}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7352, 'acc_0_0': 0.9619, 'acc_0_1': 0.9455, 'acc_1_0': 0.7352, 'acc_1_1': 0.7617, 'mean_acc': 0.9082}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9419, 'acc_1_0': 0.757, 'acc_1_1': 0.7679, 'mean_acc': 0.908}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7586, 'acc_0_0': 0.9579, 'acc_0_1': 0.9366, 'acc_1_0': 0.7586, 'acc_1_1': 0.7866, 'mean_acc': 0.9085}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.743, 'acc_0_0': 0.9588, 'acc_0_1': 0.9437, 'acc_1_0': 0.743, 'acc_1_1': 0.7788, 'mean_acc': 0.909}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7695, 'acc_0_0': 0.9543, 'acc_0_1': 0.9299, 'acc_1_0': 0.7695, 'acc_1_1': 0.8006, 'mean_acc': 0.9073}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7866, 'acc_0_0': 0.9494, 'acc_0_1': 0.9277, 'acc_1_0': 0.7866, 'acc_1_1': 0.8006, 'mean_acc': 0.9065}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7804, 'acc_0_0': 0.9521, 'acc_0_1': 0.9392, 'acc_1_0': 0.7804, 'acc_1_1': 0.7804, 'mean_acc': 0.909}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7601, 'acc_0_0': 0.9517, 'acc_0_1': 0.9424, 'acc_1_0': 0.7741, 'acc_1_1': 0.7601, 'mean_acc': 0.9071}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7648, 'acc_0_0': 0.9512, 'acc_0_1': 0.9419, 'acc_1_0': 0.7788, 'acc_1_1': 0.7648, 'mean_acc': 0.9078}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.757, 'acc_0_0': 0.9508, 'acc_0_1': 0.9424, 'acc_1_0': 0.7726, 'acc_1_1': 0.757, 'mean_acc': 0.9063}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.7757, 'acc_0_0': 0.9517, 'acc_0_1': 0.9335, 'acc_1_0': 0.7757, 'acc_1_1': 0.7866, 'mean_acc': 0.9068}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7632, 'acc_0_0': 0.9548, 'acc_0_1': 0.9379, 'acc_1_0': 0.7632, 'acc_1_1': 0.7726, 'mean_acc': 0.9068}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7679, 'acc_0_0': 0.9534, 'acc_0_1': 0.9379, 'acc_1_0': 0.7679, 'acc_1_1': 0.7726, 'mean_acc': 0.9068}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7601, 'acc_0_0': 0.9539, 'acc_0_1': 0.9419, 'acc_1_0': 0.7664, 'acc_1_1': 0.7601, 'mean_acc': 0.907}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.785, 'acc_0_0': 0.9477, 'acc_0_1': 0.9317, 'acc_1_0': 0.785, 'acc_1_1': 0.7882, 'mean_acc': 0.9058}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.771, 'acc_0_0': 0.949, 'acc_0_1': 0.9379, 'acc_1_0': 0.7741, 'acc_1_1': 0.771, 'mean_acc': 0.9056}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.771, 'acc_0_0': 0.9486, 'acc_0_1': 0.9388, 'acc_1_0': 0.7804, 'acc_1_1': 0.771, 'mean_acc': 0.9065}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7726, 'acc_0_0': 0.9494, 'acc_0_1': 0.9384, 'acc_1_0': 0.7741, 'acc_1_1': 0.7726, 'mean_acc': 0.9061}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.7648, 'acc_0_0': 0.9499, 'acc_0_1': 0.9379, 'acc_1_0': 0.7648, 'acc_1_1': 0.7695, 'mean_acc': 0.9047}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7617, 'acc_0_0': 0.9508, 'acc_0_1': 0.9397, 'acc_1_0': 0.7617, 'acc_1_1': 0.7648, 'mean_acc': 0.9049}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.771, 'acc_0_0': 0.9481, 'acc_0_1': 0.9379, 'acc_1_0': 0.7788, 'acc_1_1': 0.771, 'mean_acc': 0.9058}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7586, 'acc_0_0': 0.9503, 'acc_0_1': 0.9424, 'acc_1_0': 0.7679, 'acc_1_1': 0.7586, 'mean_acc': 0.9058}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.7617, 'acc_0_0': 0.9503, 'acc_0_1': 0.9401, 'acc_1_0': 0.771, 'acc_1_1': 0.7617, 'mean_acc': 0.9056}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7773, 'acc_0_0': 0.9494, 'acc_0_1': 0.9366, 'acc_1_0': 0.7773, 'acc_1_1': 0.7773, 'mean_acc': 0.9063}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7773, 'acc_0_0': 0.9486, 'acc_0_1': 0.9339, 'acc_1_0': 0.7773, 'acc_1_1': 0.7835, 'mean_acc': 0.9056}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.757, 'acc_0_0': 0.9512, 'acc_0_1': 0.9406, 'acc_1_0': 0.7617, 'acc_1_1': 0.757, 'mean_acc': 0.9046}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7741, 'acc_0_0': 0.9499, 'acc_0_1': 0.937, 'acc_1_0': 0.7741, 'acc_1_1': 0.7741, 'mean_acc': 0.9059}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.7555, 'acc_0_0': 0.9508, 'acc_0_1': 0.941, 'acc_1_0': 0.7648, 'acc_1_1': 0.7555, 'mean_acc': 0.9047}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.757, 'acc_0_0': 0.953, 'acc_0_1': 0.9424, 'acc_1_0': 0.757, 'acc_1_1': 0.757, 'mean_acc': 0.9054}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7757, 'acc_0_0': 0.949, 'acc_0_1': 0.9348, 'acc_1_0': 0.7757, 'acc_1_1': 0.7757, 'mean_acc': 0.9051}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7679, 'acc_0_0': 0.9494, 'acc_0_1': 0.9397, 'acc_1_0': 0.7679, 'acc_1_1': 0.771, 'mean_acc': 0.9058}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7648, 'acc_0_0': 0.9499, 'acc_0_1': 0.9392, 'acc_1_0': 0.7648, 'acc_1_1': 0.771, 'mean_acc': 0.9054}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.785, 'acc_0_0': 0.9446, 'acc_0_1': 0.9299, 'acc_1_0': 0.785, 'acc_1_1': 0.785, 'mean_acc': 0.9035}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7788, 'acc_0_0': 0.9472, 'acc_0_1': 0.9348, 'acc_1_0': 0.7788, 'acc_1_1': 0.7819, 'mean_acc': 0.9054}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.771, 'acc_0_0': 0.9494, 'acc_0_1': 0.9375, 'acc_1_0': 0.7741, 'acc_1_1': 0.771, 'mean_acc': 0.9056}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.771, 'acc_0_0': 0.9486, 'acc_0_1': 0.9375, 'acc_1_0': 0.7757, 'acc_1_1': 0.771, 'mean_acc': 0.9054}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7866, 'acc_0_0': 0.9437, 'acc_0_1': 0.9299, 'acc_1_0': 0.7882, 'acc_1_1': 0.7866, 'mean_acc': 0.9037}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7757, 'acc_0_0': 0.9481, 'acc_0_1': 0.9375, 'acc_1_0': 0.7757, 'acc_1_1': 0.7757, 'mean_acc': 0.9058}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7632, 'acc_0_0': 0.9512, 'acc_0_1': 0.9419, 'acc_1_0': 0.7632, 'acc_1_1': 0.7664, 'mean_acc': 0.9063}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7679, 'acc_0_0': 0.9503, 'acc_0_1': 0.9366, 'acc_1_0': 0.7679, 'acc_1_1': 0.771, 'mean_acc': 0.9049}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7508, 'acc_0_0': 0.9539, 'acc_0_1': 0.9419, 'acc_1_0': 0.7508, 'acc_1_1': 0.7555, 'mean_acc': 0.9047}
========================================================================
> end of training. 

best epoch : 48
best training accuracy on [class]: {'worst_acc': 0.6418, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.7879, 'acc_1_1': 0.6418, 'mean_acc': 0.9215}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8852, 'worst_acc': 0.8507, 'acc_0_0': 0.8761, 'acc_0_1': 0.9313, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}
best test accuracy on [class]: {'weighted_mean_acc': 0.87, 'worst_acc': 0.8131, 'acc_0_0': 0.8838, 'acc_0_1': 0.9268, 'acc_1_0': 0.8956, 'acc_1_1': 0.8131, 'mean_acc': 0.894}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.87, 'worst_acc': 0.8131, 'acc_0_0': 0.8838, 'acc_0_1': 0.9268, 'acc_1_0': 0.8956, 'acc_1_1': 0.8131, 'mean_acc': 0.894}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.4984, 'acc_0_0': 0.9743, 'acc_0_1': 0.8084, 'acc_1_0': 0.4984, 'acc_1_1': 0.986, 'mean_acc': 0.8583}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 48': {'Train': {'worst_acc': 0.6418, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.7879, 'acc_1_1': 0.6418, 'mean_acc': 0.9215}, 'Val': {'weighted_mean_acc': 0.8852, 'worst_acc': 0.8507, 'acc_0_0': 0.8761, 'acc_0_1': 0.9313, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}, 'Test': {'weighted_mean_acc': 0.87, 'worst_acc': 0.8131, 'acc_0_0': 0.8838, 'acc_0_1': 0.9268, 'acc_1_0': 0.8956, 'acc_1_1': 0.8131, 'mean_acc': 0.894}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.87, 'worst_acc': 0.8131, 'acc_0_0': 0.8838, 'acc_0_1': 0.9268, 'acc_1_0': 0.8956, 'acc_1_1': 0.8131, 'mean_acc': 0.894}, 'spurious': {'weighted_mean_acc': 0.9649, 'worst_acc': 0.4984, 'acc_0_0': 0.9743, 'acc_0_1': 0.8084, 'acc_1_0': 0.4984, 'acc_1_1': 0.986, 'mean_acc': 0.8583}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8740     0.8396   0.8843  ...   0.8801   0.8396    0.8754
2                       0.9029     0.8146   0.9304  ...   0.8396   0.8146    0.8985
3                       0.8700     0.8131   0.8838  ...   0.8956   0.8131    0.8940
test_mean               0.8823     0.8224   0.8995  ...   0.8718   0.8224    0.8893
test_std                0.0147     0.0122   0.0219  ...   0.0236   0.0122    0.0100
1                       0.9633     0.5436   0.9729  ...   0.5436   0.9798    0.8642
2                       0.9583     0.6994   0.9583  ...   0.6994   0.9798    0.9151
3                       0.9649     0.4984   0.9743  ...   0.4984   0.9860    0.8583
zs_spu_mean             0.9622     0.5805   0.9685  ...   0.5805   0.9819    0.8792
zs_spu_std              0.0028     0.0861   0.0072  ...   0.0861   0.0029    0.0255
1                          NaN     0.7576   0.9957  ...   0.7576   0.8955    0.9549
2                          NaN     0.9957   1.0000  ...   1.0000   1.0000    0.9983
3                          NaN     0.6418   0.9785  ...   0.7879   0.6418    0.9215
tr_mean                    NaN     0.7984   0.9914  ...   0.8485   0.8458    0.9582
tr_std                     NaN     0.1473   0.0093  ...   0.1078   0.1504    0.0314
1                       0.9232     0.8358   0.9188  ...   0.8358   0.9545    0.8883
2                       0.9214     0.8209   0.9316  ...   0.8209   0.8939    0.9083
3                       0.8852     0.8507   0.8761  ...   0.8507   0.9091    0.8983
val_mean                0.9099     0.8358   0.9088  ...   0.8358   0.9192    0.8983
val_std                 0.0175     0.0122   0.0237  ...   0.0122   0.0257    0.0082
1                       0.8740     0.8396   0.8843  ...   0.8801   0.8396    0.8754
2                       0.9029     0.8146   0.9304  ...   0.8396   0.8146    0.8985
3                       0.8700     0.8131   0.8838  ...   0.8956   0.8131    0.8940
zs_tg_mean              0.8823     0.8224   0.8995  ...   0.8718   0.8224    0.8893
zs_tg_std               0.0147     0.0122   0.0219  ...   0.0236   0.0122    0.0100

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_1.0_lrr1.0_bsr64_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0634, 'acc_0_0': 0.9643, 'acc_0_1': 0.9511, 'acc_1_0': 0.1071, 'acc_1_1': 0.0634, 'mean_acc': 0.7552}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3571, 'acc_0_0': 0.992, 'acc_0_1': 0.6957, 'acc_1_0': 0.3571, 'acc_1_1': 0.8023, 'mean_acc': 0.9314}
Val(class): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8798, 'acc_1_0': 0.4925, 'acc_1_1': 0.6061, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.4907, 'acc_0_0': 0.9938, 'acc_0_1': 0.8767, 'acc_1_0': 0.4907, 'acc_1_1': 0.6012, 'mean_acc': 0.849}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9831, 'acc_0_1': 0.6576, 'acc_1_0': 0.5536, 'acc_1_1': 0.9243, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.8888, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.3284, 'acc_1_1': 0.5455, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.3754, 'acc_0_0': 0.9978, 'acc_0_1': 0.9135, 'acc_1_0': 0.3754, 'acc_1_1': 0.5763, 'mean_acc': 0.8493}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9889, 'acc_0_1': 0.6848, 'acc_1_0': 0.625, 'acc_1_1': 0.9347, 'mean_acc': 0.961}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8112, 'acc_1_0': 0.4776, 'acc_1_1': 0.8939, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.5436, 'acc_0_0': 0.9925, 'acc_0_1': 0.8071, 'acc_1_0': 0.5436, 'acc_1_1': 0.8645, 'mean_acc': 0.8564}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9906, 'acc_0_1': 0.6685, 'acc_1_0': 0.6429, 'acc_1_1': 0.9565, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6012, 'acc_0_0': 0.9885, 'acc_0_1': 0.6373, 'acc_1_0': 0.6012, 'acc_1_1': 0.9486, 'mean_acc': 0.8045}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.663, 'acc_1_0': 0.6607, 'acc_1_1': 0.9631, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.5794, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5996, 'acc_0_0': 0.9871, 'acc_0_1': 0.5996, 'acc_1_0': 0.6106, 'acc_1_1': 0.9502, 'mean_acc': 0.7905}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9943, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9678, 'mean_acc': 0.9725}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.5665, 'acc_0_0': 0.9957, 'acc_0_1': 0.5665, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5809, 'acc_0_0': 0.9863, 'acc_0_1': 0.5809, 'acc_1_0': 0.6215, 'acc_1_1': 0.9548, 'mean_acc': 0.7846}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7065, 'acc_1_0': 0.6607, 'acc_1_1': 0.9612, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4635, 'acc_0_0': 0.9957, 'acc_0_1': 0.4635, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.5193, 'acc_0_0': 0.9814, 'acc_0_1': 0.5193, 'acc_1_0': 0.6745, 'acc_1_1': 0.9642, 'mean_acc': 0.7656}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9917, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9612, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.4721, 'acc_0_0': 0.9957, 'acc_0_1': 0.4721, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.49, 'acc_0_0': 0.984, 'acc_0_1': 0.49, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7541}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.992, 'acc_0_1': 0.6793, 'acc_1_0': 0.7143, 'acc_1_1': 0.9688, 'mean_acc': 0.9716}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.553, 'acc_0_0': 0.9836, 'acc_0_1': 0.553, 'acc_1_0': 0.6604, 'acc_1_1': 0.9595, 'mean_acc': 0.7775}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.6964, 'acc_1_1': 0.9707, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5942, 'acc_0_0': 0.9863, 'acc_0_1': 0.5942, 'acc_1_0': 0.6417, 'acc_1_1': 0.9533, 'mean_acc': 0.7919}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.994, 'acc_0_1': 0.7337, 'acc_1_0': 0.7143, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6266, 'acc_0_0': 0.9915, 'acc_0_1': 0.6266, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.612, 'acc_0_0': 0.9863, 'acc_0_1': 0.612, 'acc_1_0': 0.6449, 'acc_1_1': 0.9517, 'mean_acc': 0.7989}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9929, 'acc_0_1': 0.7772, 'acc_1_0': 0.7679, 'acc_1_1': 0.9659, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.565, 'acc_0_0': 0.9831, 'acc_0_1': 0.565, 'acc_1_0': 0.6807, 'acc_1_1': 0.9564, 'mean_acc': 0.7839}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9963, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4464, 'acc_0_0': 0.9872, 'acc_0_1': 0.4464, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7417}
Test(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.4293, 'acc_0_0': 0.9831, 'acc_0_1': 0.4293, 'acc_1_0': 0.6885, 'acc_1_1': 0.9688, 'mean_acc': 0.7333}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9931, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9678, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.7322, 'acc_1_0': 0.6277, 'acc_1_1': 0.9377, 'mean_acc': 0.8431}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9969, 'acc_0_1': 0.7935, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.5923, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5787, 'acc_0_0': 0.9849, 'acc_0_1': 0.5787, 'acc_1_0': 0.6324, 'acc_1_1': 0.9486, 'mean_acc': 0.7837}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9969, 'acc_0_1': 0.8315, 'acc_1_0': 0.8393, 'acc_1_1': 0.9792, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5872, 'acc_0_0': 0.992, 'acc_0_1': 0.7951, 'acc_1_0': 0.5872, 'acc_1_1': 0.9128, 'mean_acc': 0.8618}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8641, 'acc_1_0': 0.8036, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7854, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5576, 'acc_0_0': 0.9933, 'acc_0_1': 0.7933, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.8602}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9969, 'acc_0_1': 0.8587, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4807, 'acc_0_0': 0.9744, 'acc_0_1': 0.4807, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7533}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4683, 'acc_0_0': 0.9823, 'acc_0_1': 0.4683, 'acc_1_0': 0.6729, 'acc_1_1': 0.9673, 'mean_acc': 0.7463}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.984, 'acc_0_1': 0.6736, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.8219}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9969, 'acc_0_1': 0.913, 'acc_1_0': 0.9464, 'acc_1_1': 0.9811, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.6652, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5903, 'acc_0_0': 0.9863, 'acc_0_1': 0.6736, 'acc_1_0': 0.5903, 'acc_1_1': 0.933, 'mean_acc': 0.8148}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9943, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5545, 'acc_0_0': 0.9925, 'acc_0_1': 0.6758, 'acc_1_0': 0.5545, 'acc_1_1': 0.9299, 'mean_acc': 0.8138}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.996, 'acc_0_1': 0.875, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6524, 'acc_0_0': 0.9829, 'acc_0_1': 0.6524, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6421, 'acc_0_0': 0.9854, 'acc_0_1': 0.6421, 'acc_1_0': 0.6449, 'acc_1_1': 0.9548, 'mean_acc': 0.8107}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9937, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5436, 'acc_0_0': 0.9929, 'acc_0_1': 0.7583, 'acc_1_0': 0.5436, 'acc_1_1': 0.9268, 'mean_acc': 0.8445}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.996, 'acc_0_1': 0.8533, 'acc_1_0': 0.875, 'acc_1_1': 0.9735, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6309, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.6293, 'acc_0_0': 0.9792, 'acc_0_1': 0.6488, 'acc_1_0': 0.6293, 'acc_1_1': 0.9268, 'mean_acc': 0.806}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9954, 'acc_0_1': 0.8478, 'acc_1_0': 0.7857, 'acc_1_1': 0.9745, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.8884, 'acc_1_0': 0.4925, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.5, 'acc_0_0': 0.9965, 'acc_0_1': 0.8976, 'acc_1_0': 0.5, 'acc_1_1': 0.8583, 'mean_acc': 0.8876}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.944, 'worst_acc': 0.4292, 'acc_0_0': 0.9573, 'acc_0_1': 0.4292, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.4488, 'acc_0_0': 0.957, 'acc_0_1': 0.4488, 'acc_1_0': 0.7368, 'acc_1_1': 0.9688, 'mean_acc': 0.7361}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9929, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.9726, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.691, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6807, 'acc_0_0': 0.9871, 'acc_0_1': 0.7091, 'acc_1_0': 0.6807, 'acc_1_1': 0.947, 'mean_acc': 0.8405}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.9669, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9728, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.7641, 'acc_1_0': 0.5576, 'acc_1_1': 0.9159, 'mean_acc': 0.8459}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9969, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.9811, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3731, 'acc_0_0': 0.9957, 'acc_0_1': 0.8927, 'acc_1_0': 0.3731, 'acc_1_1': 0.8485, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9476, 'worst_acc': 0.4097, 'acc_0_0': 0.9982, 'acc_0_1': 0.9029, 'acc_1_0': 0.4097, 'acc_1_1': 0.8162, 'mean_acc': 0.8757}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9877, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5794, 'acc_0_0': 0.9744, 'acc_0_1': 0.5794, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.5902, 'acc_0_0': 0.9725, 'acc_0_1': 0.5902, 'acc_1_0': 0.7056, 'acc_1_1': 0.9517, 'mean_acc': 0.7919}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9969, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5536, 'acc_0_0': 0.9829, 'acc_0_1': 0.5536, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6226, 'acc_0_0': 0.9805, 'acc_0_1': 0.6226, 'acc_1_0': 0.6573, 'acc_1_1': 0.9486, 'mean_acc': 0.8019}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9972, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5579, 'acc_0_0': 0.9573, 'acc_0_1': 0.5579, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.942, 'worst_acc': 0.5548, 'acc_0_0': 0.9592, 'acc_0_1': 0.5548, 'acc_1_0': 0.7492, 'acc_1_1': 0.9626, 'mean_acc': 0.7789}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9991, 'acc_0_1': 0.9457, 'acc_1_0': 0.9643, 'acc_1_1': 0.9858, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.7095, 'acc_1_0': 0.5327, 'acc_1_1': 0.9268, 'mean_acc': 0.8238}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5075, 'acc_0_0': 0.9872, 'acc_0_1': 0.8112, 'acc_1_0': 0.5075, 'acc_1_1': 0.9091, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.5654, 'acc_0_0': 0.9907, 'acc_0_1': 0.8421, 'acc_1_0': 0.5654, 'acc_1_1': 0.8567, 'mean_acc': 0.8709}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9966, 'acc_0_1': 0.9565, 'acc_1_0': 0.8929, 'acc_1_1': 0.9849, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.5107, 'acc_0_0': 0.9701, 'acc_0_1': 0.5107, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.486, 'acc_0_0': 0.9698, 'acc_0_1': 0.486, 'acc_1_0': 0.6604, 'acc_1_1': 0.9517, 'mean_acc': 0.7453}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9926, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9839}
Val(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9573, 'worst_acc': 0.6667, 'acc_0_0': 0.9836, 'acc_0_1': 0.694, 'acc_1_0': 0.6667, 'acc_1_1': 0.9315, 'mean_acc': 0.83}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9914, 'acc_0_1': 0.7609, 'acc_1_0': 0.6607, 'acc_1_1': 0.9423, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6395, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.9845, 'acc_0_1': 0.6656, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.819}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9906, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9631, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8755, 'acc_1_0': 0.4776, 'acc_1_1': 0.9242, 'mean_acc': 0.885}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.514, 'acc_0_0': 0.9951, 'acc_0_1': 0.8426, 'acc_1_0': 0.514, 'acc_1_1': 0.8847, 'mean_acc': 0.8702}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9943, 'acc_0_1': 0.837, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5779, 'acc_0_0': 0.9889, 'acc_0_1': 0.8204, 'acc_1_0': 0.5779, 'acc_1_1': 0.8941, 'mean_acc': 0.8673}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5909, 'acc_0_0': 0.9356, 'acc_0_1': 0.867, 'acc_1_0': 0.5909, 'acc_1_1': 0.806, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.7682, 'worst_acc': 0.0758, 'acc_0_0': 0.9701, 'acc_0_1': 0.9957, 'acc_1_0': 0.4776, 'acc_1_1': 0.0758, 'mean_acc': 0.8267}
Test(class)(new adapter): {'weighted_mean_acc': 0.7894, 'worst_acc': 0.1121, 'acc_0_0': 0.9876, 'acc_0_1': 0.9956, 'acc_1_0': 0.5171, 'acc_1_1': 0.1121, 'mean_acc': 0.8416}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3636, 'acc_0_0': 0.8498, 'acc_0_1': 0.7682, 'acc_1_0': 0.3636, 'acc_1_1': 0.7015, 'mean_acc': 0.7479}
Val(class)(new adapter): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.5522, 'acc_0_0': 0.9744, 'acc_0_1': 0.6996, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5997, 'acc_0_0': 0.9894, 'acc_0_1': 0.6763, 'acc_1_0': 0.5997, 'acc_1_1': 0.9455, 'mean_acc': 0.8195}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9742, 'acc_0_1': 0.9313, 'acc_1_0': 0.697, 'acc_1_1': 0.8955, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.8239, 'worst_acc': 0.5455, 'acc_0_0': 0.9017, 'acc_0_1': 0.9399, 'acc_1_0': 0.8358, 'acc_1_1': 0.5455, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.7993, 'worst_acc': 0.4798, 'acc_0_0': 0.8865, 'acc_0_1': 0.9579, 'acc_1_0': 0.8676, 'acc_1_1': 0.4798, 'mean_acc': 0.8671}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3731, 'acc_0_0': 0.7854, 'acc_0_1': 0.9013, 'acc_1_0': 0.8636, 'acc_1_1': 0.3731, 'mean_acc': 0.793}
Val(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.6481, 'acc_0_0': 0.9573, 'acc_0_1': 0.6481, 'acc_1_0': 0.791, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class)(new adapter): {'weighted_mean_acc': 0.9436, 'worst_acc': 0.6692, 'acc_0_0': 0.9592, 'acc_0_1': 0.6692, 'acc_1_0': 0.8053, 'acc_1_1': 0.947, 'mean_acc': 0.8279}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9185, 'acc_1_0': 0.697, 'acc_1_1': 0.9104, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9658, 'acc_0_1': 0.9657, 'acc_1_0': 0.7015, 'acc_1_1': 0.7424, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.6199, 'acc_0_0': 0.9814, 'acc_0_1': 0.9792, 'acc_1_0': 0.743, 'acc_1_1': 0.6199, 'mean_acc': 0.914}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.9185, 'acc_0_1': 0.9528, 'acc_1_0': 0.803, 'acc_1_1': 0.5522, 'mean_acc': 0.8781}
Val(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.6738, 'acc_0_0': 0.9188, 'acc_0_1': 0.6738, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7024, 'acc_0_0': 0.922, 'acc_0_1': 0.7024, 'acc_1_0': 0.8598, 'acc_1_1': 0.9502, 'mean_acc': 0.8328}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9785, 'acc_0_1': 0.9442, 'acc_1_0': 0.7879, 'acc_1_1': 0.8955, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.8749, 'worst_acc': 0.6364, 'acc_0_0': 0.9444, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.6364, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8588, 'worst_acc': 0.5078, 'acc_0_0': 0.9596, 'acc_0_1': 0.9827, 'acc_1_0': 0.7757, 'acc_1_1': 0.5078, 'mean_acc': 0.8982}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.927, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.8209, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.8209, 'acc_0_0': 0.9487, 'acc_0_1': 0.8326, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.8302, 'acc_0_0': 0.9486, 'acc_0_1': 0.8315, 'acc_1_0': 0.8302, 'acc_1_1': 0.9034, 'mean_acc': 0.8849}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9957, 'acc_0_1': 0.9571, 'acc_1_0': 0.8333, 'acc_1_1': 0.9851, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.8915, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.9013, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8805, 'worst_acc': 0.7664, 'acc_0_0': 0.914, 'acc_0_1': 0.9157, 'acc_1_0': 0.8287, 'acc_1_1': 0.7664, 'mean_acc': 0.8889}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9227, 'acc_0_1': 0.9785, 'acc_1_0': 0.8636, 'acc_1_1': 0.8955, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.8358, 'acc_0_0': 0.9359, 'acc_0_1': 0.8498, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.824, 'acc_0_0': 0.9486, 'acc_0_1': 0.8816, 'acc_1_0': 0.824, 'acc_1_1': 0.8676, 'mean_acc': 0.8997}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.8455, 'acc_0_0': 0.9188, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8178, 'acc_0_0': 0.9175, 'acc_0_1': 0.8767, 'acc_1_0': 0.8536, 'acc_1_1': 0.8178, 'mean_acc': 0.8835}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.97, 'acc_0_1': 0.9657, 'acc_1_0': 0.9394, 'acc_1_1': 0.9254, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.8419, 'worst_acc': 0.8291, 'acc_0_0': 0.8291, 'acc_0_1': 0.867, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.8533}
Test(class)(new adapter): {'weighted_mean_acc': 0.8385, 'worst_acc': 0.8209, 'acc_0_0': 0.8399, 'acc_0_1': 0.8958, 'acc_1_0': 0.8956, 'acc_1_1': 0.8209, 'mean_acc': 0.8657}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.6818, 'acc_0_0': 0.9658, 'acc_0_1': 0.9657, 'acc_1_0': 0.7164, 'acc_1_1': 0.6818, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8749, 'worst_acc': 0.5296, 'acc_0_0': 0.9756, 'acc_0_1': 0.9858, 'acc_1_0': 0.7383, 'acc_1_1': 0.5296, 'mean_acc': 0.9039}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9442, 'acc_0_1': 0.9657, 'acc_1_0': 0.9242, 'acc_1_1': 0.9403, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8112, 'acc_0_0': 0.9359, 'acc_0_1': 0.8112, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.8426, 'acc_0_0': 0.9251, 'acc_0_1': 0.8426, 'acc_1_0': 0.8551, 'acc_1_1': 0.8769, 'mean_acc': 0.8799}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9614, 'acc_1_0': 0.7015, 'acc_1_1': 0.7121, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8892, 'worst_acc': 0.6231, 'acc_0_0': 0.9685, 'acc_0_1': 0.9694, 'acc_1_0': 0.6978, 'acc_1_1': 0.6231, 'mean_acc': 0.9006}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9828, 'acc_0_1': 0.9614, 'acc_1_0': 0.8939, 'acc_1_1': 0.8955, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.8552, 'worst_acc': 0.6824, 'acc_0_0': 0.8333, 'acc_0_1': 0.6824, 'acc_1_0': 0.9104, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8366, 'worst_acc': 0.6789, 'acc_0_0': 0.8098, 'acc_0_1': 0.6789, 'acc_1_0': 0.9159, 'acc_1_1': 0.9486, 'mean_acc': 0.786}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9914, 'acc_0_1': 0.9528, 'acc_1_0': 0.8939, 'acc_1_1': 0.8507, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.6418, 'acc_0_0': 0.9744, 'acc_0_1': 0.9657, 'acc_1_0': 0.6418, 'acc_1_1': 0.7576, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8897, 'worst_acc': 0.567, 'acc_0_0': 0.9863, 'acc_0_1': 0.9809, 'acc_1_0': 0.6511, 'acc_1_1': 0.567, 'mean_acc': 0.9006}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9614, 'acc_0_1': 0.9356, 'acc_1_0': 0.9394, 'acc_1_1': 0.8955, 'mean_acc': 0.9416}
Val(class)(new adapter): {'weighted_mean_acc': 0.9414, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.8584, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9328, 'worst_acc': 0.7913, 'acc_0_0': 0.9623, 'acc_0_1': 0.8869, 'acc_1_0': 0.7913, 'acc_1_1': 0.8505, 'mean_acc': 0.9016}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.6963, 'acc_0_0': 0.9499, 'acc_0_1': 0.9614, 'acc_1_0': 0.7866, 'acc_1_1': 0.6963, 'mean_acc': 0.9082}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.97, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.8806, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.6009, 'acc_0_0': 0.9145, 'acc_0_1': 0.6009, 'acc_1_0': 0.8358, 'acc_1_1': 0.9848, 'mean_acc': 0.7917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.6084, 'acc_0_0': 0.9047, 'acc_0_1': 0.6084, 'acc_1_0': 0.8551, 'acc_1_1': 0.9548, 'mean_acc': 0.7894}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 0.9742, 'acc_1_0': 0.8636, 'acc_1_1': 0.9851, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8345, 'worst_acc': 0.4242, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.7463, 'acc_1_1': 0.4242, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8327, 'worst_acc': 0.3629, 'acc_0_0': 0.9676, 'acc_0_1': 0.988, 'acc_1_0': 0.7617, 'acc_1_1': 0.3629, 'mean_acc': 0.8857}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.8584, 'acc_0_1': 0.9485, 'acc_1_0': 0.9697, 'acc_1_1': 0.8209, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.7511, 'acc_0_0': 0.953, 'acc_0_1': 0.7511, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9381, 'worst_acc': 0.7823, 'acc_0_0': 0.9517, 'acc_0_1': 0.7823, 'acc_1_0': 0.8146, 'acc_1_1': 0.9268, 'mean_acc': 0.8678}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.8182, 'acc_1_1': 0.9851, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.897, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.897, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.894, 'worst_acc': 0.743, 'acc_0_0': 0.9401, 'acc_0_1': 0.9082, 'acc_1_0': 0.8162, 'acc_1_1': 0.743, 'mean_acc': 0.8921}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9785, 'acc_0_1': 0.9442, 'acc_1_0': 0.8636, 'acc_1_1': 0.9254, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.814, 'worst_acc': 0.7382, 'acc_0_0': 0.7735, 'acc_0_1': 0.7382, 'acc_1_0': 0.9403, 'acc_1_1': 0.9545, 'mean_acc': 0.7983}
Test(class)(new adapter): {'weighted_mean_acc': 0.7923, 'worst_acc': 0.7503, 'acc_0_0': 0.7565, 'acc_0_1': 0.7503, 'acc_1_0': 0.9174, 'acc_1_1': 0.9112, 'mean_acc': 0.7891}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9056, 'acc_0_1': 0.9785, 'acc_1_0': 0.7879, 'acc_1_1': 0.8657, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.898, 'worst_acc': 0.5224, 'acc_0_0': 0.9829, 'acc_0_1': 0.9871, 'acc_1_0': 0.5224, 'acc_1_1': 0.6212, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8722, 'worst_acc': 0.4579, 'acc_0_0': 0.9956, 'acc_0_1': 0.9956, 'acc_1_0': 0.5826, 'acc_1_1': 0.4579, 'mean_acc': 0.8902}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9614, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.9403, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.8922, 'worst_acc': 0.8455, 'acc_0_0': 0.8761, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8785, 'worst_acc': 0.8523, 'acc_0_0': 0.8834, 'acc_0_1': 0.8523, 'acc_1_0': 0.8676, 'acc_1_1': 0.8676, 'mean_acc': 0.8678}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9742, 'acc_0_1': 0.9528, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.8987, 'worst_acc': 0.7576, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.7576, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8815, 'worst_acc': 0.6449, 'acc_0_0': 0.9503, 'acc_0_1': 0.9539, 'acc_1_0': 0.8115, 'acc_1_1': 0.6449, 'mean_acc': 0.9025}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9785, 'acc_0_1': 0.9657, 'acc_1_0': 0.9242, 'acc_1_1': 0.9104, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.8792, 'worst_acc': 0.7682, 'acc_0_0': 0.8632, 'acc_0_1': 0.7682, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.784, 'acc_0_0': 0.9038, 'acc_0_1': 0.784, 'acc_1_0': 0.8707, 'acc_1_1': 0.905, 'mean_acc': 0.8536}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 0.9785, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.8684, 'worst_acc': 0.697, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.697, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8638, 'worst_acc': 0.5717, 'acc_0_0': 0.9481, 'acc_0_1': 0.9614, 'acc_1_0': 0.7897, 'acc_1_1': 0.5717, 'mean_acc': 0.894}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9957, 'acc_0_1': 0.9528, 'acc_1_0': 0.9394, 'acc_1_1': 0.8806, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.8326, 'acc_0_0': 0.9188, 'acc_0_1': 0.8326, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.8458, 'acc_0_0': 0.9428, 'acc_0_1': 0.8528, 'acc_1_0': 0.8458, 'acc_1_1': 0.8738, 'mean_acc': 0.8894}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 0.9254, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.6869, 'acc_0_0': 0.9721, 'acc_0_1': 0.9712, 'acc_1_0': 0.7336, 'acc_1_1': 0.6869, 'mean_acc': 0.9137}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9742, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.6609, 'acc_0_0': 0.9487, 'acc_0_1': 0.6609, 'acc_1_0': 0.791, 'acc_1_1': 1.0, 'mean_acc': 0.825}
Test(class)(new adapter): {'weighted_mean_acc': 0.9399, 'worst_acc': 0.6967, 'acc_0_0': 0.953, 'acc_0_1': 0.6967, 'acc_1_0': 0.7866, 'acc_1_1': 0.947, 'mean_acc': 0.8341}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9571, 'acc_0_0': 1.0, 'acc_0_1': 0.9571, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7164, 'acc_0_0': 0.9701, 'acc_0_1': 0.9742, 'acc_1_0': 0.7164, 'acc_1_1': 0.7424, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.8855, 'worst_acc': 0.5919, 'acc_0_0': 0.9716, 'acc_0_1': 0.98, 'acc_1_0': 0.7336, 'acc_1_1': 0.5919, 'mean_acc': 0.9065}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 1.0, 'acc_0_1': 0.9742, 'acc_1_0': 0.9848, 'acc_1_1': 0.8955, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.8209, 'acc_0_0': 0.9274, 'acc_0_1': 0.8584, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.8458, 'acc_0_0': 0.9339, 'acc_0_1': 0.8461, 'acc_1_0': 0.8458, 'acc_1_1': 0.8956, 'mean_acc': 0.8857}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9657, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9339, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.9528, 'acc_1_0': 0.6269, 'acc_1_1': 0.7424, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8939, 'worst_acc': 0.6153, 'acc_0_0': 0.9783, 'acc_0_1': 0.9676, 'acc_1_0': 0.6433, 'acc_1_1': 0.6153, 'mean_acc': 0.8968}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.97, 'acc_0_1': 1.0, 'acc_1_0': 0.8636, 'acc_1_1': 0.8955, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.9571, 'acc_1_0': 0.6418, 'acc_1_1': 0.7727, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.6386, 'acc_0_0': 0.9721, 'acc_0_1': 0.9667, 'acc_1_0': 0.6854, 'acc_1_1': 0.6386, 'mean_acc': 0.9013}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7477, 'acc_0_0': 0.9472, 'acc_0_1': 0.9419, 'acc_1_0': 0.8006, 'acc_1_1': 0.7477, 'mean_acc': 0.9068}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8998, 'worst_acc': 0.7788, 'acc_0_0': 0.9361, 'acc_0_1': 0.9268, 'acc_1_0': 0.8271, 'acc_1_1': 0.7788, 'mean_acc': 0.903}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7835, 'acc_0_0': 0.941, 'acc_0_1': 0.9246, 'acc_1_0': 0.8255, 'acc_1_1': 0.7835, 'mean_acc': 0.9044}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.771, 'acc_0_0': 0.9463, 'acc_0_1': 0.9375, 'acc_1_0': 0.8115, 'acc_1_1': 0.771, 'mean_acc': 0.9085}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.7726, 'acc_0_0': 0.9468, 'acc_0_1': 0.9304, 'acc_1_0': 0.8146, 'acc_1_1': 0.7726, 'mean_acc': 0.9065}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.771, 'acc_0_0': 0.9512, 'acc_0_1': 0.933, 'acc_1_0': 0.8084, 'acc_1_1': 0.771, 'mean_acc': 0.9084}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.7726, 'acc_0_0': 0.9455, 'acc_0_1': 0.9322, 'acc_1_0': 0.81, 'acc_1_1': 0.7726, 'mean_acc': 0.9061}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9033, 'worst_acc': 0.7726, 'acc_0_0': 0.9428, 'acc_0_1': 0.9295, 'acc_1_0': 0.8162, 'acc_1_1': 0.7726, 'mean_acc': 0.9047}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7632, 'acc_0_0': 0.9512, 'acc_0_1': 0.9375, 'acc_1_0': 0.796, 'acc_1_1': 0.7632, 'mean_acc': 0.9078}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7617, 'acc_0_0': 0.9499, 'acc_0_1': 0.9375, 'acc_1_0': 0.7975, 'acc_1_1': 0.7617, 'mean_acc': 0.9073}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7601, 'acc_0_0': 0.9534, 'acc_0_1': 0.9406, 'acc_1_0': 0.7897, 'acc_1_1': 0.7601, 'mean_acc': 0.9089}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7617, 'acc_0_0': 0.9552, 'acc_0_1': 0.9375, 'acc_1_0': 0.7866, 'acc_1_1': 0.7617, 'mean_acc': 0.9082}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.7601, 'acc_0_0': 0.949, 'acc_0_1': 0.9366, 'acc_1_0': 0.7897, 'acc_1_1': 0.7601, 'mean_acc': 0.9056}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.7617, 'acc_0_0': 0.9446, 'acc_0_1': 0.9344, 'acc_1_0': 0.7928, 'acc_1_1': 0.7617, 'mean_acc': 0.9035}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7632, 'acc_0_0': 0.9428, 'acc_0_1': 0.9313, 'acc_1_0': 0.8037, 'acc_1_1': 0.7632, 'mean_acc': 0.903}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7648, 'acc_0_0': 0.9481, 'acc_0_1': 0.9361, 'acc_1_0': 0.7913, 'acc_1_1': 0.7648, 'mean_acc': 0.9058}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7555, 'acc_0_0': 0.9552, 'acc_0_1': 0.9424, 'acc_1_0': 0.7835, 'acc_1_1': 0.7555, 'mean_acc': 0.909}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7586, 'acc_0_0': 0.9503, 'acc_0_1': 0.9388, 'acc_1_0': 0.7928, 'acc_1_1': 0.7586, 'mean_acc': 0.9071}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9313, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7601, 'acc_0_0': 0.9512, 'acc_0_1': 0.9388, 'acc_1_0': 0.7882, 'acc_1_1': 0.7601, 'mean_acc': 0.9071}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.7679, 'acc_0_0': 0.9472, 'acc_0_1': 0.929, 'acc_1_0': 0.8037, 'acc_1_1': 0.7679, 'mean_acc': 0.9044}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7555, 'acc_0_0': 0.9512, 'acc_0_1': 0.9375, 'acc_1_0': 0.7866, 'acc_1_1': 0.7555, 'mean_acc': 0.9059}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7523, 'acc_0_0': 0.9561, 'acc_0_1': 0.9392, 'acc_1_0': 0.7695, 'acc_1_1': 0.7523, 'mean_acc': 0.9063}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.931, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7601, 'acc_0_0': 0.953, 'acc_0_1': 0.937, 'acc_1_0': 0.7866, 'acc_1_1': 0.7601, 'mean_acc': 0.907}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9345, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7523, 'acc_0_0': 0.9579, 'acc_0_1': 0.9446, 'acc_1_0': 0.7788, 'acc_1_1': 0.7523, 'mean_acc': 0.9101}
========================================================================
> end of training. 

best epoch : 51
best training accuracy on [class]: {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9097, 'worst_acc': 0.8455, 'acc_0_0': 0.9188, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.88}
best test accuracy on [class]: {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8178, 'acc_0_0': 0.9175, 'acc_0_1': 0.8767, 'acc_1_0': 0.8536, 'acc_1_1': 0.8178, 'mean_acc': 0.8835}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8178, 'acc_0_0': 0.9175, 'acc_0_1': 0.8767, 'acc_1_0': 0.8536, 'acc_1_1': 0.8178, 'mean_acc': 0.8835}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.5933, 'acc_0_0': 0.9969, 'acc_0_1': 0.5933, 'acc_1_0': 0.9143, 'acc_1_1': 0.8956, 'mean_acc': 0.8195}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 51': {'Train': {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.98}, 'Val': {'weighted_mean_acc': 0.9097, 'worst_acc': 0.8455, 'acc_0_0': 0.9188, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.88}, 'Test': {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8178, 'acc_0_0': 0.9175, 'acc_0_1': 0.8767, 'acc_1_0': 0.8536, 'acc_1_1': 0.8178, 'mean_acc': 0.8835}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8178, 'acc_0_0': 0.9175, 'acc_0_1': 0.8767, 'acc_1_0': 0.8536, 'acc_1_1': 0.8178, 'mean_acc': 0.8835}, 'spurious': {'weighted_mean_acc': 0.9581, 'worst_acc': 0.5933, 'acc_0_0': 0.9969, 'acc_0_1': 0.5933, 'acc_1_0': 0.9143, 'acc_1_1': 0.8956, 'mean_acc': 0.8195}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0357, 'acc_0_0': 0.9534, 'acc_0_1': 0.962, 'acc_1_0': 0.0357, 'acc_1_1': 0.0747, 'mean_acc': 0.7493}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2679, 'acc_0_0': 0.994, 'acc_0_1': 0.6902, 'acc_1_0': 0.2679, 'acc_1_1': 0.6168, 'mean_acc': 0.8907}
Val(class): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.5966, 'acc_0_0': 0.9615, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.5211, 'acc_0_0': 0.9614, 'acc_0_1': 0.5211, 'acc_1_0': 0.6807, 'acc_1_1': 0.9299, 'mean_acc': 0.7554}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9863, 'acc_0_1': 0.6141, 'acc_1_0': 0.5893, 'acc_1_1': 0.9338, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.6137, 'acc_1_0': 0.4776, 'acc_1_1': 0.9697, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.4502, 'acc_0_0': 0.9951, 'acc_0_1': 0.5885, 'acc_1_0': 0.4502, 'acc_1_1': 0.9377, 'mean_acc': 0.7701}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9891, 'acc_0_1': 0.5272, 'acc_1_0': 0.5, 'acc_1_1': 0.9603, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.72}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3543, 'acc_0_0': 0.9814, 'acc_0_1': 0.3543, 'acc_1_0': 0.6153, 'acc_1_1': 0.9657, 'mean_acc': 0.695}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5978, 'acc_0_0': 0.9874, 'acc_0_1': 0.5978, 'acc_1_0': 0.6429, 'acc_1_1': 0.9518, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3948, 'acc_0_0': 0.9872, 'acc_0_1': 0.3948, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.7283}
Test(class): {'weighted_mean_acc': 0.9461, 'worst_acc': 0.357, 'acc_0_0': 0.9738, 'acc_0_1': 0.357, 'acc_1_0': 0.7492, 'acc_1_1': 0.9673, 'mean_acc': 0.7081}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9917, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9574, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.5708, 'acc_0_0': 0.9829, 'acc_0_1': 0.5708, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.518, 'acc_0_0': 0.98, 'acc_0_1': 0.518, 'acc_1_0': 0.7196, 'acc_1_1': 0.9517, 'mean_acc': 0.7682}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.7143, 'acc_1_1': 0.9603, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7007, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.83}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.9934, 'acc_0_1': 0.6848, 'acc_1_0': 0.6964, 'acc_1_1': 0.9659, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9585, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5522, 'acc_1_1': 0.8636, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5358, 'acc_0_0': 0.9947, 'acc_0_1': 0.8377, 'acc_1_0': 0.5358, 'acc_1_1': 0.9003, 'mean_acc': 0.8723}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.994, 'acc_0_1': 0.7609, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9771, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.595, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9377, 'mean_acc': 0.8177}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9943, 'acc_0_1': 0.788, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.6524, 'acc_0_0': 0.9786, 'acc_0_1': 0.6524, 'acc_1_0': 0.7313, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.612, 'acc_0_0': 0.9814, 'acc_0_1': 0.612, 'acc_1_0': 0.7025, 'acc_1_1': 0.947, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9946, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9678, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.749, 'acc_1_0': 0.5312, 'acc_1_1': 0.9315, 'mean_acc': 0.8404}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9946, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9622, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5665, 'acc_0_0': 0.9701, 'acc_0_1': 0.5665, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.5588, 'acc_0_0': 0.9769, 'acc_0_1': 0.5588, 'acc_1_0': 0.7087, 'acc_1_1': 0.9579, 'mean_acc': 0.7824}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5047, 'acc_0_0': 0.9956, 'acc_0_1': 0.8186, 'acc_1_0': 0.5047, 'acc_1_1': 0.9065, 'mean_acc': 0.8624}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9969, 'acc_0_1': 0.7989, 'acc_1_0': 0.7679, 'acc_1_1': 0.9688, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.937, 'worst_acc': 0.3991, 'acc_0_0': 0.953, 'acc_0_1': 0.3991, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.725}
Test(class): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.4124, 'acc_0_0': 0.9619, 'acc_0_1': 0.4124, 'acc_1_0': 0.7586, 'acc_1_1': 0.9766, 'mean_acc': 0.7271}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9957, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6308, 'acc_0_0': 0.9863, 'acc_0_1': 0.6843, 'acc_1_0': 0.6308, 'acc_1_1': 0.9299, 'mean_acc': 0.8231}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.8326, 'acc_1_0': 0.6418, 'acc_1_1': 0.8939, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6371, 'acc_0_0': 0.984, 'acc_0_1': 0.8106, 'acc_1_0': 0.6371, 'acc_1_1': 0.9003, 'mean_acc': 0.8688}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8767}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5187, 'acc_0_0': 0.9951, 'acc_0_1': 0.82, 'acc_1_0': 0.5187, 'acc_1_1': 0.8801, 'mean_acc': 0.8614}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9963, 'acc_0_1': 0.8533, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.648, 'acc_0_0': 0.9889, 'acc_0_1': 0.6812, 'acc_1_0': 0.648, 'acc_1_1': 0.9455, 'mean_acc': 0.8265}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7983, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5125, 'acc_0_0': 0.9947, 'acc_0_1': 0.78, 'acc_1_0': 0.5125, 'acc_1_1': 0.8925, 'mean_acc': 0.8464}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7897, 'acc_1_0': 0.5522, 'acc_1_1': 0.8939, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7973, 'acc_1_0': 0.5981, 'acc_1_1': 0.9237, 'mean_acc': 0.8645}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9951, 'acc_0_1': 0.8641, 'acc_1_0': 0.8929, 'acc_1_1': 0.9707, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5841, 'acc_0_0': 0.9894, 'acc_0_1': 0.6497, 'acc_1_0': 0.5841, 'acc_1_1': 0.9393, 'mean_acc': 0.8067}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9971, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.9735, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9513, 'worst_acc': 0.6309, 'acc_0_0': 0.9615, 'acc_0_1': 0.6309, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6071, 'acc_0_0': 0.9818, 'acc_0_1': 0.6071, 'acc_1_0': 0.6573, 'acc_1_1': 0.9517, 'mean_acc': 0.7967}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.983, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.897, 'acc_1_0': 0.5224, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.5374, 'acc_0_0': 0.9911, 'acc_0_1': 0.8701, 'acc_1_0': 0.5374, 'acc_1_1': 0.8676, 'mean_acc': 0.88}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9974, 'acc_0_1': 0.8696, 'acc_1_0': 0.7857, 'acc_1_1': 0.9792, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9662, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6526, 'acc_0_0': 0.9863, 'acc_0_1': 0.7286, 'acc_1_0': 0.6526, 'acc_1_1': 0.9393, 'mean_acc': 0.8438}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9977, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9792, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5193, 'acc_0_0': 0.9744, 'acc_0_1': 0.5193, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7683}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5202, 'acc_0_0': 0.9787, 'acc_0_1': 0.5202, 'acc_1_0': 0.6682, 'acc_1_1': 0.9704, 'mean_acc': 0.7649}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6293, 'acc_0_0': 0.9814, 'acc_0_1': 0.6971, 'acc_1_0': 0.6293, 'acc_1_1': 0.933, 'mean_acc': 0.8264}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9966, 'acc_0_1': 0.8967, 'acc_1_0': 0.8214, 'acc_1_1': 0.964, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.3433, 'acc_0_0': 0.9359, 'acc_0_1': 0.3433, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.3512, 'acc_0_0': 0.949, 'acc_0_1': 0.3512, 'acc_1_0': 0.8084, 'acc_1_1': 0.9782, 'mean_acc': 0.704}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9886, 'acc_0_1': 0.788, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7768, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5576, 'acc_0_0': 0.9907, 'acc_0_1': 0.7486, 'acc_1_0': 0.5576, 'acc_1_1': 0.9143, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9957, 'acc_0_1': 0.7989, 'acc_1_0': 0.6607, 'acc_1_1': 0.948, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5224, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5748, 'acc_0_0': 0.9894, 'acc_0_1': 0.6754, 'acc_1_0': 0.5748, 'acc_1_1': 0.9377, 'mean_acc': 0.8155}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9934, 'acc_0_1': 0.7826, 'acc_1_0': 0.7679, 'acc_1_1': 0.9782, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.4421, 'acc_0_0': 0.9444, 'acc_0_1': 0.4421, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9431, 'worst_acc': 0.4705, 'acc_0_0': 0.9619, 'acc_0_1': 0.4705, 'acc_1_0': 0.7523, 'acc_1_1': 0.9735, 'mean_acc': 0.7487}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9909, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8712, 'acc_1_0': 0.3731, 'acc_1_1': 0.8939, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.4548, 'acc_0_0': 0.9978, 'acc_0_1': 0.8559, 'acc_1_0': 0.4548, 'acc_1_1': 0.866, 'mean_acc': 0.8678}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.8207, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7682, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.7494, 'acc_1_0': 0.6153, 'acc_1_1': 0.9252, 'mean_acc': 0.8476}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9957, 'acc_0_1': 0.8804, 'acc_1_0': 0.7857, 'acc_1_1': 0.9669, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6137, 'acc_0_0': 0.9744, 'acc_0_1': 0.6137, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.5978, 'acc_0_0': 0.9836, 'acc_0_1': 0.5978, 'acc_1_0': 0.634, 'acc_1_1': 0.9517, 'mean_acc': 0.7912}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.996, 'acc_0_1': 0.8478, 'acc_1_0': 0.8393, 'acc_1_1': 0.9726, 'mean_acc': 0.9833}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.609, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8153}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6028, 'acc_0_0': 0.9902, 'acc_0_1': 0.6927, 'acc_1_0': 0.6028, 'acc_1_1': 0.9361, 'mean_acc': 0.8255}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9946, 'acc_0_1': 0.8967, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.929, 'worst_acc': 0.4464, 'acc_0_0': 0.9402, 'acc_0_1': 0.4464, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.431, 'acc_0_0': 0.9455, 'acc_0_1': 0.431, 'acc_1_0': 0.7648, 'acc_1_1': 0.9782, 'mean_acc': 0.7289}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.6563, 'acc_1_0': 0.609, 'acc_1_1': 0.9439, 'mean_acc': 0.8134}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9957, 'acc_0_1': 0.8696, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5156, 'acc_0_0': 0.9956, 'acc_0_1': 0.8089, 'acc_1_0': 0.5156, 'acc_1_1': 0.8863, 'mean_acc': 0.8576}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9974, 'acc_0_1': 0.875, 'acc_1_0': 0.9464, 'acc_1_1': 0.9868, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.7164, 'acc_0_0': 0.9786, 'acc_0_1': 0.7296, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6745, 'acc_0_0': 0.9783, 'acc_0_1': 0.7073, 'acc_1_0': 0.6745, 'acc_1_1': 0.9393, 'mean_acc': 0.8348}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.9022, 'acc_1_0': 0.8214, 'acc_1_1': 0.9896, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6738, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6231, 'acc_0_0': 0.9916, 'acc_0_1': 0.6443, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8095}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9313, 'acc_0_1': 0.8326, 'acc_1_0': 0.6667, 'acc_1_1': 0.7015, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.7884, 'worst_acc': 0.1212, 'acc_0_0': 0.9829, 'acc_0_1': 0.9914, 'acc_1_0': 0.5672, 'acc_1_1': 0.1212, 'mean_acc': 0.845}
Test(class)(new adapter): {'weighted_mean_acc': 0.7908, 'worst_acc': 0.1184, 'acc_0_0': 0.9854, 'acc_0_1': 0.9978, 'acc_1_0': 0.6495, 'acc_1_1': 0.1184, 'mean_acc': 0.8569}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3636, 'acc_0_0': 0.8798, 'acc_0_1': 0.7082, 'acc_1_0': 0.3636, 'acc_1_1': 0.7164, 'mean_acc': 0.7379}
Val(class)(new adapter): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.4034, 'acc_0_0': 0.9829, 'acc_0_1': 0.4034, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.71}
Test(class)(new adapter): {'weighted_mean_acc': 0.959, 'worst_acc': 0.4164, 'acc_0_0': 0.9911, 'acc_0_1': 0.4164, 'acc_1_0': 0.6059, 'acc_1_1': 0.9657, 'mean_acc': 0.722}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5909, 'acc_0_0': 0.9871, 'acc_0_1': 0.867, 'acc_1_0': 0.5909, 'acc_1_1': 0.9104, 'mean_acc': 0.8881}
Val(class)(new adapter): {'weighted_mean_acc': 0.8435, 'worst_acc': 0.5152, 'acc_0_0': 0.9359, 'acc_0_1': 0.9742, 'acc_1_0': 0.8358, 'acc_1_1': 0.5152, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8316, 'worst_acc': 0.4393, 'acc_0_0': 0.9428, 'acc_0_1': 0.9738, 'acc_1_0': 0.8209, 'acc_1_1': 0.4393, 'mean_acc': 0.8856}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.209, 'acc_0_0': 0.8026, 'acc_0_1': 0.9356, 'acc_1_0': 0.9394, 'acc_1_1': 0.209, 'mean_acc': 0.803}
Val(class)(new adapter): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.7761, 'acc_0_0': 0.9701, 'acc_0_1': 0.8798, 'acc_1_0': 0.7761, 'acc_1_1': 0.9545, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.7866, 'acc_0_0': 0.969, 'acc_0_1': 0.8519, 'acc_1_0': 0.7866, 'acc_1_1': 0.905, 'mean_acc': 0.8961}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9785, 'acc_0_1': 0.9313, 'acc_1_0': 0.7121, 'acc_1_1': 0.9403, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.7463, 'acc_0_0': 0.9786, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.9242, 'mean_acc': 0.9333}
Test(class)(new adapter): {'weighted_mean_acc': 0.9465, 'worst_acc': 0.7352, 'acc_0_0': 0.9818, 'acc_0_1': 0.9348, 'acc_1_0': 0.7352, 'acc_1_1': 0.8427, 'mean_acc': 0.9208}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.8927, 'acc_0_1': 0.9571, 'acc_1_0': 0.7273, 'acc_1_1': 0.806, 'mean_acc': 0.8898}
Val(class)(new adapter): {'weighted_mean_acc': 0.9441, 'worst_acc': 0.8197, 'acc_0_0': 0.9444, 'acc_0_1': 0.8197, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.8208, 'acc_0_0': 0.9326, 'acc_0_1': 0.8208, 'acc_1_0': 0.852, 'acc_1_1': 0.9174, 'mean_acc': 0.8785}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9828, 'acc_0_1': 0.9614, 'acc_1_0': 0.8636, 'acc_1_1': 0.9403, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.697, 'acc_0_0': 0.9573, 'acc_0_1': 0.97, 'acc_1_0': 0.7463, 'acc_1_1': 0.697, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8992, 'worst_acc': 0.6371, 'acc_0_0': 0.9774, 'acc_0_1': 0.9756, 'acc_1_0': 0.7087, 'acc_1_1': 0.6371, 'mean_acc': 0.9092}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.8841, 'acc_0_1': 0.9142, 'acc_1_0': 0.803, 'acc_1_1': 0.6418, 'mean_acc': 0.8598}
Val(class)(new adapter): {'weighted_mean_acc': 0.9383, 'worst_acc': 0.7511, 'acc_0_0': 0.9444, 'acc_0_1': 0.7511, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.753, 'acc_0_0': 0.9295, 'acc_0_1': 0.753, 'acc_1_0': 0.8442, 'acc_1_1': 0.9361, 'mean_acc': 0.8521}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9957, 'acc_0_1': 0.9485, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.8912, 'worst_acc': 0.6515, 'acc_0_0': 0.9615, 'acc_0_1': 0.9657, 'acc_1_0': 0.7761, 'acc_1_1': 0.6515, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8843, 'worst_acc': 0.5935, 'acc_0_0': 0.9685, 'acc_0_1': 0.9823, 'acc_1_0': 0.7897, 'acc_1_1': 0.5935, 'mean_acc': 0.9125}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9485, 'acc_0_1': 0.897, 'acc_1_0': 0.7576, 'acc_1_1': 0.806, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.896, 'worst_acc': 0.7897, 'acc_0_0': 0.8846, 'acc_0_1': 0.7897, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class)(new adapter): {'weighted_mean_acc': 0.877, 'worst_acc': 0.8013, 'acc_0_0': 0.8696, 'acc_0_1': 0.8013, 'acc_1_0': 0.8785, 'acc_1_1': 0.9143, 'mean_acc': 0.849}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9657, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.867, 'worst_acc': 0.5758, 'acc_0_0': 0.953, 'acc_0_1': 0.97, 'acc_1_0': 0.6567, 'acc_1_1': 0.5758, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8611, 'worst_acc': 0.5312, 'acc_0_0': 0.957, 'acc_0_1': 0.98, 'acc_1_0': 0.7103, 'acc_1_1': 0.5312, 'mean_acc': 0.8914}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9571, 'acc_0_1': 0.9614, 'acc_1_0': 0.9394, 'acc_1_1': 0.8955, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.9785, 'acc_1_0': 0.6716, 'acc_1_1': 0.7273, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.8913, 'worst_acc': 0.5903, 'acc_0_0': 0.9805, 'acc_0_1': 0.9818, 'acc_1_0': 0.704, 'acc_1_1': 0.5903, 'mean_acc': 0.9071}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.8584, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.8271, 'acc_0_0': 0.9406, 'acc_0_1': 0.8807, 'acc_1_0': 0.8271, 'acc_1_1': 0.8754, 'mean_acc': 0.8975}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7227, 'acc_0_0': 0.9525, 'acc_0_1': 0.9494, 'acc_1_0': 0.7227, 'acc_1_1': 0.7352, 'mean_acc': 0.9018}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.8927, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.8271, 'acc_0_0': 0.9224, 'acc_0_1': 0.8816, 'acc_1_0': 0.8271, 'acc_1_1': 0.8489, 'mean_acc': 0.8878}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.8026, 'acc_0_0': 0.9103, 'acc_0_1': 0.8026, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.8862, 'worst_acc': 0.7987, 'acc_0_0': 0.8829, 'acc_0_1': 0.7987, 'acc_1_0': 0.8801, 'acc_1_1': 0.9128, 'mean_acc': 0.8531}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9283, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.9657, 'acc_1_0': 0.597, 'acc_1_1': 0.7727, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8911, 'worst_acc': 0.5903, 'acc_0_0': 0.9818, 'acc_0_1': 0.9783, 'acc_1_0': 0.6121, 'acc_1_1': 0.5903, 'mean_acc': 0.8961}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9871, 'acc_0_1': 0.9571, 'acc_1_0': 0.9545, 'acc_1_1': 0.8657, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.4925, 'acc_0_0': 0.9829, 'acc_0_1': 0.9657, 'acc_1_0': 0.4925, 'acc_1_1': 0.697, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.5389, 'acc_0_0': 0.9894, 'acc_0_1': 0.9707, 'acc_1_0': 0.5389, 'acc_1_1': 0.5841, 'mean_acc': 0.8873}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.803, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7383, 'acc_0_0': 0.9557, 'acc_0_1': 0.9499, 'acc_1_0': 0.7477, 'acc_1_1': 0.7383, 'mean_acc': 0.9063}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.9356, 'acc_0_1': 0.9313, 'acc_1_0': 0.8485, 'acc_1_1': 0.7761, 'mean_acc': 0.9065}
Val(class)(new adapter): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.8712, 'acc_1_0': 0.7164, 'acc_1_1': 0.9394, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.715, 'acc_0_0': 0.9747, 'acc_0_1': 0.8812, 'acc_1_0': 0.715, 'acc_1_1': 0.8645, 'mean_acc': 0.8973}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.8333, 'acc_1_1': 0.8507, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.8627, 'acc_0_0': 0.8889, 'acc_0_1': 0.8627, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8858, 'worst_acc': 0.8687, 'acc_0_0': 0.8834, 'acc_0_1': 0.8687, 'acc_1_0': 0.8801, 'acc_1_1': 0.8972, 'mean_acc': 0.8788}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9399, 'acc_0_1': 0.9485, 'acc_1_0': 0.9242, 'acc_1_1': 0.8955, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9433, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.7554, 'acc_1_0': 0.7463, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class)(new adapter): {'weighted_mean_acc': 0.9426, 'worst_acc': 0.7492, 'acc_0_0': 0.9605, 'acc_0_1': 0.7969, 'acc_1_0': 0.7492, 'acc_1_1': 0.919, 'mean_acc': 0.8688}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.8825, 'worst_acc': 0.7121, 'acc_0_0': 0.9316, 'acc_0_1': 0.97, 'acc_1_0': 0.7463, 'acc_1_1': 0.7121, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8708, 'worst_acc': 0.6199, 'acc_0_0': 0.9419, 'acc_0_1': 0.9814, 'acc_1_0': 0.7991, 'acc_1_1': 0.6199, 'mean_acc': 0.9058}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.8358, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.6867, 'acc_0_0': 0.9188, 'acc_0_1': 0.6867, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.6488, 'acc_0_0': 0.9233, 'acc_0_1': 0.6488, 'acc_1_0': 0.8551, 'acc_1_1': 0.9564, 'mean_acc': 0.8126}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9528, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.8719, 'worst_acc': 0.6667, 'acc_0_0': 0.9316, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.6667, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8748, 'worst_acc': 0.5903, 'acc_0_0': 0.9579, 'acc_0_1': 0.9707, 'acc_1_0': 0.7414, 'acc_1_1': 0.5903, 'mean_acc': 0.8982}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9571, 'acc_0_1': 0.97, 'acc_1_0': 0.9545, 'acc_1_1': 0.8806, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.8755, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.8006, 'acc_0_0': 0.9384, 'acc_0_1': 0.8785, 'acc_1_0': 0.8006, 'acc_1_1': 0.852, 'mean_acc': 0.8902}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7313, 'acc_0_0': 0.9615, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7586, 'acc_0_0': 0.9627, 'acc_0_1': 0.9224, 'acc_1_0': 0.7586, 'acc_1_1': 0.785, 'mean_acc': 0.9047}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.867, 'acc_0_1': 0.8541, 'acc_1_0': 0.7424, 'acc_1_1': 0.9552, 'mean_acc': 0.8581}
Val(class)(new adapter): {'weighted_mean_acc': 0.8395, 'worst_acc': 0.588, 'acc_0_0': 0.812, 'acc_0_1': 0.588, 'acc_1_0': 0.9254, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class)(new adapter): {'weighted_mean_acc': 0.8263, 'worst_acc': 0.5743, 'acc_0_0': 0.7947, 'acc_0_1': 0.5743, 'acc_1_0': 0.9081, 'acc_1_1': 0.9704, 'mean_acc': 0.7409}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.7424, 'acc_1_1': 0.8955, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.8816, 'worst_acc': 0.8333, 'acc_0_0': 0.8932, 'acc_0_1': 0.9399, 'acc_1_0': 0.8806, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8719, 'worst_acc': 0.7913, 'acc_0_0': 0.8927, 'acc_0_1': 0.937, 'acc_1_0': 0.8801, 'acc_1_1': 0.7913, 'mean_acc': 0.8973}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9442, 'acc_0_1': 0.9614, 'acc_1_0': 0.9091, 'acc_1_1': 0.8358, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.7677, 'worst_acc': 0.485, 'acc_0_0': 0.7094, 'acc_0_1': 0.485, 'acc_1_0': 0.9552, 'acc_1_1': 1.0, 'mean_acc': 0.6817}
Test(class)(new adapter): {'weighted_mean_acc': 0.7526, 'worst_acc': 0.4971, 'acc_0_0': 0.6953, 'acc_0_1': 0.4971, 'acc_1_0': 0.9424, 'acc_1_1': 0.9766, 'mean_acc': 0.6767}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.97, 'acc_0_1': 0.9227, 'acc_1_0': 0.9394, 'acc_1_1': 0.8955, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.88, 'worst_acc': 0.5758, 'acc_0_0': 0.9701, 'acc_0_1': 0.9871, 'acc_1_0': 0.6418, 'acc_1_1': 0.5758, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8707, 'worst_acc': 0.4969, 'acc_0_0': 0.9805, 'acc_0_1': 0.9876, 'acc_1_0': 0.6838, 'acc_1_1': 0.4969, 'mean_acc': 0.8968}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9657, 'acc_0_1': 0.9185, 'acc_1_0': 0.697, 'acc_1_1': 0.8209, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7725, 'acc_0_0': 0.9231, 'acc_0_1': 0.7725, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7747, 'acc_0_0': 0.9073, 'acc_0_1': 0.7747, 'acc_1_0': 0.8629, 'acc_1_1': 0.9252, 'mean_acc': 0.8528}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9356, 'acc_0_0': 0.9742, 'acc_0_1': 0.9356, 'acc_1_0': 1.0, 'acc_1_1': 0.9552, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.8664, 'worst_acc': 0.5455, 'acc_0_0': 0.9615, 'acc_0_1': 0.9871, 'acc_1_0': 0.5821, 'acc_1_1': 0.5455, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8456, 'worst_acc': 0.4283, 'acc_0_0': 0.9676, 'acc_0_1': 0.9849, 'acc_1_0': 0.6402, 'acc_1_1': 0.4283, 'mean_acc': 0.8783}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.8333, 'acc_1_1': 0.806, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.8224, 'acc_0_0': 0.933, 'acc_0_1': 0.8927, 'acc_1_0': 0.8224, 'acc_1_1': 0.8567, 'mean_acc': 0.8966}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9828, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7726, 'acc_0_0': 0.9543, 'acc_0_1': 0.9268, 'acc_1_0': 0.7726, 'acc_1_1': 0.8022, 'mean_acc': 0.9066}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9301, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.796, 'acc_0_0': 0.9463, 'acc_0_1': 0.91, 'acc_1_0': 0.796, 'acc_1_1': 0.8193, 'mean_acc': 0.9014}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9828, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.8115, 'acc_0_0': 0.9406, 'acc_0_1': 0.9082, 'acc_1_0': 0.8115, 'acc_1_1': 0.8193, 'mean_acc': 0.9002}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.8006, 'acc_0_0': 0.9463, 'acc_0_1': 0.9224, 'acc_1_0': 0.8006, 'acc_1_1': 0.8069, 'mean_acc': 0.9054}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7928, 'acc_0_0': 0.9486, 'acc_0_1': 0.9282, 'acc_1_0': 0.7928, 'acc_1_1': 0.796, 'mean_acc': 0.9065}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7975, 'acc_0_0': 0.9437, 'acc_0_1': 0.9242, 'acc_1_0': 0.7975, 'acc_1_1': 0.7991, 'mean_acc': 0.9039}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7913, 'acc_0_0': 0.949, 'acc_0_1': 0.9273, 'acc_1_0': 0.7913, 'acc_1_1': 0.7944, 'mean_acc': 0.9059}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7975, 'acc_0_0': 0.9486, 'acc_0_1': 0.9286, 'acc_1_0': 0.7975, 'acc_1_1': 0.7975, 'mean_acc': 0.9073}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7788, 'acc_0_0': 0.9525, 'acc_0_1': 0.9344, 'acc_1_0': 0.7788, 'acc_1_1': 0.7944, 'mean_acc': 0.9087}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7991, 'acc_0_0': 0.9415, 'acc_0_1': 0.9273, 'acc_1_0': 0.8006, 'acc_1_1': 0.7991, 'mean_acc': 0.9046}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.8084, 'acc_0_0': 0.9361, 'acc_0_1': 0.9149, 'acc_1_0': 0.8115, 'acc_1_1': 0.8084, 'mean_acc': 0.8999}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7991, 'acc_0_0': 0.9428, 'acc_0_1': 0.9246, 'acc_1_0': 0.7991, 'acc_1_1': 0.8022, 'mean_acc': 0.9042}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9274, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7975, 'acc_0_0': 0.9432, 'acc_0_1': 0.9259, 'acc_1_0': 0.7975, 'acc_1_1': 0.7991, 'mean_acc': 0.9044}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7913, 'acc_0_0': 0.9463, 'acc_0_1': 0.9313, 'acc_1_0': 0.796, 'acc_1_1': 0.7913, 'mean_acc': 0.9066}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7913, 'acc_0_0': 0.9472, 'acc_0_1': 0.9313, 'acc_1_0': 0.7928, 'acc_1_1': 0.7913, 'mean_acc': 0.9066}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7741, 'acc_0_0': 0.9543, 'acc_0_1': 0.9357, 'acc_1_0': 0.7773, 'acc_1_1': 0.7741, 'mean_acc': 0.9075}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.785, 'acc_0_0': 0.9486, 'acc_0_1': 0.9344, 'acc_1_0': 0.7866, 'acc_1_1': 0.785, 'mean_acc': 0.907}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7897, 'acc_0_0': 0.9446, 'acc_0_1': 0.9299, 'acc_1_0': 0.796, 'acc_1_1': 0.7897, 'mean_acc': 0.9052}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7726, 'acc_0_0': 0.9539, 'acc_0_1': 0.9366, 'acc_1_0': 0.7773, 'acc_1_1': 0.7726, 'mean_acc': 0.9075}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.757, 'acc_0_0': 0.9561, 'acc_0_1': 0.9397, 'acc_1_0': 0.771, 'acc_1_1': 0.757, 'mean_acc': 0.9071}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7866, 'acc_0_0': 0.949, 'acc_0_1': 0.9295, 'acc_1_0': 0.7866, 'acc_1_1': 0.7897, 'mean_acc': 0.9058}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7788, 'acc_0_0': 0.9503, 'acc_0_1': 0.9348, 'acc_1_0': 0.785, 'acc_1_1': 0.7788, 'mean_acc': 0.907}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.785, 'acc_0_0': 0.9481, 'acc_0_1': 0.9313, 'acc_1_0': 0.7897, 'acc_1_1': 0.785, 'mean_acc': 0.9059}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7695, 'acc_0_0': 0.9508, 'acc_0_1': 0.9361, 'acc_1_0': 0.7741, 'acc_1_1': 0.7695, 'mean_acc': 0.9054}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.785, 'acc_0_0': 0.949, 'acc_0_1': 0.9304, 'acc_1_0': 0.785, 'acc_1_1': 0.7882, 'mean_acc': 0.9058}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7788, 'acc_0_0': 0.9494, 'acc_0_1': 0.9348, 'acc_1_0': 0.7819, 'acc_1_1': 0.7788, 'mean_acc': 0.9063}
========================================================================
> end of training. 

best epoch : 61
best training accuracy on [class]: {'worst_acc': 0.8333, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.8333, 'acc_1_1': 0.8507, 'mean_acc': 0.9566}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8991, 'worst_acc': 0.8627, 'acc_0_0': 0.8889, 'acc_0_1': 0.8627, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
best test accuracy on [class]: {'weighted_mean_acc': 0.8858, 'worst_acc': 0.8687, 'acc_0_0': 0.8834, 'acc_0_1': 0.8687, 'acc_1_0': 0.8801, 'acc_1_1': 0.8972, 'mean_acc': 0.8788}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8858, 'worst_acc': 0.8687, 'acc_0_0': 0.8834, 'acc_0_1': 0.8687, 'acc_1_0': 0.8801, 'acc_1_1': 0.8972, 'mean_acc': 0.8788}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.4486, 'acc_0_0': 0.9579, 'acc_0_1': 0.9264, 'acc_1_0': 0.4486, 'acc_1_1': 0.9938, 'mean_acc': 0.8932}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 61': {'Train': {'worst_acc': 0.8333, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.8333, 'acc_1_1': 0.8507, 'mean_acc': 0.9566}, 'Val': {'weighted_mean_acc': 0.8991, 'worst_acc': 0.8627, 'acc_0_0': 0.8889, 'acc_0_1': 0.8627, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.885}, 'Test': {'weighted_mean_acc': 0.8858, 'worst_acc': 0.8687, 'acc_0_0': 0.8834, 'acc_0_1': 0.8687, 'acc_1_0': 0.8801, 'acc_1_1': 0.8972, 'mean_acc': 0.8788}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8858, 'worst_acc': 0.8687, 'acc_0_0': 0.8834, 'acc_0_1': 0.8687, 'acc_1_0': 0.8801, 'acc_1_1': 0.8972, 'mean_acc': 0.8788}, 'spurious': {'weighted_mean_acc': 0.9586, 'worst_acc': 0.4486, 'acc_0_0': 0.9579, 'acc_0_1': 0.9264, 'acc_1_0': 0.4486, 'acc_1_1': 0.9938, 'mean_acc': 0.8932}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.1786, 'acc_0_0': 0.9688, 'acc_0_1': 0.7609, 'acc_1_0': 0.1786, 'acc_1_1': 0.3453, 'mean_acc': 0.8142}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.2704, 'acc_0_0': 0.9829, 'acc_0_1': 0.2704, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.66}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.2554, 'acc_0_0': 0.9814, 'acc_0_1': 0.2554, 'acc_1_0': 0.5841, 'acc_1_1': 0.9657, 'mean_acc': 0.6531}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1576, 'acc_0_0': 0.9568, 'acc_0_1': 0.1576, 'acc_1_0': 0.6429, 'acc_1_1': 0.9763, 'mean_acc': 0.9268}
Val(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.3562, 'acc_0_0': 0.9829, 'acc_0_1': 0.3562, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6967}
Test(class): {'weighted_mean_acc': 0.9527, 'worst_acc': 0.329, 'acc_0_0': 0.9871, 'acc_0_1': 0.329, 'acc_1_0': 0.6012, 'acc_1_1': 0.9657, 'mean_acc': 0.6859}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.375, 'acc_0_0': 0.9977, 'acc_0_1': 0.7228, 'acc_1_0': 0.375, 'acc_1_1': 0.8761, 'mean_acc': 0.9531}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5125, 'acc_0_0': 0.9951, 'acc_0_1': 0.663, 'acc_1_0': 0.5125, 'acc_1_1': 0.9128, 'mean_acc': 0.8032}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9946, 'acc_0_1': 0.6033, 'acc_1_0': 0.5357, 'acc_1_1': 0.9272, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.3948, 'acc_0_0': 0.9915, 'acc_0_1': 0.3948, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7233}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.3871, 'acc_0_0': 0.9858, 'acc_0_1': 0.3871, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7147}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9886, 'acc_0_1': 0.4891, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9597}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7047, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8297}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9937, 'acc_0_1': 0.75, 'acc_1_0': 0.6607, 'acc_1_1': 0.9139, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7854, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.7508, 'acc_1_0': 0.6028, 'acc_1_1': 0.9143, 'mean_acc': 0.8469}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.9906, 'acc_0_1': 0.663, 'acc_1_0': 0.7321, 'acc_1_1': 0.9413, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7167, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6121, 'acc_0_0': 0.9933, 'acc_0_1': 0.7033, 'acc_1_0': 0.6121, 'acc_1_1': 0.9221, 'mean_acc': 0.8303}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9926, 'acc_0_1': 0.75, 'acc_1_0': 0.6964, 'acc_1_1': 0.9395, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7897, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6012, 'acc_0_0': 0.9938, 'acc_0_1': 0.7543, 'acc_1_0': 0.6012, 'acc_1_1': 0.9174, 'mean_acc': 0.8486}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9917, 'acc_0_1': 0.7228, 'acc_1_0': 0.75, 'acc_1_1': 0.9461, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7033, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8307}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9926, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9413, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7135, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8347}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9917, 'acc_0_1': 0.7446, 'acc_1_0': 0.6964, 'acc_1_1': 0.9565, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8283, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5545, 'acc_0_0': 0.9956, 'acc_0_1': 0.7982, 'acc_1_0': 0.5545, 'acc_1_1': 0.905, 'mean_acc': 0.8599}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9937, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9536, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.7255, 'acc_1_0': 0.5935, 'acc_1_1': 0.9252, 'mean_acc': 0.8371}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9946, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5857, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5857, 'acc_1_1': 0.919, 'mean_acc': 0.8554}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.994, 'acc_0_1': 0.7989, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.8018, 'acc_1_0': 0.567, 'acc_1_1': 0.9159, 'mean_acc': 0.8628}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9971, 'acc_0_1': 0.7935, 'acc_1_0': 0.7679, 'acc_1_1': 0.9546, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6528, 'acc_1_0': 0.6464, 'acc_1_1': 0.9408, 'mean_acc': 0.8145}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.8393, 'acc_1_1': 0.964, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.8326, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.8248, 'acc_1_0': 0.5935, 'acc_1_1': 0.9112, 'mean_acc': 0.8742}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9949, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.8498, 'acc_1_0': 0.5373, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5421, 'acc_0_0': 0.9965, 'acc_0_1': 0.8333, 'acc_1_0': 0.5421, 'acc_1_1': 0.9034, 'mean_acc': 0.8723}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.9603, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9761, 'worst_acc': 0.6996, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6869, 'acc_0_0': 0.9867, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9393, 'mean_acc': 0.8321}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.875, 'acc_1_1': 0.9726, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.7015, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.6869, 'acc_0_0': 0.9871, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.8333}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.8804, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9769, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5903, 'acc_0_0': 0.9938, 'acc_0_1': 0.788, 'acc_1_0': 0.5903, 'acc_1_1': 0.9174, 'mean_acc': 0.8605}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.998, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.9877, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9782, 'worst_acc': 0.6418, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6433, 'acc_0_0': 0.9929, 'acc_0_1': 0.8053, 'acc_1_0': 0.6433, 'acc_1_1': 0.9128, 'mean_acc': 0.8723}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9782, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6953, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6636, 'acc_0_0': 0.988, 'acc_0_1': 0.6767, 'acc_1_0': 0.6636, 'acc_1_1': 0.9424, 'mean_acc': 0.8259}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9858, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.7468, 'acc_0_0': 0.9829, 'acc_0_1': 0.7468, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.7103, 'acc_0_0': 0.9823, 'acc_0_1': 0.7459, 'acc_1_0': 0.7103, 'acc_1_1': 0.9268, 'mean_acc': 0.854}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9754, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9814, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.8155, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.5654, 'acc_0_0': 0.996, 'acc_0_1': 0.8257, 'acc_1_0': 0.5654, 'acc_1_1': 0.8769, 'mean_acc': 0.8688}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9969, 'acc_0_1': 0.9076, 'acc_1_0': 0.9107, 'acc_1_1': 0.9792, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6293, 'acc_0_0': 0.9849, 'acc_0_1': 0.7157, 'acc_1_0': 0.6293, 'acc_1_1': 0.9206, 'mean_acc': 0.8336}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9969, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9688, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.6223, 'acc_0_0': 0.9658, 'acc_0_1': 0.6223, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.6137, 'acc_0_0': 0.9747, 'acc_0_1': 0.6137, 'acc_1_0': 0.6807, 'acc_1_1': 0.9424, 'mean_acc': 0.7981}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9971, 'acc_0_1': 0.8152, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5452, 'acc_0_0': 0.9933, 'acc_0_1': 0.8009, 'acc_1_0': 0.5452, 'acc_1_1': 0.8879, 'mean_acc': 0.8571}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9926, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9527, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8617}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5327, 'acc_0_0': 0.9942, 'acc_0_1': 0.7827, 'acc_1_0': 0.5327, 'acc_1_1': 0.9143, 'mean_acc': 0.8519}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9957, 'acc_0_1': 0.875, 'acc_1_0': 0.8036, 'acc_1_1': 0.9631, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.515, 'acc_0_0': 0.9829, 'acc_0_1': 0.515, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5401, 'acc_0_0': 0.9876, 'acc_0_1': 0.5401, 'acc_1_0': 0.6526, 'acc_1_1': 0.9486, 'mean_acc': 0.772}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8424, 'acc_1_0': 0.8393, 'acc_1_1': 0.9782, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6953, 'acc_0_0': 0.9744, 'acc_0_1': 0.6953, 'acc_1_0': 0.7761, 'acc_1_1': 0.9848, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.6851, 'acc_0_0': 0.9756, 'acc_0_1': 0.6851, 'acc_1_0': 0.743, 'acc_1_1': 0.9455, 'mean_acc': 0.8334}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9983, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.983, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.5171, 'acc_0_0': 0.9951, 'acc_0_1': 0.8537, 'acc_1_0': 0.5171, 'acc_1_1': 0.8956, 'mean_acc': 0.8761}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9963, 'acc_0_1': 0.8967, 'acc_1_0': 0.9107, 'acc_1_1': 0.9754, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.8627, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.8647, 'acc_1_0': 0.6012, 'acc_1_1': 0.8769, 'mean_acc': 0.8866}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9983, 'acc_0_1': 0.8804, 'acc_1_0': 0.9464, 'acc_1_1': 0.9735, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.8111, 'acc_1_0': 0.6153, 'acc_1_1': 0.8941, 'mean_acc': 0.8687}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.875, 'acc_1_0': 0.9821, 'acc_1_1': 0.9763, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.8106, 'acc_1_0': 0.6028, 'acc_1_1': 0.9003, 'mean_acc': 0.8687}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.6866, 'acc_0_0': 0.9786, 'acc_0_1': 0.6953, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.6542, 'acc_0_0': 0.9778, 'acc_0_1': 0.7251, 'acc_1_0': 0.6542, 'acc_1_1': 0.9252, 'mean_acc': 0.8378}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9977, 'acc_0_1': 0.9565, 'acc_1_0': 0.9464, 'acc_1_1': 0.9877, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.5224, 'acc_1_1': 0.9091, 'mean_acc': 0.86}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8084, 'acc_1_0': 0.5779, 'acc_1_1': 0.905, 'mean_acc': 0.865}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.9457, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.99}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.4635, 'acc_0_0': 0.9829, 'acc_0_1': 0.4635, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7433}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4692, 'acc_0_0': 0.9871, 'acc_0_1': 0.4692, 'acc_1_0': 0.6449, 'acc_1_1': 0.9673, 'mean_acc': 0.7454}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9946, 'acc_0_1': 0.7989, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5218, 'acc_0_0': 0.9951, 'acc_0_1': 0.8319, 'acc_1_0': 0.5218, 'acc_1_1': 0.8879, 'mean_acc': 0.8673}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.9022, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.4328, 'acc_0_0': 0.9957, 'acc_0_1': 0.8326, 'acc_1_0': 0.4328, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.4922, 'acc_0_0': 0.9938, 'acc_0_1': 0.855, 'acc_1_0': 0.4922, 'acc_1_1': 0.8769, 'mean_acc': 0.8712}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8696, 'acc_1_0': 0.8393, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3863, 'acc_0_0': 0.9701, 'acc_0_1': 0.3863, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7217}
Test(class): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.3951, 'acc_0_0': 0.969, 'acc_0_1': 0.3951, 'acc_1_0': 0.7165, 'acc_1_1': 0.972, 'mean_acc': 0.718}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9614, 'acc_0_1': 0.8455, 'acc_1_0': 0.6061, 'acc_1_1': 0.7313, 'mean_acc': 0.8514}
Val(class)(new adapter): {'weighted_mean_acc': 0.8549, 'worst_acc': 0.8462, 'acc_0_0': 0.8462, 'acc_0_1': 0.867, 'acc_1_0': 0.9104, 'acc_1_1': 0.8788, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.8469, 'worst_acc': 0.843, 'acc_0_0': 0.847, 'acc_0_1': 0.843, 'acc_1_0': 0.905, 'acc_1_1': 0.8442, 'mean_acc': 0.8516}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4697, 'acc_0_0': 0.8927, 'acc_0_1': 0.8112, 'acc_1_0': 0.4697, 'acc_1_1': 0.806, 'mean_acc': 0.8047}
Val(class)(new adapter): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.4506, 'acc_0_0': 0.9786, 'acc_0_1': 0.4506, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.745}
Test(class)(new adapter): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.408, 'acc_0_0': 0.9827, 'acc_0_1': 0.408, 'acc_1_0': 0.7087, 'acc_1_1': 0.9657, 'mean_acc': 0.7268}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9657, 'acc_0_1': 0.9056, 'acc_1_0': 0.7121, 'acc_1_1': 0.7612, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.8555, 'worst_acc': 0.8504, 'acc_0_0': 0.8504, 'acc_0_1': 0.8884, 'acc_1_0': 0.9104, 'acc_1_1': 0.8636, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8472, 'worst_acc': 0.8162, 'acc_0_0': 0.8537, 'acc_0_1': 0.8843, 'acc_1_0': 0.9034, 'acc_1_1': 0.8162, 'mean_acc': 0.8669}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3433, 'acc_0_0': 0.8541, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.3433, 'mean_acc': 0.8247}
Val(class)(new adapter): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6996, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.7313, 'acc_1_1': 0.9697, 'mean_acc': 0.845}
Test(class)(new adapter): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.7055, 'acc_0_0': 0.9818, 'acc_0_1': 0.7055, 'acc_1_0': 0.7368, 'acc_1_1': 0.9408, 'mean_acc': 0.8426}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9957, 'acc_0_1': 0.8927, 'acc_1_0': 0.6061, 'acc_1_1': 0.8955, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.806, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9251, 'worst_acc': 0.796, 'acc_0_0': 0.9654, 'acc_0_1': 0.9357, 'acc_1_0': 0.8131, 'acc_1_1': 0.796, 'mean_acc': 0.9182}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.8283, 'acc_0_1': 0.9399, 'acc_1_0': 0.9091, 'acc_1_1': 0.7761, 'mean_acc': 0.8748}
Val(class)(new adapter): {'weighted_mean_acc': 0.9514, 'worst_acc': 0.8209, 'acc_0_0': 0.9615, 'acc_0_1': 0.867, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9468, 'worst_acc': 0.8178, 'acc_0_0': 0.9659, 'acc_0_1': 0.8639, 'acc_1_0': 0.8178, 'acc_1_1': 0.905, 'mean_acc': 0.903}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.803, 'acc_1_1': 0.9552, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.97, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9301, 'worst_acc': 0.7866, 'acc_0_0': 0.9747, 'acc_0_1': 0.9486, 'acc_1_0': 0.7897, 'acc_1_1': 0.7866, 'mean_acc': 0.9232}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9614, 'acc_0_1': 0.9785, 'acc_1_0': 0.7121, 'acc_1_1': 0.7612, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7425, 'acc_0_0': 0.9188, 'acc_0_1': 0.7425, 'acc_1_0': 0.8358, 'acc_1_1': 0.9848, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7432, 'acc_0_0': 0.9202, 'acc_0_1': 0.7432, 'acc_1_0': 0.8769, 'acc_1_1': 0.9424, 'mean_acc': 0.849}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.97, 'acc_0_1': 0.9528, 'acc_1_0': 0.8485, 'acc_1_1': 0.8806, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.9742, 'acc_1_0': 0.6716, 'acc_1_1': 0.803, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7072, 'acc_0_0': 0.9898, 'acc_0_1': 0.9707, 'acc_1_0': 0.7072, 'acc_1_1': 0.7336, 'mean_acc': 0.9227}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.9785, 'acc_0_1': 0.9614, 'acc_1_0': 0.8788, 'acc_1_1': 0.791, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8155, 'acc_0_0': 0.906, 'acc_0_1': 0.8155, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.8151, 'acc_0_0': 0.9366, 'acc_0_1': 0.8151, 'acc_1_0': 0.8614, 'acc_1_1': 0.9034, 'mean_acc': 0.8773}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.8824, 'worst_acc': 0.7273, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.7273, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8893, 'worst_acc': 0.6916, 'acc_0_0': 0.9459, 'acc_0_1': 0.9681, 'acc_1_0': 0.8271, 'acc_1_1': 0.6916, 'mean_acc': 0.9132}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9614, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.8955, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.9056, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.743, 'acc_0_0': 0.9876, 'acc_0_1': 0.8971, 'acc_1_0': 0.743, 'acc_1_1': 0.8738, 'mean_acc': 0.9127}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.8, 'worst_acc': 0.7424, 'acc_0_0': 0.812, 'acc_0_1': 0.897, 'acc_1_0': 0.8209, 'acc_1_1': 0.7424, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.798, 'worst_acc': 0.676, 'acc_0_0': 0.8275, 'acc_0_1': 0.9091, 'acc_1_0': 0.8941, 'acc_1_1': 0.676, 'mean_acc': 0.8498}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9227, 'acc_0_1': 0.8927, 'acc_1_0': 0.8485, 'acc_1_1': 0.7313, 'mean_acc': 0.8815}
Val(class)(new adapter): {'weighted_mean_acc': 0.9449, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.9399, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9412, 'worst_acc': 0.7118, 'acc_0_0': 0.9845, 'acc_0_1': 0.9428, 'acc_1_0': 0.7118, 'acc_1_1': 0.81, 'mean_acc': 0.9187}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8789, 'worst_acc': 0.8182, 'acc_0_0': 0.8974, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.8182, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8815, 'worst_acc': 0.824, 'acc_0_0': 0.8976, 'acc_0_1': 0.9064, 'acc_1_0': 0.8847, 'acc_1_1': 0.824, 'mean_acc': 0.8914}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9614, 'acc_0_1': 0.9742, 'acc_1_0': 0.9242, 'acc_1_1': 0.8806, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8746, 'worst_acc': 0.721, 'acc_0_0': 0.8632, 'acc_0_1': 0.721, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8167}
Test(class)(new adapter): {'weighted_mean_acc': 0.8872, 'worst_acc': 0.7286, 'acc_0_0': 0.8807, 'acc_0_1': 0.7286, 'acc_1_0': 0.8925, 'acc_1_1': 0.9361, 'mean_acc': 0.829}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.97, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.851, 'worst_acc': 0.4091, 'acc_0_0': 0.9829, 'acc_0_1': 0.9914, 'acc_1_0': 0.4925, 'acc_1_1': 0.4091, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8515, 'worst_acc': 0.3801, 'acc_0_0': 0.9916, 'acc_0_1': 0.9929, 'acc_1_0': 0.5327, 'acc_1_1': 0.3801, 'mean_acc': 0.8735}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9871, 'acc_0_1': 0.9657, 'acc_1_0': 0.8485, 'acc_1_1': 0.8507, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.8507, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.8505, 'acc_0_0': 0.9397, 'acc_0_1': 0.9033, 'acc_1_0': 0.8505, 'acc_1_1': 0.8567, 'mean_acc': 0.9065}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9342, 'worst_acc': 0.7761, 'acc_0_0': 0.9658, 'acc_0_1': 0.9614, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9283}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7445, 'acc_0_0': 0.9645, 'acc_0_1': 0.9667, 'acc_1_0': 0.7788, 'acc_1_1': 0.7445, 'mean_acc': 0.9204}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.9742, 'acc_1_0': 0.7015, 'acc_1_1': 0.7879, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.6822, 'acc_0_0': 0.9894, 'acc_0_1': 0.9721, 'acc_1_0': 0.6822, 'acc_1_1': 0.7196, 'mean_acc': 0.9187}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9742, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7227, 'acc_0_0': 0.9774, 'acc_0_1': 0.9698, 'acc_1_0': 0.7274, 'acc_1_1': 0.7227, 'mean_acc': 0.9185}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.97, 'acc_1_0': 0.7612, 'acc_1_1': 0.803, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.6713, 'acc_0_0': 0.9663, 'acc_0_1': 0.9778, 'acc_1_0': 0.7414, 'acc_1_1': 0.6713, 'mean_acc': 0.9132}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.8999, 'worst_acc': 0.7383, 'acc_0_0': 0.9481, 'acc_0_1': 0.9441, 'acc_1_0': 0.7944, 'acc_1_1': 0.7383, 'mean_acc': 0.9063}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 0.97, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8782, 'worst_acc': 0.7463, 'acc_0_0': 0.9103, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.7727, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.865, 'worst_acc': 0.7227, 'acc_0_0': 0.9078, 'acc_0_1': 0.8993, 'acc_1_0': 0.7648, 'acc_1_1': 0.7227, 'mean_acc': 0.8681}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.8275, 'worst_acc': 0.7124, 'acc_0_0': 0.7991, 'acc_0_1': 0.7124, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.7883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8111, 'worst_acc': 0.7144, 'acc_0_0': 0.7854, 'acc_0_1': 0.7144, 'acc_1_0': 0.905, 'acc_1_1': 0.9081, 'mean_acc': 0.7846}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.803, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.803, 'acc_1_1': 0.8955, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.9361, 'worst_acc': 0.7811, 'acc_0_0': 0.9359, 'acc_0_1': 0.7811, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.7455, 'acc_0_0': 0.9299, 'acc_0_1': 0.7455, 'acc_1_0': 0.8193, 'acc_1_1': 0.9221, 'mean_acc': 0.845}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.868, 'worst_acc': 0.803, 'acc_0_0': 0.8846, 'acc_0_1': 0.927, 'acc_1_0': 0.8657, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8687, 'worst_acc': 0.7601, 'acc_0_0': 0.898, 'acc_0_1': 0.9401, 'acc_1_0': 0.852, 'acc_1_1': 0.7601, 'mean_acc': 0.894}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9356, 'acc_0_1': 0.9442, 'acc_1_0': 0.7727, 'acc_1_1': 0.8657, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.6266, 'acc_0_0': 0.9402, 'acc_0_1': 0.6266, 'acc_1_0': 0.7612, 'acc_1_1': 0.9697, 'mean_acc': 0.8017}
Test(class)(new adapter): {'weighted_mean_acc': 0.943, 'worst_acc': 0.6483, 'acc_0_0': 0.9596, 'acc_0_1': 0.6483, 'acc_1_0': 0.7695, 'acc_1_1': 0.9486, 'mean_acc': 0.8162}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.9394, 'acc_1_1': 0.8209, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.8859, 'worst_acc': 0.6818, 'acc_0_0': 0.9444, 'acc_0_1': 0.9742, 'acc_1_0': 0.791, 'acc_1_1': 0.6818, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8794, 'worst_acc': 0.6231, 'acc_0_0': 0.9525, 'acc_0_1': 0.9743, 'acc_1_0': 0.8333, 'acc_1_1': 0.6231, 'mean_acc': 0.9113}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6119, 'acc_0_0': 0.9485, 'acc_0_1': 0.9185, 'acc_1_0': 0.9242, 'acc_1_1': 0.6119, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.9421, 'worst_acc': 0.5365, 'acc_0_0': 0.953, 'acc_0_1': 0.5365, 'acc_1_0': 0.791, 'acc_1_1': 0.9848, 'mean_acc': 0.7767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.5295, 'acc_0_0': 0.9707, 'acc_0_1': 0.5295, 'acc_1_0': 0.8022, 'acc_1_1': 0.9611, 'mean_acc': 0.7793}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 1.0, 'acc_0_1': 0.9142, 'acc_1_0': 0.803, 'acc_1_1': 0.8507, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.8786, 'worst_acc': 0.6667, 'acc_0_0': 0.9402, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.6667, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8567, 'worst_acc': 0.5498, 'acc_0_0': 0.9446, 'acc_0_1': 0.9672, 'acc_1_0': 0.7975, 'acc_1_1': 0.5498, 'mean_acc': 0.8933}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9185, 'acc_0_1': 0.9785, 'acc_1_0': 0.7424, 'acc_1_1': 0.6716, 'mean_acc': 0.8948}
Val(class)(new adapter): {'weighted_mean_acc': 0.952, 'worst_acc': 0.7463, 'acc_0_0': 0.9658, 'acc_0_1': 0.824, 'acc_1_0': 0.7463, 'acc_1_1': 0.9394, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9515, 'worst_acc': 0.7804, 'acc_0_0': 0.9703, 'acc_0_1': 0.8071, 'acc_1_0': 0.7804, 'acc_1_1': 0.9237, 'mean_acc': 0.8806}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9828, 'acc_0_1': 0.927, 'acc_1_0': 0.8333, 'acc_1_1': 0.9851, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.6818, 'acc_0_0': 0.9615, 'acc_0_1': 0.9742, 'acc_1_0': 0.7164, 'acc_1_1': 0.6818, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8912, 'worst_acc': 0.5872, 'acc_0_0': 0.9814, 'acc_0_1': 0.9716, 'acc_1_0': 0.7336, 'acc_1_1': 0.5872, 'mean_acc': 0.9065}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.597, 'acc_0_0': 0.9399, 'acc_0_1': 0.9614, 'acc_1_0': 0.8788, 'acc_1_1': 0.597, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.8584, 'acc_0_0': 0.9017, 'acc_0_1': 0.8584, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8421, 'acc_0_0': 0.9184, 'acc_0_1': 0.8421, 'acc_1_0': 0.8801, 'acc_1_1': 0.9065, 'mean_acc': 0.8832}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9742, 'acc_0_0': 0.9828, 'acc_0_1': 0.9742, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9516, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.9614, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9352, 'worst_acc': 0.6838, 'acc_0_0': 0.9907, 'acc_0_1': 0.9636, 'acc_1_0': 0.6838, 'acc_1_1': 0.7601, 'mean_acc': 0.9206}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5909, 'acc_0_0': 1.0, 'acc_0_1': 0.9442, 'acc_1_0': 0.5909, 'acc_1_1': 0.9104, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.9571, 'acc_1_0': 0.6716, 'acc_1_1': 0.8636, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9371, 'worst_acc': 0.7103, 'acc_0_0': 0.9863, 'acc_0_1': 0.9548, 'acc_1_0': 0.7103, 'acc_1_1': 0.7835, 'mean_acc': 0.921}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.771, 'acc_0_0': 0.9761, 'acc_0_1': 0.9406, 'acc_1_0': 0.771, 'acc_1_1': 0.8037, 'mean_acc': 0.9204}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.7944, 'acc_0_0': 0.9676, 'acc_0_1': 0.9295, 'acc_1_0': 0.7944, 'acc_1_1': 0.8178, 'mean_acc': 0.917}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.8037, 'acc_0_0': 0.9654, 'acc_0_1': 0.9255, 'acc_1_0': 0.8037, 'acc_1_1': 0.8271, 'mean_acc': 0.9166}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.8069, 'acc_0_0': 0.9636, 'acc_0_1': 0.9233, 'acc_1_0': 0.8069, 'acc_1_1': 0.8318, 'mean_acc': 0.9159}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9305, 'worst_acc': 0.8115, 'acc_0_0': 0.9663, 'acc_0_1': 0.933, 'acc_1_0': 0.8115, 'acc_1_1': 0.8178, 'mean_acc': 0.9197}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9307, 'worst_acc': 0.8224, 'acc_0_0': 0.9636, 'acc_0_1': 0.9246, 'acc_1_0': 0.8224, 'acc_1_1': 0.8287, 'mean_acc': 0.9178}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.8255, 'acc_0_0': 0.9601, 'acc_0_1': 0.9202, 'acc_1_0': 0.8255, 'acc_1_1': 0.8364, 'mean_acc': 0.9159}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.8287, 'acc_0_0': 0.9583, 'acc_0_1': 0.9175, 'acc_1_0': 0.8287, 'acc_1_1': 0.8396, 'mean_acc': 0.9149}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8193, 'acc_0_0': 0.9632, 'acc_0_1': 0.9233, 'acc_1_0': 0.8193, 'acc_1_1': 0.8209, 'mean_acc': 0.9159}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.8287, 'acc_0_0': 0.9592, 'acc_0_1': 0.9184, 'acc_1_0': 0.8287, 'acc_1_1': 0.838, 'mean_acc': 0.9154}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8209, 'acc_0_0': 0.9623, 'acc_0_1': 0.9246, 'acc_1_0': 0.8209, 'acc_1_1': 0.8224, 'mean_acc': 0.9165}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.8115, 'acc_0_0': 0.9636, 'acc_0_1': 0.9277, 'acc_1_0': 0.8131, 'acc_1_1': 0.8115, 'mean_acc': 0.9161}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9142, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.8271, 'acc_0_0': 0.9601, 'acc_0_1': 0.9206, 'acc_1_0': 0.8271, 'acc_1_1': 0.8287, 'mean_acc': 0.9154}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.8131, 'acc_0_0': 0.9614, 'acc_0_1': 0.9259, 'acc_1_0': 0.8162, 'acc_1_1': 0.8131, 'mean_acc': 0.9151}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8115, 'acc_0_0': 0.9645, 'acc_0_1': 0.9255, 'acc_1_0': 0.8115, 'acc_1_1': 0.8146, 'mean_acc': 0.9158}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.8302, 'acc_0_0': 0.9557, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.8349, 'mean_acc': 0.9135}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.8255, 'acc_0_0': 0.9565, 'acc_0_1': 0.9188, 'acc_1_0': 0.8302, 'acc_1_1': 0.8255, 'mean_acc': 0.9134}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8255, 'acc_0_0': 0.9614, 'acc_0_1': 0.9215, 'acc_1_0': 0.8271, 'acc_1_1': 0.8255, 'mean_acc': 0.9159}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.8224, 'acc_0_0': 0.9601, 'acc_0_1': 0.922, 'acc_1_0': 0.8271, 'acc_1_1': 0.8224, 'mean_acc': 0.9153}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.8318, 'acc_0_0': 0.9557, 'acc_0_1': 0.9122, 'acc_1_0': 0.8318, 'acc_1_1': 0.8396, 'mean_acc': 0.9122}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.8271, 'acc_0_0': 0.9579, 'acc_0_1': 0.9202, 'acc_1_0': 0.8287, 'acc_1_1': 0.8271, 'mean_acc': 0.9144}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.8162, 'acc_0_0': 0.9605, 'acc_0_1': 0.9246, 'acc_1_0': 0.8224, 'acc_1_1': 0.8162, 'mean_acc': 0.9153}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.929, 'worst_acc': 0.824, 'acc_0_0': 0.961, 'acc_0_1': 0.9215, 'acc_1_0': 0.824, 'acc_1_1': 0.8302, 'mean_acc': 0.9159}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8115, 'acc_0_0': 0.9645, 'acc_0_1': 0.9264, 'acc_1_0': 0.8115, 'acc_1_1': 0.8146, 'mean_acc': 0.9161}
========================================================================
> end of training. 

best epoch : 74
best training accuracy on [class]: {'worst_acc': 0.597, 'acc_0_0': 0.9399, 'acc_0_1': 0.9614, 'acc_1_0': 0.8788, 'acc_1_1': 0.597, 'mean_acc': 0.9032}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9081, 'worst_acc': 0.8584, 'acc_0_0': 0.9017, 'acc_0_1': 0.8584, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
best test accuracy on [class]: {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8421, 'acc_0_0': 0.9184, 'acc_0_1': 0.8421, 'acc_1_0': 0.8801, 'acc_1_1': 0.9065, 'mean_acc': 0.8832}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8421, 'acc_0_0': 0.9184, 'acc_0_1': 0.8421, 'acc_1_0': 0.8801, 'acc_1_1': 0.9065, 'mean_acc': 0.8832}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.4143, 'acc_0_0': 0.9778, 'acc_0_1': 0.8807, 'acc_1_0': 0.4143, 'acc_1_1': 0.9813, 'mean_acc': 0.878}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 74': {'Train': {'worst_acc': 0.597, 'acc_0_0': 0.9399, 'acc_0_1': 0.9614, 'acc_1_0': 0.8788, 'acc_1_1': 0.597, 'mean_acc': 0.9032}, 'Val': {'weighted_mean_acc': 0.9081, 'worst_acc': 0.8584, 'acc_0_0': 0.9017, 'acc_0_1': 0.8584, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}, 'Test': {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8421, 'acc_0_0': 0.9184, 'acc_0_1': 0.8421, 'acc_1_0': 0.8801, 'acc_1_1': 0.9065, 'mean_acc': 0.8832}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8421, 'acc_0_0': 0.9184, 'acc_0_1': 0.8421, 'acc_1_0': 0.8801, 'acc_1_1': 0.9065, 'mean_acc': 0.8832}, 'spurious': {'weighted_mean_acc': 0.9683, 'worst_acc': 0.4143, 'acc_0_0': 0.9778, 'acc_0_1': 0.8807, 'acc_1_0': 0.4143, 'acc_1_1': 0.9813, 'mean_acc': 0.878}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8932     0.8178   0.9175  ...   0.8536   0.8178    0.8835
2                       0.8858     0.8687   0.8834  ...   0.8801   0.8972    0.8788
3                       0.9124     0.8421   0.9184  ...   0.8801   0.9065    0.8832
test_mean               0.8971     0.8429   0.9064  ...   0.8713   0.8738    0.8818
test_std                0.0112     0.0208   0.0163  ...   0.0125   0.0398    0.0021
1                       0.9581     0.5933   0.9969  ...   0.9143   0.8956    0.8195
2                       0.9586     0.4486   0.9579  ...   0.4486   0.9938    0.8932
3                       0.9683     0.4143   0.9778  ...   0.4143   0.9813    0.8780
zs_spu_mean             0.9617     0.4854   0.9775  ...   0.5924   0.9569    0.8636
zs_spu_std              0.0047     0.0776   0.0159  ...   0.2280   0.0436    0.0318
1                          NaN     0.8788   1.0000  ...   0.8788   0.9851    0.9800
2                          NaN     0.8333   0.9914  ...   0.8333   0.8507    0.9566
3                          NaN     0.5970   0.9399  ...   0.8788   0.5970    0.9032
tr_mean                    NaN     0.7697   0.9771  ...   0.8636   0.8109    0.9466
tr_std                     NaN     0.1235   0.0265  ...   0.0214   0.1609    0.0321
1                       0.9097     0.8455   0.9188  ...   0.8507   0.8939    0.8800
2                       0.8991     0.8627   0.8889  ...   0.8955   0.9394    0.8850
3                       0.9081     0.8584   0.9017  ...   0.8806   0.9394    0.8867
val_mean                0.9056     0.8555   0.9031  ...   0.8756   0.9242    0.8839
val_std                 0.0047     0.0073   0.0122  ...   0.0186   0.0214    0.0028
1                       0.8932     0.8178   0.9175  ...   0.8536   0.8178    0.8835
2                       0.8858     0.8687   0.8834  ...   0.8801   0.8972    0.8788
3                       0.9124     0.8421   0.9184  ...   0.8801   0.9065    0.8832
zs_tg_mean              0.8971     0.8429   0.9064  ...   0.8713   0.8738    0.8818
zs_tg_std               0.0112     0.0208   0.0163  ...   0.0125   0.0398    0.0021

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_10.0_lrr10.0_bsr64_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3696, 'acc_0_0': 0.9337, 'acc_0_1': 0.3696, 'acc_1_0': 0.5357, 'acc_1_1': 0.7228, 'mean_acc': 0.8609}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4034, 'acc_0_0': 1.0, 'acc_0_1': 0.4034, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.3605, 'acc_0_0': 0.9925, 'acc_0_1': 0.3605, 'acc_1_0': 0.5592, 'acc_1_1': 0.9548, 'mean_acc': 0.6943}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9946, 'acc_0_1': 0.5707, 'acc_1_0': 0.4821, 'acc_1_1': 0.9158, 'mean_acc': 0.955}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3734, 'acc_0_0': 0.9915, 'acc_0_1': 0.3734, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.71}
Test(class): {'weighted_mean_acc': 0.9542, 'worst_acc': 0.3729, 'acc_0_0': 0.9854, 'acc_0_1': 0.3729, 'acc_1_0': 0.6386, 'acc_1_1': 0.9688, 'mean_acc': 0.7068}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6141, 'acc_0_0': 0.9883, 'acc_0_1': 0.6141, 'acc_1_0': 0.6607, 'acc_1_1': 0.9499, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9889, 'acc_0_1': 0.7565, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8488}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9929, 'acc_0_1': 0.7446, 'acc_1_0': 0.6786, 'acc_1_1': 0.9385, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.5751, 'acc_0_0': 0.9957, 'acc_0_1': 0.5751, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.5525, 'acc_0_0': 0.9831, 'acc_0_1': 0.5525, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.7794}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9923, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9593, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6044, 'acc_0_0': 0.992, 'acc_0_1': 0.6816, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8215}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.996, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9574, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.6142, 'acc_0_0': 0.9889, 'acc_0_1': 0.6142, 'acc_1_0': 0.6386, 'acc_1_1': 0.9393, 'mean_acc': 0.7988}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9963, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9631, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6153, 'acc_0_0': 0.9907, 'acc_0_1': 0.6993, 'acc_1_0': 0.6153, 'acc_1_1': 0.9299, 'mean_acc': 0.829}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9949, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9612, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6417, 'acc_0_0': 0.9894, 'acc_0_1': 0.6891, 'acc_1_0': 0.6417, 'acc_1_1': 0.933, 'mean_acc': 0.8278}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9954, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8293}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6226, 'acc_0_0': 0.9889, 'acc_0_1': 0.6226, 'acc_1_0': 0.6464, 'acc_1_1': 0.9393, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9963, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9707, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7055, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8298}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9974, 'acc_0_1': 0.7717, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.6616, 'acc_1_0': 0.6246, 'acc_1_1': 0.9377, 'mean_acc': 0.8162}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.998, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.9678, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.6355, 'acc_0_0': 0.9889, 'acc_0_1': 0.6727, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8203}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9974, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9811, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6168, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6168, 'acc_1_1': 0.9268, 'mean_acc': 0.836}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9991, 'acc_0_1': 0.8098, 'acc_1_0': 0.7321, 'acc_1_1': 0.9688, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.639, 'acc_0_0': 0.9867, 'acc_0_1': 0.639, 'acc_1_0': 0.6449, 'acc_1_1': 0.9393, 'mean_acc': 0.8082}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9983, 'acc_0_1': 0.7826, 'acc_1_0': 0.8571, 'acc_1_1': 0.9811, 'mean_acc': 0.9846}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6137, 'acc_0_0': 0.9894, 'acc_0_1': 0.7268, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.839}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6009, 'acc_0_0': 0.9829, 'acc_0_1': 0.6009, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.604, 'acc_0_0': 0.9854, 'acc_0_1': 0.604, 'acc_1_0': 0.6573, 'acc_1_1': 0.9439, 'mean_acc': 0.796}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7811, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5717, 'acc_0_0': 0.9925, 'acc_0_1': 0.757, 'acc_1_0': 0.5717, 'acc_1_1': 0.9237, 'mean_acc': 0.8466}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9983, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9839, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.741, 'acc_1_0': 0.5763, 'acc_1_1': 0.9221, 'mean_acc': 0.8405}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9991, 'acc_0_1': 0.8696, 'acc_1_0': 0.875, 'acc_1_1': 0.9849, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6137, 'acc_0_0': 0.9871, 'acc_0_1': 0.7029, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.829}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9997, 'acc_0_1': 0.8913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.662, 'acc_0_0': 0.984, 'acc_0_1': 0.6647, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8191}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6418, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6371, 'acc_0_0': 0.9858, 'acc_0_1': 0.6749, 'acc_1_0': 0.6371, 'acc_1_1': 0.9361, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6701, 'acc_1_0': 0.634, 'acc_1_1': 0.9346, 'mean_acc': 0.8188}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5903, 'acc_0_0': 0.9902, 'acc_0_1': 0.7406, 'acc_1_0': 0.5903, 'acc_1_1': 0.9237, 'mean_acc': 0.8414}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9885, 'acc_0_1': 0.7011, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.8262}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6012, 'acc_0_0': 0.9898, 'acc_0_1': 0.7286, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8381}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9728, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5935, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.5935, 'acc_1_1': 0.933, 'mean_acc': 0.8221}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9997, 'acc_0_1': 0.9348, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9962}
Val(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6866, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6866, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6402, 'acc_0_0': 0.9845, 'acc_0_1': 0.7282, 'acc_1_0': 0.6402, 'acc_1_1': 0.933, 'mean_acc': 0.8409}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.5997, 'acc_0_0': 0.9898, 'acc_0_1': 0.6772, 'acc_1_0': 0.5997, 'acc_1_1': 0.9408, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.7361, 'acc_1_0': 0.5763, 'acc_1_1': 0.9252, 'mean_acc': 0.839}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9643, 'acc_1_1': 0.9972, 'mean_acc': 0.9981}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.729, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8393}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6137, 'acc_0_0': 0.9885, 'acc_0_1': 0.7255, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8376}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5966, 'acc_0_0': 0.9898, 'acc_0_1': 0.7082, 'acc_1_0': 0.5966, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9985}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6433, 'acc_0_0': 0.9827, 'acc_0_1': 0.6439, 'acc_1_0': 0.6433, 'acc_1_1': 0.9455, 'mean_acc': 0.8091}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.648, 'acc_0_0': 0.9845, 'acc_0_1': 0.6851, 'acc_1_0': 0.648, 'acc_1_1': 0.9439, 'mean_acc': 0.8262}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.8157}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9981, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5888, 'acc_0_0': 0.9925, 'acc_0_1': 0.7401, 'acc_1_0': 0.5888, 'acc_1_1': 0.9237, 'mean_acc': 0.8419}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5919, 'acc_0_0': 0.9902, 'acc_0_1': 0.7086, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8298}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.609, 'acc_0_0': 0.9889, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8284}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6519, 'acc_0_0': 0.9827, 'acc_0_1': 0.6519, 'acc_1_0': 0.6573, 'acc_1_1': 0.9377, 'mean_acc': 0.8129}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3939, 'acc_0_0': 0.9914, 'acc_0_1': 0.7897, 'acc_1_0': 0.3939, 'acc_1_1': 0.9104, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.954, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.8498, 'acc_1_0': 0.6269, 'acc_1_1': 0.8939, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.8608, 'acc_1_0': 0.6153, 'acc_1_1': 0.8754, 'mean_acc': 0.8852}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2121, 'acc_0_0': 0.8712, 'acc_0_1': 0.5279, 'acc_1_0': 0.2121, 'acc_1_1': 0.7612, 'mean_acc': 0.6528}
Val(class)(new adapter): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.3734, 'acc_0_0': 0.953, 'acc_0_1': 0.3734, 'acc_1_0': 0.7612, 'acc_1_1': 1.0, 'mean_acc': 0.7117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.3725, 'acc_0_0': 0.9561, 'acc_0_1': 0.3725, 'acc_1_0': 0.771, 'acc_1_1': 0.9798, 'mean_acc': 0.7111}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9742, 'acc_0_1': 0.7597, 'acc_1_0': 0.5455, 'acc_1_1': 0.791, 'mean_acc': 0.823}
Val(class)(new adapter): {'weighted_mean_acc': 0.8548, 'worst_acc': 0.3939, 'acc_0_0': 0.9915, 'acc_0_1': 0.9742, 'acc_1_0': 0.6269, 'acc_1_1': 0.3939, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8688, 'worst_acc': 0.4595, 'acc_0_0': 0.9898, 'acc_0_1': 0.9854, 'acc_1_0': 0.6495, 'acc_1_1': 0.4595, 'mean_acc': 0.8916}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0896, 'acc_0_0': 0.8798, 'acc_0_1': 0.9399, 'acc_1_0': 0.8333, 'acc_1_1': 0.0896, 'mean_acc': 0.8097}
Val(class)(new adapter): {'weighted_mean_acc': 0.8457, 'worst_acc': 0.8248, 'acc_0_0': 0.8248, 'acc_0_1': 0.8584, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.8205, 'worst_acc': 0.8004, 'acc_0_0': 0.8004, 'acc_0_1': 0.8479, 'acc_1_0': 0.9221, 'acc_1_1': 0.8769, 'mean_acc': 0.8409}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9185, 'acc_0_1': 0.9485, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.7463, 'acc_0_0': 0.9658, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.9545, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.7975, 'acc_0_0': 0.9694, 'acc_0_1': 0.8865, 'acc_1_0': 0.7975, 'acc_1_1': 0.8879, 'mean_acc': 0.909}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5672, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.6515, 'acc_1_1': 0.5672, 'mean_acc': 0.8848}
Val(class)(new adapter): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.8755, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9406, 'worst_acc': 0.8084, 'acc_0_0': 0.9605, 'acc_0_1': 0.8678, 'acc_1_0': 0.8084, 'acc_1_1': 0.8941, 'mean_acc': 0.9002}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 0.97, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.8543, 'worst_acc': 0.8248, 'acc_0_0': 0.8248, 'acc_0_1': 0.8326, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.8308, 'worst_acc': 0.8013, 'acc_0_0': 0.8013, 'acc_0_1': 0.8266, 'acc_1_0': 0.9065, 'acc_1_1': 0.9252, 'mean_acc': 0.8366}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9313, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.8507, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.8209, 'acc_0_0': 0.906, 'acc_0_1': 0.8326, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8915, 'worst_acc': 0.8386, 'acc_0_0': 0.8887, 'acc_0_1': 0.8386, 'acc_1_0': 0.8692, 'acc_1_1': 0.9112, 'mean_acc': 0.8695}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9785, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.9545, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.8349, 'acc_0_0': 0.9197, 'acc_0_1': 0.8639, 'acc_1_0': 0.8349, 'acc_1_1': 0.8738, 'mean_acc': 0.8835}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9914, 'acc_0_1': 0.9571, 'acc_1_0': 0.9545, 'acc_1_1': 0.9254, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8507, 'acc_0_0': 0.8889, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8652, 'worst_acc': 0.8598, 'acc_0_0': 0.8656, 'acc_0_1': 0.8847, 'acc_1_0': 0.8754, 'acc_1_1': 0.8598, 'mean_acc': 0.8735}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9055, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.7726, 'acc_0_0': 0.9335, 'acc_0_1': 0.9552, 'acc_1_0': 0.7928, 'acc_1_1': 0.7726, 'mean_acc': 0.9085}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9552, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.7015, 'acc_0_0': 0.9615, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7103, 'acc_0_0': 0.9681, 'acc_0_1': 0.9574, 'acc_1_0': 0.7103, 'acc_1_1': 0.7492, 'mean_acc': 0.9111}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7227, 'acc_0_0': 0.9676, 'acc_0_1': 0.9512, 'acc_1_0': 0.7227, 'acc_1_1': 0.7617, 'mean_acc': 0.9113}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9552, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7695, 'acc_0_0': 0.9486, 'acc_0_1': 0.9237, 'acc_1_0': 0.7695, 'acc_1_1': 0.8115, 'mean_acc': 0.9039}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7612, 'acc_0_0': 0.9188, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7991, 'acc_0_0': 0.9375, 'acc_0_1': 0.9149, 'acc_1_0': 0.7991, 'acc_1_1': 0.8178, 'mean_acc': 0.9001}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7612, 'acc_0_0': 0.9188, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7913, 'acc_0_0': 0.9388, 'acc_0_1': 0.9268, 'acc_1_0': 0.7928, 'acc_1_1': 0.7913, 'mean_acc': 0.9016}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7586, 'acc_0_0': 0.9441, 'acc_0_1': 0.9428, 'acc_1_0': 0.7741, 'acc_1_1': 0.7586, 'mean_acc': 0.9042}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.7015, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7695, 'acc_0_0': 0.9494, 'acc_0_1': 0.9384, 'acc_1_0': 0.7695, 'acc_1_1': 0.7726, 'mean_acc': 0.9056}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.6716, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7508, 'acc_0_0': 0.9552, 'acc_0_1': 0.937, 'acc_1_0': 0.7508, 'acc_1_1': 0.7726, 'mean_acc': 0.9052}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.6866, 'acc_0_0': 0.9316, 'acc_0_1': 0.897, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.757, 'acc_0_0': 0.9548, 'acc_0_1': 0.9339, 'acc_1_0': 0.757, 'acc_1_1': 0.7788, 'mean_acc': 0.9052}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.6716, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7492, 'acc_0_0': 0.9561, 'acc_0_1': 0.9348, 'acc_1_0': 0.7492, 'acc_1_1': 0.7773, 'mean_acc': 0.9051}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.6716, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.743, 'acc_0_0': 0.9565, 'acc_0_1': 0.9366, 'acc_1_0': 0.743, 'acc_1_1': 0.7757, 'mean_acc': 0.9051}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7445, 'acc_0_0': 0.9548, 'acc_0_1': 0.9348, 'acc_1_0': 0.7445, 'acc_1_1': 0.7804, 'mean_acc': 0.9044}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7414, 'acc_0_0': 0.9561, 'acc_0_1': 0.937, 'acc_1_0': 0.7414, 'acc_1_1': 0.7757, 'mean_acc': 0.9049}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7399, 'acc_0_0': 0.9579, 'acc_0_1': 0.945, 'acc_1_0': 0.7399, 'acc_1_1': 0.7632, 'mean_acc': 0.9071}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7601, 'acc_0_0': 0.9534, 'acc_0_1': 0.9508, 'acc_1_0': 0.7601, 'acc_1_1': 0.7601, 'mean_acc': 0.9096}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7601, 'acc_0_0': 0.9525, 'acc_0_1': 0.9499, 'acc_1_0': 0.7773, 'acc_1_1': 0.7601, 'mean_acc': 0.9108}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.757, 'acc_0_0': 0.9623, 'acc_0_1': 0.9503, 'acc_1_0': 0.7632, 'acc_1_1': 0.757, 'mean_acc': 0.9128}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9323, 'worst_acc': 0.6866, 'acc_0_0': 0.9701, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.715, 'acc_0_0': 0.9761, 'acc_0_1': 0.9552, 'acc_1_0': 0.715, 'acc_1_1': 0.7461, 'mean_acc': 0.9135}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9357, 'worst_acc': 0.7015, 'acc_0_0': 0.9658, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7025, 'acc_0_0': 0.9761, 'acc_0_1': 0.953, 'acc_1_0': 0.7025, 'acc_1_1': 0.7508, 'mean_acc': 0.9118}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.7321, 'acc_0_0': 0.9694, 'acc_0_1': 0.9481, 'acc_1_0': 0.7321, 'acc_1_1': 0.7586, 'mean_acc': 0.9115}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.757, 'acc_0_0': 0.9605, 'acc_0_1': 0.9437, 'acc_1_0': 0.757, 'acc_1_1': 0.7695, 'mean_acc': 0.9103}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7679, 'acc_0_0': 0.9543, 'acc_0_1': 0.9375, 'acc_1_0': 0.7679, 'acc_1_1': 0.7757, 'mean_acc': 0.9073}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7664, 'acc_0_0': 0.9525, 'acc_0_1': 0.9379, 'acc_1_0': 0.7664, 'acc_1_1': 0.7741, 'mean_acc': 0.9065}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7679, 'acc_0_0': 0.9512, 'acc_0_1': 0.9379, 'acc_1_0': 0.7679, 'acc_1_1': 0.7679, 'mean_acc': 0.9054}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7555, 'acc_0_0': 0.9552, 'acc_0_1': 0.9424, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9066}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7586, 'acc_0_0': 0.9543, 'acc_0_1': 0.9419, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9063}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7586, 'acc_0_0': 0.9552, 'acc_0_1': 0.941, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9063}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7586, 'acc_0_0': 0.9548, 'acc_0_1': 0.941, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9061}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.757, 'acc_0_0': 0.9548, 'acc_0_1': 0.9432, 'acc_1_0': 0.757, 'acc_1_1': 0.7601, 'mean_acc': 0.9068}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7539, 'acc_0_0': 0.9548, 'acc_0_1': 0.9428, 'acc_1_0': 0.7539, 'acc_1_1': 0.7601, 'mean_acc': 0.9063}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7523, 'acc_0_0': 0.9574, 'acc_0_1': 0.9432, 'acc_1_0': 0.7523, 'acc_1_1': 0.7586, 'mean_acc': 0.9071}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7539, 'acc_0_0': 0.9561, 'acc_0_1': 0.9406, 'acc_1_0': 0.7539, 'acc_1_1': 0.7601, 'mean_acc': 0.9059}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7586, 'acc_0_0': 0.9548, 'acc_0_1': 0.9401, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9058}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.757, 'acc_0_0': 0.9548, 'acc_0_1': 0.9406, 'acc_1_0': 0.757, 'acc_1_1': 0.7601, 'mean_acc': 0.9058}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7617, 'acc_0_0': 0.9534, 'acc_0_1': 0.9379, 'acc_1_0': 0.7648, 'acc_1_1': 0.7617, 'mean_acc': 0.9052}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7601, 'acc_0_0': 0.9539, 'acc_0_1': 0.9401, 'acc_1_0': 0.7632, 'acc_1_1': 0.7601, 'mean_acc': 0.9059}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7601, 'acc_0_0': 0.9543, 'acc_0_1': 0.9397, 'acc_1_0': 0.7601, 'acc_1_1': 0.7601, 'mean_acc': 0.9056}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7632, 'acc_0_0': 0.9525, 'acc_0_1': 0.937, 'acc_1_0': 0.7648, 'acc_1_1': 0.7632, 'mean_acc': 0.9047}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7601, 'acc_0_0': 0.9539, 'acc_0_1': 0.9379, 'acc_1_0': 0.7632, 'acc_1_1': 0.7601, 'mean_acc': 0.9051}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7601, 'acc_0_0': 0.9525, 'acc_0_1': 0.9379, 'acc_1_0': 0.7648, 'acc_1_1': 0.7601, 'mean_acc': 0.9047}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7632, 'acc_0_0': 0.9525, 'acc_0_1': 0.9366, 'acc_1_0': 0.7632, 'acc_1_1': 0.7632, 'mean_acc': 0.9044}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7586, 'acc_0_0': 0.9548, 'acc_0_1': 0.9406, 'acc_1_0': 0.7648, 'acc_1_1': 0.7586, 'mean_acc': 0.9065}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7601, 'acc_0_0': 0.9534, 'acc_0_1': 0.9392, 'acc_1_0': 0.7648, 'acc_1_1': 0.7601, 'mean_acc': 0.9056}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7586, 'acc_0_0': 0.9552, 'acc_0_1': 0.941, 'acc_1_0': 0.7601, 'acc_1_1': 0.7586, 'mean_acc': 0.9063}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7586, 'acc_0_0': 0.9552, 'acc_0_1': 0.9388, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9054}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7586, 'acc_0_0': 0.9557, 'acc_0_1': 0.937, 'acc_1_0': 0.7586, 'acc_1_1': 0.7617, 'mean_acc': 0.9051}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7586, 'acc_0_0': 0.957, 'acc_0_1': 0.9375, 'acc_1_0': 0.7586, 'acc_1_1': 0.7601, 'mean_acc': 0.9056}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7586, 'acc_0_0': 0.9561, 'acc_0_1': 0.9384, 'acc_1_0': 0.7586, 'acc_1_1': 0.7617, 'mean_acc': 0.9058}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7601, 'acc_0_0': 0.9548, 'acc_0_1': 0.9397, 'acc_1_0': 0.7601, 'acc_1_1': 0.7601, 'mean_acc': 0.9058}
========================================================================
> end of training. 

best epoch : 50
best training accuracy on [class]: {'worst_acc': 0.9254, 'acc_0_0': 0.9914, 'acc_0_1': 0.9571, 'acc_1_0': 0.9545, 'acc_1_1': 0.9254, 'mean_acc': 0.9666}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8507, 'acc_0_0': 0.8889, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8883}
best test accuracy on [class]: {'weighted_mean_acc': 0.8652, 'worst_acc': 0.8598, 'acc_0_0': 0.8656, 'acc_0_1': 0.8847, 'acc_1_0': 0.8754, 'acc_1_1': 0.8598, 'mean_acc': 0.8735}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8652, 'worst_acc': 0.8598, 'acc_0_0': 0.8656, 'acc_0_1': 0.8847, 'acc_1_0': 0.8754, 'acc_1_1': 0.8598, 'mean_acc': 0.8735}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.6246, 'acc_0_0': 0.9858, 'acc_0_1': 0.8191, 'acc_1_0': 0.6246, 'acc_1_1': 0.972, 'mean_acc': 0.8794}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 50': {'Train': {'worst_acc': 0.9254, 'acc_0_0': 0.9914, 'acc_0_1': 0.9571, 'acc_1_0': 0.9545, 'acc_1_1': 0.9254, 'mean_acc': 0.9666}, 'Val': {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8507, 'acc_0_0': 0.8889, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8883}, 'Test': {'weighted_mean_acc': 0.8652, 'worst_acc': 0.8598, 'acc_0_0': 0.8656, 'acc_0_1': 0.8847, 'acc_1_0': 0.8754, 'acc_1_1': 0.8598, 'mean_acc': 0.8735}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8652, 'worst_acc': 0.8598, 'acc_0_0': 0.8656, 'acc_0_1': 0.8847, 'acc_1_0': 0.8754, 'acc_1_1': 0.8598, 'mean_acc': 0.8735}, 'spurious': {'weighted_mean_acc': 0.9721, 'worst_acc': 0.6246, 'acc_0_0': 0.9858, 'acc_0_1': 0.8191, 'acc_1_0': 0.6246, 'acc_1_1': 0.972, 'mean_acc': 0.8794}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9231, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.6433, 'mean_acc': 0.8375}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.1588, 'acc_0_0': 0.9786, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6317}
Test(class): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.1512, 'acc_0_0': 0.9641, 'acc_0_1': 0.1512, 'acc_1_0': 0.6916, 'acc_1_1': 0.9798, 'mean_acc': 0.6193}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9974, 'acc_0_1': 0.587, 'acc_1_0': 0.4286, 'acc_1_1': 0.9101, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.3476, 'acc_0_0': 0.9957, 'acc_0_1': 0.3476, 'acc_1_0': 0.597, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.3228, 'acc_0_0': 0.9796, 'acc_0_1': 0.3228, 'acc_1_0': 0.6121, 'acc_1_1': 0.9642, 'mean_acc': 0.6816}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4837, 'acc_0_0': 0.9857, 'acc_0_1': 0.4837, 'acc_1_0': 0.6607, 'acc_1_1': 0.9763, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.4592, 'acc_0_0': 0.9872, 'acc_0_1': 0.4592, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.4288, 'acc_0_0': 0.9712, 'acc_0_1': 0.4288, 'acc_1_0': 0.7118, 'acc_1_1': 0.9626, 'mean_acc': 0.7304}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9883, 'acc_0_1': 0.7011, 'acc_1_0': 0.6607, 'acc_1_1': 0.9177, 'mean_acc': 0.9579}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6215, 'acc_0_0': 0.984, 'acc_0_1': 0.6568, 'acc_1_0': 0.6215, 'acc_1_1': 0.9346, 'mean_acc': 0.811}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5652, 'acc_0_0': 0.9877, 'acc_0_1': 0.5652, 'acc_1_0': 0.6964, 'acc_1_1': 0.9697, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.533, 'acc_0_0': 0.9858, 'acc_0_1': 0.533, 'acc_1_0': 0.6199, 'acc_1_1': 0.9533, 'mean_acc': 0.7654}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9957, 'acc_0_1': 0.6739, 'acc_1_0': 0.6429, 'acc_1_1': 0.9584, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5888, 'acc_0_0': 0.9894, 'acc_0_1': 0.6186, 'acc_1_0': 0.5888, 'acc_1_1': 0.9424, 'mean_acc': 0.7955}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9934, 'acc_0_1': 0.6467, 'acc_1_0': 0.6607, 'acc_1_1': 0.9697, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9659, 'worst_acc': 0.5622, 'acc_0_0': 0.9915, 'acc_0_1': 0.5622, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5605, 'acc_0_0': 0.9871, 'acc_0_1': 0.5605, 'acc_1_0': 0.6246, 'acc_1_1': 0.9502, 'mean_acc': 0.7768}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9951, 'acc_0_1': 0.7228, 'acc_1_0': 0.6964, 'acc_1_1': 0.9622, 'mean_acc': 0.9739}
Val(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.6399, 'acc_1_0': 0.6137, 'acc_1_1': 0.9408, 'mean_acc': 0.8058}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9954, 'acc_0_1': 0.7228, 'acc_1_0': 0.7321, 'acc_1_1': 0.9697, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6059, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6059, 'acc_1_1': 0.9393, 'mean_acc': 0.8084}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9951, 'acc_0_1': 0.7011, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.609, 'acc_0_0': 0.9902, 'acc_0_1': 0.6678, 'acc_1_0': 0.609, 'acc_1_1': 0.9377, 'mean_acc': 0.8167}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.7554, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6246, 'acc_1_1': 0.9424, 'mean_acc': 0.8133}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9949, 'acc_0_1': 0.712, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6639, 'acc_1_0': 0.6153, 'acc_1_1': 0.9408, 'mean_acc': 0.8155}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.7663, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6012, 'acc_0_0': 0.988, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9346, 'mean_acc': 0.8208}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9969, 'acc_0_1': 0.7446, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6106, 'acc_0_0': 0.9889, 'acc_0_1': 0.6776, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8202}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.998, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6776, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8203}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9971, 'acc_0_1': 0.7826, 'acc_1_0': 0.8036, 'acc_1_1': 0.9782, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6012, 'acc_0_0': 0.9894, 'acc_0_1': 0.7073, 'acc_1_0': 0.6012, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8315, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6433, 'acc_0_0': 0.9876, 'acc_0_1': 0.6763, 'acc_1_0': 0.6433, 'acc_1_1': 0.9393, 'mean_acc': 0.8229}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8587, 'acc_1_0': 0.8036, 'acc_1_1': 0.965, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6749, 'acc_1_0': 0.634, 'acc_1_1': 0.9439, 'mean_acc': 0.8217}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9957, 'acc_0_1': 0.7446, 'acc_1_0': 0.875, 'acc_1_1': 0.982, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.662, 'acc_0_0': 0.9863, 'acc_0_1': 0.6683, 'acc_1_0': 0.662, 'acc_1_1': 0.9455, 'mean_acc': 0.8221}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.9022, 'acc_1_0': 0.8393, 'acc_1_1': 0.9745, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.6371, 'acc_1_1': 0.9424, 'mean_acc': 0.8246}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6215, 'acc_0_0': 0.988, 'acc_0_1': 0.7073, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9991, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6075, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6075, 'acc_1_1': 0.9393, 'mean_acc': 0.8269}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9989, 'acc_0_1': 0.8641, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6293, 'acc_0_0': 0.9871, 'acc_0_1': 0.6976, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8295}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9701, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6568, 'acc_1_0': 0.6371, 'acc_1_1': 0.9502, 'mean_acc': 0.816}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5919, 'acc_0_0': 0.9916, 'acc_0_1': 0.7676, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8533}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9565, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.995}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.6223, 'acc_0_0': 0.9872, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6284, 'acc_0_0': 0.9858, 'acc_0_1': 0.6284, 'acc_1_0': 0.6713, 'acc_1_1': 0.9517, 'mean_acc': 0.8081}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9565, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9682, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6324, 'acc_0_0': 0.9898, 'acc_0_1': 0.7184, 'acc_1_0': 0.6324, 'acc_1_1': 0.9361, 'mean_acc': 0.8386}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9565, 'acc_0_0': 1.0, 'acc_0_1': 0.9565, 'acc_1_0': 0.9643, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.6059, 'acc_0_0': 0.9911, 'acc_0_1': 0.6971, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.8288}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9674, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.634, 'acc_0_0': 0.9876, 'acc_0_1': 0.6736, 'acc_1_0': 0.634, 'acc_1_1': 0.9486, 'mean_acc': 0.8219}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9643, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.7069, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8338}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.6475, 'acc_1_0': 0.6153, 'acc_1_1': 0.9486, 'mean_acc': 0.8103}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6293, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6293, 'acc_1_1': 0.9408, 'mean_acc': 0.8295}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9979}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6277, 'acc_0_0': 0.9894, 'acc_0_1': 0.7392, 'acc_1_0': 0.6277, 'acc_1_1': 0.9361, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.6967, 'acc_1_0': 0.6044, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7468, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5935, 'acc_0_0': 0.9907, 'acc_0_1': 0.7512, 'acc_1_0': 0.5935, 'acc_1_1': 0.9346, 'mean_acc': 0.8473}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6976, 'acc_1_0': 0.6464, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7029, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8315}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6215, 'acc_0_0': 0.9907, 'acc_0_1': 0.7118, 'acc_1_0': 0.6215, 'acc_1_1': 0.9408, 'mean_acc': 0.8357}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6277, 'acc_0_0': 0.9898, 'acc_0_1': 0.7171, 'acc_1_0': 0.6277, 'acc_1_1': 0.9408, 'mean_acc': 0.8381}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6293, 'acc_0_0': 0.9902, 'acc_0_1': 0.6922, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.829}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9914, 'acc_0_1': 0.824, 'acc_1_0': 0.4394, 'acc_1_1': 0.9104, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.9356, 'acc_1_0': 0.5373, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.5405, 'acc_0_0': 0.996, 'acc_0_1': 0.9295, 'acc_1_0': 0.5405, 'acc_1_1': 0.7991, 'mean_acc': 0.8978}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1061, 'acc_0_0': 0.8884, 'acc_0_1': 0.5622, 'acc_1_0': 0.1061, 'acc_1_1': 0.7164, 'mean_acc': 0.6561}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.2961, 'acc_0_0': 0.9444, 'acc_0_1': 0.2961, 'acc_1_0': 0.791, 'acc_1_1': 1.0, 'mean_acc': 0.6817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9324, 'worst_acc': 0.3091, 'acc_0_0': 0.9508, 'acc_0_1': 0.3091, 'acc_1_0': 0.8193, 'acc_1_1': 0.986, 'mean_acc': 0.6904}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9657, 'acc_0_1': 0.7382, 'acc_1_0': 0.7273, 'acc_1_1': 0.7463, 'mean_acc': 0.8264}
Val(class)(new adapter): {'weighted_mean_acc': 0.7862, 'worst_acc': 0.1212, 'acc_0_0': 0.9786, 'acc_0_1': 0.9914, 'acc_1_0': 0.6418, 'acc_1_1': 0.1212, 'mean_acc': 0.8517}
Test(class)(new adapter): {'weighted_mean_acc': 0.8011, 'worst_acc': 0.1464, 'acc_0_0': 0.9907, 'acc_0_1': 0.9982, 'acc_1_0': 0.6651, 'acc_1_1': 0.1464, 'mean_acc': 0.864}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1642, 'acc_0_0': 0.897, 'acc_0_1': 0.9528, 'acc_1_0': 0.8182, 'acc_1_1': 0.1642, 'mean_acc': 0.828}
Val(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.803, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.9104, 'acc_1_1': 0.803, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8816, 'worst_acc': 0.757, 'acc_0_0': 0.9166, 'acc_0_1': 0.9322, 'acc_1_0': 0.8816, 'acc_1_1': 0.757, 'mean_acc': 0.9011}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9571, 'acc_0_1': 0.9657, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.8358, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.8551, 'acc_0_0': 0.933, 'acc_0_1': 0.9042, 'acc_1_0': 0.8551, 'acc_1_1': 0.8629, 'mean_acc': 0.9054}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9356, 'acc_0_1': 0.9914, 'acc_1_0': 0.7879, 'acc_1_1': 0.7612, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.8358, 'acc_0_0': 0.9103, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.898, 'worst_acc': 0.8598, 'acc_0_0': 0.9029, 'acc_0_1': 0.8936, 'acc_1_0': 0.8598, 'acc_1_1': 0.8847, 'mean_acc': 0.8925}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9871, 'acc_0_1': 0.9657, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.8358, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.8358, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.8162, 'acc_0_0': 0.9255, 'acc_0_1': 0.9166, 'acc_1_0': 0.8162, 'acc_1_1': 0.8489, 'mean_acc': 0.9014}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9742, 'acc_0_1': 0.9657, 'acc_1_0': 0.9242, 'acc_1_1': 0.8806, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.8595, 'worst_acc': 0.8376, 'acc_0_0': 0.8376, 'acc_0_1': 0.8927, 'acc_1_0': 0.8955, 'acc_1_1': 0.9242, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8323, 'worst_acc': 0.8102, 'acc_0_0': 0.8102, 'acc_0_1': 0.8758, 'acc_1_0': 0.9065, 'acc_1_1': 0.8941, 'mean_acc': 0.8557}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.8507, 'acc_0_0': 0.8974, 'acc_0_1': 0.9185, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8489, 'acc_0_0': 0.9042, 'acc_0_1': 0.8993, 'acc_1_0': 0.8489, 'acc_1_1': 0.8692, 'mean_acc': 0.8923}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.8964, 'worst_acc': 0.8209, 'acc_0_0': 0.8974, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.8629, 'acc_0_0': 0.9033, 'acc_0_1': 0.9073, 'acc_1_0': 0.8629, 'acc_1_1': 0.8645, 'mean_acc': 0.8961}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8902, 'worst_acc': 0.8209, 'acc_0_0': 0.8889, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8755, 'worst_acc': 0.8489, 'acc_0_0': 0.8816, 'acc_0_1': 0.9135, 'acc_1_0': 0.8707, 'acc_1_1': 0.8489, 'mean_acc': 0.8892}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.7523, 'acc_0_0': 0.9716, 'acc_0_1': 0.9441, 'acc_1_0': 0.7523, 'acc_1_1': 0.8115, 'mean_acc': 0.9189}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.771, 'acc_0_0': 0.9698, 'acc_0_1': 0.9366, 'acc_1_0': 0.771, 'acc_1_1': 0.8178, 'mean_acc': 0.918}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8832, 'worst_acc': 0.8209, 'acc_0_0': 0.8846, 'acc_0_1': 0.9013, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8739, 'worst_acc': 0.8505, 'acc_0_0': 0.8798, 'acc_0_1': 0.8953, 'acc_1_0': 0.8785, 'acc_1_1': 0.8505, 'mean_acc': 0.8825}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8612, 'worst_acc': 0.8504, 'acc_0_0': 0.8504, 'acc_0_1': 0.8755, 'acc_1_0': 0.8657, 'acc_1_1': 0.8939, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.8456, 'worst_acc': 0.8421, 'acc_0_0': 0.8421, 'acc_0_1': 0.8874, 'acc_1_0': 0.8925, 'acc_1_1': 0.8474, 'mean_acc': 0.8659}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8973, 'worst_acc': 0.824, 'acc_0_0': 0.9197, 'acc_0_1': 0.9082, 'acc_1_0': 0.8458, 'acc_1_1': 0.824, 'mean_acc': 0.8964}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7586, 'acc_0_0': 0.9588, 'acc_0_1': 0.9295, 'acc_1_0': 0.7586, 'acc_1_1': 0.7882, 'mean_acc': 0.9063}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.771, 'acc_0_0': 0.9583, 'acc_0_1': 0.9299, 'acc_1_0': 0.771, 'acc_1_1': 0.7991, 'mean_acc': 0.9089}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7788, 'acc_0_0': 0.9561, 'acc_0_1': 0.9361, 'acc_1_0': 0.7788, 'acc_1_1': 0.7913, 'mean_acc': 0.9104}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7913, 'acc_0_0': 0.9525, 'acc_0_1': 0.9361, 'acc_1_0': 0.7913, 'acc_1_1': 0.7913, 'mean_acc': 0.9104}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7726, 'acc_0_0': 0.953, 'acc_0_1': 0.9406, 'acc_1_0': 0.7882, 'acc_1_1': 0.7726, 'mean_acc': 0.9099}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7695, 'acc_0_0': 0.9557, 'acc_0_1': 0.9437, 'acc_1_0': 0.785, 'acc_1_1': 0.7695, 'mean_acc': 0.9115}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.7679, 'acc_0_0': 0.957, 'acc_0_1': 0.9441, 'acc_1_0': 0.785, 'acc_1_1': 0.7679, 'mean_acc': 0.912}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7695, 'acc_0_0': 0.957, 'acc_0_1': 0.9446, 'acc_1_0': 0.7835, 'acc_1_1': 0.7695, 'mean_acc': 0.9122}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7664, 'acc_0_0': 0.9583, 'acc_0_1': 0.9441, 'acc_1_0': 0.7819, 'acc_1_1': 0.7664, 'mean_acc': 0.912}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7726, 'acc_0_0': 0.9574, 'acc_0_1': 0.9441, 'acc_1_0': 0.7819, 'acc_1_1': 0.7726, 'mean_acc': 0.9123}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7679, 'acc_0_0': 0.9543, 'acc_0_1': 0.9437, 'acc_1_0': 0.7866, 'acc_1_1': 0.7679, 'mean_acc': 0.9109}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7819, 'acc_0_0': 0.9512, 'acc_0_1': 0.9392, 'acc_1_0': 0.7928, 'acc_1_1': 0.7819, 'mean_acc': 0.9103}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9023, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7788, 'acc_0_0': 0.949, 'acc_0_1': 0.9375, 'acc_1_0': 0.7975, 'acc_1_1': 0.7788, 'mean_acc': 0.9089}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7835, 'acc_0_0': 0.949, 'acc_0_1': 0.937, 'acc_1_0': 0.7975, 'acc_1_1': 0.7835, 'mean_acc': 0.9092}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7897, 'acc_0_0': 0.9517, 'acc_0_1': 0.9348, 'acc_1_0': 0.7928, 'acc_1_1': 0.7897, 'mean_acc': 0.9096}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7928, 'acc_0_0': 0.9525, 'acc_0_1': 0.9348, 'acc_1_0': 0.7944, 'acc_1_1': 0.7928, 'mean_acc': 0.9104}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7928, 'acc_0_0': 0.9512, 'acc_0_1': 0.9357, 'acc_1_0': 0.7991, 'acc_1_1': 0.7928, 'mean_acc': 0.9108}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7897, 'acc_0_0': 0.9499, 'acc_0_1': 0.9357, 'acc_1_0': 0.8037, 'acc_1_1': 0.7897, 'mean_acc': 0.9104}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9126, 'worst_acc': 0.7928, 'acc_0_0': 0.9494, 'acc_0_1': 0.9339, 'acc_1_0': 0.8053, 'acc_1_1': 0.7928, 'mean_acc': 0.9101}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7897, 'acc_0_0': 0.9494, 'acc_0_1': 0.9348, 'acc_1_0': 0.8053, 'acc_1_1': 0.7897, 'mean_acc': 0.9101}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7897, 'acc_0_0': 0.9499, 'acc_0_1': 0.9353, 'acc_1_0': 0.8022, 'acc_1_1': 0.7897, 'mean_acc': 0.9101}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7913, 'acc_0_0': 0.9503, 'acc_0_1': 0.9344, 'acc_1_0': 0.8022, 'acc_1_1': 0.7913, 'mean_acc': 0.9101}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7913, 'acc_0_0': 0.9481, 'acc_0_1': 0.9344, 'acc_1_0': 0.8037, 'acc_1_1': 0.7913, 'mean_acc': 0.9094}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7913, 'acc_0_0': 0.9477, 'acc_0_1': 0.9339, 'acc_1_0': 0.8069, 'acc_1_1': 0.7913, 'mean_acc': 0.9094}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7882, 'acc_0_0': 0.949, 'acc_0_1': 0.9348, 'acc_1_0': 0.8037, 'acc_1_1': 0.7882, 'mean_acc': 0.9096}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7913, 'acc_0_0': 0.949, 'acc_0_1': 0.9335, 'acc_1_0': 0.8022, 'acc_1_1': 0.7913, 'mean_acc': 0.9092}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7866, 'acc_0_0': 0.9503, 'acc_0_1': 0.9361, 'acc_1_0': 0.7975, 'acc_1_1': 0.7866, 'mean_acc': 0.9097}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7866, 'acc_0_0': 0.9499, 'acc_0_1': 0.9357, 'acc_1_0': 0.7975, 'acc_1_1': 0.7866, 'mean_acc': 0.9094}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7882, 'acc_0_0': 0.9486, 'acc_0_1': 0.9348, 'acc_1_0': 0.8022, 'acc_1_1': 0.7882, 'mean_acc': 0.9092}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7866, 'acc_0_0': 0.9508, 'acc_0_1': 0.9361, 'acc_1_0': 0.7975, 'acc_1_1': 0.7866, 'mean_acc': 0.9099}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7866, 'acc_0_0': 0.9486, 'acc_0_1': 0.9344, 'acc_1_0': 0.8037, 'acc_1_1': 0.7866, 'mean_acc': 0.909}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7866, 'acc_0_0': 0.949, 'acc_0_1': 0.9344, 'acc_1_0': 0.8006, 'acc_1_1': 0.7866, 'mean_acc': 0.9089}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7897, 'acc_0_0': 0.9481, 'acc_0_1': 0.9344, 'acc_1_0': 0.8053, 'acc_1_1': 0.7897, 'mean_acc': 0.9094}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7866, 'acc_0_0': 0.9486, 'acc_0_1': 0.9348, 'acc_1_0': 0.8022, 'acc_1_1': 0.7866, 'mean_acc': 0.909}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7866, 'acc_0_0': 0.9477, 'acc_0_1': 0.9353, 'acc_1_0': 0.8022, 'acc_1_1': 0.7866, 'mean_acc': 0.9089}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7882, 'acc_0_0': 0.9481, 'acc_0_1': 0.9344, 'acc_1_0': 0.8022, 'acc_1_1': 0.7882, 'mean_acc': 0.9089}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.785, 'acc_0_0': 0.9508, 'acc_0_1': 0.9357, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9097}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.785, 'acc_0_0': 0.9512, 'acc_0_1': 0.9361, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9101}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7866, 'acc_0_0': 0.9503, 'acc_0_1': 0.9344, 'acc_1_0': 0.8006, 'acc_1_1': 0.7866, 'mean_acc': 0.9094}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.785, 'acc_0_0': 0.9503, 'acc_0_1': 0.9357, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9096}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.785, 'acc_0_0': 0.949, 'acc_0_1': 0.9353, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9089}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.785, 'acc_0_0': 0.949, 'acc_0_1': 0.937, 'acc_1_0': 0.8006, 'acc_1_1': 0.785, 'mean_acc': 0.9097}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.785, 'acc_0_0': 0.949, 'acc_0_1': 0.9353, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9089}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.785, 'acc_0_0': 0.9486, 'acc_0_1': 0.9361, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.909}
========================================================================
> end of training. 

best epoch : 49
best training accuracy on [class]: {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9003, 'worst_acc': 0.8507, 'acc_0_0': 0.8974, 'acc_0_1': 0.9185, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.9017}
best test accuracy on [class]: {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8489, 'acc_0_0': 0.9042, 'acc_0_1': 0.8993, 'acc_1_0': 0.8489, 'acc_1_1': 0.8692, 'mean_acc': 0.8923}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8489, 'acc_0_0': 0.9042, 'acc_0_1': 0.8993, 'acc_1_0': 0.8489, 'acc_1_1': 0.8692, 'mean_acc': 0.8923}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6402, 'acc_0_0': 0.9596, 'acc_0_1': 0.9166, 'acc_1_0': 0.6402, 'acc_1_1': 0.9891, 'mean_acc': 0.9108}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 49': {'Train': {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.99}, 'Val': {'weighted_mean_acc': 0.9003, 'worst_acc': 0.8507, 'acc_0_0': 0.8974, 'acc_0_1': 0.9185, 'acc_1_0': 0.8507, 'acc_1_1': 0.9091, 'mean_acc': 0.9017}, 'Test': {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8489, 'acc_0_0': 0.9042, 'acc_0_1': 0.8993, 'acc_1_0': 0.8489, 'acc_1_1': 0.8692, 'mean_acc': 0.8923}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8489, 'acc_0_0': 0.9042, 'acc_0_1': 0.8993, 'acc_1_0': 0.8489, 'acc_1_1': 0.8692, 'mean_acc': 0.8923}, 'spurious': {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6402, 'acc_0_0': 0.9596, 'acc_0_1': 0.9166, 'acc_1_0': 0.6402, 'acc_1_1': 0.9891, 'mean_acc': 0.9108}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3859, 'acc_0_0': 0.9483, 'acc_0_1': 0.3859, 'acc_1_0': 0.4286, 'acc_1_1': 0.7739, 'mean_acc': 0.8822}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.3433, 'acc_0_0': 0.9957, 'acc_0_1': 0.4592, 'acc_1_0': 0.3433, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9539, 'worst_acc': 0.2804, 'acc_0_0': 0.9982, 'acc_0_1': 0.4182, 'acc_1_0': 0.2804, 'acc_1_1': 0.9361, 'mean_acc': 0.6861}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9883, 'acc_0_1': 0.4946, 'acc_1_0': 0.4286, 'acc_1_1': 0.9413, 'mean_acc': 0.9525}
Val(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.2661, 'acc_0_0': 0.9573, 'acc_0_1': 0.2661, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.6683}
Test(class): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.2213, 'acc_0_0': 0.9503, 'acc_0_1': 0.2213, 'acc_1_0': 0.7523, 'acc_1_1': 0.9798, 'mean_acc': 0.6479}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9886, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.8855, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5751, 'acc_0_0': 0.9872, 'acc_0_1': 0.5751, 'acc_1_0': 0.7164, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.5357, 'acc_0_0': 0.9756, 'acc_0_1': 0.5357, 'acc_1_0': 0.6947, 'acc_1_1': 0.9455, 'mean_acc': 0.7699}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9823, 'acc_0_1': 0.6957, 'acc_1_0': 0.6607, 'acc_1_1': 0.9413, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5075, 'acc_0_0': 0.9957, 'acc_0_1': 0.7639, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.5312, 'acc_0_0': 0.9956, 'acc_0_1': 0.7388, 'acc_1_0': 0.5312, 'acc_1_1': 0.9065, 'mean_acc': 0.8343}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.663, 'acc_1_0': 0.5893, 'acc_1_1': 0.9442, 'mean_acc': 0.9658}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.7833}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5743, 'acc_0_0': 0.9929, 'acc_0_1': 0.5743, 'acc_1_0': 0.5763, 'acc_1_1': 0.9455, 'mean_acc': 0.7786}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9949, 'acc_0_1': 0.6739, 'acc_1_0': 0.5536, 'acc_1_1': 0.9461, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5639, 'acc_0_0': 0.9938, 'acc_0_1': 0.6142, 'acc_1_0': 0.5639, 'acc_1_1': 0.9361, 'mean_acc': 0.792}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.6522, 'acc_1_0': 0.5893, 'acc_1_1': 0.9574, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.5779, 'acc_0_0': 0.9933, 'acc_0_1': 0.6217, 'acc_1_0': 0.5779, 'acc_1_1': 0.9408, 'mean_acc': 0.7969}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9963, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9451, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6438, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6059, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.7994}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9949, 'acc_0_1': 0.7446, 'acc_1_0': 0.625, 'acc_1_1': 0.9499, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6031, 'acc_0_0': 0.9916, 'acc_0_1': 0.6031, 'acc_1_0': 0.6184, 'acc_1_1': 0.9486, 'mean_acc': 0.7943}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9546, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5826, 'acc_0_0': 0.9938, 'acc_0_1': 0.6545, 'acc_1_0': 0.5826, 'acc_1_1': 0.9393, 'mean_acc': 0.8101}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9951, 'acc_0_1': 0.7446, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5483, 'acc_0_0': 0.9956, 'acc_0_1': 0.7268, 'acc_1_0': 0.5483, 'acc_1_1': 0.9283, 'mean_acc': 0.834}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.996, 'acc_0_1': 0.75, 'acc_1_0': 0.6429, 'acc_1_1': 0.9555, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5654, 'acc_0_0': 0.9942, 'acc_0_1': 0.6927, 'acc_1_0': 0.5654, 'acc_1_1': 0.9377, 'mean_acc': 0.8231}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.6896, 'acc_1_0': 0.5794, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.7826, 'acc_1_0': 0.6786, 'acc_1_1': 0.9697, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5075, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.567, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.567, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9977, 'acc_0_1': 0.7989, 'acc_1_0': 0.6786, 'acc_1_1': 0.964, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6004, 'acc_0_0': 0.9894, 'acc_0_1': 0.6004, 'acc_1_0': 0.6153, 'acc_1_1': 0.9455, 'mean_acc': 0.7917}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7854, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5607, 'acc_0_0': 0.9942, 'acc_0_1': 0.761, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8483}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9966, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7086, 'acc_1_0': 0.5654, 'acc_1_1': 0.9346, 'mean_acc': 0.8288}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9991, 'acc_0_1': 0.8859, 'acc_1_0': 0.7679, 'acc_1_1': 0.9584, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6075, 'acc_0_0': 0.9925, 'acc_0_1': 0.6177, 'acc_1_0': 0.6075, 'acc_1_1': 0.947, 'mean_acc': 0.7989}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.983, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9942, 'acc_0_1': 0.7933, 'acc_1_0': 0.5545, 'acc_1_1': 0.919, 'mean_acc': 0.859}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.8214, 'acc_1_1': 0.983, 'mean_acc': 0.9881}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7682, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5654, 'acc_1_1': 0.9206, 'mean_acc': 0.8533}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.8967, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7425, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6044, 'acc_0_0': 0.9911, 'acc_0_1': 0.733, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8416}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.8929, 'acc_1_1': 0.9763, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6119, 'acc_0_0': 0.9786, 'acc_0_1': 0.6395, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5981, 'acc_0_0': 0.9925, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9502, 'mean_acc': 0.8098}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9896, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7983, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5748, 'acc_0_0': 0.9938, 'acc_0_1': 0.8231, 'acc_1_0': 0.5748, 'acc_1_1': 0.9065, 'mean_acc': 0.8712}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.9076, 'acc_1_0': 0.8571, 'acc_1_1': 0.9886, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.6867, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6106, 'acc_0_0': 0.9894, 'acc_0_1': 0.6927, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9868, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6215, 'acc_0_0': 0.9894, 'acc_0_1': 0.7282, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.841}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9989, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9962, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.7548, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8485}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9185, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6215, 'acc_0_0': 0.9876, 'acc_0_1': 0.7042, 'acc_1_0': 0.6215, 'acc_1_1': 0.9377, 'mean_acc': 0.8312}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7255, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8397}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9107, 'acc_1_1': 0.9953, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9732, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.5623, 'acc_0_0': 0.9956, 'acc_0_1': 0.7437, 'acc_1_0': 0.5623, 'acc_1_1': 0.9268, 'mean_acc': 0.8419}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.9022, 'acc_1_0': 0.8929, 'acc_1_1': 0.9915, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6355, 'acc_0_0': 0.9854, 'acc_0_1': 0.745, 'acc_1_0': 0.6355, 'acc_1_1': 0.919, 'mean_acc': 0.8457}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9956}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.6269, 'acc_0_0': 0.9744, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6573, 'acc_0_0': 0.9867, 'acc_0_1': 0.6962, 'acc_1_0': 0.6573, 'acc_1_1': 0.9361, 'mean_acc': 0.8315}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.9286, 'acc_1_1': 0.9905, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6781, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6324, 'acc_0_0': 0.9867, 'acc_0_1': 0.6914, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.8272}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9674, 'acc_1_0': 0.9464, 'acc_1_1': 0.9943, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.721, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6199, 'acc_0_0': 0.9925, 'acc_0_1': 0.7499, 'acc_1_0': 0.6199, 'acc_1_1': 0.9252, 'mean_acc': 0.8493}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9286, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5966, 'acc_0_0': 0.9744, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.5863, 'acc_0_0': 0.9778, 'acc_0_1': 0.5863, 'acc_1_0': 0.6636, 'acc_1_1': 0.9517, 'mean_acc': 0.7877}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.7752, 'acc_1_0': 0.609, 'acc_1_1': 0.9206, 'mean_acc': 0.8567}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6542, 'acc_0_0': 0.9836, 'acc_0_1': 0.6625, 'acc_1_0': 0.6542, 'acc_1_1': 0.9439, 'mean_acc': 0.8177}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9981, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5623, 'acc_0_0': 0.9969, 'acc_0_1': 0.8284, 'acc_1_0': 0.5623, 'acc_1_1': 0.905, 'mean_acc': 0.873}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6352, 'acc_0_0': 0.9829, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.6381, 'acc_0_0': 0.9796, 'acc_0_1': 0.6381, 'acc_1_0': 0.6573, 'acc_1_1': 0.9533, 'mean_acc': 0.8081}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.7344, 'acc_1_0': 0.6277, 'acc_1_1': 0.9299, 'mean_acc': 0.8426}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6542, 'acc_0_0': 0.9858, 'acc_0_1': 0.7007, 'acc_1_0': 0.6542, 'acc_1_1': 0.9408, 'mean_acc': 0.8331}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5, 'acc_0_0': 0.9914, 'acc_0_1': 0.8326, 'acc_1_0': 0.5, 'acc_1_1': 0.8806, 'mean_acc': 0.8631}
Val(class)(new adapter): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6119, 'acc_0_0': 0.9829, 'acc_0_1': 0.867, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6308, 'acc_0_0': 0.9925, 'acc_0_1': 0.8696, 'acc_1_0': 0.6308, 'acc_1_1': 0.8769, 'mean_acc': 0.8918}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0758, 'acc_0_0': 0.8841, 'acc_0_1': 0.5665, 'acc_1_0': 0.0758, 'acc_1_1': 0.806, 'mean_acc': 0.6628}
Val(class)(new adapter): {'weighted_mean_acc': 0.9448, 'worst_acc': 0.5236, 'acc_0_0': 0.953, 'acc_0_1': 0.5236, 'acc_1_0': 0.7761, 'acc_1_1': 1.0, 'mean_acc': 0.7717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.467, 'acc_0_0': 0.9641, 'acc_0_1': 0.467, 'acc_1_0': 0.796, 'acc_1_1': 0.9766, 'mean_acc': 0.7534}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9914, 'acc_0_1': 0.8026, 'acc_1_0': 0.5758, 'acc_1_1': 0.8358, 'mean_acc': 0.8548}
Val(class)(new adapter): {'weighted_mean_acc': 0.8438, 'worst_acc': 0.5606, 'acc_0_0': 0.9231, 'acc_0_1': 0.9614, 'acc_1_0': 0.8507, 'acc_1_1': 0.5606, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8295, 'worst_acc': 0.5249, 'acc_0_0': 0.914, 'acc_0_1': 0.969, 'acc_1_0': 0.8411, 'acc_1_1': 0.5249, 'mean_acc': 0.8842}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2239, 'acc_0_0': 0.824, 'acc_0_1': 0.9571, 'acc_1_0': 0.8485, 'acc_1_1': 0.2239, 'mean_acc': 0.8114}
Val(class)(new adapter): {'weighted_mean_acc': 0.8834, 'worst_acc': 0.8498, 'acc_0_0': 0.8632, 'acc_0_1': 0.8498, 'acc_1_0': 0.9104, 'acc_1_1': 0.9545, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8611, 'worst_acc': 0.8253, 'acc_0_0': 0.8457, 'acc_0_1': 0.8253, 'acc_1_0': 0.9081, 'acc_1_1': 0.9159, 'mean_acc': 0.8524}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9871, 'acc_0_1': 0.9313, 'acc_1_0': 0.7273, 'acc_1_1': 0.9104, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.8598, 'acc_0_0': 0.9348, 'acc_0_1': 0.9171, 'acc_1_0': 0.8614, 'acc_1_1': 0.8598, 'mean_acc': 0.9115}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.9356, 'acc_0_1': 0.9785, 'acc_1_0': 0.7879, 'acc_1_1': 0.6418, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.8359, 'worst_acc': 0.7949, 'acc_0_0': 0.7949, 'acc_0_1': 0.824, 'acc_1_0': 0.9104, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.8186, 'worst_acc': 0.7863, 'acc_0_0': 0.7863, 'acc_0_1': 0.831, 'acc_1_0': 0.9283, 'acc_1_1': 0.9174, 'mean_acc': 0.834}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8927, 'acc_0_0': 0.8927, 'acc_0_1': 0.9399, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8326, 'acc_0_0': 0.9274, 'acc_0_1': 0.8326, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.8457, 'acc_0_0': 0.9428, 'acc_0_1': 0.8457, 'acc_1_0': 0.8536, 'acc_1_1': 0.9112, 'mean_acc': 0.8916}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6212, 'acc_0_0': 1.0, 'acc_0_1': 0.9313, 'acc_1_0': 0.6212, 'acc_1_1': 0.8806, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.8442, 'acc_0_0': 0.9353, 'acc_0_1': 0.894, 'acc_1_0': 0.8442, 'acc_1_1': 0.866, 'mean_acc': 0.9014}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.8997, 'worst_acc': 0.8209, 'acc_0_0': 0.9017, 'acc_0_1': 0.9185, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8784, 'worst_acc': 0.8178, 'acc_0_0': 0.894, 'acc_0_1': 0.9308, 'acc_1_0': 0.8769, 'acc_1_1': 0.8178, 'mean_acc': 0.898}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9399, 'acc_0_0': 0.9399, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.8861, 'worst_acc': 0.7727, 'acc_0_0': 0.9188, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.7727, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.729, 'acc_0_0': 0.9406, 'acc_0_1': 0.957, 'acc_1_0': 0.824, 'acc_1_1': 0.729, 'mean_acc': 0.9106}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.7727, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.6776, 'acc_0_0': 0.965, 'acc_0_1': 0.9641, 'acc_1_0': 0.7492, 'acc_1_1': 0.6776, 'mean_acc': 0.9089}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 1.0, 'acc_0_1': 0.9785, 'acc_1_0': 0.9545, 'acc_1_1': 0.8806, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8984, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8178, 'acc_0_0': 0.9233, 'acc_0_1': 0.9206, 'acc_1_0': 0.824, 'acc_1_1': 0.8178, 'mean_acc': 0.8996}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8913, 'worst_acc': 0.8209, 'acc_0_0': 0.8932, 'acc_0_1': 0.8627, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8882, 'worst_acc': 0.8714, 'acc_0_0': 0.8931, 'acc_0_1': 0.8714, 'acc_1_0': 0.8769, 'acc_1_1': 0.8754, 'mean_acc': 0.8809}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.8841, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.8178, 'acc_0_0': 0.9379, 'acc_0_1': 0.8993, 'acc_1_0': 0.8178, 'acc_1_1': 0.8411, 'mean_acc': 0.8989}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7757, 'acc_0_0': 0.965, 'acc_0_1': 0.937, 'acc_1_0': 0.7757, 'acc_1_1': 0.7944, 'mean_acc': 0.9142}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7586, 'acc_0_0': 0.969, 'acc_0_1': 0.9379, 'acc_1_0': 0.7586, 'acc_1_1': 0.7913, 'mean_acc': 0.9139}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.785, 'acc_0_0': 0.9574, 'acc_0_1': 0.9317, 'acc_1_0': 0.785, 'acc_1_1': 0.8053, 'mean_acc': 0.9115}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7975, 'acc_0_0': 0.9534, 'acc_0_1': 0.9322, 'acc_1_0': 0.7975, 'acc_1_1': 0.8022, 'mean_acc': 0.9111}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7975, 'acc_0_0': 0.9503, 'acc_0_1': 0.9357, 'acc_1_0': 0.7991, 'acc_1_1': 0.7975, 'mean_acc': 0.9109}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7928, 'acc_0_0': 0.9521, 'acc_0_1': 0.9397, 'acc_1_0': 0.7944, 'acc_1_1': 0.7928, 'mean_acc': 0.9122}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7835, 'acc_0_0': 0.9539, 'acc_0_1': 0.9415, 'acc_1_0': 0.7913, 'acc_1_1': 0.7835, 'mean_acc': 0.9122}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7757, 'acc_0_0': 0.9548, 'acc_0_1': 0.945, 'acc_1_0': 0.7804, 'acc_1_1': 0.7757, 'mean_acc': 0.9118}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7695, 'acc_0_0': 0.9579, 'acc_0_1': 0.9459, 'acc_1_0': 0.7695, 'acc_1_1': 0.771, 'mean_acc': 0.9116}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7664, 'acc_0_0': 0.9592, 'acc_0_1': 0.945, 'acc_1_0': 0.7664, 'acc_1_1': 0.7726, 'mean_acc': 0.9116}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9428, 'acc_1_0': 0.7664, 'acc_1_1': 0.7835, 'mean_acc': 0.9111}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7632, 'acc_0_0': 0.961, 'acc_0_1': 0.9477, 'acc_1_0': 0.7632, 'acc_1_1': 0.7664, 'mean_acc': 0.9123}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7632, 'acc_0_0': 0.9632, 'acc_0_1': 0.9477, 'acc_1_0': 0.7632, 'acc_1_1': 0.7664, 'mean_acc': 0.9132}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7617, 'acc_0_0': 0.9632, 'acc_0_1': 0.9477, 'acc_1_0': 0.7617, 'acc_1_1': 0.7664, 'mean_acc': 0.913}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7555, 'acc_0_0': 0.9641, 'acc_0_1': 0.9499, 'acc_1_0': 0.7555, 'acc_1_1': 0.7586, 'mean_acc': 0.9127}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7523, 'acc_0_0': 0.965, 'acc_0_1': 0.9459, 'acc_1_0': 0.7523, 'acc_1_1': 0.7695, 'mean_acc': 0.9123}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7523, 'acc_0_0': 0.965, 'acc_0_1': 0.9441, 'acc_1_0': 0.7523, 'acc_1_1': 0.7741, 'mean_acc': 0.9122}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7523, 'acc_0_0': 0.965, 'acc_0_1': 0.9441, 'acc_1_0': 0.7523, 'acc_1_1': 0.7773, 'mean_acc': 0.9125}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.7539, 'acc_0_0': 0.9627, 'acc_0_1': 0.9432, 'acc_1_0': 0.7539, 'acc_1_1': 0.7804, 'mean_acc': 0.9118}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7648, 'acc_0_0': 0.9592, 'acc_0_1': 0.9406, 'acc_1_0': 0.7648, 'acc_1_1': 0.7897, 'mean_acc': 0.9116}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7648, 'acc_0_0': 0.9605, 'acc_0_1': 0.9428, 'acc_1_0': 0.7648, 'acc_1_1': 0.7866, 'mean_acc': 0.9127}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7632, 'acc_0_0': 0.9614, 'acc_0_1': 0.9441, 'acc_1_0': 0.7632, 'acc_1_1': 0.7788, 'mean_acc': 0.9125}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7617, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7617, 'acc_1_1': 0.7804, 'mean_acc': 0.9127}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7586, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7586, 'acc_1_1': 0.7773, 'mean_acc': 0.912}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7555, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.7555, 'acc_1_1': 0.7741, 'mean_acc': 0.9115}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7632, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.7632, 'acc_1_1': 0.7788, 'mean_acc': 0.9128}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7648, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7773, 'mean_acc': 0.9128}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7648, 'acc_0_0': 0.961, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7788, 'mean_acc': 0.9127}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7648, 'acc_0_0': 0.9601, 'acc_0_1': 0.9432, 'acc_1_0': 0.7648, 'acc_1_1': 0.7866, 'mean_acc': 0.9127}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7664, 'acc_0_0': 0.9592, 'acc_0_1': 0.9424, 'acc_1_0': 0.7664, 'acc_1_1': 0.7866, 'mean_acc': 0.9122}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7648, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7819, 'mean_acc': 0.9132}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7648, 'acc_0_0': 0.9605, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7788, 'mean_acc': 0.9125}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7632, 'acc_0_0': 0.961, 'acc_0_1': 0.9446, 'acc_1_0': 0.7632, 'acc_1_1': 0.7757, 'mean_acc': 0.9122}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7555, 'acc_0_0': 0.9623, 'acc_0_1': 0.9446, 'acc_1_0': 0.7555, 'acc_1_1': 0.7741, 'mean_acc': 0.9116}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7617, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7617, 'acc_1_1': 0.7804, 'mean_acc': 0.9127}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7648, 'acc_0_0': 0.961, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7773, 'mean_acc': 0.9125}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7617, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7617, 'acc_1_1': 0.7773, 'mean_acc': 0.9123}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7679, 'acc_0_0': 0.9592, 'acc_0_1': 0.9428, 'acc_1_0': 0.7679, 'acc_1_1': 0.7819, 'mean_acc': 0.912}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7648, 'acc_0_0': 0.9601, 'acc_0_1': 0.9441, 'acc_1_0': 0.7648, 'acc_1_1': 0.7804, 'mean_acc': 0.9123}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7664, 'acc_0_0': 0.9605, 'acc_0_1': 0.9441, 'acc_1_0': 0.7664, 'acc_1_1': 0.7804, 'mean_acc': 0.9127}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9186, 'worst_acc': 0.7664, 'acc_0_0': 0.9605, 'acc_0_1': 0.9428, 'acc_1_0': 0.7664, 'acc_1_1': 0.7835, 'mean_acc': 0.9125}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7679, 'acc_0_0': 0.9592, 'acc_0_1': 0.9428, 'acc_1_0': 0.7679, 'acc_1_1': 0.7866, 'mean_acc': 0.9125}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7648, 'acc_0_0': 0.9596, 'acc_0_1': 0.9437, 'acc_1_0': 0.7648, 'acc_1_1': 0.7819, 'mean_acc': 0.9122}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7648, 'acc_0_0': 0.9605, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7804, 'mean_acc': 0.9127}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7632, 'acc_0_0': 0.961, 'acc_0_1': 0.9446, 'acc_1_0': 0.7632, 'acc_1_1': 0.7804, 'mean_acc': 0.9127}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7648, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7773, 'mean_acc': 0.9127}
========================================================================
> end of training. 

best epoch : 44
best training accuracy on [class]: {'worst_acc': 0.2239, 'acc_0_0': 0.824, 'acc_0_1': 0.9571, 'acc_1_0': 0.8485, 'acc_1_1': 0.2239, 'mean_acc': 0.8114}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8834, 'worst_acc': 0.8498, 'acc_0_0': 0.8632, 'acc_0_1': 0.8498, 'acc_1_0': 0.9104, 'acc_1_1': 0.9545, 'mean_acc': 0.8733}
best test accuracy on [class]: {'weighted_mean_acc': 0.8611, 'worst_acc': 0.8253, 'acc_0_0': 0.8457, 'acc_0_1': 0.8253, 'acc_1_0': 0.9081, 'acc_1_1': 0.9159, 'mean_acc': 0.8524}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8611, 'worst_acc': 0.8253, 'acc_0_0': 0.8457, 'acc_0_1': 0.8253, 'acc_1_0': 0.9081, 'acc_1_1': 0.9159, 'mean_acc': 0.8524}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4704, 'acc_0_0': 0.9592, 'acc_0_1': 0.9211, 'acc_1_0': 0.4704, 'acc_1_1': 0.9875, 'mean_acc': 0.8933}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 44': {'Train': {'worst_acc': 0.2239, 'acc_0_0': 0.824, 'acc_0_1': 0.9571, 'acc_1_0': 0.8485, 'acc_1_1': 0.2239, 'mean_acc': 0.8114}, 'Val': {'weighted_mean_acc': 0.8834, 'worst_acc': 0.8498, 'acc_0_0': 0.8632, 'acc_0_1': 0.8498, 'acc_1_0': 0.9104, 'acc_1_1': 0.9545, 'mean_acc': 0.8733}, 'Test': {'weighted_mean_acc': 0.8611, 'worst_acc': 0.8253, 'acc_0_0': 0.8457, 'acc_0_1': 0.8253, 'acc_1_0': 0.9081, 'acc_1_1': 0.9159, 'mean_acc': 0.8524}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8611, 'worst_acc': 0.8253, 'acc_0_0': 0.8457, 'acc_0_1': 0.8253, 'acc_1_0': 0.9081, 'acc_1_1': 0.9159, 'mean_acc': 0.8524}, 'spurious': {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4704, 'acc_0_0': 0.9592, 'acc_0_1': 0.9211, 'acc_1_0': 0.4704, 'acc_1_1': 0.9875, 'mean_acc': 0.8933}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8652     0.8598   0.8656  ...   0.8754   0.8598    0.8735
2                       0.8957     0.8489   0.9042  ...   0.8489   0.8692    0.8923
3                       0.8611     0.8253   0.8457  ...   0.9081   0.9159    0.8524
test_mean               0.8740     0.8447   0.8718  ...   0.8775   0.8816    0.8727
test_std                0.0154     0.0144   0.0243  ...   0.0242   0.0245    0.0163
1                       0.9721     0.6246   0.9858  ...   0.6246   0.9720    0.8794
2                       0.9608     0.6402   0.9596  ...   0.6402   0.9891    0.9108
3                       0.9583     0.4704   0.9592  ...   0.4704   0.9875    0.8933
zs_spu_mean             0.9637     0.5784   0.9682  ...   0.5784   0.9829    0.8945
zs_spu_std              0.0060     0.0766   0.0124  ...   0.0766   0.0077    0.0128
1                          NaN     0.9254   0.9914  ...   0.9545   0.9254    0.9666
2                          NaN     0.9848   0.9914  ...   0.9848   0.9851    0.9900
3                          NaN     0.2239   0.8240  ...   0.8485   0.2239    0.8114
tr_mean                    NaN     0.7114   0.9356  ...   0.9293   0.7115    0.9227
tr_std                     NaN     0.3455   0.0789  ...   0.0584   0.3456    0.0793
1                       0.8994     0.8507   0.8889  ...   0.8507   0.9394    0.8883
2                       0.9003     0.8507   0.8974  ...   0.8507   0.9091    0.9017
3                       0.8834     0.8498   0.8632  ...   0.9104   0.9545    0.8733
val_mean                0.8944     0.8504   0.8832  ...   0.8706   0.9343    0.8878
val_std                 0.0078     0.0004   0.0145  ...   0.0281   0.0189    0.0116
1                       0.8652     0.8598   0.8656  ...   0.8754   0.8598    0.8735
2                       0.8957     0.8489   0.9042  ...   0.8489   0.8692    0.8923
3                       0.8611     0.8253   0.8457  ...   0.9081   0.9159    0.8524
zs_tg_mean              0.8740     0.8447   0.8718  ...   0.8775   0.8816    0.8727
zs_tg_std               0.0154     0.0144   0.0243  ...   0.0242   0.0245    0.0163

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_1.0_lrr1.0_bsr128_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0634, 'acc_0_0': 0.9643, 'acc_0_1': 0.9511, 'acc_1_0': 0.1071, 'acc_1_1': 0.0634, 'mean_acc': 0.7552}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3571, 'acc_0_0': 0.992, 'acc_0_1': 0.6957, 'acc_1_0': 0.3571, 'acc_1_1': 0.8023, 'mean_acc': 0.9314}
Val(class): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8798, 'acc_1_0': 0.4925, 'acc_1_1': 0.6061, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.4907, 'acc_0_0': 0.9938, 'acc_0_1': 0.8767, 'acc_1_0': 0.4907, 'acc_1_1': 0.6012, 'mean_acc': 0.849}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9831, 'acc_0_1': 0.6576, 'acc_1_0': 0.5536, 'acc_1_1': 0.9243, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.8888, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.3284, 'acc_1_1': 0.5455, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.3754, 'acc_0_0': 0.9978, 'acc_0_1': 0.9135, 'acc_1_0': 0.3754, 'acc_1_1': 0.5763, 'mean_acc': 0.8493}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9889, 'acc_0_1': 0.6848, 'acc_1_0': 0.625, 'acc_1_1': 0.9347, 'mean_acc': 0.961}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8112, 'acc_1_0': 0.4776, 'acc_1_1': 0.8939, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.5436, 'acc_0_0': 0.9925, 'acc_0_1': 0.8071, 'acc_1_0': 0.5436, 'acc_1_1': 0.8645, 'mean_acc': 0.8564}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9906, 'acc_0_1': 0.6685, 'acc_1_0': 0.6429, 'acc_1_1': 0.9565, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6012, 'acc_0_0': 0.9885, 'acc_0_1': 0.6373, 'acc_1_0': 0.6012, 'acc_1_1': 0.9486, 'mean_acc': 0.8045}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.663, 'acc_1_0': 0.6607, 'acc_1_1': 0.9631, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.5794, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5996, 'acc_0_0': 0.9871, 'acc_0_1': 0.5996, 'acc_1_0': 0.6106, 'acc_1_1': 0.9502, 'mean_acc': 0.7905}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9943, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9678, 'mean_acc': 0.9725}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.5665, 'acc_0_0': 0.9957, 'acc_0_1': 0.5665, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5809, 'acc_0_0': 0.9863, 'acc_0_1': 0.5809, 'acc_1_0': 0.6215, 'acc_1_1': 0.9548, 'mean_acc': 0.7846}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7065, 'acc_1_0': 0.6607, 'acc_1_1': 0.9612, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4635, 'acc_0_0': 0.9957, 'acc_0_1': 0.4635, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.5193, 'acc_0_0': 0.9814, 'acc_0_1': 0.5193, 'acc_1_0': 0.6745, 'acc_1_1': 0.9642, 'mean_acc': 0.7656}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9917, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9612, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.4721, 'acc_0_0': 0.9957, 'acc_0_1': 0.4721, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.49, 'acc_0_0': 0.984, 'acc_0_1': 0.49, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7541}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.992, 'acc_0_1': 0.6793, 'acc_1_0': 0.7143, 'acc_1_1': 0.9688, 'mean_acc': 0.9716}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.553, 'acc_0_0': 0.9836, 'acc_0_1': 0.553, 'acc_1_0': 0.6604, 'acc_1_1': 0.9595, 'mean_acc': 0.7775}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.6964, 'acc_1_1': 0.9707, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5942, 'acc_0_0': 0.9863, 'acc_0_1': 0.5942, 'acc_1_0': 0.6417, 'acc_1_1': 0.9533, 'mean_acc': 0.7919}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.994, 'acc_0_1': 0.7337, 'acc_1_0': 0.7143, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6266, 'acc_0_0': 0.9915, 'acc_0_1': 0.6266, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.612, 'acc_0_0': 0.9863, 'acc_0_1': 0.612, 'acc_1_0': 0.6449, 'acc_1_1': 0.9517, 'mean_acc': 0.7989}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9929, 'acc_0_1': 0.7772, 'acc_1_0': 0.7679, 'acc_1_1': 0.9659, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.565, 'acc_0_0': 0.9831, 'acc_0_1': 0.565, 'acc_1_0': 0.6807, 'acc_1_1': 0.9564, 'mean_acc': 0.7839}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9963, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4464, 'acc_0_0': 0.9872, 'acc_0_1': 0.4464, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7417}
Test(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.4293, 'acc_0_0': 0.9831, 'acc_0_1': 0.4293, 'acc_1_0': 0.6885, 'acc_1_1': 0.9688, 'mean_acc': 0.7333}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9931, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9678, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.7322, 'acc_1_0': 0.6277, 'acc_1_1': 0.9377, 'mean_acc': 0.8431}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9969, 'acc_0_1': 0.7935, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.5923, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5787, 'acc_0_0': 0.9849, 'acc_0_1': 0.5787, 'acc_1_0': 0.6324, 'acc_1_1': 0.9486, 'mean_acc': 0.7837}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9969, 'acc_0_1': 0.8315, 'acc_1_0': 0.8393, 'acc_1_1': 0.9792, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5872, 'acc_0_0': 0.992, 'acc_0_1': 0.7951, 'acc_1_0': 0.5872, 'acc_1_1': 0.9128, 'mean_acc': 0.8618}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8641, 'acc_1_0': 0.8036, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7854, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5576, 'acc_0_0': 0.9933, 'acc_0_1': 0.7933, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.8602}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9969, 'acc_0_1': 0.8587, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4807, 'acc_0_0': 0.9744, 'acc_0_1': 0.4807, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7533}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4683, 'acc_0_0': 0.9823, 'acc_0_1': 0.4683, 'acc_1_0': 0.6729, 'acc_1_1': 0.9673, 'mean_acc': 0.7463}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.984, 'acc_0_1': 0.6736, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.8219}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9969, 'acc_0_1': 0.913, 'acc_1_0': 0.9464, 'acc_1_1': 0.9811, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.6652, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5903, 'acc_0_0': 0.9863, 'acc_0_1': 0.6736, 'acc_1_0': 0.5903, 'acc_1_1': 0.933, 'mean_acc': 0.8148}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9943, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5545, 'acc_0_0': 0.9925, 'acc_0_1': 0.6758, 'acc_1_0': 0.5545, 'acc_1_1': 0.9299, 'mean_acc': 0.8138}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.996, 'acc_0_1': 0.875, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6524, 'acc_0_0': 0.9829, 'acc_0_1': 0.6524, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6421, 'acc_0_0': 0.9854, 'acc_0_1': 0.6421, 'acc_1_0': 0.6449, 'acc_1_1': 0.9548, 'mean_acc': 0.8107}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9937, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5436, 'acc_0_0': 0.9929, 'acc_0_1': 0.7583, 'acc_1_0': 0.5436, 'acc_1_1': 0.9268, 'mean_acc': 0.8445}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.996, 'acc_0_1': 0.8533, 'acc_1_0': 0.875, 'acc_1_1': 0.9735, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6309, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.6293, 'acc_0_0': 0.9792, 'acc_0_1': 0.6488, 'acc_1_0': 0.6293, 'acc_1_1': 0.9268, 'mean_acc': 0.806}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9954, 'acc_0_1': 0.8478, 'acc_1_0': 0.7857, 'acc_1_1': 0.9745, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.8884, 'acc_1_0': 0.4925, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.5, 'acc_0_0': 0.9965, 'acc_0_1': 0.8976, 'acc_1_0': 0.5, 'acc_1_1': 0.8583, 'mean_acc': 0.8876}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.944, 'worst_acc': 0.4292, 'acc_0_0': 0.9573, 'acc_0_1': 0.4292, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.4488, 'acc_0_0': 0.957, 'acc_0_1': 0.4488, 'acc_1_0': 0.7368, 'acc_1_1': 0.9688, 'mean_acc': 0.7361}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9929, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.9726, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.691, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6807, 'acc_0_0': 0.9871, 'acc_0_1': 0.7091, 'acc_1_0': 0.6807, 'acc_1_1': 0.947, 'mean_acc': 0.8405}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.9669, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9728, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.7641, 'acc_1_0': 0.5576, 'acc_1_1': 0.9159, 'mean_acc': 0.8459}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9969, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.9811, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3731, 'acc_0_0': 0.9957, 'acc_0_1': 0.8927, 'acc_1_0': 0.3731, 'acc_1_1': 0.8485, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9476, 'worst_acc': 0.4097, 'acc_0_0': 0.9982, 'acc_0_1': 0.9029, 'acc_1_0': 0.4097, 'acc_1_1': 0.8162, 'mean_acc': 0.8757}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9877, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5794, 'acc_0_0': 0.9744, 'acc_0_1': 0.5794, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.5902, 'acc_0_0': 0.9725, 'acc_0_1': 0.5902, 'acc_1_0': 0.7056, 'acc_1_1': 0.9517, 'mean_acc': 0.7919}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9969, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5536, 'acc_0_0': 0.9829, 'acc_0_1': 0.5536, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6226, 'acc_0_0': 0.9805, 'acc_0_1': 0.6226, 'acc_1_0': 0.6573, 'acc_1_1': 0.9486, 'mean_acc': 0.8019}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9972, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5579, 'acc_0_0': 0.9573, 'acc_0_1': 0.5579, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.942, 'worst_acc': 0.5548, 'acc_0_0': 0.9592, 'acc_0_1': 0.5548, 'acc_1_0': 0.7492, 'acc_1_1': 0.9626, 'mean_acc': 0.7789}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9991, 'acc_0_1': 0.9457, 'acc_1_0': 0.9643, 'acc_1_1': 0.9858, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.7095, 'acc_1_0': 0.5327, 'acc_1_1': 0.9268, 'mean_acc': 0.8238}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5075, 'acc_0_0': 0.9872, 'acc_0_1': 0.8112, 'acc_1_0': 0.5075, 'acc_1_1': 0.9091, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.5654, 'acc_0_0': 0.9907, 'acc_0_1': 0.8421, 'acc_1_0': 0.5654, 'acc_1_1': 0.8567, 'mean_acc': 0.8709}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9966, 'acc_0_1': 0.9565, 'acc_1_0': 0.8929, 'acc_1_1': 0.9849, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.5107, 'acc_0_0': 0.9701, 'acc_0_1': 0.5107, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.486, 'acc_0_0': 0.9698, 'acc_0_1': 0.486, 'acc_1_0': 0.6604, 'acc_1_1': 0.9517, 'mean_acc': 0.7453}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9926, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9839}
Val(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9573, 'worst_acc': 0.6667, 'acc_0_0': 0.9836, 'acc_0_1': 0.694, 'acc_1_0': 0.6667, 'acc_1_1': 0.9315, 'mean_acc': 0.83}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9914, 'acc_0_1': 0.7609, 'acc_1_0': 0.6607, 'acc_1_1': 0.9423, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6395, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.9845, 'acc_0_1': 0.6656, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.819}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9906, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9631, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8755, 'acc_1_0': 0.4776, 'acc_1_1': 0.9242, 'mean_acc': 0.885}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.514, 'acc_0_0': 0.9951, 'acc_0_1': 0.8426, 'acc_1_0': 0.514, 'acc_1_1': 0.8847, 'mean_acc': 0.8702}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9943, 'acc_0_1': 0.837, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5779, 'acc_0_0': 0.9889, 'acc_0_1': 0.8204, 'acc_1_0': 0.5779, 'acc_1_1': 0.8941, 'mean_acc': 0.8673}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5303, 'acc_0_0': 0.9657, 'acc_0_1': 0.8455, 'acc_1_0': 0.5303, 'acc_1_1': 0.8209, 'mean_acc': 0.8548}
Val(class)(new adapter): {'weighted_mean_acc': 0.7576, 'worst_acc': 0.0758, 'acc_0_0': 0.953, 'acc_0_1': 0.9914, 'acc_1_0': 0.6567, 'acc_1_1': 0.0758, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.7663, 'worst_acc': 0.0794, 'acc_0_0': 0.9627, 'acc_0_1': 0.9933, 'acc_1_0': 0.7134, 'acc_1_1': 0.0794, 'mean_acc': 0.8492}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3182, 'acc_0_0': 0.8455, 'acc_0_1': 0.7167, 'acc_1_0': 0.3182, 'acc_1_1': 0.7164, 'mean_acc': 0.7229}
Val(class)(new adapter): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.4506, 'acc_0_0': 0.9744, 'acc_0_1': 0.4506, 'acc_1_0': 0.6119, 'acc_1_1': 1.0, 'mean_acc': 0.7333}
Test(class)(new adapter): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.4705, 'acc_0_0': 0.9836, 'acc_0_1': 0.4705, 'acc_1_0': 0.6558, 'acc_1_1': 0.9657, 'mean_acc': 0.7456}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5909, 'acc_0_0': 0.9914, 'acc_0_1': 0.794, 'acc_1_0': 0.5909, 'acc_1_1': 0.9104, 'mean_acc': 0.8614}
Val(class)(new adapter): {'weighted_mean_acc': 0.82, 'worst_acc': 0.4697, 'acc_0_0': 0.9188, 'acc_0_1': 0.9485, 'acc_1_0': 0.8358, 'acc_1_1': 0.4697, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8117, 'worst_acc': 0.419, 'acc_0_0': 0.9224, 'acc_0_1': 0.9574, 'acc_1_0': 0.8287, 'acc_1_1': 0.419, 'mean_acc': 0.8699}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0597, 'acc_0_0': 0.8069, 'acc_0_1': 0.9142, 'acc_1_0': 0.9242, 'acc_1_1': 0.0597, 'mean_acc': 0.778}
Val(class)(new adapter): {'weighted_mean_acc': 0.8747, 'worst_acc': 0.8333, 'acc_0_0': 0.8846, 'acc_0_1': 0.9142, 'acc_1_0': 0.9104, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8497, 'worst_acc': 0.7928, 'acc_0_0': 0.8625, 'acc_0_1': 0.9224, 'acc_1_0': 0.8847, 'acc_1_1': 0.7928, 'mean_acc': 0.8806}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9442, 'acc_0_1': 0.9785, 'acc_1_0': 0.9242, 'acc_1_1': 0.8806, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.8209, 'acc_0_0': 0.9615, 'acc_0_1': 0.9442, 'acc_1_0': 0.8209, 'acc_1_1': 0.8485, 'mean_acc': 0.9267}
Test(class)(new adapter): {'weighted_mean_acc': 0.937, 'worst_acc': 0.8131, 'acc_0_0': 0.9685, 'acc_0_1': 0.9273, 'acc_1_0': 0.8131, 'acc_1_1': 0.8411, 'mean_acc': 0.9211}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5672, 'acc_0_0': 0.9227, 'acc_0_1': 0.9742, 'acc_1_0': 0.6818, 'acc_1_1': 0.5672, 'mean_acc': 0.8765}
Val(class)(new adapter): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.7511, 'acc_0_0': 0.953, 'acc_0_1': 0.7511, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9446, 'worst_acc': 0.7787, 'acc_0_0': 0.9592, 'acc_0_1': 0.7787, 'acc_1_0': 0.824, 'acc_1_1': 0.9315, 'mean_acc': 0.8709}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9828, 'acc_0_1': 0.9056, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9354, 'worst_acc': 0.806, 'acc_0_0': 0.953, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.8193, 'acc_0_0': 0.9583, 'acc_0_1': 0.8745, 'acc_1_0': 0.8193, 'acc_1_1': 0.8676, 'mean_acc': 0.9002}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9785, 'acc_0_1': 0.9399, 'acc_1_0': 0.8636, 'acc_1_1': 0.7612, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.8727, 'worst_acc': 0.7727, 'acc_0_0': 0.9017, 'acc_0_1': 0.9056, 'acc_1_0': 0.8358, 'acc_1_1': 0.7727, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8608, 'worst_acc': 0.7664, 'acc_0_0': 0.8865, 'acc_0_1': 0.9162, 'acc_1_0': 0.8536, 'acc_1_1': 0.7664, 'mean_acc': 0.8811}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9571, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.8705, 'worst_acc': 0.8182, 'acc_0_0': 0.8846, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8182, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8637, 'worst_acc': 0.8037, 'acc_0_0': 0.8789, 'acc_0_1': 0.9237, 'acc_1_0': 0.8458, 'acc_1_1': 0.8037, 'mean_acc': 0.8844}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9142, 'acc_0_1': 0.9957, 'acc_1_0': 0.8636, 'acc_1_1': 0.9104, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.7726, 'acc_0_0': 0.9632, 'acc_0_1': 0.9286, 'acc_1_0': 0.7726, 'acc_1_1': 0.8193, 'mean_acc': 0.9127}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9391, 'worst_acc': 0.7761, 'acc_0_0': 0.953, 'acc_0_1': 0.897, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9341, 'worst_acc': 0.7897, 'acc_0_0': 0.9619, 'acc_0_1': 0.8949, 'acc_1_0': 0.7897, 'acc_1_1': 0.8567, 'mean_acc': 0.9051}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.9957, 'acc_0_1': 0.8798, 'acc_1_0': 0.8788, 'acc_1_1': 0.791, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7983, 'acc_0_0': 0.8889, 'acc_0_1': 0.7983, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8821, 'worst_acc': 0.8089, 'acc_0_0': 0.8776, 'acc_0_1': 0.8089, 'acc_1_0': 0.8816, 'acc_1_1': 0.9097, 'mean_acc': 0.8548}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9785, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.8738, 'worst_acc': 0.8718, 'acc_0_0': 0.8718, 'acc_0_1': 0.8755, 'acc_1_0': 0.8955, 'acc_1_1': 0.8788, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8318, 'acc_0_0': 0.8683, 'acc_0_1': 0.8967, 'acc_1_0': 0.8847, 'acc_1_1': 0.8318, 'mean_acc': 0.8771}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9313, 'acc_0_1': 1.0, 'acc_1_0': 0.8333, 'acc_1_1': 0.9254, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.7879, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.7879, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7243, 'acc_0_0': 0.953, 'acc_0_1': 0.9494, 'acc_1_0': 0.8193, 'acc_1_1': 0.7243, 'mean_acc': 0.9115}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8636, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9615, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7025, 'acc_0_0': 0.9747, 'acc_0_1': 0.9588, 'acc_1_0': 0.7586, 'acc_1_1': 0.7025, 'mean_acc': 0.9144}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.8209, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.785, 'acc_0_0': 0.9623, 'acc_0_1': 0.9348, 'acc_1_0': 0.8022, 'acc_1_1': 0.785, 'mean_acc': 0.9142}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.8507, 'acc_0_0': 0.9274, 'acc_0_1': 0.897, 'acc_1_0': 0.8507, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.8209, 'acc_0_0': 0.9406, 'acc_0_1': 0.9113, 'acc_1_0': 0.838, 'acc_1_1': 0.8209, 'mean_acc': 0.9046}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.8507, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.8302, 'acc_0_0': 0.9299, 'acc_0_1': 0.8936, 'acc_1_0': 0.8489, 'acc_1_1': 0.8302, 'mean_acc': 0.8958}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.8927, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.8006, 'acc_0_0': 0.9419, 'acc_0_1': 0.9016, 'acc_1_0': 0.8224, 'acc_1_1': 0.8006, 'mean_acc': 0.8973}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7804, 'acc_0_0': 0.9508, 'acc_0_1': 0.9131, 'acc_1_0': 0.8115, 'acc_1_1': 0.7804, 'mean_acc': 0.9018}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7477, 'acc_0_0': 0.9619, 'acc_0_1': 0.9344, 'acc_1_0': 0.7788, 'acc_1_1': 0.7477, 'mean_acc': 0.9071}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7352, 'acc_0_0': 0.9654, 'acc_0_1': 0.9401, 'acc_1_0': 0.7664, 'acc_1_1': 0.7352, 'mean_acc': 0.908}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7383, 'acc_0_0': 0.9636, 'acc_0_1': 0.941, 'acc_1_0': 0.7757, 'acc_1_1': 0.7383, 'mean_acc': 0.909}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7383, 'acc_0_0': 0.9614, 'acc_0_1': 0.941, 'acc_1_0': 0.7819, 'acc_1_1': 0.7383, 'mean_acc': 0.9089}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7383, 'acc_0_0': 0.9579, 'acc_0_1': 0.9424, 'acc_1_0': 0.7928, 'acc_1_1': 0.7383, 'mean_acc': 0.9092}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7321, 'acc_0_0': 0.9512, 'acc_0_1': 0.9392, 'acc_1_0': 0.8146, 'acc_1_1': 0.7321, 'mean_acc': 0.9071}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.896, 'worst_acc': 0.7181, 'acc_0_0': 0.9486, 'acc_0_1': 0.9424, 'acc_1_0': 0.8178, 'acc_1_1': 0.7181, 'mean_acc': 0.9061}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7212, 'acc_0_0': 0.9557, 'acc_0_1': 0.9384, 'acc_1_0': 0.7913, 'acc_1_1': 0.7212, 'mean_acc': 0.9047}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.7576, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.6978, 'acc_0_0': 0.9698, 'acc_0_1': 0.9517, 'acc_1_0': 0.7243, 'acc_1_1': 0.6978, 'mean_acc': 0.9054}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.6866, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7368, 'acc_0_0': 0.9672, 'acc_0_1': 0.9384, 'acc_1_0': 0.7368, 'acc_1_1': 0.7383, 'mean_acc': 0.9051}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7835, 'acc_0_0': 0.9508, 'acc_0_1': 0.9188, 'acc_1_0': 0.8037, 'acc_1_1': 0.7835, 'mean_acc': 0.9035}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7913, 'acc_0_0': 0.9375, 'acc_0_1': 0.914, 'acc_1_0': 0.8271, 'acc_1_1': 0.7913, 'mean_acc': 0.8999}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.771, 'acc_0_0': 0.9375, 'acc_0_1': 0.9193, 'acc_1_0': 0.824, 'acc_1_1': 0.771, 'mean_acc': 0.8994}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7461, 'acc_0_0': 0.9494, 'acc_0_1': 0.9322, 'acc_1_0': 0.785, 'acc_1_1': 0.7461, 'mean_acc': 0.902}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7305, 'acc_0_0': 0.961, 'acc_0_1': 0.9392, 'acc_1_0': 0.7679, 'acc_1_1': 0.7305, 'mean_acc': 0.9056}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.7274, 'acc_0_0': 0.9614, 'acc_0_1': 0.9392, 'acc_1_0': 0.7601, 'acc_1_1': 0.7274, 'mean_acc': 0.9046}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7383, 'acc_0_0': 0.9583, 'acc_0_1': 0.9335, 'acc_1_0': 0.7726, 'acc_1_1': 0.7383, 'mean_acc': 0.9037}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7461, 'acc_0_0': 0.9548, 'acc_0_1': 0.9286, 'acc_1_0': 0.7819, 'acc_1_1': 0.7461, 'mean_acc': 0.9023}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7508, 'acc_0_0': 0.9543, 'acc_0_1': 0.9255, 'acc_1_0': 0.785, 'acc_1_1': 0.7508, 'mean_acc': 0.9018}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7539, 'acc_0_0': 0.9534, 'acc_0_1': 0.9255, 'acc_1_0': 0.7866, 'acc_1_1': 0.7539, 'mean_acc': 0.902}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7555, 'acc_0_0': 0.9539, 'acc_0_1': 0.9251, 'acc_1_0': 0.7882, 'acc_1_1': 0.7555, 'mean_acc': 0.9023}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7539, 'acc_0_0': 0.9539, 'acc_0_1': 0.9251, 'acc_1_0': 0.7882, 'acc_1_1': 0.7539, 'mean_acc': 0.9021}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7555, 'acc_0_0': 0.9525, 'acc_0_1': 0.9228, 'acc_1_0': 0.7897, 'acc_1_1': 0.7555, 'mean_acc': 0.9011}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7586, 'acc_0_0': 0.9508, 'acc_0_1': 0.9215, 'acc_1_0': 0.7928, 'acc_1_1': 0.7586, 'mean_acc': 0.9006}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.757, 'acc_0_0': 0.9486, 'acc_0_1': 0.9233, 'acc_1_0': 0.7944, 'acc_1_1': 0.757, 'mean_acc': 0.9004}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.7555, 'acc_0_0': 0.9477, 'acc_0_1': 0.9224, 'acc_1_0': 0.7975, 'acc_1_1': 0.7555, 'mean_acc': 0.8999}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7508, 'acc_0_0': 0.949, 'acc_0_1': 0.9242, 'acc_1_0': 0.7944, 'acc_1_1': 0.7508, 'mean_acc': 0.9002}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7492, 'acc_0_0': 0.9494, 'acc_0_1': 0.9237, 'acc_1_0': 0.7944, 'acc_1_1': 0.7492, 'mean_acc': 0.9001}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7492, 'acc_0_0': 0.9477, 'acc_0_1': 0.9233, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.8996}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7492, 'acc_0_0': 0.9472, 'acc_0_1': 0.9233, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.8994}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7492, 'acc_0_0': 0.9468, 'acc_0_1': 0.9228, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.899}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7508, 'acc_0_0': 0.9463, 'acc_0_1': 0.9224, 'acc_1_0': 0.7975, 'acc_1_1': 0.7508, 'mean_acc': 0.8989}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7492, 'acc_0_0': 0.9477, 'acc_0_1': 0.9237, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.8997}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7492, 'acc_0_0': 0.9468, 'acc_0_1': 0.9237, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.8994}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7477, 'acc_0_0': 0.9481, 'acc_0_1': 0.9242, 'acc_1_0': 0.796, 'acc_1_1': 0.7477, 'mean_acc': 0.8997}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7492, 'acc_0_0': 0.9472, 'acc_0_1': 0.9237, 'acc_1_0': 0.796, 'acc_1_1': 0.7492, 'mean_acc': 0.8994}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7492, 'acc_0_0': 0.9472, 'acc_0_1': 0.9233, 'acc_1_0': 0.796, 'acc_1_1': 0.7492, 'mean_acc': 0.8992}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7492, 'acc_0_0': 0.9472, 'acc_0_1': 0.9224, 'acc_1_0': 0.796, 'acc_1_1': 0.7492, 'mean_acc': 0.8989}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.7477, 'acc_0_0': 0.9477, 'acc_0_1': 0.9228, 'acc_1_0': 0.7944, 'acc_1_1': 0.7477, 'mean_acc': 0.8989}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7477, 'acc_0_0': 0.9477, 'acc_0_1': 0.9242, 'acc_1_0': 0.796, 'acc_1_1': 0.7477, 'mean_acc': 0.8996}
========================================================================
> end of training. 

best epoch : 53
best training accuracy on [class]: {'worst_acc': 0.9785, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8738, 'worst_acc': 0.8718, 'acc_0_0': 0.8718, 'acc_0_1': 0.8755, 'acc_1_0': 0.8955, 'acc_1_1': 0.8788, 'mean_acc': 0.8767}
best test accuracy on [class]: {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8318, 'acc_0_0': 0.8683, 'acc_0_1': 0.8967, 'acc_1_0': 0.8847, 'acc_1_1': 0.8318, 'mean_acc': 0.8771}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8318, 'acc_0_0': 0.8683, 'acc_0_1': 0.8967, 'acc_1_0': 0.8847, 'acc_1_1': 0.8318, 'mean_acc': 0.8771}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.935, 'worst_acc': 0.4626, 'acc_0_0': 0.9259, 'acc_0_1': 0.9126, 'acc_1_0': 0.4626, 'acc_1_1': 0.9938, 'mean_acc': 0.8769}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 53': {'Train': {'worst_acc': 0.9785, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9833}, 'Val': {'weighted_mean_acc': 0.8738, 'worst_acc': 0.8718, 'acc_0_0': 0.8718, 'acc_0_1': 0.8755, 'acc_1_0': 0.8955, 'acc_1_1': 0.8788, 'mean_acc': 0.8767}, 'Test': {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8318, 'acc_0_0': 0.8683, 'acc_0_1': 0.8967, 'acc_1_0': 0.8847, 'acc_1_1': 0.8318, 'mean_acc': 0.8771}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8318, 'acc_0_0': 0.8683, 'acc_0_1': 0.8967, 'acc_1_0': 0.8847, 'acc_1_1': 0.8318, 'mean_acc': 0.8771}, 'spurious': {'weighted_mean_acc': 0.935, 'worst_acc': 0.4626, 'acc_0_0': 0.9259, 'acc_0_1': 0.9126, 'acc_1_0': 0.4626, 'acc_1_1': 0.9938, 'mean_acc': 0.8769}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0357, 'acc_0_0': 0.9534, 'acc_0_1': 0.962, 'acc_1_0': 0.0357, 'acc_1_1': 0.0747, 'mean_acc': 0.7493}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2679, 'acc_0_0': 0.994, 'acc_0_1': 0.6902, 'acc_1_0': 0.2679, 'acc_1_1': 0.6168, 'mean_acc': 0.8907}
Val(class): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.5966, 'acc_0_0': 0.9615, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.5211, 'acc_0_0': 0.9614, 'acc_0_1': 0.5211, 'acc_1_0': 0.6807, 'acc_1_1': 0.9299, 'mean_acc': 0.7554}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9863, 'acc_0_1': 0.6141, 'acc_1_0': 0.5893, 'acc_1_1': 0.9338, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.6137, 'acc_1_0': 0.4776, 'acc_1_1': 0.9697, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.4502, 'acc_0_0': 0.9951, 'acc_0_1': 0.5885, 'acc_1_0': 0.4502, 'acc_1_1': 0.9377, 'mean_acc': 0.7701}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9891, 'acc_0_1': 0.5272, 'acc_1_0': 0.5, 'acc_1_1': 0.9603, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.72}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3543, 'acc_0_0': 0.9814, 'acc_0_1': 0.3543, 'acc_1_0': 0.6153, 'acc_1_1': 0.9657, 'mean_acc': 0.695}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5978, 'acc_0_0': 0.9874, 'acc_0_1': 0.5978, 'acc_1_0': 0.6429, 'acc_1_1': 0.9518, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3948, 'acc_0_0': 0.9872, 'acc_0_1': 0.3948, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.7283}
Test(class): {'weighted_mean_acc': 0.9461, 'worst_acc': 0.357, 'acc_0_0': 0.9738, 'acc_0_1': 0.357, 'acc_1_0': 0.7492, 'acc_1_1': 0.9673, 'mean_acc': 0.7081}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9917, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9574, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.5708, 'acc_0_0': 0.9829, 'acc_0_1': 0.5708, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.518, 'acc_0_0': 0.98, 'acc_0_1': 0.518, 'acc_1_0': 0.7196, 'acc_1_1': 0.9517, 'mean_acc': 0.7682}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.7143, 'acc_1_1': 0.9603, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7007, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.83}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.9934, 'acc_0_1': 0.6848, 'acc_1_0': 0.6964, 'acc_1_1': 0.9659, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9585, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5522, 'acc_1_1': 0.8636, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5358, 'acc_0_0': 0.9947, 'acc_0_1': 0.8377, 'acc_1_0': 0.5358, 'acc_1_1': 0.9003, 'mean_acc': 0.8723}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.994, 'acc_0_1': 0.7609, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9771, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.595, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9377, 'mean_acc': 0.8177}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9943, 'acc_0_1': 0.788, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.6524, 'acc_0_0': 0.9786, 'acc_0_1': 0.6524, 'acc_1_0': 0.7313, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.612, 'acc_0_0': 0.9814, 'acc_0_1': 0.612, 'acc_1_0': 0.7025, 'acc_1_1': 0.947, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9946, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9678, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.749, 'acc_1_0': 0.5312, 'acc_1_1': 0.9315, 'mean_acc': 0.8404}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9946, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9622, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5665, 'acc_0_0': 0.9701, 'acc_0_1': 0.5665, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.5588, 'acc_0_0': 0.9769, 'acc_0_1': 0.5588, 'acc_1_0': 0.7087, 'acc_1_1': 0.9579, 'mean_acc': 0.7824}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5047, 'acc_0_0': 0.9956, 'acc_0_1': 0.8186, 'acc_1_0': 0.5047, 'acc_1_1': 0.9065, 'mean_acc': 0.8624}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9969, 'acc_0_1': 0.7989, 'acc_1_0': 0.7679, 'acc_1_1': 0.9688, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.937, 'worst_acc': 0.3991, 'acc_0_0': 0.953, 'acc_0_1': 0.3991, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.725}
Test(class): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.4124, 'acc_0_0': 0.9619, 'acc_0_1': 0.4124, 'acc_1_0': 0.7586, 'acc_1_1': 0.9766, 'mean_acc': 0.7271}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9957, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6308, 'acc_0_0': 0.9863, 'acc_0_1': 0.6843, 'acc_1_0': 0.6308, 'acc_1_1': 0.9299, 'mean_acc': 0.8231}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.8326, 'acc_1_0': 0.6418, 'acc_1_1': 0.8939, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6371, 'acc_0_0': 0.984, 'acc_0_1': 0.8106, 'acc_1_0': 0.6371, 'acc_1_1': 0.9003, 'mean_acc': 0.8688}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8767}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5187, 'acc_0_0': 0.9951, 'acc_0_1': 0.82, 'acc_1_0': 0.5187, 'acc_1_1': 0.8801, 'mean_acc': 0.8614}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9963, 'acc_0_1': 0.8533, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.648, 'acc_0_0': 0.9889, 'acc_0_1': 0.6812, 'acc_1_0': 0.648, 'acc_1_1': 0.9455, 'mean_acc': 0.8265}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7983, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5125, 'acc_0_0': 0.9947, 'acc_0_1': 0.78, 'acc_1_0': 0.5125, 'acc_1_1': 0.8925, 'mean_acc': 0.8464}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7897, 'acc_1_0': 0.5522, 'acc_1_1': 0.8939, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7973, 'acc_1_0': 0.5981, 'acc_1_1': 0.9237, 'mean_acc': 0.8645}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9951, 'acc_0_1': 0.8641, 'acc_1_0': 0.8929, 'acc_1_1': 0.9707, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5841, 'acc_0_0': 0.9894, 'acc_0_1': 0.6497, 'acc_1_0': 0.5841, 'acc_1_1': 0.9393, 'mean_acc': 0.8067}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9971, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.9735, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9513, 'worst_acc': 0.6309, 'acc_0_0': 0.9615, 'acc_0_1': 0.6309, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6071, 'acc_0_0': 0.9818, 'acc_0_1': 0.6071, 'acc_1_0': 0.6573, 'acc_1_1': 0.9517, 'mean_acc': 0.7967}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.983, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.897, 'acc_1_0': 0.5224, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.5374, 'acc_0_0': 0.9911, 'acc_0_1': 0.8701, 'acc_1_0': 0.5374, 'acc_1_1': 0.8676, 'mean_acc': 0.88}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9974, 'acc_0_1': 0.8696, 'acc_1_0': 0.7857, 'acc_1_1': 0.9792, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9662, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6526, 'acc_0_0': 0.9863, 'acc_0_1': 0.7286, 'acc_1_0': 0.6526, 'acc_1_1': 0.9393, 'mean_acc': 0.8438}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9977, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9792, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5193, 'acc_0_0': 0.9744, 'acc_0_1': 0.5193, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7683}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5202, 'acc_0_0': 0.9787, 'acc_0_1': 0.5202, 'acc_1_0': 0.6682, 'acc_1_1': 0.9704, 'mean_acc': 0.7649}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6293, 'acc_0_0': 0.9814, 'acc_0_1': 0.6971, 'acc_1_0': 0.6293, 'acc_1_1': 0.933, 'mean_acc': 0.8264}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9966, 'acc_0_1': 0.8967, 'acc_1_0': 0.8214, 'acc_1_1': 0.964, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.3433, 'acc_0_0': 0.9359, 'acc_0_1': 0.3433, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.3512, 'acc_0_0': 0.949, 'acc_0_1': 0.3512, 'acc_1_0': 0.8084, 'acc_1_1': 0.9782, 'mean_acc': 0.704}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9886, 'acc_0_1': 0.788, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7768, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5576, 'acc_0_0': 0.9907, 'acc_0_1': 0.7486, 'acc_1_0': 0.5576, 'acc_1_1': 0.9143, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9957, 'acc_0_1': 0.7989, 'acc_1_0': 0.6607, 'acc_1_1': 0.948, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5224, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5748, 'acc_0_0': 0.9894, 'acc_0_1': 0.6754, 'acc_1_0': 0.5748, 'acc_1_1': 0.9377, 'mean_acc': 0.8155}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9934, 'acc_0_1': 0.7826, 'acc_1_0': 0.7679, 'acc_1_1': 0.9782, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.4421, 'acc_0_0': 0.9444, 'acc_0_1': 0.4421, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9431, 'worst_acc': 0.4705, 'acc_0_0': 0.9619, 'acc_0_1': 0.4705, 'acc_1_0': 0.7523, 'acc_1_1': 0.9735, 'mean_acc': 0.7487}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9909, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8712, 'acc_1_0': 0.3731, 'acc_1_1': 0.8939, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.4548, 'acc_0_0': 0.9978, 'acc_0_1': 0.8559, 'acc_1_0': 0.4548, 'acc_1_1': 0.866, 'mean_acc': 0.8678}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.8207, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7682, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.7494, 'acc_1_0': 0.6153, 'acc_1_1': 0.9252, 'mean_acc': 0.8476}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9957, 'acc_0_1': 0.8804, 'acc_1_0': 0.7857, 'acc_1_1': 0.9669, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6137, 'acc_0_0': 0.9744, 'acc_0_1': 0.6137, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.5978, 'acc_0_0': 0.9836, 'acc_0_1': 0.5978, 'acc_1_0': 0.634, 'acc_1_1': 0.9517, 'mean_acc': 0.7912}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.996, 'acc_0_1': 0.8478, 'acc_1_0': 0.8393, 'acc_1_1': 0.9726, 'mean_acc': 0.9833}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.609, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8153}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6028, 'acc_0_0': 0.9902, 'acc_0_1': 0.6927, 'acc_1_0': 0.6028, 'acc_1_1': 0.9361, 'mean_acc': 0.8255}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9946, 'acc_0_1': 0.8967, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.929, 'worst_acc': 0.4464, 'acc_0_0': 0.9402, 'acc_0_1': 0.4464, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.431, 'acc_0_0': 0.9455, 'acc_0_1': 0.431, 'acc_1_0': 0.7648, 'acc_1_1': 0.9782, 'mean_acc': 0.7289}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.6563, 'acc_1_0': 0.609, 'acc_1_1': 0.9439, 'mean_acc': 0.8134}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9957, 'acc_0_1': 0.8696, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5156, 'acc_0_0': 0.9956, 'acc_0_1': 0.8089, 'acc_1_0': 0.5156, 'acc_1_1': 0.8863, 'mean_acc': 0.8576}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9974, 'acc_0_1': 0.875, 'acc_1_0': 0.9464, 'acc_1_1': 0.9868, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.7164, 'acc_0_0': 0.9786, 'acc_0_1': 0.7296, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6745, 'acc_0_0': 0.9783, 'acc_0_1': 0.7073, 'acc_1_0': 0.6745, 'acc_1_1': 0.9393, 'mean_acc': 0.8348}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.9022, 'acc_1_0': 0.8214, 'acc_1_1': 0.9896, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6738, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6231, 'acc_0_0': 0.9916, 'acc_0_1': 0.6443, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8095}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9828, 'acc_0_1': 0.8541, 'acc_1_0': 0.5758, 'acc_1_1': 0.7015, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7695, 'acc_0_0': 0.9472, 'acc_0_1': 0.9308, 'acc_1_0': 0.8302, 'acc_1_1': 0.7695, 'mean_acc': 0.9082}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2879, 'acc_0_0': 0.8755, 'acc_0_1': 0.7554, 'acc_1_0': 0.2879, 'acc_1_1': 0.7612, 'mean_acc': 0.7513}
Val(class)(new adapter): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.2189, 'acc_0_0': 0.953, 'acc_0_1': 0.2189, 'acc_1_0': 0.7612, 'acc_1_1': 1.0, 'mean_acc': 0.6517}
Test(class)(new adapter): {'weighted_mean_acc': 0.9402, 'worst_acc': 0.231, 'acc_0_0': 0.9659, 'acc_0_1': 0.231, 'acc_1_0': 0.743, 'acc_1_1': 0.9891, 'mean_acc': 0.6577}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9828, 'acc_0_1': 0.7597, 'acc_1_0': 0.697, 'acc_1_1': 0.8507, 'mean_acc': 0.8497}
Val(class)(new adapter): {'weighted_mean_acc': 0.791, 'worst_acc': 0.2121, 'acc_0_0': 0.9573, 'acc_0_1': 0.9828, 'acc_1_0': 0.7015, 'acc_1_1': 0.2121, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.8048, 'worst_acc': 0.2632, 'acc_0_0': 0.9601, 'acc_0_1': 0.9854, 'acc_1_0': 0.7368, 'acc_1_1': 0.2632, 'mean_acc': 0.868}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0896, 'acc_0_0': 0.8069, 'acc_0_1': 0.8712, 'acc_1_0': 0.9394, 'acc_1_1': 0.0896, 'mean_acc': 0.7663}
Val(class)(new adapter): {'weighted_mean_acc': 0.9499, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9394, 'worst_acc': 0.7975, 'acc_0_0': 0.9619, 'acc_0_1': 0.9144, 'acc_1_0': 0.7975, 'acc_1_1': 0.8769, 'mean_acc': 0.9158}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9785, 'acc_0_1': 0.9442, 'acc_1_0': 0.7273, 'acc_1_1': 0.9403, 'mean_acc': 0.9332}
Val(class)(new adapter): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.7612, 'acc_0_0': 0.9786, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.9394, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.7586, 'acc_0_0': 0.9778, 'acc_0_1': 0.8905, 'acc_1_0': 0.7586, 'acc_1_1': 0.8972, 'mean_acc': 0.9106}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6818, 'acc_0_0': 0.7983, 'acc_0_1': 0.9957, 'acc_1_0': 0.6818, 'acc_1_1': 0.8358, 'mean_acc': 0.8664}
Val(class)(new adapter): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.7612, 'acc_0_0': 0.9701, 'acc_0_1': 0.867, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.7726, 'acc_0_0': 0.9729, 'acc_0_1': 0.843, 'acc_1_0': 0.7726, 'acc_1_1': 0.9128, 'mean_acc': 0.8935}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9871, 'acc_0_1': 0.9185, 'acc_1_0': 0.7424, 'acc_1_1': 0.9552, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.7015, 'acc_0_0': 0.9658, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.942, 'worst_acc': 0.7165, 'acc_0_0': 0.9818, 'acc_0_1': 0.9406, 'acc_1_0': 0.7165, 'acc_1_1': 0.8224, 'mean_acc': 0.9187}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4179, 'acc_0_0': 0.9828, 'acc_0_1': 0.7725, 'acc_1_0': 0.8485, 'acc_1_1': 0.4179, 'mean_acc': 0.823}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.8209, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.7913, 'acc_0_0': 0.9273, 'acc_0_1': 0.9339, 'acc_1_0': 0.8474, 'acc_1_1': 0.7913, 'mean_acc': 0.9059}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.8806, 'acc_0_0': 0.8932, 'acc_0_1': 0.9227, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8556, 'worst_acc': 0.8396, 'acc_0_0': 0.8563, 'acc_0_1': 0.9259, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8845}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6818, 'acc_0_0': 0.8197, 'acc_0_1': 0.9957, 'acc_1_0': 0.6818, 'acc_1_1': 0.7463, 'mean_acc': 0.8648}
Val(class)(new adapter): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.7612, 'acc_0_0': 0.9615, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9473, 'worst_acc': 0.7445, 'acc_0_0': 0.9734, 'acc_0_1': 0.9082, 'acc_1_0': 0.7445, 'acc_1_1': 0.8785, 'mean_acc': 0.9122}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.97, 'acc_1_0': 0.7576, 'acc_1_1': 0.9701, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.9013, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.6963, 'acc_0_0': 0.9809, 'acc_0_1': 0.9016, 'acc_1_0': 0.6963, 'acc_1_1': 0.8847, 'mean_acc': 0.9078}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9828, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9403, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.9242, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.94, 'worst_acc': 0.7477, 'acc_0_0': 0.9645, 'acc_0_1': 0.9047, 'acc_1_0': 0.7477, 'acc_1_1': 0.8754, 'mean_acc': 0.9073}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9404, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7819, 'acc_0_0': 0.9521, 'acc_0_1': 0.9388, 'acc_1_0': 0.7819, 'acc_1_1': 0.81, 'mean_acc': 0.9123}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7632, 'acc_0_0': 0.9512, 'acc_0_1': 0.9539, 'acc_1_0': 0.7897, 'acc_1_1': 0.7632, 'mean_acc': 0.9135}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.803, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7664, 'acc_0_0': 0.9512, 'acc_0_1': 0.9517, 'acc_1_0': 0.7835, 'acc_1_1': 0.7664, 'mean_acc': 0.9123}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7726, 'acc_0_0': 0.9561, 'acc_0_1': 0.9286, 'acc_1_0': 0.7726, 'acc_1_1': 0.7991, 'mean_acc': 0.9077}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7695, 'acc_0_0': 0.9561, 'acc_0_1': 0.9073, 'acc_1_0': 0.7695, 'acc_1_1': 0.8333, 'mean_acc': 0.9028}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7648, 'acc_0_0': 0.961, 'acc_0_1': 0.9069, 'acc_1_0': 0.7648, 'acc_1_1': 0.8271, 'mean_acc': 0.9033}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7164, 'acc_0_0': 0.9573, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.7227, 'acc_0_0': 0.969, 'acc_0_1': 0.9277, 'acc_1_0': 0.7227, 'acc_1_1': 0.7975, 'mean_acc': 0.9066}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7243, 'acc_0_0': 0.969, 'acc_0_1': 0.9361, 'acc_1_0': 0.7243, 'acc_1_1': 0.7632, 'mean_acc': 0.9063}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7243, 'acc_0_0': 0.9694, 'acc_0_1': 0.9463, 'acc_1_0': 0.7243, 'acc_1_1': 0.7414, 'mean_acc': 0.908}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7164, 'acc_0_0': 0.9573, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7274, 'acc_0_0': 0.9685, 'acc_0_1': 0.9463, 'acc_1_0': 0.7274, 'acc_1_1': 0.7461, 'mean_acc': 0.9085}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9614, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7414, 'acc_0_0': 0.9645, 'acc_0_1': 0.9459, 'acc_1_0': 0.7414, 'acc_1_1': 0.7523, 'mean_acc': 0.909}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7336, 'acc_0_0': 0.9636, 'acc_0_1': 0.9424, 'acc_1_0': 0.7336, 'acc_1_1': 0.7586, 'mean_acc': 0.9071}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7196, 'acc_0_0': 0.9659, 'acc_0_1': 0.9419, 'acc_1_0': 0.7196, 'acc_1_1': 0.7632, 'mean_acc': 0.9068}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7165, 'acc_0_0': 0.9676, 'acc_0_1': 0.9384, 'acc_1_0': 0.7165, 'acc_1_1': 0.7648, 'mean_acc': 0.9059}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7227, 'acc_0_0': 0.9676, 'acc_0_1': 0.9397, 'acc_1_0': 0.7227, 'acc_1_1': 0.7648, 'mean_acc': 0.9071}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7352, 'acc_0_0': 0.965, 'acc_0_1': 0.9353, 'acc_1_0': 0.7352, 'acc_1_1': 0.7741, 'mean_acc': 0.9068}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7477, 'acc_0_0': 0.9623, 'acc_0_1': 0.933, 'acc_1_0': 0.7477, 'acc_1_1': 0.7773, 'mean_acc': 0.9066}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7445, 'acc_0_0': 0.9627, 'acc_0_1': 0.9335, 'acc_1_0': 0.7445, 'acc_1_1': 0.7804, 'mean_acc': 0.907}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7399, 'acc_0_0': 0.961, 'acc_0_1': 0.9304, 'acc_1_0': 0.7399, 'acc_1_1': 0.7788, 'mean_acc': 0.9044}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.7477, 'acc_0_0': 0.957, 'acc_0_1': 0.9273, 'acc_1_0': 0.7477, 'acc_1_1': 0.7726, 'mean_acc': 0.9018}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.7368, 'acc_0_0': 0.9619, 'acc_0_1': 0.9379, 'acc_1_0': 0.7368, 'acc_1_1': 0.7539, 'mean_acc': 0.9046}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7015, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7056, 'acc_0_0': 0.9698, 'acc_0_1': 0.9463, 'acc_1_0': 0.7056, 'acc_1_1': 0.7445, 'mean_acc': 0.9065}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9302, 'worst_acc': 0.6866, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.69, 'acc_0_0': 0.9721, 'acc_0_1': 0.9415, 'acc_1_0': 0.69, 'acc_1_1': 0.7539, 'mean_acc': 0.9047}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9339, 'worst_acc': 0.7164, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.6994, 'acc_0_0': 0.9716, 'acc_0_1': 0.937, 'acc_1_0': 0.6994, 'acc_1_1': 0.7648, 'mean_acc': 0.9051}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9341, 'worst_acc': 0.7313, 'acc_0_0': 0.9615, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7087, 'acc_0_0': 0.9712, 'acc_0_1': 0.9339, 'acc_1_0': 0.7087, 'acc_1_1': 0.7695, 'mean_acc': 0.9052}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.715, 'acc_0_0': 0.9681, 'acc_0_1': 0.933, 'acc_1_0': 0.715, 'acc_1_1': 0.7788, 'mean_acc': 0.9054}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7181, 'acc_0_0': 0.9667, 'acc_0_1': 0.9339, 'acc_1_0': 0.7181, 'acc_1_1': 0.7788, 'mean_acc': 0.9056}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.729, 'acc_0_0': 0.9663, 'acc_0_1': 0.9295, 'acc_1_0': 0.729, 'acc_1_1': 0.7819, 'mean_acc': 0.9052}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7305, 'acc_0_0': 0.9654, 'acc_0_1': 0.9326, 'acc_1_0': 0.7305, 'acc_1_1': 0.7788, 'mean_acc': 0.9059}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7368, 'acc_0_0': 0.9627, 'acc_0_1': 0.9268, 'acc_1_0': 0.7368, 'acc_1_1': 0.7835, 'mean_acc': 0.9039}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7368, 'acc_0_0': 0.9619, 'acc_0_1': 0.9286, 'acc_1_0': 0.7368, 'acc_1_1': 0.7788, 'mean_acc': 0.9037}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7414, 'acc_0_0': 0.9614, 'acc_0_1': 0.9295, 'acc_1_0': 0.7414, 'acc_1_1': 0.7788, 'mean_acc': 0.9044}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7477, 'acc_0_0': 0.961, 'acc_0_1': 0.929, 'acc_1_0': 0.7477, 'acc_1_1': 0.7788, 'mean_acc': 0.9047}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7414, 'acc_0_0': 0.961, 'acc_0_1': 0.9299, 'acc_1_0': 0.7414, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7461, 'acc_0_0': 0.9605, 'acc_0_1': 0.929, 'acc_1_0': 0.7461, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7445, 'acc_0_0': 0.961, 'acc_0_1': 0.9299, 'acc_1_0': 0.7445, 'acc_1_1': 0.7741, 'mean_acc': 0.9042}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7445, 'acc_0_0': 0.9605, 'acc_0_1': 0.9295, 'acc_1_0': 0.7445, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.743, 'acc_0_0': 0.9619, 'acc_0_1': 0.9286, 'acc_1_0': 0.743, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7445, 'acc_0_0': 0.9619, 'acc_0_1': 0.929, 'acc_1_0': 0.7445, 'acc_1_1': 0.7741, 'mean_acc': 0.9042}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7445, 'acc_0_0': 0.9601, 'acc_0_1': 0.9282, 'acc_1_0': 0.7445, 'acc_1_1': 0.7773, 'mean_acc': 0.9035}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7414, 'acc_0_0': 0.9619, 'acc_0_1': 0.9299, 'acc_1_0': 0.7414, 'acc_1_1': 0.7726, 'mean_acc': 0.904}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7399, 'acc_0_0': 0.9619, 'acc_0_1': 0.9299, 'acc_1_0': 0.7399, 'acc_1_1': 0.7726, 'mean_acc': 0.9039}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7414, 'acc_0_0': 0.961, 'acc_0_1': 0.9286, 'acc_1_0': 0.7414, 'acc_1_1': 0.7741, 'mean_acc': 0.9033}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7383, 'acc_0_0': 0.9619, 'acc_0_1': 0.9304, 'acc_1_0': 0.7383, 'acc_1_1': 0.7726, 'mean_acc': 0.9039}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7414, 'acc_0_0': 0.961, 'acc_0_1': 0.9295, 'acc_1_0': 0.7414, 'acc_1_1': 0.7741, 'mean_acc': 0.9037}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.743, 'acc_0_0': 0.961, 'acc_0_1': 0.9304, 'acc_1_0': 0.743, 'acc_1_1': 0.7726, 'mean_acc': 0.904}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.743, 'acc_0_0': 0.9605, 'acc_0_1': 0.9286, 'acc_1_0': 0.743, 'acc_1_1': 0.7741, 'mean_acc': 0.9033}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.743, 'acc_0_0': 0.961, 'acc_0_1': 0.9308, 'acc_1_0': 0.743, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
========================================================================
> end of training. 

best epoch : 49
best training accuracy on [class]: {'worst_acc': 0.9394, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8977, 'worst_acc': 0.8806, 'acc_0_0': 0.8932, 'acc_0_1': 0.9227, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.905}
best test accuracy on [class]: {'weighted_mean_acc': 0.8556, 'worst_acc': 0.8396, 'acc_0_0': 0.8563, 'acc_0_1': 0.9259, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8845}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8556, 'worst_acc': 0.8396, 'acc_0_0': 0.8563, 'acc_0_1': 0.9259, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8845}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.2897, 'acc_0_0': 0.9277, 'acc_0_1': 0.9392, 'acc_1_0': 0.2897, 'acc_1_1': 1.0, 'mean_acc': 0.8695}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 49': {'Train': {'worst_acc': 0.9394, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}, 'Val': {'weighted_mean_acc': 0.8977, 'worst_acc': 0.8806, 'acc_0_0': 0.8932, 'acc_0_1': 0.9227, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.905}, 'Test': {'weighted_mean_acc': 0.8556, 'worst_acc': 0.8396, 'acc_0_0': 0.8563, 'acc_0_1': 0.9259, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8845}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8556, 'worst_acc': 0.8396, 'acc_0_0': 0.8563, 'acc_0_1': 0.9259, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8845}, 'spurious': {'weighted_mean_acc': 0.9366, 'worst_acc': 0.2897, 'acc_0_0': 0.9277, 'acc_0_1': 0.9392, 'acc_1_0': 0.2897, 'acc_1_1': 1.0, 'mean_acc': 0.8695}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.1786, 'acc_0_0': 0.9688, 'acc_0_1': 0.7609, 'acc_1_0': 0.1786, 'acc_1_1': 0.3453, 'mean_acc': 0.8142}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.2704, 'acc_0_0': 0.9829, 'acc_0_1': 0.2704, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.66}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.2554, 'acc_0_0': 0.9814, 'acc_0_1': 0.2554, 'acc_1_0': 0.5841, 'acc_1_1': 0.9657, 'mean_acc': 0.6531}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1576, 'acc_0_0': 0.9568, 'acc_0_1': 0.1576, 'acc_1_0': 0.6429, 'acc_1_1': 0.9763, 'mean_acc': 0.9268}
Val(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.3562, 'acc_0_0': 0.9829, 'acc_0_1': 0.3562, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6967}
Test(class): {'weighted_mean_acc': 0.9527, 'worst_acc': 0.329, 'acc_0_0': 0.9871, 'acc_0_1': 0.329, 'acc_1_0': 0.6012, 'acc_1_1': 0.9657, 'mean_acc': 0.6859}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.375, 'acc_0_0': 0.9977, 'acc_0_1': 0.7228, 'acc_1_0': 0.375, 'acc_1_1': 0.8761, 'mean_acc': 0.9531}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5125, 'acc_0_0': 0.9951, 'acc_0_1': 0.663, 'acc_1_0': 0.5125, 'acc_1_1': 0.9128, 'mean_acc': 0.8032}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9946, 'acc_0_1': 0.6033, 'acc_1_0': 0.5357, 'acc_1_1': 0.9272, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.3948, 'acc_0_0': 0.9915, 'acc_0_1': 0.3948, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7233}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.3871, 'acc_0_0': 0.9858, 'acc_0_1': 0.3871, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7147}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9886, 'acc_0_1': 0.4891, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9597}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7047, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8297}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9937, 'acc_0_1': 0.75, 'acc_1_0': 0.6607, 'acc_1_1': 0.9139, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7854, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.7508, 'acc_1_0': 0.6028, 'acc_1_1': 0.9143, 'mean_acc': 0.8469}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.9906, 'acc_0_1': 0.663, 'acc_1_0': 0.7321, 'acc_1_1': 0.9413, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7167, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6121, 'acc_0_0': 0.9933, 'acc_0_1': 0.7033, 'acc_1_0': 0.6121, 'acc_1_1': 0.9221, 'mean_acc': 0.8303}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9926, 'acc_0_1': 0.75, 'acc_1_0': 0.6964, 'acc_1_1': 0.9395, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7897, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6012, 'acc_0_0': 0.9938, 'acc_0_1': 0.7543, 'acc_1_0': 0.6012, 'acc_1_1': 0.9174, 'mean_acc': 0.8486}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9917, 'acc_0_1': 0.7228, 'acc_1_0': 0.75, 'acc_1_1': 0.9461, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7033, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8307}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9926, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9413, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7135, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8347}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9917, 'acc_0_1': 0.7446, 'acc_1_0': 0.6964, 'acc_1_1': 0.9565, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8283, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5545, 'acc_0_0': 0.9956, 'acc_0_1': 0.7982, 'acc_1_0': 0.5545, 'acc_1_1': 0.905, 'mean_acc': 0.8599}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9937, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9536, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.7255, 'acc_1_0': 0.5935, 'acc_1_1': 0.9252, 'mean_acc': 0.8371}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9946, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5857, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5857, 'acc_1_1': 0.919, 'mean_acc': 0.8554}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.994, 'acc_0_1': 0.7989, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.8018, 'acc_1_0': 0.567, 'acc_1_1': 0.9159, 'mean_acc': 0.8628}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9971, 'acc_0_1': 0.7935, 'acc_1_0': 0.7679, 'acc_1_1': 0.9546, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6528, 'acc_1_0': 0.6464, 'acc_1_1': 0.9408, 'mean_acc': 0.8145}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.8393, 'acc_1_1': 0.964, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.8326, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.8248, 'acc_1_0': 0.5935, 'acc_1_1': 0.9112, 'mean_acc': 0.8742}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9949, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.8498, 'acc_1_0': 0.5373, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5421, 'acc_0_0': 0.9965, 'acc_0_1': 0.8333, 'acc_1_0': 0.5421, 'acc_1_1': 0.9034, 'mean_acc': 0.8723}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.9603, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9761, 'worst_acc': 0.6996, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6869, 'acc_0_0': 0.9867, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9393, 'mean_acc': 0.8321}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.875, 'acc_1_1': 0.9726, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.7015, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.6869, 'acc_0_0': 0.9871, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.8333}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.8804, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9769, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5903, 'acc_0_0': 0.9938, 'acc_0_1': 0.788, 'acc_1_0': 0.5903, 'acc_1_1': 0.9174, 'mean_acc': 0.8605}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.998, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.9877, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9782, 'worst_acc': 0.6418, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6433, 'acc_0_0': 0.9929, 'acc_0_1': 0.8053, 'acc_1_0': 0.6433, 'acc_1_1': 0.9128, 'mean_acc': 0.8723}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9782, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6953, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6636, 'acc_0_0': 0.988, 'acc_0_1': 0.6767, 'acc_1_0': 0.6636, 'acc_1_1': 0.9424, 'mean_acc': 0.8259}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9858, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.7468, 'acc_0_0': 0.9829, 'acc_0_1': 0.7468, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.7103, 'acc_0_0': 0.9823, 'acc_0_1': 0.7459, 'acc_1_0': 0.7103, 'acc_1_1': 0.9268, 'mean_acc': 0.854}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9754, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9814, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.8155, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.5654, 'acc_0_0': 0.996, 'acc_0_1': 0.8257, 'acc_1_0': 0.5654, 'acc_1_1': 0.8769, 'mean_acc': 0.8688}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9969, 'acc_0_1': 0.9076, 'acc_1_0': 0.9107, 'acc_1_1': 0.9792, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6293, 'acc_0_0': 0.9849, 'acc_0_1': 0.7157, 'acc_1_0': 0.6293, 'acc_1_1': 0.9206, 'mean_acc': 0.8336}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9969, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9688, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.6223, 'acc_0_0': 0.9658, 'acc_0_1': 0.6223, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.6137, 'acc_0_0': 0.9747, 'acc_0_1': 0.6137, 'acc_1_0': 0.6807, 'acc_1_1': 0.9424, 'mean_acc': 0.7981}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9971, 'acc_0_1': 0.8152, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5452, 'acc_0_0': 0.9933, 'acc_0_1': 0.8009, 'acc_1_0': 0.5452, 'acc_1_1': 0.8879, 'mean_acc': 0.8571}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9926, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9527, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8617}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5327, 'acc_0_0': 0.9942, 'acc_0_1': 0.7827, 'acc_1_0': 0.5327, 'acc_1_1': 0.9143, 'mean_acc': 0.8519}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9957, 'acc_0_1': 0.875, 'acc_1_0': 0.8036, 'acc_1_1': 0.9631, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.515, 'acc_0_0': 0.9829, 'acc_0_1': 0.515, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5401, 'acc_0_0': 0.9876, 'acc_0_1': 0.5401, 'acc_1_0': 0.6526, 'acc_1_1': 0.9486, 'mean_acc': 0.772}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8424, 'acc_1_0': 0.8393, 'acc_1_1': 0.9782, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6953, 'acc_0_0': 0.9744, 'acc_0_1': 0.6953, 'acc_1_0': 0.7761, 'acc_1_1': 0.9848, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.6851, 'acc_0_0': 0.9756, 'acc_0_1': 0.6851, 'acc_1_0': 0.743, 'acc_1_1': 0.9455, 'mean_acc': 0.8334}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9983, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.983, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.5171, 'acc_0_0': 0.9951, 'acc_0_1': 0.8537, 'acc_1_0': 0.5171, 'acc_1_1': 0.8956, 'mean_acc': 0.8761}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9963, 'acc_0_1': 0.8967, 'acc_1_0': 0.9107, 'acc_1_1': 0.9754, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.8627, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.8647, 'acc_1_0': 0.6012, 'acc_1_1': 0.8769, 'mean_acc': 0.8866}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9983, 'acc_0_1': 0.8804, 'acc_1_0': 0.9464, 'acc_1_1': 0.9735, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.8111, 'acc_1_0': 0.6153, 'acc_1_1': 0.8941, 'mean_acc': 0.8687}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.875, 'acc_1_0': 0.9821, 'acc_1_1': 0.9763, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.8106, 'acc_1_0': 0.6028, 'acc_1_1': 0.9003, 'mean_acc': 0.8687}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.6866, 'acc_0_0': 0.9786, 'acc_0_1': 0.6953, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.6542, 'acc_0_0': 0.9778, 'acc_0_1': 0.7251, 'acc_1_0': 0.6542, 'acc_1_1': 0.9252, 'mean_acc': 0.8378}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9977, 'acc_0_1': 0.9565, 'acc_1_0': 0.9464, 'acc_1_1': 0.9877, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.5224, 'acc_1_1': 0.9091, 'mean_acc': 0.86}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8084, 'acc_1_0': 0.5779, 'acc_1_1': 0.905, 'mean_acc': 0.865}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.9457, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.99}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.4635, 'acc_0_0': 0.9829, 'acc_0_1': 0.4635, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7433}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4692, 'acc_0_0': 0.9871, 'acc_0_1': 0.4692, 'acc_1_0': 0.6449, 'acc_1_1': 0.9673, 'mean_acc': 0.7454}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9946, 'acc_0_1': 0.7989, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5218, 'acc_0_0': 0.9951, 'acc_0_1': 0.8319, 'acc_1_0': 0.5218, 'acc_1_1': 0.8879, 'mean_acc': 0.8673}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.9022, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.4328, 'acc_0_0': 0.9957, 'acc_0_1': 0.8326, 'acc_1_0': 0.4328, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.4922, 'acc_0_0': 0.9938, 'acc_0_1': 0.855, 'acc_1_0': 0.4922, 'acc_1_1': 0.8769, 'mean_acc': 0.8712}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8696, 'acc_1_0': 0.8393, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3863, 'acc_0_0': 0.9701, 'acc_0_1': 0.3863, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7217}
Test(class): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.3951, 'acc_0_0': 0.969, 'acc_0_1': 0.3951, 'acc_1_0': 0.7165, 'acc_1_1': 0.972, 'mean_acc': 0.718}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9742, 'acc_0_1': 0.8326, 'acc_1_0': 0.5758, 'acc_1_1': 0.7015, 'mean_acc': 0.8447}
Val(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.8026, 'acc_0_0': 0.9103, 'acc_0_1': 0.8026, 'acc_1_0': 0.9104, 'acc_1_1': 0.9394, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.8067, 'acc_0_0': 0.9242, 'acc_0_1': 0.8067, 'acc_1_0': 0.8614, 'acc_1_1': 0.9268, 'mean_acc': 0.8718}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3939, 'acc_0_0': 0.8884, 'acc_0_1': 0.7296, 'acc_1_0': 0.3939, 'acc_1_1': 0.7313, 'mean_acc': 0.7546}
Val(class)(new adapter): {'weighted_mean_acc': 0.8831, 'worst_acc': 0.0987, 'acc_0_0': 0.8889, 'acc_0_1': 0.0987, 'acc_1_0': 0.8955, 'acc_1_1': 1.0, 'mean_acc': 0.595}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.1091, 'acc_0_0': 0.9104, 'acc_0_1': 0.1091, 'acc_1_0': 0.8489, 'acc_1_1': 0.9953, 'mean_acc': 0.6011}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5909, 'acc_0_0': 0.9914, 'acc_0_1': 0.7425, 'acc_1_0': 0.5909, 'acc_1_1': 0.8358, 'mean_acc': 0.8331}
Val(class)(new adapter): {'weighted_mean_acc': 0.7274, 'worst_acc': 0.2879, 'acc_0_0': 0.8462, 'acc_0_1': 0.9442, 'acc_1_0': 0.8955, 'acc_1_1': 0.2879, 'mean_acc': 0.8283}
Test(class)(new adapter): {'weighted_mean_acc': 0.7484, 'worst_acc': 0.3427, 'acc_0_0': 0.8585, 'acc_0_1': 0.9463, 'acc_1_0': 0.8754, 'acc_1_1': 0.3427, 'mean_acc': 0.8374}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0149, 'acc_0_0': 0.7811, 'acc_0_1': 0.9056, 'acc_1_0': 0.9394, 'acc_1_1': 0.0149, 'mean_acc': 0.7613}
Val(class)(new adapter): {'weighted_mean_acc': 0.8843, 'worst_acc': 0.7727, 'acc_0_0': 0.9145, 'acc_0_1': 0.9528, 'acc_1_0': 0.8806, 'acc_1_1': 0.7727, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8794, 'worst_acc': 0.7399, 'acc_0_0': 0.918, 'acc_0_1': 0.953, 'acc_1_0': 0.8629, 'acc_1_1': 0.7399, 'mean_acc': 0.9058}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.803, 'acc_1_1': 0.8955, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.934, 'worst_acc': 0.8507, 'acc_0_0': 0.9359, 'acc_0_1': 0.8927, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8474, 'acc_0_0': 0.945, 'acc_0_1': 0.8909, 'acc_1_0': 0.8474, 'acc_1_1': 0.8988, 'mean_acc': 0.908}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9013, 'acc_0_1': 0.97, 'acc_1_0': 0.8333, 'acc_1_1': 0.6866, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.6695, 'acc_0_0': 0.9017, 'acc_0_1': 0.6695, 'acc_1_0': 0.9254, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.6647, 'acc_0_0': 0.8989, 'acc_0_1': 0.6647, 'acc_1_0': 0.8879, 'acc_1_1': 0.9533, 'mean_acc': 0.8126}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9785, 'acc_0_1': 0.8627, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.838, 'acc_0_0': 0.9463, 'acc_0_1': 0.914, 'acc_1_0': 0.838, 'acc_1_1': 0.866, 'mean_acc': 0.9128}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4776, 'acc_0_0': 0.9657, 'acc_0_1': 0.9657, 'acc_1_0': 0.8182, 'acc_1_1': 0.4776, 'mean_acc': 0.8948}
Val(class)(new adapter): {'weighted_mean_acc': 0.8801, 'worst_acc': 0.7424, 'acc_0_0': 0.9188, 'acc_0_1': 0.9657, 'acc_1_0': 0.7761, 'acc_1_1': 0.7424, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8798, 'worst_acc': 0.6931, 'acc_0_0': 0.9326, 'acc_0_1': 0.9681, 'acc_1_0': 0.8115, 'acc_1_1': 0.6931, 'mean_acc': 0.9065}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9254, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.771, 'acc_0_0': 0.9348, 'acc_0_1': 0.9583, 'acc_1_0': 0.8131, 'acc_1_1': 0.771, 'mean_acc': 0.9123}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9013, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.9254, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9451, 'worst_acc': 0.6269, 'acc_0_0': 0.9701, 'acc_0_1': 0.9485, 'acc_1_0': 0.6269, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.6931, 'acc_0_0': 0.9836, 'acc_0_1': 0.9432, 'acc_1_0': 0.6931, 'acc_1_1': 0.8193, 'mean_acc': 0.9175}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.8636, 'acc_1_1': 0.9851, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.6418, 'acc_0_0': 0.9615, 'acc_0_1': 0.9442, 'acc_1_0': 0.6418, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9352, 'worst_acc': 0.7274, 'acc_0_0': 0.9761, 'acc_0_1': 0.9326, 'acc_1_0': 0.7274, 'acc_1_1': 0.8115, 'mean_acc': 0.9134}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9871, 'acc_0_1': 0.9571, 'acc_1_0': 0.9091, 'acc_1_1': 0.9552, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7612, 'acc_0_0': 0.8932, 'acc_0_1': 0.8798, 'acc_1_0': 0.7612, 'acc_1_1': 0.9394, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.8364, 'acc_0_0': 0.9135, 'acc_0_1': 0.8918, 'acc_1_0': 0.8364, 'acc_1_1': 0.852, 'mean_acc': 0.8897}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.806, 'acc_0_0': 0.8974, 'acc_0_1': 0.9013, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8968, 'worst_acc': 0.8193, 'acc_0_0': 0.9157, 'acc_0_1': 0.9064, 'acc_1_0': 0.8193, 'acc_1_1': 0.8364, 'mean_acc': 0.8926}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9742, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9412, 'worst_acc': 0.6567, 'acc_0_0': 0.9573, 'acc_0_1': 0.9056, 'acc_1_0': 0.6567, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.7586, 'acc_0_0': 0.9645, 'acc_0_1': 0.9118, 'acc_1_0': 0.7586, 'acc_1_1': 0.838, 'mean_acc': 0.9071}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.6567, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9345, 'worst_acc': 0.7336, 'acc_0_0': 0.9778, 'acc_0_1': 0.9317, 'acc_1_0': 0.7336, 'acc_1_1': 0.8022, 'mean_acc': 0.9134}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7773, 'acc_0_0': 0.9632, 'acc_0_1': 0.922, 'acc_1_0': 0.7773, 'acc_1_1': 0.8193, 'mean_acc': 0.9106}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.8037, 'acc_0_0': 0.9477, 'acc_0_1': 0.9184, 'acc_1_0': 0.8037, 'acc_1_1': 0.8146, 'mean_acc': 0.9056}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7866, 'acc_0_0': 0.9481, 'acc_0_1': 0.9313, 'acc_1_0': 0.7991, 'acc_1_1': 0.7866, 'mean_acc': 0.9071}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9015, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7461, 'acc_0_0': 0.9539, 'acc_0_1': 0.9441, 'acc_1_0': 0.7788, 'acc_1_1': 0.7461, 'mean_acc': 0.9077}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7368, 'acc_0_0': 0.961, 'acc_0_1': 0.9486, 'acc_1_0': 0.7539, 'acc_1_1': 0.7368, 'mean_acc': 0.9084}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.6866, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7399, 'acc_0_0': 0.9676, 'acc_0_1': 0.949, 'acc_1_0': 0.7399, 'acc_1_1': 0.7399, 'mean_acc': 0.9099}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.6716, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7399, 'acc_0_0': 0.9694, 'acc_0_1': 0.9472, 'acc_1_0': 0.7399, 'acc_1_1': 0.7477, 'mean_acc': 0.9108}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7414, 'acc_0_0': 0.9681, 'acc_0_1': 0.9494, 'acc_1_0': 0.7414, 'acc_1_1': 0.743, 'mean_acc': 0.9108}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.803, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7399, 'acc_0_0': 0.9672, 'acc_0_1': 0.9494, 'acc_1_0': 0.7477, 'acc_1_1': 0.7399, 'mean_acc': 0.9108}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.6866, 'acc_1_1': 0.803, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7368, 'acc_0_0': 0.9659, 'acc_0_1': 0.953, 'acc_1_0': 0.7477, 'acc_1_1': 0.7368, 'mean_acc': 0.9113}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.6716, 'acc_0_0': 0.9573, 'acc_0_1': 0.9785, 'acc_1_0': 0.6716, 'acc_1_1': 0.7727, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.6978, 'acc_0_0': 0.9747, 'acc_0_1': 0.9663, 'acc_1_0': 0.7321, 'acc_1_1': 0.6978, 'mean_acc': 0.9139}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.6567, 'acc_0_0': 0.9573, 'acc_0_1': 0.9785, 'acc_1_0': 0.6567, 'acc_1_1': 0.7727, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.6838, 'acc_0_0': 0.9769, 'acc_0_1': 0.9676, 'acc_1_0': 0.7181, 'acc_1_1': 0.6838, 'mean_acc': 0.9122}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.6567, 'acc_0_0': 0.9615, 'acc_0_1': 0.9785, 'acc_1_0': 0.6567, 'acc_1_1': 0.7727, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.6854, 'acc_0_0': 0.9778, 'acc_0_1': 0.9667, 'acc_1_0': 0.7181, 'acc_1_1': 0.6854, 'mean_acc': 0.9123}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.6567, 'acc_0_0': 0.9615, 'acc_0_1': 0.9742, 'acc_1_0': 0.6567, 'acc_1_1': 0.7727, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.6791, 'acc_0_0': 0.9778, 'acc_0_1': 0.9676, 'acc_1_0': 0.7165, 'acc_1_1': 0.6791, 'mean_acc': 0.9118}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.6716, 'acc_0_0': 0.9573, 'acc_0_1': 0.9657, 'acc_1_0': 0.6716, 'acc_1_1': 0.803, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7181, 'acc_0_0': 0.9752, 'acc_0_1': 0.9574, 'acc_1_0': 0.7259, 'acc_1_1': 0.7181, 'mean_acc': 0.9122}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.6716, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.6716, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7383, 'acc_0_0': 0.9716, 'acc_0_1': 0.949, 'acc_1_0': 0.7383, 'acc_1_1': 0.7414, 'mean_acc': 0.9115}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7399, 'acc_0_0': 0.9698, 'acc_0_1': 0.9441, 'acc_1_0': 0.7399, 'acc_1_1': 0.7523, 'mean_acc': 0.9103}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7461, 'acc_0_0': 0.965, 'acc_0_1': 0.9419, 'acc_1_0': 0.7461, 'acc_1_1': 0.7539, 'mean_acc': 0.9084}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7539, 'acc_0_0': 0.9627, 'acc_0_1': 0.9401, 'acc_1_0': 0.7539, 'acc_1_1': 0.7586, 'mean_acc': 0.9082}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.7274, 'acc_0_0': 0.9672, 'acc_0_1': 0.9477, 'acc_1_0': 0.7274, 'acc_1_1': 0.7368, 'mean_acc': 0.9075}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7321, 'acc_0_0': 0.9641, 'acc_0_1': 0.9477, 'acc_1_0': 0.7321, 'acc_1_1': 0.7383, 'mean_acc': 0.907}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7368, 'acc_0_0': 0.9632, 'acc_0_1': 0.9455, 'acc_1_0': 0.7368, 'acc_1_1': 0.7399, 'mean_acc': 0.9065}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7352, 'acc_0_0': 0.9632, 'acc_0_1': 0.9455, 'acc_1_0': 0.7352, 'acc_1_1': 0.7383, 'mean_acc': 0.9061}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7352, 'acc_0_0': 0.9632, 'acc_0_1': 0.9463, 'acc_1_0': 0.7399, 'acc_1_1': 0.7352, 'mean_acc': 0.9066}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7399, 'acc_0_0': 0.961, 'acc_0_1': 0.945, 'acc_1_0': 0.7492, 'acc_1_1': 0.7399, 'mean_acc': 0.9068}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7368, 'acc_0_0': 0.9601, 'acc_0_1': 0.9455, 'acc_1_0': 0.7523, 'acc_1_1': 0.7368, 'mean_acc': 0.9066}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.743, 'acc_0_0': 0.9596, 'acc_0_1': 0.9441, 'acc_1_0': 0.7586, 'acc_1_1': 0.743, 'mean_acc': 0.9073}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7523, 'acc_0_0': 0.9592, 'acc_0_1': 0.9401, 'acc_1_0': 0.7632, 'acc_1_1': 0.7523, 'mean_acc': 0.9071}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7523, 'acc_0_0': 0.9592, 'acc_0_1': 0.9388, 'acc_1_0': 0.7648, 'acc_1_1': 0.7523, 'mean_acc': 0.9068}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7508, 'acc_0_0': 0.9592, 'acc_0_1': 0.9406, 'acc_1_0': 0.7617, 'acc_1_1': 0.7508, 'mean_acc': 0.907}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7492, 'acc_0_0': 0.9592, 'acc_0_1': 0.941, 'acc_1_0': 0.7617, 'acc_1_1': 0.7492, 'mean_acc': 0.907}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.743, 'acc_0_0': 0.9596, 'acc_0_1': 0.9428, 'acc_1_0': 0.7601, 'acc_1_1': 0.743, 'mean_acc': 0.907}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7383, 'acc_0_0': 0.961, 'acc_0_1': 0.9455, 'acc_1_0': 0.7555, 'acc_1_1': 0.7383, 'mean_acc': 0.9075}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7461, 'acc_0_0': 0.9601, 'acc_0_1': 0.9432, 'acc_1_0': 0.7601, 'acc_1_1': 0.7461, 'mean_acc': 0.9077}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7445, 'acc_0_0': 0.9601, 'acc_0_1': 0.9428, 'acc_1_0': 0.7601, 'acc_1_1': 0.7445, 'mean_acc': 0.9073}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.743, 'acc_0_0': 0.9592, 'acc_0_1': 0.9428, 'acc_1_0': 0.7601, 'acc_1_1': 0.743, 'mean_acc': 0.9068}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7508, 'acc_0_0': 0.9574, 'acc_0_1': 0.9392, 'acc_1_0': 0.7664, 'acc_1_1': 0.7508, 'mean_acc': 0.9063}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7508, 'acc_0_0': 0.9579, 'acc_0_1': 0.9397, 'acc_1_0': 0.7664, 'acc_1_1': 0.7508, 'mean_acc': 0.9066}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7492, 'acc_0_0': 0.9592, 'acc_0_1': 0.9392, 'acc_1_0': 0.7617, 'acc_1_1': 0.7492, 'mean_acc': 0.9063}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7523, 'acc_0_0': 0.9583, 'acc_0_1': 0.9392, 'acc_1_0': 0.7632, 'acc_1_1': 0.7523, 'mean_acc': 0.9065}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7523, 'acc_0_0': 0.9579, 'acc_0_1': 0.9375, 'acc_1_0': 0.7664, 'acc_1_1': 0.7523, 'mean_acc': 0.9059}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7523, 'acc_0_0': 0.9579, 'acc_0_1': 0.9392, 'acc_1_0': 0.7632, 'acc_1_1': 0.7523, 'mean_acc': 0.9063}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7523, 'acc_0_0': 0.9583, 'acc_0_1': 0.9397, 'acc_1_0': 0.7617, 'acc_1_1': 0.7523, 'mean_acc': 0.9065}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7523, 'acc_0_0': 0.9583, 'acc_0_1': 0.9401, 'acc_1_0': 0.7632, 'acc_1_1': 0.7523, 'mean_acc': 0.9068}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7523, 'acc_0_0': 0.9592, 'acc_0_1': 0.9406, 'acc_1_0': 0.7617, 'acc_1_1': 0.7523, 'mean_acc': 0.9071}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.803, 'acc_1_1': 0.8955, 'mean_acc': 0.9533}
best validation accuracy on [class]: {'weighted_mean_acc': 0.934, 'worst_acc': 0.8507, 'acc_0_0': 0.9359, 'acc_0_1': 0.8927, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.91}
best test accuracy on [class]: {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8474, 'acc_0_0': 0.945, 'acc_0_1': 0.8909, 'acc_1_0': 0.8474, 'acc_1_1': 0.8988, 'mean_acc': 0.908}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8474, 'acc_0_0': 0.945, 'acc_0_1': 0.8909, 'acc_1_0': 0.8474, 'acc_1_1': 0.8988, 'mean_acc': 0.908}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9456, 'worst_acc': 0.4346, 'acc_0_0': 0.9384, 'acc_0_1': 0.953, 'acc_1_0': 0.4346, 'acc_1_1': 0.9953, 'mean_acc': 0.8945}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.803, 'acc_1_1': 0.8955, 'mean_acc': 0.9533}, 'Val': {'weighted_mean_acc': 0.934, 'worst_acc': 0.8507, 'acc_0_0': 0.9359, 'acc_0_1': 0.8927, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.91}, 'Test': {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8474, 'acc_0_0': 0.945, 'acc_0_1': 0.8909, 'acc_1_0': 0.8474, 'acc_1_1': 0.8988, 'mean_acc': 0.908}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8474, 'acc_0_0': 0.945, 'acc_0_1': 0.8909, 'acc_1_0': 0.8474, 'acc_1_1': 0.8988, 'mean_acc': 0.908}, 'spurious': {'weighted_mean_acc': 0.9456, 'worst_acc': 0.4346, 'acc_0_0': 0.9384, 'acc_0_1': 0.953, 'acc_1_0': 0.4346, 'acc_1_1': 0.9953, 'mean_acc': 0.8945}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8615     0.8318   0.8683  ...   0.8847   0.8318    0.8771
2                       0.8556     0.8396   0.8563  ...   0.8832   0.8396    0.8845
3                       0.9316     0.8474   0.9450  ...   0.8474   0.8988    0.9080
test_mean               0.8829     0.8396   0.8899  ...   0.8718   0.8567    0.8899
test_std                0.0345     0.0064   0.0393  ...   0.0172   0.0299    0.0132
1                       0.9350     0.4626   0.9259  ...   0.4626   0.9938    0.8769
2                       0.9366     0.2897   0.9277  ...   0.2897   1.0000    0.8695
3                       0.9456     0.4346   0.9384  ...   0.4346   0.9953    0.8945
zs_spu_mean             0.9391     0.3956   0.9307  ...   0.3956   0.9964    0.8803
zs_spu_std              0.0047     0.0758   0.0055  ...   0.0758   0.0026    0.0105
1                          NaN     0.9785   0.9785  ...   0.9848   1.0000    0.9833
2                          NaN     0.9394   0.9485  ...   0.9394   0.9701    0.9649
3                          NaN     0.8030   0.9828  ...   0.8030   0.8955    0.9533
tr_mean                    NaN     0.9070   0.9699  ...   0.9091   0.9552    0.9672
tr_std                     NaN     0.0752   0.0153  ...   0.0773   0.0439    0.0124
1                       0.8738     0.8718   0.8718  ...   0.8955   0.8788    0.8767
2                       0.8977     0.8806   0.8932  ...   0.8806   0.9091    0.9050
3                       0.9340     0.8507   0.9359  ...   0.8507   0.9394    0.9100
val_mean                0.9018     0.8677   0.9003  ...   0.8756   0.9091    0.8972
val_std                 0.0247     0.0125   0.0266  ...   0.0186   0.0247    0.0147
1                       0.8615     0.8318   0.8683  ...   0.8847   0.8318    0.8771
2                       0.8556     0.8396   0.8563  ...   0.8832   0.8396    0.8845
3                       0.9316     0.8474   0.9450  ...   0.8474   0.8988    0.9080
zs_tg_mean              0.8829     0.8396   0.8899  ...   0.8718   0.8567    0.8899
zs_tg_std               0.0345     0.0064   0.0393  ...   0.0172   0.0299    0.0132

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_10.0_lrr10.0_bsr128_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3696, 'acc_0_0': 0.9337, 'acc_0_1': 0.3696, 'acc_1_0': 0.5357, 'acc_1_1': 0.7228, 'mean_acc': 0.8609}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4034, 'acc_0_0': 1.0, 'acc_0_1': 0.4034, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.3605, 'acc_0_0': 0.9925, 'acc_0_1': 0.3605, 'acc_1_0': 0.5592, 'acc_1_1': 0.9548, 'mean_acc': 0.6943}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9946, 'acc_0_1': 0.5707, 'acc_1_0': 0.4821, 'acc_1_1': 0.9158, 'mean_acc': 0.955}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3734, 'acc_0_0': 0.9915, 'acc_0_1': 0.3734, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.71}
Test(class): {'weighted_mean_acc': 0.9542, 'worst_acc': 0.3729, 'acc_0_0': 0.9854, 'acc_0_1': 0.3729, 'acc_1_0': 0.6386, 'acc_1_1': 0.9688, 'mean_acc': 0.7068}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6141, 'acc_0_0': 0.9883, 'acc_0_1': 0.6141, 'acc_1_0': 0.6607, 'acc_1_1': 0.9499, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9889, 'acc_0_1': 0.7565, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8488}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9929, 'acc_0_1': 0.7446, 'acc_1_0': 0.6786, 'acc_1_1': 0.9385, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.5751, 'acc_0_0': 0.9957, 'acc_0_1': 0.5751, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.5525, 'acc_0_0': 0.9831, 'acc_0_1': 0.5525, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.7794}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9923, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9593, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6044, 'acc_0_0': 0.992, 'acc_0_1': 0.6816, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8215}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.996, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9574, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.6142, 'acc_0_0': 0.9889, 'acc_0_1': 0.6142, 'acc_1_0': 0.6386, 'acc_1_1': 0.9393, 'mean_acc': 0.7988}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9963, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9631, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6153, 'acc_0_0': 0.9907, 'acc_0_1': 0.6993, 'acc_1_0': 0.6153, 'acc_1_1': 0.9299, 'mean_acc': 0.829}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9949, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9612, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6417, 'acc_0_0': 0.9894, 'acc_0_1': 0.6891, 'acc_1_0': 0.6417, 'acc_1_1': 0.933, 'mean_acc': 0.8278}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9954, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8293}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6226, 'acc_0_0': 0.9889, 'acc_0_1': 0.6226, 'acc_1_0': 0.6464, 'acc_1_1': 0.9393, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9963, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9707, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7055, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8298}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9974, 'acc_0_1': 0.7717, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.6616, 'acc_1_0': 0.6246, 'acc_1_1': 0.9377, 'mean_acc': 0.8162}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.998, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.9678, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.6355, 'acc_0_0': 0.9889, 'acc_0_1': 0.6727, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8203}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9974, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9811, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6168, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6168, 'acc_1_1': 0.9268, 'mean_acc': 0.836}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9991, 'acc_0_1': 0.8098, 'acc_1_0': 0.7321, 'acc_1_1': 0.9688, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.639, 'acc_0_0': 0.9867, 'acc_0_1': 0.639, 'acc_1_0': 0.6449, 'acc_1_1': 0.9393, 'mean_acc': 0.8082}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9983, 'acc_0_1': 0.7826, 'acc_1_0': 0.8571, 'acc_1_1': 0.9811, 'mean_acc': 0.9846}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6137, 'acc_0_0': 0.9894, 'acc_0_1': 0.7268, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.839}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6009, 'acc_0_0': 0.9829, 'acc_0_1': 0.6009, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.604, 'acc_0_0': 0.9854, 'acc_0_1': 0.604, 'acc_1_0': 0.6573, 'acc_1_1': 0.9439, 'mean_acc': 0.796}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7811, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5717, 'acc_0_0': 0.9925, 'acc_0_1': 0.757, 'acc_1_0': 0.5717, 'acc_1_1': 0.9237, 'mean_acc': 0.8466}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9983, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9839, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.741, 'acc_1_0': 0.5763, 'acc_1_1': 0.9221, 'mean_acc': 0.8405}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9991, 'acc_0_1': 0.8696, 'acc_1_0': 0.875, 'acc_1_1': 0.9849, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6137, 'acc_0_0': 0.9871, 'acc_0_1': 0.7029, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.829}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9997, 'acc_0_1': 0.8913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.662, 'acc_0_0': 0.984, 'acc_0_1': 0.6647, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8191}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6418, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6371, 'acc_0_0': 0.9858, 'acc_0_1': 0.6749, 'acc_1_0': 0.6371, 'acc_1_1': 0.9361, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6701, 'acc_1_0': 0.634, 'acc_1_1': 0.9346, 'mean_acc': 0.8188}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5903, 'acc_0_0': 0.9902, 'acc_0_1': 0.7406, 'acc_1_0': 0.5903, 'acc_1_1': 0.9237, 'mean_acc': 0.8414}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9885, 'acc_0_1': 0.7011, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.8262}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6012, 'acc_0_0': 0.9898, 'acc_0_1': 0.7286, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8381}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9728, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5935, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.5935, 'acc_1_1': 0.933, 'mean_acc': 0.8221}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9997, 'acc_0_1': 0.9348, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9962}
Val(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6866, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6866, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6402, 'acc_0_0': 0.9845, 'acc_0_1': 0.7282, 'acc_1_0': 0.6402, 'acc_1_1': 0.933, 'mean_acc': 0.8409}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.5997, 'acc_0_0': 0.9898, 'acc_0_1': 0.6772, 'acc_1_0': 0.5997, 'acc_1_1': 0.9408, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.7361, 'acc_1_0': 0.5763, 'acc_1_1': 0.9252, 'mean_acc': 0.839}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9643, 'acc_1_1': 0.9972, 'mean_acc': 0.9981}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.729, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8393}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6137, 'acc_0_0': 0.9885, 'acc_0_1': 0.7255, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8376}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5966, 'acc_0_0': 0.9898, 'acc_0_1': 0.7082, 'acc_1_0': 0.5966, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9985}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6433, 'acc_0_0': 0.9827, 'acc_0_1': 0.6439, 'acc_1_0': 0.6433, 'acc_1_1': 0.9455, 'mean_acc': 0.8091}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.648, 'acc_0_0': 0.9845, 'acc_0_1': 0.6851, 'acc_1_0': 0.648, 'acc_1_1': 0.9439, 'mean_acc': 0.8262}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.8157}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9981, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5888, 'acc_0_0': 0.9925, 'acc_0_1': 0.7401, 'acc_1_0': 0.5888, 'acc_1_1': 0.9237, 'mean_acc': 0.8419}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5919, 'acc_0_0': 0.9902, 'acc_0_1': 0.7086, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8298}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.609, 'acc_0_0': 0.9889, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8284}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6519, 'acc_0_0': 0.9827, 'acc_0_1': 0.6519, 'acc_1_0': 0.6573, 'acc_1_1': 0.9377, 'mean_acc': 0.8129}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3788, 'acc_0_0': 0.9914, 'acc_0_1': 0.7597, 'acc_1_0': 0.3788, 'acc_1_1': 0.9552, 'mean_acc': 0.8297}
Val(class)(new adapter): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7468, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6293, 'acc_0_0': 0.9871, 'acc_0_1': 0.7432, 'acc_1_0': 0.6293, 'acc_1_1': 0.9283, 'mean_acc': 0.846}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1061, 'acc_0_0': 0.9785, 'acc_0_1': 0.2532, 'acc_1_0': 0.1061, 'acc_1_1': 0.7164, 'mean_acc': 0.571}
Val(class)(new adapter): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.588, 'acc_0_0': 0.9701, 'acc_0_1': 0.588, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.7983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9504, 'worst_acc': 0.5942, 'acc_0_0': 0.9698, 'acc_0_1': 0.5942, 'acc_1_0': 0.7321, 'acc_1_1': 0.9595, 'mean_acc': 0.7962}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9442, 'acc_0_1': 0.7511, 'acc_1_0': 0.7424, 'acc_1_1': 0.9552, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.9399, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7072, 'acc_0_0': 0.9778, 'acc_0_1': 0.9406, 'acc_1_0': 0.7072, 'acc_1_1': 0.757, 'mean_acc': 0.9089}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1045, 'acc_0_0': 0.4979, 'acc_0_1': 0.9828, 'acc_1_0': 0.4545, 'acc_1_1': 0.1045, 'mean_acc': 0.6377}
Val(class)(new adapter): {'weighted_mean_acc': 0.9373, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.97, 'acc_1_0': 0.5522, 'acc_1_1': 0.7727, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.5888, 'acc_0_0': 0.996, 'acc_0_1': 0.9681, 'acc_1_0': 0.5888, 'acc_1_1': 0.6885, 'mean_acc': 0.9059}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 1.0, 'acc_0_1': 0.9657, 'acc_1_0': 0.4848, 'acc_1_1': 0.8657, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.9483, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.9528, 'acc_1_0': 0.6716, 'acc_1_1': 0.8333, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.7009, 'acc_0_0': 0.9871, 'acc_0_1': 0.9477, 'acc_1_0': 0.7009, 'acc_1_1': 0.8255, 'mean_acc': 0.9222}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.9657, 'acc_0_1': 0.8841, 'acc_1_0': 0.7424, 'acc_1_1': 0.403, 'mean_acc': 0.8464}
Val(class)(new adapter): {'weighted_mean_acc': 0.9427, 'worst_acc': 0.8209, 'acc_0_0': 0.9487, 'acc_0_1': 0.8841, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.8287, 'acc_0_0': 0.9468, 'acc_0_1': 0.871, 'acc_1_0': 0.8287, 'acc_1_1': 0.9034, 'mean_acc': 0.8994}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9485, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.8657, 'acc_0_0': 0.9017, 'acc_0_1': 0.8755, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8754, 'acc_0_0': 0.8967, 'acc_0_1': 0.8772, 'acc_1_0': 0.8754, 'acc_1_1': 0.8956, 'mean_acc': 0.8866}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.8927, 'acc_0_1': 0.9614, 'acc_1_0': 0.9697, 'acc_1_1': 0.791, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.8827, 'worst_acc': 0.8507, 'acc_0_0': 0.8889, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.8636, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8597, 'worst_acc': 0.8554, 'acc_0_0': 0.8554, 'acc_0_1': 0.8971, 'acc_1_0': 0.8847, 'acc_1_1': 0.866, 'mean_acc': 0.8761}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9657, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9552, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.8699, 'worst_acc': 0.8333, 'acc_0_0': 0.8803, 'acc_0_1': 0.8927, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8488, 'worst_acc': 0.8302, 'acc_0_0': 0.8506, 'acc_0_1': 0.9122, 'acc_1_0': 0.8847, 'acc_1_1': 0.8302, 'mean_acc': 0.8761}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9657, 'acc_0_1': 0.9828, 'acc_1_0': 0.9091, 'acc_1_1': 0.8806, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.8912, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8789, 'worst_acc': 0.8349, 'acc_0_0': 0.8909, 'acc_0_1': 0.9126, 'acc_1_0': 0.852, 'acc_1_1': 0.8349, 'mean_acc': 0.8889}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7761, 'acc_0_0': 0.9017, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.8333, 'acc_0_0': 0.9078, 'acc_0_1': 0.9007, 'acc_1_0': 0.8333, 'acc_1_1': 0.8536, 'mean_acc': 0.8907}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.8584, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.8411, 'acc_0_0': 0.9069, 'acc_0_1': 0.8736, 'acc_1_0': 0.8411, 'acc_1_1': 0.8738, 'mean_acc': 0.883}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9828, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.897, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8987, 'worst_acc': 0.8333, 'acc_0_0': 0.9104, 'acc_0_1': 0.8838, 'acc_1_0': 0.8333, 'acc_1_1': 0.866, 'mean_acc': 0.8866}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.8193, 'acc_0_0': 0.9251, 'acc_0_1': 0.9038, 'acc_1_0': 0.8193, 'acc_1_1': 0.838, 'mean_acc': 0.8954}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7975, 'acc_0_0': 0.9339, 'acc_0_1': 0.9162, 'acc_1_0': 0.7975, 'acc_1_1': 0.8146, 'mean_acc': 0.8987}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8984, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7913, 'acc_0_0': 0.9424, 'acc_0_1': 0.9299, 'acc_1_0': 0.7913, 'acc_1_1': 0.7928, 'mean_acc': 0.9042}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7726, 'acc_0_0': 0.9477, 'acc_0_1': 0.9361, 'acc_1_0': 0.7835, 'acc_1_1': 0.7726, 'mean_acc': 0.9056}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7741, 'acc_0_0': 0.9494, 'acc_0_1': 0.9322, 'acc_1_0': 0.7741, 'acc_1_1': 0.7788, 'mean_acc': 0.9044}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7726, 'acc_0_0': 0.9525, 'acc_0_1': 0.9308, 'acc_1_0': 0.7726, 'acc_1_1': 0.785, 'mean_acc': 0.9056}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.771, 'acc_0_0': 0.953, 'acc_0_1': 0.9335, 'acc_1_0': 0.771, 'acc_1_1': 0.7866, 'mean_acc': 0.9068}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7648, 'acc_0_0': 0.9557, 'acc_0_1': 0.9339, 'acc_1_0': 0.7648, 'acc_1_1': 0.7835, 'mean_acc': 0.907}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7617, 'acc_0_0': 0.9557, 'acc_0_1': 0.9353, 'acc_1_0': 0.7617, 'acc_1_1': 0.7788, 'mean_acc': 0.9066}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7617, 'acc_0_0': 0.9539, 'acc_0_1': 0.9361, 'acc_1_0': 0.7617, 'acc_1_1': 0.7741, 'mean_acc': 0.9058}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7586, 'acc_0_0': 0.9534, 'acc_0_1': 0.9397, 'acc_1_0': 0.7586, 'acc_1_1': 0.7679, 'mean_acc': 0.9059}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.7601, 'acc_0_0': 0.9512, 'acc_0_1': 0.9441, 'acc_1_0': 0.7648, 'acc_1_1': 0.7601, 'mean_acc': 0.9066}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8987, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.757, 'acc_0_0': 0.9366, 'acc_0_1': 0.9424, 'acc_1_0': 0.7928, 'acc_1_1': 0.757, 'mean_acc': 0.903}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.7879, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8924, 'worst_acc': 0.7523, 'acc_0_0': 0.9335, 'acc_0_1': 0.9455, 'acc_1_0': 0.7991, 'acc_1_1': 0.7523, 'mean_acc': 0.9032}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.7414, 'acc_0_0': 0.9397, 'acc_0_1': 0.9494, 'acc_1_0': 0.7882, 'acc_1_1': 0.7414, 'mean_acc': 0.9047}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7103, 'acc_0_0': 0.9623, 'acc_0_1': 0.957, 'acc_1_0': 0.7508, 'acc_1_1': 0.7103, 'mean_acc': 0.9089}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7165, 'acc_0_0': 0.9703, 'acc_0_1': 0.9579, 'acc_1_0': 0.7383, 'acc_1_1': 0.7165, 'mean_acc': 0.9116}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7274, 'acc_0_0': 0.9698, 'acc_0_1': 0.953, 'acc_1_0': 0.7368, 'acc_1_1': 0.7274, 'mean_acc': 0.9106}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.7727, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7492, 'acc_0_0': 0.9685, 'acc_0_1': 0.9477, 'acc_1_0': 0.7508, 'acc_1_1': 0.7492, 'mean_acc': 0.912}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.757, 'acc_0_0': 0.9627, 'acc_0_1': 0.9415, 'acc_1_0': 0.757, 'acc_1_1': 0.7601, 'mean_acc': 0.9092}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7664, 'acc_0_0': 0.9579, 'acc_0_1': 0.9375, 'acc_1_0': 0.7695, 'acc_1_1': 0.7664, 'mean_acc': 0.9078}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7726, 'acc_0_0': 0.9548, 'acc_0_1': 0.9335, 'acc_1_0': 0.7788, 'acc_1_1': 0.7726, 'mean_acc': 0.9068}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7648, 'acc_0_0': 0.9574, 'acc_0_1': 0.9388, 'acc_1_0': 0.7679, 'acc_1_1': 0.7648, 'mean_acc': 0.9078}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7648, 'acc_0_0': 0.957, 'acc_0_1': 0.9406, 'acc_1_0': 0.7679, 'acc_1_1': 0.7648, 'mean_acc': 0.9084}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9406, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9085}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7648, 'acc_0_0': 0.9574, 'acc_0_1': 0.9415, 'acc_1_0': 0.7648, 'acc_1_1': 0.7648, 'mean_acc': 0.9085}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7586, 'acc_0_0': 0.957, 'acc_0_1': 0.9419, 'acc_1_0': 0.7586, 'acc_1_1': 0.7632, 'mean_acc': 0.9077}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9419, 'acc_1_0': 0.757, 'acc_1_1': 0.7617, 'mean_acc': 0.9073}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7555, 'acc_0_0': 0.9583, 'acc_0_1': 0.9428, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.908}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.757, 'acc_0_0': 0.9579, 'acc_0_1': 0.9424, 'acc_1_0': 0.757, 'acc_1_1': 0.7648, 'mean_acc': 0.9082}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7586, 'acc_0_0': 0.957, 'acc_0_1': 0.9415, 'acc_1_0': 0.7586, 'acc_1_1': 0.7648, 'mean_acc': 0.9077}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9419, 'acc_1_0': 0.757, 'acc_1_1': 0.7632, 'mean_acc': 0.9075}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7664, 'acc_0_0': 0.9534, 'acc_0_1': 0.9415, 'acc_1_0': 0.7664, 'acc_1_1': 0.7679, 'mean_acc': 0.9075}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7648, 'acc_0_0': 0.9543, 'acc_0_1': 0.941, 'acc_1_0': 0.7664, 'acc_1_1': 0.7648, 'mean_acc': 0.9073}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7632, 'acc_0_0': 0.9565, 'acc_0_1': 0.9415, 'acc_1_0': 0.7632, 'acc_1_1': 0.7648, 'mean_acc': 0.908}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7664, 'acc_0_0': 0.9557, 'acc_0_1': 0.9401, 'acc_1_0': 0.7695, 'acc_1_1': 0.7664, 'mean_acc': 0.908}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7664, 'acc_0_0': 0.9561, 'acc_0_1': 0.941, 'acc_1_0': 0.7664, 'acc_1_1': 0.7664, 'mean_acc': 0.9082}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7679, 'acc_0_0': 0.9525, 'acc_0_1': 0.9388, 'acc_1_0': 0.771, 'acc_1_1': 0.7679, 'mean_acc': 0.9066}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7679, 'acc_0_0': 0.953, 'acc_0_1': 0.9375, 'acc_1_0': 0.771, 'acc_1_1': 0.7679, 'mean_acc': 0.9063}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7664, 'acc_0_0': 0.953, 'acc_0_1': 0.941, 'acc_1_0': 0.7664, 'acc_1_1': 0.7679, 'mean_acc': 0.9071}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7664, 'acc_0_0': 0.9525, 'acc_0_1': 0.9415, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9071}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7648, 'acc_0_0': 0.9548, 'acc_0_1': 0.9415, 'acc_1_0': 0.7664, 'acc_1_1': 0.7648, 'mean_acc': 0.9077}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7632, 'acc_0_0': 0.9543, 'acc_0_1': 0.9406, 'acc_1_0': 0.7632, 'acc_1_1': 0.7679, 'mean_acc': 0.9071}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9415, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9089}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9401, 'acc_1_0': 0.7664, 'acc_1_1': 0.7679, 'mean_acc': 0.9084}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7632, 'acc_0_0': 0.9574, 'acc_0_1': 0.9397, 'acc_1_0': 0.7632, 'acc_1_1': 0.7664, 'mean_acc': 0.9078}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.941, 'acc_1_0': 0.7664, 'acc_1_1': 0.7679, 'mean_acc': 0.9087}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8333, 'acc_0_0': 0.9485, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9086, 'worst_acc': 0.8657, 'acc_0_0': 0.9017, 'acc_0_1': 0.8755, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
best test accuracy on [class]: {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8754, 'acc_0_0': 0.8967, 'acc_0_1': 0.8772, 'acc_1_0': 0.8754, 'acc_1_1': 0.8956, 'mean_acc': 0.8866}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8754, 'acc_0_0': 0.8967, 'acc_0_1': 0.8772, 'acc_1_0': 0.8754, 'acc_1_1': 0.8956, 'mean_acc': 0.8866}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9736, 'worst_acc': 0.7274, 'acc_0_0': 0.9823, 'acc_0_1': 0.8843, 'acc_1_0': 0.7274, 'acc_1_1': 0.9735, 'mean_acc': 0.9149}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8333, 'acc_0_0': 0.9485, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}, 'Val': {'weighted_mean_acc': 0.9086, 'worst_acc': 0.8657, 'acc_0_0': 0.9017, 'acc_0_1': 0.8755, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}, 'Test': {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8754, 'acc_0_0': 0.8967, 'acc_0_1': 0.8772, 'acc_1_0': 0.8754, 'acc_1_1': 0.8956, 'mean_acc': 0.8866}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8754, 'acc_0_0': 0.8967, 'acc_0_1': 0.8772, 'acc_1_0': 0.8754, 'acc_1_1': 0.8956, 'mean_acc': 0.8866}, 'spurious': {'weighted_mean_acc': 0.9736, 'worst_acc': 0.7274, 'acc_0_0': 0.9823, 'acc_0_1': 0.8843, 'acc_1_0': 0.7274, 'acc_1_1': 0.9735, 'mean_acc': 0.9149}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9231, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.6433, 'mean_acc': 0.8375}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.1588, 'acc_0_0': 0.9786, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6317}
Test(class): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.1512, 'acc_0_0': 0.9641, 'acc_0_1': 0.1512, 'acc_1_0': 0.6916, 'acc_1_1': 0.9798, 'mean_acc': 0.6193}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9974, 'acc_0_1': 0.587, 'acc_1_0': 0.4286, 'acc_1_1': 0.9101, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.3476, 'acc_0_0': 0.9957, 'acc_0_1': 0.3476, 'acc_1_0': 0.597, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.3228, 'acc_0_0': 0.9796, 'acc_0_1': 0.3228, 'acc_1_0': 0.6121, 'acc_1_1': 0.9642, 'mean_acc': 0.6816}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4837, 'acc_0_0': 0.9857, 'acc_0_1': 0.4837, 'acc_1_0': 0.6607, 'acc_1_1': 0.9763, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.4592, 'acc_0_0': 0.9872, 'acc_0_1': 0.4592, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.4288, 'acc_0_0': 0.9712, 'acc_0_1': 0.4288, 'acc_1_0': 0.7118, 'acc_1_1': 0.9626, 'mean_acc': 0.7304}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9883, 'acc_0_1': 0.7011, 'acc_1_0': 0.6607, 'acc_1_1': 0.9177, 'mean_acc': 0.9579}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6215, 'acc_0_0': 0.984, 'acc_0_1': 0.6568, 'acc_1_0': 0.6215, 'acc_1_1': 0.9346, 'mean_acc': 0.811}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5652, 'acc_0_0': 0.9877, 'acc_0_1': 0.5652, 'acc_1_0': 0.6964, 'acc_1_1': 0.9697, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.533, 'acc_0_0': 0.9858, 'acc_0_1': 0.533, 'acc_1_0': 0.6199, 'acc_1_1': 0.9533, 'mean_acc': 0.7654}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9957, 'acc_0_1': 0.6739, 'acc_1_0': 0.6429, 'acc_1_1': 0.9584, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5888, 'acc_0_0': 0.9894, 'acc_0_1': 0.6186, 'acc_1_0': 0.5888, 'acc_1_1': 0.9424, 'mean_acc': 0.7955}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9934, 'acc_0_1': 0.6467, 'acc_1_0': 0.6607, 'acc_1_1': 0.9697, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9659, 'worst_acc': 0.5622, 'acc_0_0': 0.9915, 'acc_0_1': 0.5622, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5605, 'acc_0_0': 0.9871, 'acc_0_1': 0.5605, 'acc_1_0': 0.6246, 'acc_1_1': 0.9502, 'mean_acc': 0.7768}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9951, 'acc_0_1': 0.7228, 'acc_1_0': 0.6964, 'acc_1_1': 0.9622, 'mean_acc': 0.9739}
Val(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.6399, 'acc_1_0': 0.6137, 'acc_1_1': 0.9408, 'mean_acc': 0.8058}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9954, 'acc_0_1': 0.7228, 'acc_1_0': 0.7321, 'acc_1_1': 0.9697, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6059, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6059, 'acc_1_1': 0.9393, 'mean_acc': 0.8084}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9951, 'acc_0_1': 0.7011, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.609, 'acc_0_0': 0.9902, 'acc_0_1': 0.6678, 'acc_1_0': 0.609, 'acc_1_1': 0.9377, 'mean_acc': 0.8167}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.7554, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6246, 'acc_1_1': 0.9424, 'mean_acc': 0.8133}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9949, 'acc_0_1': 0.712, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6639, 'acc_1_0': 0.6153, 'acc_1_1': 0.9408, 'mean_acc': 0.8155}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.7663, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6012, 'acc_0_0': 0.988, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9346, 'mean_acc': 0.8208}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9969, 'acc_0_1': 0.7446, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6106, 'acc_0_0': 0.9889, 'acc_0_1': 0.6776, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8202}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.998, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6776, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8203}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9971, 'acc_0_1': 0.7826, 'acc_1_0': 0.8036, 'acc_1_1': 0.9782, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6012, 'acc_0_0': 0.9894, 'acc_0_1': 0.7073, 'acc_1_0': 0.6012, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8315, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6433, 'acc_0_0': 0.9876, 'acc_0_1': 0.6763, 'acc_1_0': 0.6433, 'acc_1_1': 0.9393, 'mean_acc': 0.8229}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8587, 'acc_1_0': 0.8036, 'acc_1_1': 0.965, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6749, 'acc_1_0': 0.634, 'acc_1_1': 0.9439, 'mean_acc': 0.8217}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9957, 'acc_0_1': 0.7446, 'acc_1_0': 0.875, 'acc_1_1': 0.982, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.662, 'acc_0_0': 0.9863, 'acc_0_1': 0.6683, 'acc_1_0': 0.662, 'acc_1_1': 0.9455, 'mean_acc': 0.8221}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.9022, 'acc_1_0': 0.8393, 'acc_1_1': 0.9745, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.6371, 'acc_1_1': 0.9424, 'mean_acc': 0.8246}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6215, 'acc_0_0': 0.988, 'acc_0_1': 0.7073, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9991, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6075, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6075, 'acc_1_1': 0.9393, 'mean_acc': 0.8269}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9989, 'acc_0_1': 0.8641, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6293, 'acc_0_0': 0.9871, 'acc_0_1': 0.6976, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8295}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9701, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6568, 'acc_1_0': 0.6371, 'acc_1_1': 0.9502, 'mean_acc': 0.816}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5919, 'acc_0_0': 0.9916, 'acc_0_1': 0.7676, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8533}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9565, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.995}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.6223, 'acc_0_0': 0.9872, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6284, 'acc_0_0': 0.9858, 'acc_0_1': 0.6284, 'acc_1_0': 0.6713, 'acc_1_1': 0.9517, 'mean_acc': 0.8081}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9565, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9682, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6324, 'acc_0_0': 0.9898, 'acc_0_1': 0.7184, 'acc_1_0': 0.6324, 'acc_1_1': 0.9361, 'mean_acc': 0.8386}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9565, 'acc_0_0': 1.0, 'acc_0_1': 0.9565, 'acc_1_0': 0.9643, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.6059, 'acc_0_0': 0.9911, 'acc_0_1': 0.6971, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.8288}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9674, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.634, 'acc_0_0': 0.9876, 'acc_0_1': 0.6736, 'acc_1_0': 0.634, 'acc_1_1': 0.9486, 'mean_acc': 0.8219}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9643, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.7069, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8338}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.6475, 'acc_1_0': 0.6153, 'acc_1_1': 0.9486, 'mean_acc': 0.8103}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6293, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6293, 'acc_1_1': 0.9408, 'mean_acc': 0.8295}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9979}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6277, 'acc_0_0': 0.9894, 'acc_0_1': 0.7392, 'acc_1_0': 0.6277, 'acc_1_1': 0.9361, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.6967, 'acc_1_0': 0.6044, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7468, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5935, 'acc_0_0': 0.9907, 'acc_0_1': 0.7512, 'acc_1_0': 0.5935, 'acc_1_1': 0.9346, 'mean_acc': 0.8473}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6976, 'acc_1_0': 0.6464, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7029, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8315}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6215, 'acc_0_0': 0.9907, 'acc_0_1': 0.7118, 'acc_1_0': 0.6215, 'acc_1_1': 0.9408, 'mean_acc': 0.8357}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6277, 'acc_0_0': 0.9898, 'acc_0_1': 0.7171, 'acc_1_0': 0.6277, 'acc_1_1': 0.9408, 'mean_acc': 0.8381}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6293, 'acc_0_0': 0.9902, 'acc_0_1': 0.6922, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.829}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9957, 'acc_0_1': 0.7511, 'acc_1_0': 0.4394, 'acc_1_1': 0.9254, 'mean_acc': 0.8314}
Val(class)(new adapter): {'weighted_mean_acc': 0.967, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.8798, 'acc_1_0': 0.5373, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.5296, 'acc_0_0': 0.9951, 'acc_0_1': 0.8714, 'acc_1_0': 0.5296, 'acc_1_1': 0.8738, 'mean_acc': 0.8819}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1515, 'acc_0_0': 0.9828, 'acc_0_1': 0.309, 'acc_1_0': 0.1515, 'acc_1_1': 0.6716, 'mean_acc': 0.5943}
Val(class)(new adapter): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6309, 'acc_0_0': 0.9744, 'acc_0_1': 0.6309, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.8133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.6359, 'acc_0_0': 0.9814, 'acc_0_1': 0.6359, 'acc_1_0': 0.7181, 'acc_1_1': 0.9564, 'mean_acc': 0.815}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6781, 'acc_0_0': 0.9528, 'acc_0_1': 0.6781, 'acc_1_0': 0.7727, 'acc_1_1': 0.9701, 'mean_acc': 0.828}
Val(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.697, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.7313, 'acc_1_1': 0.697, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.6713, 'acc_0_0': 0.98, 'acc_0_1': 0.9667, 'acc_1_0': 0.7414, 'acc_1_1': 0.6713, 'mean_acc': 0.9142}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1493, 'acc_0_0': 0.4421, 'acc_0_1': 0.9914, 'acc_1_0': 0.2121, 'acc_1_1': 0.1493, 'mean_acc': 0.5977}
Val(class)(new adapter): {'weighted_mean_acc': 0.8369, 'worst_acc': 0.2879, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.4776, 'acc_1_1': 0.2879, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.8406, 'worst_acc': 0.3084, 'acc_0_0': 0.9982, 'acc_0_1': 0.9991, 'acc_1_0': 0.5187, 'acc_1_1': 0.3084, 'mean_acc': 0.869}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.5758, 'acc_1_1': 0.7612, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.9242, 'mean_acc': 0.9283}
Test(class)(new adapter): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.7165, 'acc_0_0': 0.9876, 'acc_0_1': 0.9401, 'acc_1_0': 0.7165, 'acc_1_1': 0.8474, 'mean_acc': 0.9235}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5373, 'acc_0_0': 0.9313, 'acc_0_1': 0.824, 'acc_1_0': 0.8182, 'acc_1_1': 0.5373, 'mean_acc': 0.8331}
Val(class)(new adapter): {'weighted_mean_acc': 0.945, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.867, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.8287, 'acc_0_0': 0.9494, 'acc_0_1': 0.8585, 'acc_1_0': 0.8287, 'acc_1_1': 0.9143, 'mean_acc': 0.8968}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9614, 'acc_0_1': 0.9356, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8657, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.8657, 'acc_1_1': 0.9242, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.8645, 'acc_0_0': 0.9299, 'acc_0_1': 0.8785, 'acc_1_0': 0.8645, 'acc_1_1': 0.8863, 'mean_acc': 0.8978}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.927, 'acc_0_1': 0.9399, 'acc_1_0': 0.8939, 'acc_1_1': 0.791, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.8806, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8871, 'worst_acc': 0.852, 'acc_0_0': 0.8971, 'acc_0_1': 0.9007, 'acc_1_0': 0.8785, 'acc_1_1': 0.852, 'mean_acc': 0.8914}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.8788, 'acc_1_1': 0.9254, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8815, 'worst_acc': 0.8788, 'acc_0_0': 0.8803, 'acc_0_1': 0.9185, 'acc_1_0': 0.8806, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8613, 'worst_acc': 0.8333, 'acc_0_0': 0.867, 'acc_0_1': 0.9078, 'acc_1_0': 0.8863, 'acc_1_1': 0.8333, 'mean_acc': 0.8813}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9442, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.8657, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.8209, 'acc_0_0': 0.9103, 'acc_0_1': 0.9227, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.8411, 'acc_0_0': 0.9091, 'acc_0_1': 0.9104, 'acc_1_0': 0.8598, 'acc_1_1': 0.8411, 'mean_acc': 0.8966}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.8209, 'acc_0_0': 0.9512, 'acc_0_1': 0.9211, 'acc_1_0': 0.8209, 'acc_1_1': 0.838, 'mean_acc': 0.9125}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.8084, 'acc_0_0': 0.9552, 'acc_0_1': 0.9175, 'acc_1_0': 0.8084, 'acc_1_1': 0.8458, 'mean_acc': 0.9122}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7991, 'acc_0_0': 0.9543, 'acc_0_1': 0.9295, 'acc_1_0': 0.7991, 'acc_1_1': 0.81, 'mean_acc': 0.9115}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7015, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7726, 'acc_0_0': 0.9512, 'acc_0_1': 0.9401, 'acc_1_0': 0.7913, 'acc_1_1': 0.7726, 'mean_acc': 0.9094}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.6866, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7539, 'acc_0_0': 0.9477, 'acc_0_1': 0.9459, 'acc_1_0': 0.7913, 'acc_1_1': 0.7539, 'mean_acc': 0.9082}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.7015, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7539, 'acc_0_0': 0.9406, 'acc_0_1': 0.9446, 'acc_1_0': 0.7991, 'acc_1_1': 0.7539, 'mean_acc': 0.9058}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7015, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7757, 'acc_0_0': 0.9392, 'acc_0_1': 0.9348, 'acc_1_0': 0.8037, 'acc_1_1': 0.7757, 'mean_acc': 0.9044}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9015, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.8162, 'acc_0_0': 0.937, 'acc_0_1': 0.9188, 'acc_1_0': 0.8193, 'acc_1_1': 0.8162, 'mean_acc': 0.9035}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7463, 'acc_0_0': 0.9188, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.824, 'acc_0_0': 0.9419, 'acc_0_1': 0.9149, 'acc_1_0': 0.824, 'acc_1_1': 0.8396, 'mean_acc': 0.907}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.824, 'acc_0_0': 0.945, 'acc_0_1': 0.9113, 'acc_1_0': 0.824, 'acc_1_1': 0.8427, 'mean_acc': 0.9071}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.8178, 'acc_0_0': 0.9494, 'acc_0_1': 0.9197, 'acc_1_0': 0.8178, 'acc_1_1': 0.8302, 'mean_acc': 0.9101}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9188, 'worst_acc': 0.8053, 'acc_0_0': 0.9525, 'acc_0_1': 0.9286, 'acc_1_0': 0.8053, 'acc_1_1': 0.8115, 'mean_acc': 0.9113}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7897, 'acc_0_0': 0.9525, 'acc_0_1': 0.9375, 'acc_1_0': 0.8037, 'acc_1_1': 0.7897, 'mean_acc': 0.9122}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7679, 'acc_0_0': 0.9561, 'acc_0_1': 0.9459, 'acc_1_0': 0.796, 'acc_1_1': 0.7679, 'mean_acc': 0.9135}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.757, 'acc_0_0': 0.9583, 'acc_0_1': 0.9472, 'acc_1_0': 0.7866, 'acc_1_1': 0.757, 'mean_acc': 0.9127}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7508, 'acc_0_0': 0.9583, 'acc_0_1': 0.9494, 'acc_1_0': 0.7835, 'acc_1_1': 0.7508, 'mean_acc': 0.9125}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.743, 'acc_0_0': 0.9601, 'acc_0_1': 0.9521, 'acc_1_0': 0.7757, 'acc_1_1': 0.743, 'mean_acc': 0.9125}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7508, 'acc_0_0': 0.961, 'acc_0_1': 0.9499, 'acc_1_0': 0.7726, 'acc_1_1': 0.7508, 'mean_acc': 0.9125}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7523, 'acc_0_0': 0.9623, 'acc_0_1': 0.9494, 'acc_1_0': 0.7741, 'acc_1_1': 0.7523, 'mean_acc': 0.9132}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7555, 'acc_0_0': 0.965, 'acc_0_1': 0.9494, 'acc_1_0': 0.7555, 'acc_1_1': 0.7555, 'mean_acc': 0.9125}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7523, 'acc_0_0': 0.9681, 'acc_0_1': 0.9481, 'acc_1_0': 0.7523, 'acc_1_1': 0.7632, 'mean_acc': 0.9137}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.757, 'acc_0_0': 0.9654, 'acc_0_1': 0.941, 'acc_1_0': 0.757, 'acc_1_1': 0.7804, 'mean_acc': 0.9123}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7586, 'acc_0_0': 0.9641, 'acc_0_1': 0.9361, 'acc_1_0': 0.7586, 'acc_1_1': 0.7928, 'mean_acc': 0.9115}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7601, 'acc_0_0': 0.9645, 'acc_0_1': 0.9361, 'acc_1_0': 0.7601, 'acc_1_1': 0.7928, 'mean_acc': 0.9118}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7617, 'acc_0_0': 0.9641, 'acc_0_1': 0.9322, 'acc_1_0': 0.7617, 'acc_1_1': 0.8006, 'mean_acc': 0.9111}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7617, 'acc_0_0': 0.9636, 'acc_0_1': 0.9322, 'acc_1_0': 0.7617, 'acc_1_1': 0.7991, 'mean_acc': 0.9108}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9251, 'worst_acc': 0.7617, 'acc_0_0': 0.9654, 'acc_0_1': 0.933, 'acc_1_0': 0.7617, 'acc_1_1': 0.7991, 'mean_acc': 0.9118}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7632, 'acc_0_0': 0.9645, 'acc_0_1': 0.9322, 'acc_1_0': 0.7632, 'acc_1_1': 0.8006, 'mean_acc': 0.9115}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7648, 'acc_0_0': 0.9623, 'acc_0_1': 0.9308, 'acc_1_0': 0.7648, 'acc_1_1': 0.8006, 'mean_acc': 0.9103}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.7695, 'acc_0_0': 0.961, 'acc_0_1': 0.9286, 'acc_1_0': 0.7695, 'acc_1_1': 0.8006, 'mean_acc': 0.9094}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.7648, 'acc_0_0': 0.9619, 'acc_0_1': 0.9326, 'acc_1_0': 0.7648, 'acc_1_1': 0.7944, 'mean_acc': 0.9101}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.7617, 'acc_0_0': 0.9632, 'acc_0_1': 0.9335, 'acc_1_0': 0.7617, 'acc_1_1': 0.7928, 'mean_acc': 0.9104}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7601, 'acc_0_0': 0.9645, 'acc_0_1': 0.9384, 'acc_1_0': 0.7601, 'acc_1_1': 0.7835, 'mean_acc': 0.9116}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7617, 'acc_0_0': 0.965, 'acc_0_1': 0.9375, 'acc_1_0': 0.7617, 'acc_1_1': 0.7882, 'mean_acc': 0.9122}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7664, 'acc_0_0': 0.9614, 'acc_0_1': 0.9357, 'acc_1_0': 0.7664, 'acc_1_1': 0.7882, 'mean_acc': 0.9106}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7617, 'acc_0_0': 0.9641, 'acc_0_1': 0.9406, 'acc_1_0': 0.7617, 'acc_1_1': 0.7773, 'mean_acc': 0.9118}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.7695, 'acc_0_0': 0.9614, 'acc_0_1': 0.9375, 'acc_1_0': 0.7695, 'acc_1_1': 0.785, 'mean_acc': 0.9113}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7679, 'acc_0_0': 0.9619, 'acc_0_1': 0.9384, 'acc_1_0': 0.7679, 'acc_1_1': 0.7819, 'mean_acc': 0.9113}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.7695, 'acc_0_0': 0.9614, 'acc_0_1': 0.9375, 'acc_1_0': 0.7695, 'acc_1_1': 0.785, 'mean_acc': 0.9113}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.771, 'acc_0_0': 0.9601, 'acc_0_1': 0.9375, 'acc_1_0': 0.771, 'acc_1_1': 0.785, 'mean_acc': 0.9109}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7695, 'acc_0_0': 0.961, 'acc_0_1': 0.9384, 'acc_1_0': 0.7695, 'acc_1_1': 0.785, 'mean_acc': 0.9115}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9188, 'worst_acc': 0.7741, 'acc_0_0': 0.9592, 'acc_0_1': 0.9366, 'acc_1_0': 0.7741, 'acc_1_1': 0.7897, 'mean_acc': 0.9111}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7664, 'acc_0_0': 0.9632, 'acc_0_1': 0.9392, 'acc_1_0': 0.7664, 'acc_1_1': 0.7773, 'mean_acc': 0.9115}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7617, 'acc_0_0': 0.9645, 'acc_0_1': 0.9392, 'acc_1_0': 0.7617, 'acc_1_1': 0.7788, 'mean_acc': 0.9116}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7648, 'acc_0_0': 0.9632, 'acc_0_1': 0.937, 'acc_1_0': 0.7648, 'acc_1_1': 0.785, 'mean_acc': 0.9113}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7648, 'acc_0_0': 0.9636, 'acc_0_1': 0.9388, 'acc_1_0': 0.7648, 'acc_1_1': 0.7835, 'mean_acc': 0.912}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.7695, 'acc_0_0': 0.961, 'acc_0_1': 0.9366, 'acc_1_0': 0.7695, 'acc_1_1': 0.7866, 'mean_acc': 0.9109}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.771, 'acc_0_0': 0.9596, 'acc_0_1': 0.9401, 'acc_1_0': 0.771, 'acc_1_1': 0.7804, 'mean_acc': 0.9113}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7695, 'acc_0_0': 0.9596, 'acc_0_1': 0.9379, 'acc_1_0': 0.7695, 'acc_1_1': 0.7866, 'mean_acc': 0.9109}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7695, 'acc_0_0': 0.9601, 'acc_0_1': 0.9397, 'acc_1_0': 0.7695, 'acc_1_1': 0.7804, 'mean_acc': 0.9111}
========================================================================
> end of training. 

best epoch : 48
best training accuracy on [class]: {'worst_acc': 0.791, 'acc_0_0': 0.927, 'acc_0_1': 0.9399, 'acc_1_0': 0.8939, 'acc_1_1': 0.791, 'mean_acc': 0.9132}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9067, 'worst_acc': 0.8806, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
best test accuracy on [class]: {'weighted_mean_acc': 0.8871, 'worst_acc': 0.852, 'acc_0_0': 0.8971, 'acc_0_1': 0.9007, 'acc_1_0': 0.8785, 'acc_1_1': 0.852, 'mean_acc': 0.8914}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8871, 'worst_acc': 0.852, 'acc_0_0': 0.8971, 'acc_0_1': 0.9007, 'acc_1_0': 0.8785, 'acc_1_1': 0.852, 'mean_acc': 0.8914}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9705, 'worst_acc': 0.7928, 'acc_0_0': 0.9765, 'acc_0_1': 0.9122, 'acc_1_0': 0.7928, 'acc_1_1': 0.9704, 'mean_acc': 0.9304}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 48': {'Train': {'worst_acc': 0.791, 'acc_0_0': 0.927, 'acc_0_1': 0.9399, 'acc_1_0': 0.8939, 'acc_1_1': 0.791, 'mean_acc': 0.9132}, 'Val': {'weighted_mean_acc': 0.9067, 'worst_acc': 0.8806, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}, 'Test': {'weighted_mean_acc': 0.8871, 'worst_acc': 0.852, 'acc_0_0': 0.8971, 'acc_0_1': 0.9007, 'acc_1_0': 0.8785, 'acc_1_1': 0.852, 'mean_acc': 0.8914}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8871, 'worst_acc': 0.852, 'acc_0_0': 0.8971, 'acc_0_1': 0.9007, 'acc_1_0': 0.8785, 'acc_1_1': 0.852, 'mean_acc': 0.8914}, 'spurious': {'weighted_mean_acc': 0.9705, 'worst_acc': 0.7928, 'acc_0_0': 0.9765, 'acc_0_1': 0.9122, 'acc_1_0': 0.7928, 'acc_1_1': 0.9704, 'mean_acc': 0.9304}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3859, 'acc_0_0': 0.9483, 'acc_0_1': 0.3859, 'acc_1_0': 0.4286, 'acc_1_1': 0.7739, 'mean_acc': 0.8822}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.3433, 'acc_0_0': 0.9957, 'acc_0_1': 0.4592, 'acc_1_0': 0.3433, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9539, 'worst_acc': 0.2804, 'acc_0_0': 0.9982, 'acc_0_1': 0.4182, 'acc_1_0': 0.2804, 'acc_1_1': 0.9361, 'mean_acc': 0.6861}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9883, 'acc_0_1': 0.4946, 'acc_1_0': 0.4286, 'acc_1_1': 0.9413, 'mean_acc': 0.9525}
Val(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.2661, 'acc_0_0': 0.9573, 'acc_0_1': 0.2661, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.6683}
Test(class): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.2213, 'acc_0_0': 0.9503, 'acc_0_1': 0.2213, 'acc_1_0': 0.7523, 'acc_1_1': 0.9798, 'mean_acc': 0.6479}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9886, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.8855, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5751, 'acc_0_0': 0.9872, 'acc_0_1': 0.5751, 'acc_1_0': 0.7164, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.5357, 'acc_0_0': 0.9756, 'acc_0_1': 0.5357, 'acc_1_0': 0.6947, 'acc_1_1': 0.9455, 'mean_acc': 0.7699}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9823, 'acc_0_1': 0.6957, 'acc_1_0': 0.6607, 'acc_1_1': 0.9413, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5075, 'acc_0_0': 0.9957, 'acc_0_1': 0.7639, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.5312, 'acc_0_0': 0.9956, 'acc_0_1': 0.7388, 'acc_1_0': 0.5312, 'acc_1_1': 0.9065, 'mean_acc': 0.8343}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.663, 'acc_1_0': 0.5893, 'acc_1_1': 0.9442, 'mean_acc': 0.9658}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.7833}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5743, 'acc_0_0': 0.9929, 'acc_0_1': 0.5743, 'acc_1_0': 0.5763, 'acc_1_1': 0.9455, 'mean_acc': 0.7786}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9949, 'acc_0_1': 0.6739, 'acc_1_0': 0.5536, 'acc_1_1': 0.9461, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5639, 'acc_0_0': 0.9938, 'acc_0_1': 0.6142, 'acc_1_0': 0.5639, 'acc_1_1': 0.9361, 'mean_acc': 0.792}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.6522, 'acc_1_0': 0.5893, 'acc_1_1': 0.9574, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.5779, 'acc_0_0': 0.9933, 'acc_0_1': 0.6217, 'acc_1_0': 0.5779, 'acc_1_1': 0.9408, 'mean_acc': 0.7969}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9963, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9451, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6438, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6059, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.7994}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9949, 'acc_0_1': 0.7446, 'acc_1_0': 0.625, 'acc_1_1': 0.9499, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6031, 'acc_0_0': 0.9916, 'acc_0_1': 0.6031, 'acc_1_0': 0.6184, 'acc_1_1': 0.9486, 'mean_acc': 0.7943}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9546, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5826, 'acc_0_0': 0.9938, 'acc_0_1': 0.6545, 'acc_1_0': 0.5826, 'acc_1_1': 0.9393, 'mean_acc': 0.8101}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9951, 'acc_0_1': 0.7446, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5483, 'acc_0_0': 0.9956, 'acc_0_1': 0.7268, 'acc_1_0': 0.5483, 'acc_1_1': 0.9283, 'mean_acc': 0.834}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.996, 'acc_0_1': 0.75, 'acc_1_0': 0.6429, 'acc_1_1': 0.9555, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5654, 'acc_0_0': 0.9942, 'acc_0_1': 0.6927, 'acc_1_0': 0.5654, 'acc_1_1': 0.9377, 'mean_acc': 0.8231}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.6896, 'acc_1_0': 0.5794, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.7826, 'acc_1_0': 0.6786, 'acc_1_1': 0.9697, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5075, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.567, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.567, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9977, 'acc_0_1': 0.7989, 'acc_1_0': 0.6786, 'acc_1_1': 0.964, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6004, 'acc_0_0': 0.9894, 'acc_0_1': 0.6004, 'acc_1_0': 0.6153, 'acc_1_1': 0.9455, 'mean_acc': 0.7917}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7854, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5607, 'acc_0_0': 0.9942, 'acc_0_1': 0.761, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8483}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9966, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7086, 'acc_1_0': 0.5654, 'acc_1_1': 0.9346, 'mean_acc': 0.8288}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9991, 'acc_0_1': 0.8859, 'acc_1_0': 0.7679, 'acc_1_1': 0.9584, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6075, 'acc_0_0': 0.9925, 'acc_0_1': 0.6177, 'acc_1_0': 0.6075, 'acc_1_1': 0.947, 'mean_acc': 0.7989}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.983, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9942, 'acc_0_1': 0.7933, 'acc_1_0': 0.5545, 'acc_1_1': 0.919, 'mean_acc': 0.859}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.8214, 'acc_1_1': 0.983, 'mean_acc': 0.9881}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7682, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5654, 'acc_1_1': 0.9206, 'mean_acc': 0.8533}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.8967, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7425, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6044, 'acc_0_0': 0.9911, 'acc_0_1': 0.733, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8416}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.8929, 'acc_1_1': 0.9763, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6119, 'acc_0_0': 0.9786, 'acc_0_1': 0.6395, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5981, 'acc_0_0': 0.9925, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9502, 'mean_acc': 0.8098}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9896, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7983, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5748, 'acc_0_0': 0.9938, 'acc_0_1': 0.8231, 'acc_1_0': 0.5748, 'acc_1_1': 0.9065, 'mean_acc': 0.8712}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.9076, 'acc_1_0': 0.8571, 'acc_1_1': 0.9886, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.6867, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6106, 'acc_0_0': 0.9894, 'acc_0_1': 0.6927, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9868, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6215, 'acc_0_0': 0.9894, 'acc_0_1': 0.7282, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.841}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9989, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9962, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.7548, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8485}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9185, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6215, 'acc_0_0': 0.9876, 'acc_0_1': 0.7042, 'acc_1_0': 0.6215, 'acc_1_1': 0.9377, 'mean_acc': 0.8312}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7255, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8397}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9107, 'acc_1_1': 0.9953, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9732, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.5623, 'acc_0_0': 0.9956, 'acc_0_1': 0.7437, 'acc_1_0': 0.5623, 'acc_1_1': 0.9268, 'mean_acc': 0.8419}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.9022, 'acc_1_0': 0.8929, 'acc_1_1': 0.9915, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6355, 'acc_0_0': 0.9854, 'acc_0_1': 0.745, 'acc_1_0': 0.6355, 'acc_1_1': 0.919, 'mean_acc': 0.8457}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9956}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.6269, 'acc_0_0': 0.9744, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6573, 'acc_0_0': 0.9867, 'acc_0_1': 0.6962, 'acc_1_0': 0.6573, 'acc_1_1': 0.9361, 'mean_acc': 0.8315}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.9286, 'acc_1_1': 0.9905, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6781, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6324, 'acc_0_0': 0.9867, 'acc_0_1': 0.6914, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.8272}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9674, 'acc_1_0': 0.9464, 'acc_1_1': 0.9943, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.721, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6199, 'acc_0_0': 0.9925, 'acc_0_1': 0.7499, 'acc_1_0': 0.6199, 'acc_1_1': 0.9252, 'mean_acc': 0.8493}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9286, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5966, 'acc_0_0': 0.9744, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.5863, 'acc_0_0': 0.9778, 'acc_0_1': 0.5863, 'acc_1_0': 0.6636, 'acc_1_1': 0.9517, 'mean_acc': 0.7877}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.7752, 'acc_1_0': 0.609, 'acc_1_1': 0.9206, 'mean_acc': 0.8567}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6542, 'acc_0_0': 0.9836, 'acc_0_1': 0.6625, 'acc_1_0': 0.6542, 'acc_1_1': 0.9439, 'mean_acc': 0.8177}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9981, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5623, 'acc_0_0': 0.9969, 'acc_0_1': 0.8284, 'acc_1_0': 0.5623, 'acc_1_1': 0.905, 'mean_acc': 0.873}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6352, 'acc_0_0': 0.9829, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.6381, 'acc_0_0': 0.9796, 'acc_0_1': 0.6381, 'acc_1_0': 0.6573, 'acc_1_1': 0.9533, 'mean_acc': 0.8081}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.7344, 'acc_1_0': 0.6277, 'acc_1_1': 0.9299, 'mean_acc': 0.8426}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6542, 'acc_0_0': 0.9858, 'acc_0_1': 0.7007, 'acc_1_0': 0.6542, 'acc_1_1': 0.9408, 'mean_acc': 0.8331}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4545, 'acc_0_0': 0.9914, 'acc_0_1': 0.7897, 'acc_1_0': 0.4545, 'acc_1_1': 0.9254, 'mean_acc': 0.8464}
Val(class)(new adapter): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7983, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6153, 'acc_0_0': 0.992, 'acc_0_1': 0.8075, 'acc_1_0': 0.6153, 'acc_1_1': 0.9097, 'mean_acc': 0.8693}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0152, 'acc_0_0': 0.9571, 'acc_0_1': 0.2876, 'acc_1_0': 0.0152, 'acc_1_1': 0.791, 'mean_acc': 0.5743}
Val(class)(new adapter): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.7082, 'acc_0_0': 0.9701, 'acc_0_1': 0.7082, 'acc_1_0': 0.7164, 'acc_1_1': 0.9848, 'mean_acc': 0.8417}
Test(class)(new adapter): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.71, 'acc_0_0': 0.9814, 'acc_0_1': 0.71, 'acc_1_0': 0.7259, 'acc_1_1': 0.9377, 'mean_acc': 0.8426}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9871, 'acc_0_1': 0.8455, 'acc_1_0': 0.7121, 'acc_1_1': 0.9254, 'mean_acc': 0.8948}
Val(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7679, 'acc_0_0': 0.9752, 'acc_0_1': 0.9166, 'acc_1_0': 0.7679, 'acc_1_1': 0.7882, 'mean_acc': 0.9087}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1194, 'acc_0_0': 0.6867, 'acc_0_1': 0.9871, 'acc_1_0': 0.5909, 'acc_1_1': 0.1194, 'mean_acc': 0.7295}
Val(class)(new adapter): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.7015, 'acc_0_0': 0.9658, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.743, 'acc_0_0': 0.9805, 'acc_0_1': 0.9468, 'acc_1_0': 0.743, 'acc_1_1': 0.7741, 'mean_acc': 0.9182}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.6667, 'acc_1_1': 0.8955, 'mean_acc': 0.9416}
Val(class)(new adapter): {'weighted_mean_acc': 0.945, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.867, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.8396, 'acc_0_0': 0.9539, 'acc_0_1': 0.8701, 'acc_1_0': 0.8396, 'acc_1_1': 0.8801, 'mean_acc': 0.9004}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.597, 'acc_0_0': 0.9442, 'acc_0_1': 0.9013, 'acc_1_0': 0.8636, 'acc_1_1': 0.597, 'mean_acc': 0.8798}
Val(class)(new adapter): {'weighted_mean_acc': 0.889, 'worst_acc': 0.7554, 'acc_0_0': 0.8761, 'acc_0_1': 0.7554, 'acc_1_0': 0.8955, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class)(new adapter): {'weighted_mean_acc': 0.8736, 'worst_acc': 0.7672, 'acc_0_0': 0.8608, 'acc_0_1': 0.7672, 'acc_1_0': 0.9065, 'acc_1_1': 0.933, 'mean_acc': 0.8374}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8755, 'acc_0_0': 0.9356, 'acc_0_1': 0.8755, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.8971, 'worst_acc': 0.8657, 'acc_0_0': 0.8889, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.9242, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8823, 'worst_acc': 0.8614, 'acc_0_0': 0.8878, 'acc_0_1': 0.8936, 'acc_1_0': 0.8941, 'acc_1_1': 0.8614, 'mean_acc': 0.8878}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7463, 'acc_0_0': 0.9657, 'acc_0_1': 0.9614, 'acc_1_0': 0.9091, 'acc_1_1': 0.7463, 'mean_acc': 0.9332}
Val(class)(new adapter): {'weighted_mean_acc': 0.8717, 'worst_acc': 0.7879, 'acc_0_0': 0.8932, 'acc_0_1': 0.9571, 'acc_1_0': 0.8358, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8593, 'worst_acc': 0.7601, 'acc_0_0': 0.8843, 'acc_0_1': 0.9481, 'acc_1_0': 0.8801, 'acc_1_1': 0.7601, 'mean_acc': 0.8949}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.7879, 'acc_1_1': 0.8209, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.8439, 'worst_acc': 0.8291, 'acc_0_0': 0.8291, 'acc_0_1': 0.9185, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8157, 'worst_acc': 0.8067, 'acc_0_0': 0.8067, 'acc_0_1': 0.9277, 'acc_1_0': 0.9159, 'acc_1_1': 0.8209, 'mean_acc': 0.8674}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9356, 'acc_0_0': 0.9356, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.8715, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8884, 'acc_1_0': 0.8657, 'acc_1_1': 0.9242, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8604, 'worst_acc': 0.8501, 'acc_0_0': 0.8501, 'acc_0_1': 0.8878, 'acc_1_0': 0.8988, 'acc_1_1': 0.8879, 'mean_acc': 0.8744}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.8209, 'acc_0_0': 0.8889, 'acc_0_1': 0.8798, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.8396, 'acc_0_0': 0.9113, 'acc_0_1': 0.8705, 'acc_1_0': 0.8396, 'acc_1_1': 0.8941, 'mean_acc': 0.8856}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9871, 'acc_0_1': 0.9785, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7913, 'acc_0_0': 0.9384, 'acc_0_1': 0.8834, 'acc_1_0': 0.7913, 'acc_1_1': 0.8801, 'mean_acc': 0.8942}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.791, 'acc_0_0': 0.9017, 'acc_0_1': 0.8841, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.796, 'acc_0_0': 0.9348, 'acc_0_1': 0.8958, 'acc_1_0': 0.796, 'acc_1_1': 0.8583, 'mean_acc': 0.8958}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9785, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.806, 'acc_0_0': 0.8932, 'acc_0_1': 0.867, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8952, 'worst_acc': 0.8271, 'acc_0_0': 0.9109, 'acc_0_1': 0.8922, 'acc_1_0': 0.8271, 'acc_1_1': 0.8474, 'mean_acc': 0.8873}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8791, 'worst_acc': 0.806, 'acc_0_0': 0.8675, 'acc_0_1': 0.8627, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.8667, 'worst_acc': 0.8442, 'acc_0_0': 0.8723, 'acc_0_1': 0.89, 'acc_1_0': 0.8614, 'acc_1_1': 0.8442, 'mean_acc': 0.8749}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8757, 'worst_acc': 0.806, 'acc_0_0': 0.8632, 'acc_0_1': 0.8541, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8474, 'acc_0_0': 0.8767, 'acc_0_1': 0.8816, 'acc_1_0': 0.8707, 'acc_1_1': 0.8474, 'mean_acc': 0.8747}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.806, 'acc_0_0': 0.8889, 'acc_0_1': 0.8541, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.8882, 'worst_acc': 0.838, 'acc_0_0': 0.9016, 'acc_0_1': 0.8843, 'acc_1_0': 0.838, 'acc_1_1': 0.8474, 'mean_acc': 0.8818}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8976, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.8053, 'acc_0_0': 0.9353, 'acc_0_1': 0.9033, 'acc_1_0': 0.8053, 'acc_1_1': 0.8302, 'mean_acc': 0.8968}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7648, 'acc_0_0': 0.9565, 'acc_0_1': 0.914, 'acc_1_0': 0.7648, 'acc_1_1': 0.8209, 'mean_acc': 0.9037}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7414, 'acc_0_0': 0.965, 'acc_0_1': 0.9246, 'acc_1_0': 0.7414, 'acc_1_1': 0.81, 'mean_acc': 0.9073}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7414, 'acc_0_0': 0.9663, 'acc_0_1': 0.9259, 'acc_1_0': 0.7414, 'acc_1_1': 0.8084, 'mean_acc': 0.9082}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7461, 'acc_0_0': 0.9645, 'acc_0_1': 0.9273, 'acc_1_0': 0.7461, 'acc_1_1': 0.7975, 'mean_acc': 0.9073}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7508, 'acc_0_0': 0.9614, 'acc_0_1': 0.9264, 'acc_1_0': 0.7508, 'acc_1_1': 0.8037, 'mean_acc': 0.907}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7555, 'acc_0_0': 0.9588, 'acc_0_1': 0.9264, 'acc_1_0': 0.7555, 'acc_1_1': 0.8037, 'mean_acc': 0.9065}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7508, 'acc_0_0': 0.9579, 'acc_0_1': 0.929, 'acc_1_0': 0.7508, 'acc_1_1': 0.7975, 'mean_acc': 0.9059}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7336, 'acc_0_0': 0.9645, 'acc_0_1': 0.9437, 'acc_1_0': 0.7336, 'acc_1_1': 0.7664, 'mean_acc': 0.9089}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.715, 'acc_0_0': 0.9672, 'acc_0_1': 0.9499, 'acc_1_0': 0.715, 'acc_1_1': 0.7508, 'mean_acc': 0.9085}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.715, 'acc_0_0': 0.9654, 'acc_0_1': 0.9517, 'acc_1_0': 0.715, 'acc_1_1': 0.7477, 'mean_acc': 0.9082}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9614, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7087, 'acc_0_0': 0.969, 'acc_0_1': 0.9565, 'acc_1_0': 0.7087, 'acc_1_1': 0.7352, 'mean_acc': 0.9094}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9657, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.6994, 'acc_0_0': 0.9721, 'acc_0_1': 0.9561, 'acc_1_0': 0.6994, 'acc_1_1': 0.7352, 'mean_acc': 0.9094}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7009, 'acc_0_0': 0.9721, 'acc_0_1': 0.9517, 'acc_1_0': 0.7009, 'acc_1_1': 0.7383, 'mean_acc': 0.9082}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.704, 'acc_0_0': 0.9707, 'acc_0_1': 0.9503, 'acc_1_0': 0.704, 'acc_1_1': 0.7399, 'mean_acc': 0.9077}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7015, 'acc_0_0': 0.9231, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7181, 'acc_0_0': 0.969, 'acc_0_1': 0.9486, 'acc_1_0': 0.7181, 'acc_1_1': 0.757, 'mean_acc': 0.9097}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.901, 'worst_acc': 0.7015, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.729, 'acc_0_0': 0.9632, 'acc_0_1': 0.9415, 'acc_1_0': 0.729, 'acc_1_1': 0.7819, 'mean_acc': 0.9087}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7164, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.729, 'acc_0_0': 0.961, 'acc_0_1': 0.9388, 'acc_1_0': 0.729, 'acc_1_1': 0.7819, 'mean_acc': 0.9068}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7164, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.729, 'acc_0_0': 0.9614, 'acc_0_1': 0.9401, 'acc_1_0': 0.729, 'acc_1_1': 0.7773, 'mean_acc': 0.907}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7305, 'acc_0_0': 0.9605, 'acc_0_1': 0.9388, 'acc_1_0': 0.7305, 'acc_1_1': 0.7819, 'mean_acc': 0.9068}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.729, 'acc_0_0': 0.9614, 'acc_0_1': 0.9388, 'acc_1_0': 0.729, 'acc_1_1': 0.7804, 'mean_acc': 0.9068}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.729, 'acc_0_0': 0.9619, 'acc_0_1': 0.9397, 'acc_1_0': 0.729, 'acc_1_1': 0.7773, 'mean_acc': 0.907}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7352, 'acc_0_0': 0.9583, 'acc_0_1': 0.9366, 'acc_1_0': 0.7352, 'acc_1_1': 0.7866, 'mean_acc': 0.9061}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7352, 'acc_0_0': 0.9588, 'acc_0_1': 0.9366, 'acc_1_0': 0.7352, 'acc_1_1': 0.7819, 'mean_acc': 0.9058}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7352, 'acc_0_0': 0.9579, 'acc_0_1': 0.9357, 'acc_1_0': 0.7352, 'acc_1_1': 0.7897, 'mean_acc': 0.9059}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7461, 'acc_0_0': 0.9574, 'acc_0_1': 0.933, 'acc_1_0': 0.7461, 'acc_1_1': 0.7928, 'mean_acc': 0.9063}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7461, 'acc_0_0': 0.957, 'acc_0_1': 0.9322, 'acc_1_0': 0.7461, 'acc_1_1': 0.7944, 'mean_acc': 0.9059}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7414, 'acc_0_0': 0.957, 'acc_0_1': 0.933, 'acc_1_0': 0.7414, 'acc_1_1': 0.7928, 'mean_acc': 0.9056}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7445, 'acc_0_0': 0.957, 'acc_0_1': 0.9339, 'acc_1_0': 0.7445, 'acc_1_1': 0.7897, 'mean_acc': 0.9059}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7399, 'acc_0_0': 0.9574, 'acc_0_1': 0.9353, 'acc_1_0': 0.7399, 'acc_1_1': 0.785, 'mean_acc': 0.9056}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7305, 'acc_0_0': 0.9588, 'acc_0_1': 0.9366, 'acc_1_0': 0.7305, 'acc_1_1': 0.7804, 'mean_acc': 0.9051}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7414, 'acc_0_0': 0.9574, 'acc_0_1': 0.9348, 'acc_1_0': 0.7414, 'acc_1_1': 0.7882, 'mean_acc': 0.9059}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7414, 'acc_0_0': 0.957, 'acc_0_1': 0.9348, 'acc_1_0': 0.7414, 'acc_1_1': 0.785, 'mean_acc': 0.9054}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7399, 'acc_0_0': 0.957, 'acc_0_1': 0.9353, 'acc_1_0': 0.7399, 'acc_1_1': 0.7835, 'mean_acc': 0.9052}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7477, 'acc_0_0': 0.9557, 'acc_0_1': 0.9326, 'acc_1_0': 0.7477, 'acc_1_1': 0.7928, 'mean_acc': 0.9056}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7445, 'acc_0_0': 0.957, 'acc_0_1': 0.9344, 'acc_1_0': 0.7445, 'acc_1_1': 0.7913, 'mean_acc': 0.9063}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7445, 'acc_0_0': 0.9565, 'acc_0_1': 0.9339, 'acc_1_0': 0.7445, 'acc_1_1': 0.7913, 'mean_acc': 0.9059}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7445, 'acc_0_0': 0.9565, 'acc_0_1': 0.9335, 'acc_1_0': 0.7445, 'acc_1_1': 0.7913, 'mean_acc': 0.9058}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7523, 'acc_0_0': 0.9557, 'acc_0_1': 0.9255, 'acc_1_0': 0.7523, 'acc_1_1': 0.7991, 'mean_acc': 0.904}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7523, 'acc_0_0': 0.9548, 'acc_0_1': 0.929, 'acc_1_0': 0.7523, 'acc_1_1': 0.7944, 'mean_acc': 0.9046}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.743, 'acc_0_0': 0.957, 'acc_0_1': 0.9344, 'acc_1_0': 0.743, 'acc_1_1': 0.7897, 'mean_acc': 0.9059}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7414, 'acc_0_0': 0.9574, 'acc_0_1': 0.9339, 'acc_1_0': 0.7414, 'acc_1_1': 0.7928, 'mean_acc': 0.9061}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7383, 'acc_0_0': 0.9583, 'acc_0_1': 0.9344, 'acc_1_0': 0.7383, 'acc_1_1': 0.7897, 'mean_acc': 0.9059}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8755, 'acc_0_0': 0.9356, 'acc_0_1': 0.8755, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9132}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8971, 'worst_acc': 0.8657, 'acc_0_0': 0.8889, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.9242, 'mean_acc': 0.8967}
best test accuracy on [class]: {'weighted_mean_acc': 0.8823, 'worst_acc': 0.8614, 'acc_0_0': 0.8878, 'acc_0_1': 0.8936, 'acc_1_0': 0.8941, 'acc_1_1': 0.8614, 'mean_acc': 0.8878}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8823, 'worst_acc': 0.8614, 'acc_0_0': 0.8878, 'acc_0_1': 0.8936, 'acc_1_0': 0.8941, 'acc_1_1': 0.8614, 'mean_acc': 0.8878}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9738, 'worst_acc': 0.8302, 'acc_0_0': 0.98, 'acc_0_1': 0.9011, 'acc_1_0': 0.8302, 'acc_1_1': 0.9735, 'mean_acc': 0.932}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8755, 'acc_0_0': 0.9356, 'acc_0_1': 0.8755, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9132}, 'Val': {'weighted_mean_acc': 0.8971, 'worst_acc': 0.8657, 'acc_0_0': 0.8889, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.9242, 'mean_acc': 0.8967}, 'Test': {'weighted_mean_acc': 0.8823, 'worst_acc': 0.8614, 'acc_0_0': 0.8878, 'acc_0_1': 0.8936, 'acc_1_0': 0.8941, 'acc_1_1': 0.8614, 'mean_acc': 0.8878}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8823, 'worst_acc': 0.8614, 'acc_0_0': 0.8878, 'acc_0_1': 0.8936, 'acc_1_0': 0.8941, 'acc_1_1': 0.8614, 'mean_acc': 0.8878}, 'spurious': {'weighted_mean_acc': 0.9738, 'worst_acc': 0.8302, 'acc_0_0': 0.98, 'acc_0_1': 0.9011, 'acc_1_0': 0.8302, 'acc_1_1': 0.9735, 'mean_acc': 0.932}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8954     0.8754   0.8967  ...   0.8754   0.8956    0.8866
2                       0.8871     0.8520   0.8971  ...   0.8785   0.8520    0.8914
3                       0.8823     0.8614   0.8878  ...   0.8941   0.8614    0.8878
test_mean               0.8883     0.8629   0.8939  ...   0.8827   0.8697    0.8886
test_std                0.0054     0.0096   0.0043  ...   0.0082   0.0187    0.0020
1                       0.9736     0.7274   0.9823  ...   0.7274   0.9735    0.9149
2                       0.9705     0.7928   0.9765  ...   0.7928   0.9704    0.9304
3                       0.9738     0.8302   0.9800  ...   0.8302   0.9735    0.9320
zs_spu_mean             0.9726     0.7835   0.9796  ...   0.7835   0.9725    0.9258
zs_spu_std              0.0015     0.0425   0.0024  ...   0.0425   0.0015    0.0077
1                          NaN     0.8333   0.9485  ...   0.8333   0.9701    0.9316
2                          NaN     0.7910   0.9270  ...   0.8939   0.7910    0.9132
3                          NaN     0.8755   0.9356  ...   0.8939   0.9851    0.9132
tr_mean                    NaN     0.8333   0.9370  ...   0.8737   0.9154    0.9193
tr_std                     NaN     0.0345   0.0088  ...   0.0286   0.0882    0.0087
1                       0.9086     0.8657   0.9017  ...   0.8657   0.9394    0.8917
2                       0.9067     0.8806   0.9060  ...   0.8806   0.9091    0.9067
3                       0.8971     0.8657   0.8889  ...   0.8657   0.9242    0.8967
val_mean                0.9041     0.8707   0.8989  ...   0.8707   0.9242    0.8984
val_std                 0.0050     0.0070   0.0073  ...   0.0070   0.0124    0.0062
1                       0.8954     0.8754   0.8967  ...   0.8754   0.8956    0.8866
2                       0.8871     0.8520   0.8971  ...   0.8785   0.8520    0.8914
3                       0.8823     0.8614   0.8878  ...   0.8941   0.8614    0.8878
zs_tg_mean              0.8883     0.8629   0.8939  ...   0.8827   0.8697    0.8886
zs_tg_std               0.0054     0.0096   0.0043  ...   0.0082   0.0187    0.0020

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_1.0_lrr1.0_bsr256_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0634, 'acc_0_0': 0.9643, 'acc_0_1': 0.9511, 'acc_1_0': 0.1071, 'acc_1_1': 0.0634, 'mean_acc': 0.7552}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3571, 'acc_0_0': 0.992, 'acc_0_1': 0.6957, 'acc_1_0': 0.3571, 'acc_1_1': 0.8023, 'mean_acc': 0.9314}
Val(class): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8798, 'acc_1_0': 0.4925, 'acc_1_1': 0.6061, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.4907, 'acc_0_0': 0.9938, 'acc_0_1': 0.8767, 'acc_1_0': 0.4907, 'acc_1_1': 0.6012, 'mean_acc': 0.849}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9831, 'acc_0_1': 0.6576, 'acc_1_0': 0.5536, 'acc_1_1': 0.9243, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.8888, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.3284, 'acc_1_1': 0.5455, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.3754, 'acc_0_0': 0.9978, 'acc_0_1': 0.9135, 'acc_1_0': 0.3754, 'acc_1_1': 0.5763, 'mean_acc': 0.8493}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9889, 'acc_0_1': 0.6848, 'acc_1_0': 0.625, 'acc_1_1': 0.9347, 'mean_acc': 0.961}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8112, 'acc_1_0': 0.4776, 'acc_1_1': 0.8939, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.5436, 'acc_0_0': 0.9925, 'acc_0_1': 0.8071, 'acc_1_0': 0.5436, 'acc_1_1': 0.8645, 'mean_acc': 0.8564}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9906, 'acc_0_1': 0.6685, 'acc_1_0': 0.6429, 'acc_1_1': 0.9565, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6012, 'acc_0_0': 0.9885, 'acc_0_1': 0.6373, 'acc_1_0': 0.6012, 'acc_1_1': 0.9486, 'mean_acc': 0.8045}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.663, 'acc_1_0': 0.6607, 'acc_1_1': 0.9631, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.5794, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5996, 'acc_0_0': 0.9871, 'acc_0_1': 0.5996, 'acc_1_0': 0.6106, 'acc_1_1': 0.9502, 'mean_acc': 0.7905}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9943, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9678, 'mean_acc': 0.9725}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.5665, 'acc_0_0': 0.9957, 'acc_0_1': 0.5665, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5809, 'acc_0_0': 0.9863, 'acc_0_1': 0.5809, 'acc_1_0': 0.6215, 'acc_1_1': 0.9548, 'mean_acc': 0.7846}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7065, 'acc_1_0': 0.6607, 'acc_1_1': 0.9612, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4635, 'acc_0_0': 0.9957, 'acc_0_1': 0.4635, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.5193, 'acc_0_0': 0.9814, 'acc_0_1': 0.5193, 'acc_1_0': 0.6745, 'acc_1_1': 0.9642, 'mean_acc': 0.7656}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9917, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9612, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.4721, 'acc_0_0': 0.9957, 'acc_0_1': 0.4721, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.49, 'acc_0_0': 0.984, 'acc_0_1': 0.49, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7541}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.992, 'acc_0_1': 0.6793, 'acc_1_0': 0.7143, 'acc_1_1': 0.9688, 'mean_acc': 0.9716}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.553, 'acc_0_0': 0.9836, 'acc_0_1': 0.553, 'acc_1_0': 0.6604, 'acc_1_1': 0.9595, 'mean_acc': 0.7775}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.6964, 'acc_1_1': 0.9707, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5942, 'acc_0_0': 0.9863, 'acc_0_1': 0.5942, 'acc_1_0': 0.6417, 'acc_1_1': 0.9533, 'mean_acc': 0.7919}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.994, 'acc_0_1': 0.7337, 'acc_1_0': 0.7143, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6266, 'acc_0_0': 0.9915, 'acc_0_1': 0.6266, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.612, 'acc_0_0': 0.9863, 'acc_0_1': 0.612, 'acc_1_0': 0.6449, 'acc_1_1': 0.9517, 'mean_acc': 0.7989}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9929, 'acc_0_1': 0.7772, 'acc_1_0': 0.7679, 'acc_1_1': 0.9659, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.565, 'acc_0_0': 0.9831, 'acc_0_1': 0.565, 'acc_1_0': 0.6807, 'acc_1_1': 0.9564, 'mean_acc': 0.7839}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9963, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4464, 'acc_0_0': 0.9872, 'acc_0_1': 0.4464, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7417}
Test(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.4293, 'acc_0_0': 0.9831, 'acc_0_1': 0.4293, 'acc_1_0': 0.6885, 'acc_1_1': 0.9688, 'mean_acc': 0.7333}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9931, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9678, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.7322, 'acc_1_0': 0.6277, 'acc_1_1': 0.9377, 'mean_acc': 0.8431}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9969, 'acc_0_1': 0.7935, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.5923, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5787, 'acc_0_0': 0.9849, 'acc_0_1': 0.5787, 'acc_1_0': 0.6324, 'acc_1_1': 0.9486, 'mean_acc': 0.7837}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9969, 'acc_0_1': 0.8315, 'acc_1_0': 0.8393, 'acc_1_1': 0.9792, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5872, 'acc_0_0': 0.992, 'acc_0_1': 0.7951, 'acc_1_0': 0.5872, 'acc_1_1': 0.9128, 'mean_acc': 0.8618}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8641, 'acc_1_0': 0.8036, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7854, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5576, 'acc_0_0': 0.9933, 'acc_0_1': 0.7933, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.8602}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9969, 'acc_0_1': 0.8587, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4807, 'acc_0_0': 0.9744, 'acc_0_1': 0.4807, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7533}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4683, 'acc_0_0': 0.9823, 'acc_0_1': 0.4683, 'acc_1_0': 0.6729, 'acc_1_1': 0.9673, 'mean_acc': 0.7463}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.984, 'acc_0_1': 0.6736, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.8219}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9969, 'acc_0_1': 0.913, 'acc_1_0': 0.9464, 'acc_1_1': 0.9811, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.6652, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5903, 'acc_0_0': 0.9863, 'acc_0_1': 0.6736, 'acc_1_0': 0.5903, 'acc_1_1': 0.933, 'mean_acc': 0.8148}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9943, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5545, 'acc_0_0': 0.9925, 'acc_0_1': 0.6758, 'acc_1_0': 0.5545, 'acc_1_1': 0.9299, 'mean_acc': 0.8138}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.996, 'acc_0_1': 0.875, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6524, 'acc_0_0': 0.9829, 'acc_0_1': 0.6524, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6421, 'acc_0_0': 0.9854, 'acc_0_1': 0.6421, 'acc_1_0': 0.6449, 'acc_1_1': 0.9548, 'mean_acc': 0.8107}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9937, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5436, 'acc_0_0': 0.9929, 'acc_0_1': 0.7583, 'acc_1_0': 0.5436, 'acc_1_1': 0.9268, 'mean_acc': 0.8445}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.996, 'acc_0_1': 0.8533, 'acc_1_0': 0.875, 'acc_1_1': 0.9735, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6309, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.6293, 'acc_0_0': 0.9792, 'acc_0_1': 0.6488, 'acc_1_0': 0.6293, 'acc_1_1': 0.9268, 'mean_acc': 0.806}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9954, 'acc_0_1': 0.8478, 'acc_1_0': 0.7857, 'acc_1_1': 0.9745, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.8884, 'acc_1_0': 0.4925, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.5, 'acc_0_0': 0.9965, 'acc_0_1': 0.8976, 'acc_1_0': 0.5, 'acc_1_1': 0.8583, 'mean_acc': 0.8876}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.944, 'worst_acc': 0.4292, 'acc_0_0': 0.9573, 'acc_0_1': 0.4292, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.4488, 'acc_0_0': 0.957, 'acc_0_1': 0.4488, 'acc_1_0': 0.7368, 'acc_1_1': 0.9688, 'mean_acc': 0.7361}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9929, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.9726, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.691, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6807, 'acc_0_0': 0.9871, 'acc_0_1': 0.7091, 'acc_1_0': 0.6807, 'acc_1_1': 0.947, 'mean_acc': 0.8405}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.9669, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9728, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.7641, 'acc_1_0': 0.5576, 'acc_1_1': 0.9159, 'mean_acc': 0.8459}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9969, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.9811, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3731, 'acc_0_0': 0.9957, 'acc_0_1': 0.8927, 'acc_1_0': 0.3731, 'acc_1_1': 0.8485, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9476, 'worst_acc': 0.4097, 'acc_0_0': 0.9982, 'acc_0_1': 0.9029, 'acc_1_0': 0.4097, 'acc_1_1': 0.8162, 'mean_acc': 0.8757}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9877, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5794, 'acc_0_0': 0.9744, 'acc_0_1': 0.5794, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.5902, 'acc_0_0': 0.9725, 'acc_0_1': 0.5902, 'acc_1_0': 0.7056, 'acc_1_1': 0.9517, 'mean_acc': 0.7919}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9969, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5536, 'acc_0_0': 0.9829, 'acc_0_1': 0.5536, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6226, 'acc_0_0': 0.9805, 'acc_0_1': 0.6226, 'acc_1_0': 0.6573, 'acc_1_1': 0.9486, 'mean_acc': 0.8019}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9972, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5579, 'acc_0_0': 0.9573, 'acc_0_1': 0.5579, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.942, 'worst_acc': 0.5548, 'acc_0_0': 0.9592, 'acc_0_1': 0.5548, 'acc_1_0': 0.7492, 'acc_1_1': 0.9626, 'mean_acc': 0.7789}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9991, 'acc_0_1': 0.9457, 'acc_1_0': 0.9643, 'acc_1_1': 0.9858, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.7095, 'acc_1_0': 0.5327, 'acc_1_1': 0.9268, 'mean_acc': 0.8238}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5075, 'acc_0_0': 0.9872, 'acc_0_1': 0.8112, 'acc_1_0': 0.5075, 'acc_1_1': 0.9091, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.5654, 'acc_0_0': 0.9907, 'acc_0_1': 0.8421, 'acc_1_0': 0.5654, 'acc_1_1': 0.8567, 'mean_acc': 0.8709}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9966, 'acc_0_1': 0.9565, 'acc_1_0': 0.8929, 'acc_1_1': 0.9849, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.5107, 'acc_0_0': 0.9701, 'acc_0_1': 0.5107, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.486, 'acc_0_0': 0.9698, 'acc_0_1': 0.486, 'acc_1_0': 0.6604, 'acc_1_1': 0.9517, 'mean_acc': 0.7453}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9926, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9839}
Val(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9573, 'worst_acc': 0.6667, 'acc_0_0': 0.9836, 'acc_0_1': 0.694, 'acc_1_0': 0.6667, 'acc_1_1': 0.9315, 'mean_acc': 0.83}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9914, 'acc_0_1': 0.7609, 'acc_1_0': 0.6607, 'acc_1_1': 0.9423, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6395, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.9845, 'acc_0_1': 0.6656, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.819}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9906, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9631, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8755, 'acc_1_0': 0.4776, 'acc_1_1': 0.9242, 'mean_acc': 0.885}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.514, 'acc_0_0': 0.9951, 'acc_0_1': 0.8426, 'acc_1_0': 0.514, 'acc_1_1': 0.8847, 'mean_acc': 0.8702}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9943, 'acc_0_1': 0.837, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5779, 'acc_0_0': 0.9889, 'acc_0_1': 0.8204, 'acc_1_0': 0.5779, 'acc_1_1': 0.8941, 'mean_acc': 0.8673}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5152, 'acc_0_0': 0.9871, 'acc_0_1': 0.867, 'acc_1_0': 0.5152, 'acc_1_1': 0.9403, 'mean_acc': 0.8831}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.6716, 'acc_0_0': 0.9615, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.7424, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8971, 'worst_acc': 0.6433, 'acc_0_0': 0.9752, 'acc_0_1': 0.9202, 'acc_1_0': 0.7321, 'acc_1_1': 0.6433, 'mean_acc': 0.8901}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2121, 'acc_0_0': 0.6524, 'acc_0_1': 0.2704, 'acc_1_0': 0.2121, 'acc_1_1': 0.5224, 'mean_acc': 0.4407}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.2361, 'acc_0_0': 0.9487, 'acc_0_1': 0.2361, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.6517}
Test(class)(new adapter): {'weighted_mean_acc': 0.9314, 'worst_acc': 0.2302, 'acc_0_0': 0.9552, 'acc_0_1': 0.2302, 'acc_1_0': 0.7508, 'acc_1_1': 0.9844, 'mean_acc': 0.6536}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4697, 'acc_0_0': 0.9957, 'acc_0_1': 0.5408, 'acc_1_0': 0.4697, 'acc_1_1': 0.9254, 'mean_acc': 0.7529}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7761, 'acc_0_0': 0.953, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.7866, 'acc_0_0': 0.9645, 'acc_0_1': 0.918, 'acc_1_0': 0.7866, 'acc_1_1': 0.8302, 'mean_acc': 0.9118}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.9142, 'acc_0_1': 0.9099, 'acc_1_0': 0.7879, 'acc_1_1': 0.0, 'mean_acc': 0.7963}
Val(class)(new adapter): {'weighted_mean_acc': 0.8595, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.9013, 'acc_1_0': 0.9403, 'acc_1_1': 0.8636, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8432, 'worst_acc': 0.8364, 'acc_0_0': 0.8364, 'acc_0_1': 0.9051, 'acc_1_0': 0.9019, 'acc_1_1': 0.852, 'mean_acc': 0.8721}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.867, 'acc_0_0': 0.867, 'acc_0_1': 0.9185, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.8921, 'worst_acc': 0.8788, 'acc_0_0': 0.8932, 'acc_0_1': 0.9485, 'acc_1_0': 0.8955, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8396, 'acc_0_0': 0.8905, 'acc_0_1': 0.9308, 'acc_1_0': 0.8832, 'acc_1_1': 0.8396, 'mean_acc': 0.8997}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1343, 'acc_0_0': 0.8455, 'acc_0_1': 0.9742, 'acc_1_0': 0.8788, 'acc_1_1': 0.1343, 'mean_acc': 0.8197}
Val(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.8806, 'acc_1_1': 0.9242, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8598, 'acc_0_0': 0.9304, 'acc_0_1': 0.8931, 'acc_1_0': 0.8598, 'acc_1_1': 0.8894, 'mean_acc': 0.9035}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9657, 'acc_0_1': 0.9442, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.8209, 'acc_0_0': 0.9444, 'acc_0_1': 0.8369, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9288, 'worst_acc': 0.8328, 'acc_0_0': 0.9406, 'acc_0_1': 0.8328, 'acc_1_0': 0.8411, 'acc_1_1': 0.9112, 'mean_acc': 0.8844}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2388, 'acc_0_0': 0.9742, 'acc_0_1': 0.927, 'acc_1_0': 0.803, 'acc_1_1': 0.2388, 'mean_acc': 0.8548}
Val(class)(new adapter): {'weighted_mean_acc': 0.9353, 'worst_acc': 0.7468, 'acc_0_0': 0.9359, 'acc_0_1': 0.7468, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7769, 'acc_0_0': 0.9308, 'acc_0_1': 0.7769, 'acc_1_0': 0.8551, 'acc_1_1': 0.9268, 'mean_acc': 0.8621}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9528, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9341, 'worst_acc': 0.794, 'acc_0_0': 0.9316, 'acc_0_1': 0.794, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.808, 'acc_0_0': 0.9131, 'acc_0_1': 0.808, 'acc_1_0': 0.8645, 'acc_1_1': 0.9252, 'mean_acc': 0.8681}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5672, 'acc_0_0': 0.8283, 'acc_0_1': 1.0, 'acc_1_0': 0.7727, 'acc_1_1': 0.5672, 'mean_acc': 0.8598}
Val(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.7511, 'acc_0_0': 0.9274, 'acc_0_1': 0.7511, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7836, 'acc_0_0': 0.9091, 'acc_0_1': 0.7836, 'acc_1_0': 0.8629, 'acc_1_1': 0.9361, 'mean_acc': 0.8581}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.97, 'acc_0_1': 0.9185, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9416}
Val(class)(new adapter): {'weighted_mean_acc': 0.9382, 'worst_acc': 0.8283, 'acc_0_0': 0.9359, 'acc_0_1': 0.8283, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.8395, 'acc_0_0': 0.933, 'acc_0_1': 0.8395, 'acc_1_0': 0.8458, 'acc_1_1': 0.9097, 'mean_acc': 0.8844}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7164, 'acc_0_0': 0.9785, 'acc_0_1': 0.9742, 'acc_1_0': 0.8939, 'acc_1_1': 0.7164, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.8358, 'acc_0_0': 0.9487, 'acc_0_1': 0.8412, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.8287, 'acc_0_0': 0.9441, 'acc_0_1': 0.8661, 'acc_1_0': 0.8287, 'acc_1_1': 0.8894, 'mean_acc': 0.8949}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9914, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9393, 'worst_acc': 0.8209, 'acc_0_0': 0.953, 'acc_0_1': 0.8884, 'acc_1_0': 0.8209, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.8193, 'acc_0_0': 0.9552, 'acc_0_1': 0.9104, 'acc_1_0': 0.8193, 'acc_1_1': 0.8458, 'mean_acc': 0.9106}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.9828, 'acc_0_1': 0.97, 'acc_1_0': 0.9091, 'acc_1_1': 0.791, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.8037, 'acc_0_0': 0.9588, 'acc_0_1': 0.9322, 'acc_1_0': 0.8084, 'acc_1_1': 0.8037, 'mean_acc': 0.9146}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7835, 'acc_0_0': 0.9552, 'acc_0_1': 0.9392, 'acc_1_0': 0.81, 'acc_1_1': 0.7835, 'mean_acc': 0.9139}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.8507, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.8162, 'acc_0_0': 0.949, 'acc_0_1': 0.922, 'acc_1_0': 0.8255, 'acc_1_1': 0.8162, 'mean_acc': 0.9101}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.8841, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.8364, 'acc_0_0': 0.9353, 'acc_0_1': 0.8927, 'acc_1_0': 0.8364, 'acc_1_1': 0.838, 'mean_acc': 0.897}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.97, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9104, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.8498, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.8411, 'acc_0_0': 0.929, 'acc_0_1': 0.867, 'acc_1_0': 0.8411, 'acc_1_1': 0.8754, 'mean_acc': 0.8892}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.8326, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.8364, 'acc_0_0': 0.9326, 'acc_0_1': 0.8537, 'acc_1_0': 0.8364, 'acc_1_1': 0.8769, 'mean_acc': 0.8851}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9403, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8026, 'acc_0_0': 0.9231, 'acc_0_1': 0.8026, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.8333, 'acc_0_0': 0.9295, 'acc_0_1': 0.835, 'acc_1_0': 0.8333, 'acc_1_1': 0.8863, 'mean_acc': 0.8773}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.8326, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9186, 'worst_acc': 0.8193, 'acc_0_0': 0.9401, 'acc_0_1': 0.851, 'acc_1_0': 0.8193, 'acc_1_1': 0.8645, 'mean_acc': 0.8837}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.8584, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.8084, 'acc_0_0': 0.9437, 'acc_0_1': 0.8763, 'acc_1_0': 0.8084, 'acc_1_1': 0.8302, 'mean_acc': 0.8899}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.8755, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7928, 'acc_0_0': 0.9481, 'acc_0_1': 0.9007, 'acc_1_0': 0.7991, 'acc_1_1': 0.7928, 'mean_acc': 0.8959}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9104, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.785, 'acc_0_0': 0.9508, 'acc_0_1': 0.9091, 'acc_1_0': 0.7882, 'acc_1_1': 0.785, 'mean_acc': 0.8982}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7664, 'acc_0_0': 0.9508, 'acc_0_1': 0.9246, 'acc_1_0': 0.785, 'acc_1_1': 0.7664, 'mean_acc': 0.9018}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7788, 'acc_0_0': 0.9508, 'acc_0_1': 0.9224, 'acc_1_0': 0.7928, 'acc_1_1': 0.7788, 'mean_acc': 0.9032}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7897, 'acc_0_0': 0.9503, 'acc_0_1': 0.9215, 'acc_1_0': 0.8037, 'acc_1_1': 0.7897, 'mean_acc': 0.9051}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7991, 'acc_0_0': 0.9561, 'acc_0_1': 0.9184, 'acc_1_0': 0.7991, 'acc_1_1': 0.7991, 'mean_acc': 0.9066}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7757, 'acc_0_0': 0.9667, 'acc_0_1': 0.9286, 'acc_1_0': 0.7757, 'acc_1_1': 0.7773, 'mean_acc': 0.9097}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.791, 'acc_0_0': 0.953, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7726, 'acc_0_0': 0.9627, 'acc_0_1': 0.9304, 'acc_1_0': 0.7913, 'acc_1_1': 0.7726, 'mean_acc': 0.9101}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.757, 'acc_0_0': 0.9397, 'acc_0_1': 0.9401, 'acc_1_0': 0.8255, 'acc_1_1': 0.757, 'mean_acc': 0.907}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9254, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8894, 'worst_acc': 0.7555, 'acc_0_0': 0.9282, 'acc_0_1': 0.9384, 'acc_1_0': 0.8396, 'acc_1_1': 0.7555, 'mean_acc': 0.9032}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.889, 'worst_acc': 0.7586, 'acc_0_0': 0.9264, 'acc_0_1': 0.9406, 'acc_1_0': 0.8427, 'acc_1_1': 0.7586, 'mean_acc': 0.904}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8967, 'worst_acc': 0.7586, 'acc_0_0': 0.9375, 'acc_0_1': 0.937, 'acc_1_0': 0.8255, 'acc_1_1': 0.7586, 'mean_acc': 0.9051}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7632, 'acc_0_0': 0.9534, 'acc_0_1': 0.937, 'acc_1_0': 0.8037, 'acc_1_1': 0.7632, 'mean_acc': 0.9094}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7617, 'acc_0_0': 0.9561, 'acc_0_1': 0.9379, 'acc_1_0': 0.7944, 'acc_1_1': 0.7617, 'mean_acc': 0.9096}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7741, 'acc_0_0': 0.9534, 'acc_0_1': 0.9313, 'acc_1_0': 0.796, 'acc_1_1': 0.7741, 'mean_acc': 0.9075}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7882, 'acc_0_0': 0.9539, 'acc_0_1': 0.9215, 'acc_1_0': 0.8022, 'acc_1_1': 0.7882, 'mean_acc': 0.9061}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.796, 'acc_0_0': 0.9517, 'acc_0_1': 0.9166, 'acc_1_0': 0.7991, 'acc_1_1': 0.796, 'mean_acc': 0.9039}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7928, 'acc_0_0': 0.9534, 'acc_0_1': 0.9171, 'acc_1_0': 0.7944, 'acc_1_1': 0.7928, 'mean_acc': 0.9039}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7913, 'acc_0_0': 0.953, 'acc_0_1': 0.9162, 'acc_1_0': 0.7913, 'acc_1_1': 0.7944, 'mean_acc': 0.9032}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.7882, 'acc_0_0': 0.9534, 'acc_0_1': 0.914, 'acc_1_0': 0.7882, 'acc_1_1': 0.7975, 'mean_acc': 0.9025}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.7944, 'acc_0_0': 0.9534, 'acc_0_1': 0.9126, 'acc_1_0': 0.7944, 'acc_1_1': 0.7975, 'mean_acc': 0.9027}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7975, 'acc_0_0': 0.953, 'acc_0_1': 0.9104, 'acc_1_0': 0.7975, 'acc_1_1': 0.8006, 'mean_acc': 0.9023}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7975, 'acc_0_0': 0.9539, 'acc_0_1': 0.9113, 'acc_1_0': 0.7975, 'acc_1_1': 0.7991, 'mean_acc': 0.9028}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.8069, 'acc_0_0': 0.9517, 'acc_0_1': 0.9073, 'acc_1_0': 0.81, 'acc_1_1': 0.8069, 'mean_acc': 0.9027}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.8006, 'acc_0_0': 0.9521, 'acc_0_1': 0.9091, 'acc_1_0': 0.81, 'acc_1_1': 0.8006, 'mean_acc': 0.9028}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.8006, 'acc_0_0': 0.9539, 'acc_0_1': 0.9086, 'acc_1_0': 0.8006, 'acc_1_1': 0.8006, 'mean_acc': 0.9023}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.8053, 'acc_0_0': 0.9521, 'acc_0_1': 0.9064, 'acc_1_0': 0.8084, 'acc_1_1': 0.8053, 'mean_acc': 0.9021}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8927, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.8037, 'acc_0_0': 0.9525, 'acc_0_1': 0.9078, 'acc_1_0': 0.8069, 'acc_1_1': 0.8037, 'mean_acc': 0.9025}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8053, 'acc_0_0': 0.9494, 'acc_0_1': 0.9051, 'acc_1_0': 0.81, 'acc_1_1': 0.8053, 'mean_acc': 0.9008}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.81, 'acc_0_0': 0.9503, 'acc_0_1': 0.9033, 'acc_1_0': 0.81, 'acc_1_1': 0.8115, 'mean_acc': 0.9011}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.8006, 'acc_0_0': 0.9521, 'acc_0_1': 0.9091, 'acc_1_0': 0.8069, 'acc_1_1': 0.8006, 'mean_acc': 0.9025}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7991, 'acc_0_0': 0.9499, 'acc_0_1': 0.9086, 'acc_1_0': 0.8115, 'acc_1_1': 0.7991, 'mean_acc': 0.9018}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.796, 'acc_0_0': 0.953, 'acc_0_1': 0.91, 'acc_1_0': 0.8069, 'acc_1_1': 0.796, 'mean_acc': 0.9027}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.8006, 'acc_0_0': 0.953, 'acc_0_1': 0.9082, 'acc_1_0': 0.8069, 'acc_1_1': 0.8006, 'mean_acc': 0.9025}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.8037, 'acc_0_0': 0.953, 'acc_0_1': 0.9078, 'acc_1_0': 0.8084, 'acc_1_1': 0.8037, 'mean_acc': 0.9028}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.8037, 'acc_0_0': 0.9512, 'acc_0_1': 0.9069, 'acc_1_0': 0.8084, 'acc_1_1': 0.8037, 'mean_acc': 0.9018}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.8053, 'acc_0_0': 0.9525, 'acc_0_1': 0.9078, 'acc_1_0': 0.8084, 'acc_1_1': 0.8053, 'mean_acc': 0.9028}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.8006, 'acc_0_0': 0.9539, 'acc_0_1': 0.9091, 'acc_1_0': 0.8053, 'acc_1_1': 0.8006, 'mean_acc': 0.903}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.1343, 'acc_0_0': 0.8455, 'acc_0_1': 0.9742, 'acc_1_0': 0.8788, 'acc_1_1': 0.1343, 'mean_acc': 0.8197}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.8806, 'acc_1_1': 0.9242, 'mean_acc': 0.915}
best test accuracy on [class]: {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8598, 'acc_0_0': 0.9304, 'acc_0_1': 0.8931, 'acc_1_0': 0.8598, 'acc_1_1': 0.8894, 'mean_acc': 0.9035}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8598, 'acc_0_0': 0.9304, 'acc_0_1': 0.8931, 'acc_1_0': 0.8598, 'acc_1_1': 0.8894, 'mean_acc': 0.9035}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6386, 'acc_0_0': 0.9627, 'acc_0_1': 0.8958, 'acc_1_0': 0.6386, 'acc_1_1': 0.9875, 'mean_acc': 0.9035}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.1343, 'acc_0_0': 0.8455, 'acc_0_1': 0.9742, 'acc_1_0': 0.8788, 'acc_1_1': 0.1343, 'mean_acc': 0.8197}, 'Val': {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.8806, 'acc_1_1': 0.9242, 'mean_acc': 0.915}, 'Test': {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8598, 'acc_0_0': 0.9304, 'acc_0_1': 0.8931, 'acc_1_0': 0.8598, 'acc_1_1': 0.8894, 'mean_acc': 0.9035}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9191, 'worst_acc': 0.8598, 'acc_0_0': 0.9304, 'acc_0_1': 0.8931, 'acc_1_0': 0.8598, 'acc_1_1': 0.8894, 'mean_acc': 0.9035}, 'spurious': {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6386, 'acc_0_0': 0.9627, 'acc_0_1': 0.8958, 'acc_1_0': 0.6386, 'acc_1_1': 0.9875, 'mean_acc': 0.9035}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0357, 'acc_0_0': 0.9534, 'acc_0_1': 0.962, 'acc_1_0': 0.0357, 'acc_1_1': 0.0747, 'mean_acc': 0.7493}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2679, 'acc_0_0': 0.994, 'acc_0_1': 0.6902, 'acc_1_0': 0.2679, 'acc_1_1': 0.6168, 'mean_acc': 0.8907}
Val(class): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.5966, 'acc_0_0': 0.9615, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.5211, 'acc_0_0': 0.9614, 'acc_0_1': 0.5211, 'acc_1_0': 0.6807, 'acc_1_1': 0.9299, 'mean_acc': 0.7554}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9863, 'acc_0_1': 0.6141, 'acc_1_0': 0.5893, 'acc_1_1': 0.9338, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.6137, 'acc_1_0': 0.4776, 'acc_1_1': 0.9697, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.4502, 'acc_0_0': 0.9951, 'acc_0_1': 0.5885, 'acc_1_0': 0.4502, 'acc_1_1': 0.9377, 'mean_acc': 0.7701}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9891, 'acc_0_1': 0.5272, 'acc_1_0': 0.5, 'acc_1_1': 0.9603, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.72}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3543, 'acc_0_0': 0.9814, 'acc_0_1': 0.3543, 'acc_1_0': 0.6153, 'acc_1_1': 0.9657, 'mean_acc': 0.695}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5978, 'acc_0_0': 0.9874, 'acc_0_1': 0.5978, 'acc_1_0': 0.6429, 'acc_1_1': 0.9518, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3948, 'acc_0_0': 0.9872, 'acc_0_1': 0.3948, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.7283}
Test(class): {'weighted_mean_acc': 0.9461, 'worst_acc': 0.357, 'acc_0_0': 0.9738, 'acc_0_1': 0.357, 'acc_1_0': 0.7492, 'acc_1_1': 0.9673, 'mean_acc': 0.7081}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9917, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9574, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.5708, 'acc_0_0': 0.9829, 'acc_0_1': 0.5708, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.518, 'acc_0_0': 0.98, 'acc_0_1': 0.518, 'acc_1_0': 0.7196, 'acc_1_1': 0.9517, 'mean_acc': 0.7682}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.7143, 'acc_1_1': 0.9603, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7007, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.83}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.9934, 'acc_0_1': 0.6848, 'acc_1_0': 0.6964, 'acc_1_1': 0.9659, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9585, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5522, 'acc_1_1': 0.8636, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5358, 'acc_0_0': 0.9947, 'acc_0_1': 0.8377, 'acc_1_0': 0.5358, 'acc_1_1': 0.9003, 'mean_acc': 0.8723}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.994, 'acc_0_1': 0.7609, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9771, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.595, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9377, 'mean_acc': 0.8177}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9943, 'acc_0_1': 0.788, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.6524, 'acc_0_0': 0.9786, 'acc_0_1': 0.6524, 'acc_1_0': 0.7313, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.612, 'acc_0_0': 0.9814, 'acc_0_1': 0.612, 'acc_1_0': 0.7025, 'acc_1_1': 0.947, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9946, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9678, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.749, 'acc_1_0': 0.5312, 'acc_1_1': 0.9315, 'mean_acc': 0.8404}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9946, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9622, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5665, 'acc_0_0': 0.9701, 'acc_0_1': 0.5665, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.5588, 'acc_0_0': 0.9769, 'acc_0_1': 0.5588, 'acc_1_0': 0.7087, 'acc_1_1': 0.9579, 'mean_acc': 0.7824}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5047, 'acc_0_0': 0.9956, 'acc_0_1': 0.8186, 'acc_1_0': 0.5047, 'acc_1_1': 0.9065, 'mean_acc': 0.8624}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9969, 'acc_0_1': 0.7989, 'acc_1_0': 0.7679, 'acc_1_1': 0.9688, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.937, 'worst_acc': 0.3991, 'acc_0_0': 0.953, 'acc_0_1': 0.3991, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.725}
Test(class): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.4124, 'acc_0_0': 0.9619, 'acc_0_1': 0.4124, 'acc_1_0': 0.7586, 'acc_1_1': 0.9766, 'mean_acc': 0.7271}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9957, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6308, 'acc_0_0': 0.9863, 'acc_0_1': 0.6843, 'acc_1_0': 0.6308, 'acc_1_1': 0.9299, 'mean_acc': 0.8231}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.8326, 'acc_1_0': 0.6418, 'acc_1_1': 0.8939, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6371, 'acc_0_0': 0.984, 'acc_0_1': 0.8106, 'acc_1_0': 0.6371, 'acc_1_1': 0.9003, 'mean_acc': 0.8688}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8767}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5187, 'acc_0_0': 0.9951, 'acc_0_1': 0.82, 'acc_1_0': 0.5187, 'acc_1_1': 0.8801, 'mean_acc': 0.8614}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9963, 'acc_0_1': 0.8533, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.648, 'acc_0_0': 0.9889, 'acc_0_1': 0.6812, 'acc_1_0': 0.648, 'acc_1_1': 0.9455, 'mean_acc': 0.8265}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7983, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5125, 'acc_0_0': 0.9947, 'acc_0_1': 0.78, 'acc_1_0': 0.5125, 'acc_1_1': 0.8925, 'mean_acc': 0.8464}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7897, 'acc_1_0': 0.5522, 'acc_1_1': 0.8939, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7973, 'acc_1_0': 0.5981, 'acc_1_1': 0.9237, 'mean_acc': 0.8645}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9951, 'acc_0_1': 0.8641, 'acc_1_0': 0.8929, 'acc_1_1': 0.9707, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5841, 'acc_0_0': 0.9894, 'acc_0_1': 0.6497, 'acc_1_0': 0.5841, 'acc_1_1': 0.9393, 'mean_acc': 0.8067}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9971, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.9735, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9513, 'worst_acc': 0.6309, 'acc_0_0': 0.9615, 'acc_0_1': 0.6309, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6071, 'acc_0_0': 0.9818, 'acc_0_1': 0.6071, 'acc_1_0': 0.6573, 'acc_1_1': 0.9517, 'mean_acc': 0.7967}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.983, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.897, 'acc_1_0': 0.5224, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.5374, 'acc_0_0': 0.9911, 'acc_0_1': 0.8701, 'acc_1_0': 0.5374, 'acc_1_1': 0.8676, 'mean_acc': 0.88}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9974, 'acc_0_1': 0.8696, 'acc_1_0': 0.7857, 'acc_1_1': 0.9792, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9662, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6526, 'acc_0_0': 0.9863, 'acc_0_1': 0.7286, 'acc_1_0': 0.6526, 'acc_1_1': 0.9393, 'mean_acc': 0.8438}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9977, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9792, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5193, 'acc_0_0': 0.9744, 'acc_0_1': 0.5193, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7683}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5202, 'acc_0_0': 0.9787, 'acc_0_1': 0.5202, 'acc_1_0': 0.6682, 'acc_1_1': 0.9704, 'mean_acc': 0.7649}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6293, 'acc_0_0': 0.9814, 'acc_0_1': 0.6971, 'acc_1_0': 0.6293, 'acc_1_1': 0.933, 'mean_acc': 0.8264}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9966, 'acc_0_1': 0.8967, 'acc_1_0': 0.8214, 'acc_1_1': 0.964, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.3433, 'acc_0_0': 0.9359, 'acc_0_1': 0.3433, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.3512, 'acc_0_0': 0.949, 'acc_0_1': 0.3512, 'acc_1_0': 0.8084, 'acc_1_1': 0.9782, 'mean_acc': 0.704}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9886, 'acc_0_1': 0.788, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7768, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5576, 'acc_0_0': 0.9907, 'acc_0_1': 0.7486, 'acc_1_0': 0.5576, 'acc_1_1': 0.9143, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9957, 'acc_0_1': 0.7989, 'acc_1_0': 0.6607, 'acc_1_1': 0.948, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5224, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5748, 'acc_0_0': 0.9894, 'acc_0_1': 0.6754, 'acc_1_0': 0.5748, 'acc_1_1': 0.9377, 'mean_acc': 0.8155}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9934, 'acc_0_1': 0.7826, 'acc_1_0': 0.7679, 'acc_1_1': 0.9782, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.4421, 'acc_0_0': 0.9444, 'acc_0_1': 0.4421, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9431, 'worst_acc': 0.4705, 'acc_0_0': 0.9619, 'acc_0_1': 0.4705, 'acc_1_0': 0.7523, 'acc_1_1': 0.9735, 'mean_acc': 0.7487}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9909, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8712, 'acc_1_0': 0.3731, 'acc_1_1': 0.8939, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.4548, 'acc_0_0': 0.9978, 'acc_0_1': 0.8559, 'acc_1_0': 0.4548, 'acc_1_1': 0.866, 'mean_acc': 0.8678}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.8207, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7682, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.7494, 'acc_1_0': 0.6153, 'acc_1_1': 0.9252, 'mean_acc': 0.8476}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9957, 'acc_0_1': 0.8804, 'acc_1_0': 0.7857, 'acc_1_1': 0.9669, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6137, 'acc_0_0': 0.9744, 'acc_0_1': 0.6137, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.5978, 'acc_0_0': 0.9836, 'acc_0_1': 0.5978, 'acc_1_0': 0.634, 'acc_1_1': 0.9517, 'mean_acc': 0.7912}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.996, 'acc_0_1': 0.8478, 'acc_1_0': 0.8393, 'acc_1_1': 0.9726, 'mean_acc': 0.9833}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.609, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8153}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6028, 'acc_0_0': 0.9902, 'acc_0_1': 0.6927, 'acc_1_0': 0.6028, 'acc_1_1': 0.9361, 'mean_acc': 0.8255}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9946, 'acc_0_1': 0.8967, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.929, 'worst_acc': 0.4464, 'acc_0_0': 0.9402, 'acc_0_1': 0.4464, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.431, 'acc_0_0': 0.9455, 'acc_0_1': 0.431, 'acc_1_0': 0.7648, 'acc_1_1': 0.9782, 'mean_acc': 0.7289}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.6563, 'acc_1_0': 0.609, 'acc_1_1': 0.9439, 'mean_acc': 0.8134}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9957, 'acc_0_1': 0.8696, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5156, 'acc_0_0': 0.9956, 'acc_0_1': 0.8089, 'acc_1_0': 0.5156, 'acc_1_1': 0.8863, 'mean_acc': 0.8576}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9974, 'acc_0_1': 0.875, 'acc_1_0': 0.9464, 'acc_1_1': 0.9868, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.7164, 'acc_0_0': 0.9786, 'acc_0_1': 0.7296, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6745, 'acc_0_0': 0.9783, 'acc_0_1': 0.7073, 'acc_1_0': 0.6745, 'acc_1_1': 0.9393, 'mean_acc': 0.8348}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.9022, 'acc_1_0': 0.8214, 'acc_1_1': 0.9896, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6738, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6231, 'acc_0_0': 0.9916, 'acc_0_1': 0.6443, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8095}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9871, 'acc_0_1': 0.8112, 'acc_1_0': 0.4848, 'acc_1_1': 0.8806, 'mean_acc': 0.8514}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.9614, 'acc_1_0': 0.6269, 'acc_1_1': 0.7424, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.6028, 'acc_0_0': 0.9942, 'acc_0_1': 0.9579, 'acc_1_0': 0.6028, 'acc_1_1': 0.6682, 'mean_acc': 0.9006}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1364, 'acc_0_0': 0.8455, 'acc_0_1': 0.3348, 'acc_1_0': 0.1364, 'acc_1_1': 0.8806, 'mean_acc': 0.5726}
Val(class)(new adapter): {'weighted_mean_acc': 0.95, 'worst_acc': 0.2446, 'acc_0_0': 0.9786, 'acc_0_1': 0.2446, 'acc_1_0': 0.5373, 'acc_1_1': 1.0, 'mean_acc': 0.6467}
Test(class)(new adapter): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.2373, 'acc_0_0': 0.9849, 'acc_0_1': 0.2373, 'acc_1_0': 0.5047, 'acc_1_1': 0.9782, 'mean_acc': 0.64}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5279, 'acc_0_0': 0.9828, 'acc_0_1': 0.5279, 'acc_1_0': 0.6212, 'acc_1_1': 0.9254, 'mean_acc': 0.7596}
Val(class)(new adapter): {'weighted_mean_acc': 0.8823, 'worst_acc': 0.5758, 'acc_0_0': 0.9744, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.5758, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8676, 'worst_acc': 0.5234, 'acc_0_0': 0.9694, 'acc_0_1': 0.9645, 'acc_1_0': 0.69, 'acc_1_1': 0.5234, 'mean_acc': 0.8871}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8283, 'acc_0_1': 0.8927, 'acc_1_0': 0.8485, 'acc_1_1': 0.0, 'mean_acc': 0.7629}
Val(class)(new adapter): {'weighted_mean_acc': 0.8726, 'worst_acc': 0.6364, 'acc_0_0': 0.9402, 'acc_0_1': 0.97, 'acc_1_0': 0.791, 'acc_1_1': 0.6364, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8603, 'worst_acc': 0.5561, 'acc_0_0': 0.9477, 'acc_0_1': 0.9601, 'acc_1_0': 0.8193, 'acc_1_1': 0.5561, 'mean_acc': 0.8949}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9571, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.8209, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7866, 'acc_0_0': 0.9494, 'acc_0_1': 0.9206, 'acc_1_0': 0.8178, 'acc_1_1': 0.7866, 'mean_acc': 0.9056}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0597, 'acc_0_0': 0.8755, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.0597, 'mean_acc': 0.8197}
Val(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.7811, 'acc_0_0': 0.9316, 'acc_0_1': 0.7811, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7947, 'acc_0_0': 0.9304, 'acc_0_1': 0.7947, 'acc_1_0': 0.8458, 'acc_1_1': 0.919, 'mean_acc': 0.8669}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.8884, 'acc_1_0': 0.803, 'acc_1_1': 0.9701, 'mean_acc': 0.9249}
Val(class)(new adapter): {'weighted_mean_acc': 0.9445, 'worst_acc': 0.7511, 'acc_0_0': 0.9444, 'acc_0_1': 0.7511, 'acc_1_0': 0.8209, 'acc_1_1': 0.9848, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9452, 'worst_acc': 0.7565, 'acc_0_0': 0.9592, 'acc_0_1': 0.7565, 'acc_1_0': 0.7991, 'acc_1_1': 0.9393, 'mean_acc': 0.8604}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1642, 'acc_0_0': 0.9828, 'acc_0_1': 0.8541, 'acc_1_0': 0.7424, 'acc_1_1': 0.1642, 'mean_acc': 0.8147}
Val(class)(new adapter): {'weighted_mean_acc': 0.9307, 'worst_acc': 0.7082, 'acc_0_0': 0.9274, 'acc_0_1': 0.7082, 'acc_1_0': 0.8507, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.6984, 'acc_0_0': 0.9286, 'acc_0_1': 0.6984, 'acc_1_0': 0.8474, 'acc_1_1': 0.9486, 'mean_acc': 0.8322}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8841, 'acc_0_0': 0.9828, 'acc_0_1': 0.8841, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7511, 'acc_0_0': 0.9017, 'acc_0_1': 0.7511, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class)(new adapter): {'weighted_mean_acc': 0.893, 'worst_acc': 0.7463, 'acc_0_0': 0.8869, 'acc_0_1': 0.7463, 'acc_1_0': 0.8785, 'acc_1_1': 0.9393, 'mean_acc': 0.8371}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.897, 'acc_0_1': 0.9957, 'acc_1_0': 0.7879, 'acc_1_1': 0.5522, 'mean_acc': 0.8848}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7468, 'acc_0_0': 0.8974, 'acc_0_1': 0.7468, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.7472, 'acc_0_0': 0.8891, 'acc_0_1': 0.7472, 'acc_1_0': 0.8801, 'acc_1_1': 0.9393, 'mean_acc': 0.8385}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 0.927, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7725, 'acc_0_0': 0.9103, 'acc_0_1': 0.7725, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.8997, 'worst_acc': 0.7756, 'acc_0_0': 0.8976, 'acc_0_1': 0.7756, 'acc_1_0': 0.8676, 'acc_1_1': 0.9299, 'mean_acc': 0.8504}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.9356, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.7761, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9244, 'worst_acc': 0.7897, 'acc_0_0': 0.9188, 'acc_0_1': 0.7897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7889, 'acc_0_0': 0.9033, 'acc_0_1': 0.7889, 'acc_1_0': 0.852, 'acc_1_1': 0.9221, 'mean_acc': 0.8552}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9614, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.8209, 'acc_0_0': 0.9359, 'acc_0_1': 0.8369, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.8364, 'acc_0_0': 0.9202, 'acc_0_1': 0.8364, 'acc_1_0': 0.8364, 'acc_1_1': 0.9081, 'mean_acc': 0.8769}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9785, 'acc_0_1': 0.9742, 'acc_1_0': 0.9394, 'acc_1_1': 0.7612, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9379, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.8541, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.8224, 'acc_0_0': 0.9384, 'acc_0_1': 0.863, 'acc_1_0': 0.8224, 'acc_1_1': 0.8988, 'mean_acc': 0.8918}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9381, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.8627, 'acc_1_0': 0.7612, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9274, 'worst_acc': 0.8006, 'acc_0_0': 0.9455, 'acc_0_1': 0.886, 'acc_1_0': 0.8006, 'acc_1_1': 0.8816, 'mean_acc': 0.8992}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 0.8507, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9379, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.8541, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7991, 'acc_0_0': 0.9477, 'acc_0_1': 0.8865, 'acc_1_0': 0.7991, 'acc_1_1': 0.8754, 'mean_acc': 0.8994}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.8584, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.7788, 'acc_0_0': 0.9588, 'acc_0_1': 0.894, 'acc_1_0': 0.7788, 'acc_1_1': 0.8645, 'mean_acc': 0.9032}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.867, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.7695, 'acc_0_0': 0.9619, 'acc_0_1': 0.8927, 'acc_1_0': 0.7695, 'acc_1_1': 0.8536, 'mean_acc': 0.9016}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.8755, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7477, 'acc_0_0': 0.9663, 'acc_0_1': 0.9051, 'acc_1_0': 0.7477, 'acc_1_1': 0.8224, 'mean_acc': 0.9023}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.897, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7321, 'acc_0_0': 0.9685, 'acc_0_1': 0.9211, 'acc_1_0': 0.7321, 'acc_1_1': 0.8006, 'mean_acc': 0.9052}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.6716, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7181, 'acc_0_0': 0.9685, 'acc_0_1': 0.9317, 'acc_1_0': 0.7181, 'acc_1_1': 0.7492, 'mean_acc': 0.9021}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7056, 'acc_0_0': 0.9698, 'acc_0_1': 0.9357, 'acc_1_0': 0.7056, 'acc_1_1': 0.7243, 'mean_acc': 0.9001}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.704, 'acc_0_0': 0.9685, 'acc_0_1': 0.937, 'acc_1_0': 0.704, 'acc_1_1': 0.7227, 'mean_acc': 0.8997}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.69, 'acc_0_0': 0.9716, 'acc_0_1': 0.9388, 'acc_1_0': 0.69, 'acc_1_1': 0.7212, 'mean_acc': 0.8999}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.6418, 'acc_0_0': 0.953, 'acc_0_1': 0.9356, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.6791, 'acc_0_0': 0.9747, 'acc_0_1': 0.9392, 'acc_1_0': 0.6791, 'acc_1_1': 0.7212, 'mean_acc': 0.9001}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.6869, 'acc_0_0': 0.9729, 'acc_0_1': 0.9379, 'acc_1_0': 0.6869, 'acc_1_1': 0.7352, 'mean_acc': 0.9013}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.6869, 'acc_0_0': 0.9743, 'acc_0_1': 0.9366, 'acc_1_0': 0.6869, 'acc_1_1': 0.7352, 'mean_acc': 0.9013}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.704, 'acc_0_0': 0.9716, 'acc_0_1': 0.9304, 'acc_1_0': 0.704, 'acc_1_1': 0.743, 'mean_acc': 0.9006}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6418, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7134, 'acc_0_0': 0.9698, 'acc_0_1': 0.9304, 'acc_1_0': 0.7134, 'acc_1_1': 0.7477, 'mean_acc': 0.9014}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6567, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7212, 'acc_0_0': 0.9685, 'acc_0_1': 0.9286, 'acc_1_0': 0.7212, 'acc_1_1': 0.7679, 'mean_acc': 0.9033}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.6716, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7243, 'acc_0_0': 0.9698, 'acc_0_1': 0.9237, 'acc_1_0': 0.7243, 'acc_1_1': 0.7804, 'mean_acc': 0.9037}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7399, 'acc_0_0': 0.9636, 'acc_0_1': 0.9184, 'acc_1_0': 0.7399, 'acc_1_1': 0.7975, 'mean_acc': 0.9028}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7555, 'acc_0_0': 0.9601, 'acc_0_1': 0.914, 'acc_1_0': 0.7555, 'acc_1_1': 0.8069, 'mean_acc': 0.9025}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7539, 'acc_0_0': 0.9605, 'acc_0_1': 0.914, 'acc_1_0': 0.7539, 'acc_1_1': 0.81, 'mean_acc': 0.9028}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7445, 'acc_0_0': 0.961, 'acc_0_1': 0.9126, 'acc_1_0': 0.7445, 'acc_1_1': 0.8115, 'mean_acc': 0.9016}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7477, 'acc_0_0': 0.9601, 'acc_0_1': 0.91, 'acc_1_0': 0.7477, 'acc_1_1': 0.8146, 'mean_acc': 0.9009}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7477, 'acc_0_0': 0.9596, 'acc_0_1': 0.9073, 'acc_1_0': 0.7477, 'acc_1_1': 0.8146, 'mean_acc': 0.8997}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7539, 'acc_0_0': 0.9588, 'acc_0_1': 0.9064, 'acc_1_0': 0.7539, 'acc_1_1': 0.8178, 'mean_acc': 0.9001}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7539, 'acc_0_0': 0.9583, 'acc_0_1': 0.9055, 'acc_1_0': 0.7539, 'acc_1_1': 0.8209, 'mean_acc': 0.8999}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.757, 'acc_0_0': 0.9565, 'acc_0_1': 0.9038, 'acc_1_0': 0.757, 'acc_1_1': 0.8255, 'mean_acc': 0.8994}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7539, 'acc_0_0': 0.9579, 'acc_0_1': 0.9069, 'acc_1_0': 0.7539, 'acc_1_1': 0.8178, 'mean_acc': 0.8999}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7477, 'acc_0_0': 0.9583, 'acc_0_1': 0.9069, 'acc_1_0': 0.7477, 'acc_1_1': 0.8178, 'mean_acc': 0.8994}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7445, 'acc_0_0': 0.9579, 'acc_0_1': 0.9104, 'acc_1_0': 0.7445, 'acc_1_1': 0.8146, 'mean_acc': 0.8999}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7461, 'acc_0_0': 0.9574, 'acc_0_1': 0.9109, 'acc_1_0': 0.7461, 'acc_1_1': 0.8146, 'mean_acc': 0.9001}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7508, 'acc_0_0': 0.9565, 'acc_0_1': 0.9086, 'acc_1_0': 0.7508, 'acc_1_1': 0.8178, 'mean_acc': 0.8997}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7477, 'acc_0_0': 0.9583, 'acc_0_1': 0.9109, 'acc_1_0': 0.7477, 'acc_1_1': 0.8131, 'mean_acc': 0.9004}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.7539, 'acc_0_0': 0.9574, 'acc_0_1': 0.91, 'acc_1_0': 0.7539, 'acc_1_1': 0.8146, 'mean_acc': 0.9006}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7508, 'acc_0_0': 0.957, 'acc_0_1': 0.9104, 'acc_1_0': 0.7508, 'acc_1_1': 0.8131, 'mean_acc': 0.9001}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7523, 'acc_0_0': 0.9561, 'acc_0_1': 0.9104, 'acc_1_0': 0.7523, 'acc_1_1': 0.8146, 'mean_acc': 0.9001}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7523, 'acc_0_0': 0.9557, 'acc_0_1': 0.9104, 'acc_1_0': 0.7523, 'acc_1_1': 0.8162, 'mean_acc': 0.9001}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7492, 'acc_0_0': 0.9552, 'acc_0_1': 0.9104, 'acc_1_0': 0.7492, 'acc_1_1': 0.8146, 'mean_acc': 0.8994}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7586, 'acc_0_0': 0.9548, 'acc_0_1': 0.9069, 'acc_1_0': 0.7586, 'acc_1_1': 0.8209, 'mean_acc': 0.8996}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.7492, 'acc_0_0': 0.9565, 'acc_0_1': 0.9109, 'acc_1_0': 0.7492, 'acc_1_1': 0.8131, 'mean_acc': 0.8999}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7492, 'acc_0_0': 0.9574, 'acc_0_1': 0.9109, 'acc_1_0': 0.7492, 'acc_1_1': 0.8131, 'mean_acc': 0.9002}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7508, 'acc_0_0': 0.9561, 'acc_0_1': 0.9082, 'acc_1_0': 0.7508, 'acc_1_1': 0.8162, 'mean_acc': 0.8992}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7523, 'acc_0_0': 0.9557, 'acc_0_1': 0.9109, 'acc_1_0': 0.7523, 'acc_1_1': 0.8131, 'mean_acc': 0.8999}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7555, 'acc_0_0': 0.9548, 'acc_0_1': 0.9095, 'acc_1_0': 0.7555, 'acc_1_1': 0.8162, 'mean_acc': 0.8997}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.7586, 'acc_0_0': 0.9539, 'acc_0_1': 0.9113, 'acc_1_0': 0.7586, 'acc_1_1': 0.8146, 'mean_acc': 0.9002}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7586, 'acc_0_0': 0.9539, 'acc_0_1': 0.9069, 'acc_1_0': 0.7586, 'acc_1_1': 0.8209, 'mean_acc': 0.8992}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.757, 'acc_0_0': 0.9539, 'acc_0_1': 0.91, 'acc_1_0': 0.757, 'acc_1_1': 0.8146, 'mean_acc': 0.8996}
========================================================================
> end of training. 

best epoch : 53
best training accuracy on [class]: {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9614, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.975}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9315, 'worst_acc': 0.8209, 'acc_0_0': 0.9359, 'acc_0_1': 0.8369, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
best test accuracy on [class]: {'weighted_mean_acc': 0.9133, 'worst_acc': 0.8364, 'acc_0_0': 0.9202, 'acc_0_1': 0.8364, 'acc_1_0': 0.8364, 'acc_1_1': 0.9081, 'mean_acc': 0.8769}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.8364, 'acc_0_0': 0.9202, 'acc_0_1': 0.8364, 'acc_1_0': 0.8364, 'acc_1_1': 0.9081, 'mean_acc': 0.8769}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9714, 'worst_acc': 0.4688, 'acc_0_0': 0.9814, 'acc_0_1': 0.8412, 'acc_1_0': 0.4688, 'acc_1_1': 0.9875, 'mean_acc': 0.8707}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 53': {'Train': {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9614, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.975}, 'Val': {'weighted_mean_acc': 0.9315, 'worst_acc': 0.8209, 'acc_0_0': 0.9359, 'acc_0_1': 0.8369, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.885}, 'Test': {'weighted_mean_acc': 0.9133, 'worst_acc': 0.8364, 'acc_0_0': 0.9202, 'acc_0_1': 0.8364, 'acc_1_0': 0.8364, 'acc_1_1': 0.9081, 'mean_acc': 0.8769}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9133, 'worst_acc': 0.8364, 'acc_0_0': 0.9202, 'acc_0_1': 0.8364, 'acc_1_0': 0.8364, 'acc_1_1': 0.9081, 'mean_acc': 0.8769}, 'spurious': {'weighted_mean_acc': 0.9714, 'worst_acc': 0.4688, 'acc_0_0': 0.9814, 'acc_0_1': 0.8412, 'acc_1_0': 0.4688, 'acc_1_1': 0.9875, 'mean_acc': 0.8707}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.1786, 'acc_0_0': 0.9688, 'acc_0_1': 0.7609, 'acc_1_0': 0.1786, 'acc_1_1': 0.3453, 'mean_acc': 0.8142}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.2704, 'acc_0_0': 0.9829, 'acc_0_1': 0.2704, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.66}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.2554, 'acc_0_0': 0.9814, 'acc_0_1': 0.2554, 'acc_1_0': 0.5841, 'acc_1_1': 0.9657, 'mean_acc': 0.6531}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1576, 'acc_0_0': 0.9568, 'acc_0_1': 0.1576, 'acc_1_0': 0.6429, 'acc_1_1': 0.9763, 'mean_acc': 0.9268}
Val(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.3562, 'acc_0_0': 0.9829, 'acc_0_1': 0.3562, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6967}
Test(class): {'weighted_mean_acc': 0.9527, 'worst_acc': 0.329, 'acc_0_0': 0.9871, 'acc_0_1': 0.329, 'acc_1_0': 0.6012, 'acc_1_1': 0.9657, 'mean_acc': 0.6859}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.375, 'acc_0_0': 0.9977, 'acc_0_1': 0.7228, 'acc_1_0': 0.375, 'acc_1_1': 0.8761, 'mean_acc': 0.9531}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5125, 'acc_0_0': 0.9951, 'acc_0_1': 0.663, 'acc_1_0': 0.5125, 'acc_1_1': 0.9128, 'mean_acc': 0.8032}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9946, 'acc_0_1': 0.6033, 'acc_1_0': 0.5357, 'acc_1_1': 0.9272, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.3948, 'acc_0_0': 0.9915, 'acc_0_1': 0.3948, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7233}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.3871, 'acc_0_0': 0.9858, 'acc_0_1': 0.3871, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7147}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9886, 'acc_0_1': 0.4891, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9597}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7047, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8297}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9937, 'acc_0_1': 0.75, 'acc_1_0': 0.6607, 'acc_1_1': 0.9139, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7854, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.7508, 'acc_1_0': 0.6028, 'acc_1_1': 0.9143, 'mean_acc': 0.8469}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.9906, 'acc_0_1': 0.663, 'acc_1_0': 0.7321, 'acc_1_1': 0.9413, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7167, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6121, 'acc_0_0': 0.9933, 'acc_0_1': 0.7033, 'acc_1_0': 0.6121, 'acc_1_1': 0.9221, 'mean_acc': 0.8303}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9926, 'acc_0_1': 0.75, 'acc_1_0': 0.6964, 'acc_1_1': 0.9395, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7897, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6012, 'acc_0_0': 0.9938, 'acc_0_1': 0.7543, 'acc_1_0': 0.6012, 'acc_1_1': 0.9174, 'mean_acc': 0.8486}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9917, 'acc_0_1': 0.7228, 'acc_1_0': 0.75, 'acc_1_1': 0.9461, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7033, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8307}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9926, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9413, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7135, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8347}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9917, 'acc_0_1': 0.7446, 'acc_1_0': 0.6964, 'acc_1_1': 0.9565, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8283, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5545, 'acc_0_0': 0.9956, 'acc_0_1': 0.7982, 'acc_1_0': 0.5545, 'acc_1_1': 0.905, 'mean_acc': 0.8599}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9937, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9536, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.7255, 'acc_1_0': 0.5935, 'acc_1_1': 0.9252, 'mean_acc': 0.8371}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9946, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5857, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5857, 'acc_1_1': 0.919, 'mean_acc': 0.8554}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.994, 'acc_0_1': 0.7989, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.8018, 'acc_1_0': 0.567, 'acc_1_1': 0.9159, 'mean_acc': 0.8628}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9971, 'acc_0_1': 0.7935, 'acc_1_0': 0.7679, 'acc_1_1': 0.9546, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6528, 'acc_1_0': 0.6464, 'acc_1_1': 0.9408, 'mean_acc': 0.8145}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.8393, 'acc_1_1': 0.964, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.8326, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.8248, 'acc_1_0': 0.5935, 'acc_1_1': 0.9112, 'mean_acc': 0.8742}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9949, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.8498, 'acc_1_0': 0.5373, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5421, 'acc_0_0': 0.9965, 'acc_0_1': 0.8333, 'acc_1_0': 0.5421, 'acc_1_1': 0.9034, 'mean_acc': 0.8723}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.9603, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9761, 'worst_acc': 0.6996, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6869, 'acc_0_0': 0.9867, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9393, 'mean_acc': 0.8321}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.875, 'acc_1_1': 0.9726, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.7015, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.6869, 'acc_0_0': 0.9871, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.8333}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.8804, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9769, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5903, 'acc_0_0': 0.9938, 'acc_0_1': 0.788, 'acc_1_0': 0.5903, 'acc_1_1': 0.9174, 'mean_acc': 0.8605}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.998, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.9877, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9782, 'worst_acc': 0.6418, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6433, 'acc_0_0': 0.9929, 'acc_0_1': 0.8053, 'acc_1_0': 0.6433, 'acc_1_1': 0.9128, 'mean_acc': 0.8723}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9782, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6953, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6636, 'acc_0_0': 0.988, 'acc_0_1': 0.6767, 'acc_1_0': 0.6636, 'acc_1_1': 0.9424, 'mean_acc': 0.8259}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9858, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.7468, 'acc_0_0': 0.9829, 'acc_0_1': 0.7468, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.7103, 'acc_0_0': 0.9823, 'acc_0_1': 0.7459, 'acc_1_0': 0.7103, 'acc_1_1': 0.9268, 'mean_acc': 0.854}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9754, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9814, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.8155, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.5654, 'acc_0_0': 0.996, 'acc_0_1': 0.8257, 'acc_1_0': 0.5654, 'acc_1_1': 0.8769, 'mean_acc': 0.8688}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9969, 'acc_0_1': 0.9076, 'acc_1_0': 0.9107, 'acc_1_1': 0.9792, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6293, 'acc_0_0': 0.9849, 'acc_0_1': 0.7157, 'acc_1_0': 0.6293, 'acc_1_1': 0.9206, 'mean_acc': 0.8336}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9969, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9688, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.6223, 'acc_0_0': 0.9658, 'acc_0_1': 0.6223, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.6137, 'acc_0_0': 0.9747, 'acc_0_1': 0.6137, 'acc_1_0': 0.6807, 'acc_1_1': 0.9424, 'mean_acc': 0.7981}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9971, 'acc_0_1': 0.8152, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5452, 'acc_0_0': 0.9933, 'acc_0_1': 0.8009, 'acc_1_0': 0.5452, 'acc_1_1': 0.8879, 'mean_acc': 0.8571}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9926, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9527, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8617}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5327, 'acc_0_0': 0.9942, 'acc_0_1': 0.7827, 'acc_1_0': 0.5327, 'acc_1_1': 0.9143, 'mean_acc': 0.8519}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9957, 'acc_0_1': 0.875, 'acc_1_0': 0.8036, 'acc_1_1': 0.9631, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.515, 'acc_0_0': 0.9829, 'acc_0_1': 0.515, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5401, 'acc_0_0': 0.9876, 'acc_0_1': 0.5401, 'acc_1_0': 0.6526, 'acc_1_1': 0.9486, 'mean_acc': 0.772}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8424, 'acc_1_0': 0.8393, 'acc_1_1': 0.9782, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6953, 'acc_0_0': 0.9744, 'acc_0_1': 0.6953, 'acc_1_0': 0.7761, 'acc_1_1': 0.9848, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.6851, 'acc_0_0': 0.9756, 'acc_0_1': 0.6851, 'acc_1_0': 0.743, 'acc_1_1': 0.9455, 'mean_acc': 0.8334}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9983, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.983, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.5171, 'acc_0_0': 0.9951, 'acc_0_1': 0.8537, 'acc_1_0': 0.5171, 'acc_1_1': 0.8956, 'mean_acc': 0.8761}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9963, 'acc_0_1': 0.8967, 'acc_1_0': 0.9107, 'acc_1_1': 0.9754, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.8627, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.8647, 'acc_1_0': 0.6012, 'acc_1_1': 0.8769, 'mean_acc': 0.8866}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9983, 'acc_0_1': 0.8804, 'acc_1_0': 0.9464, 'acc_1_1': 0.9735, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.8111, 'acc_1_0': 0.6153, 'acc_1_1': 0.8941, 'mean_acc': 0.8687}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.875, 'acc_1_0': 0.9821, 'acc_1_1': 0.9763, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.8106, 'acc_1_0': 0.6028, 'acc_1_1': 0.9003, 'mean_acc': 0.8687}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.6866, 'acc_0_0': 0.9786, 'acc_0_1': 0.6953, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.6542, 'acc_0_0': 0.9778, 'acc_0_1': 0.7251, 'acc_1_0': 0.6542, 'acc_1_1': 0.9252, 'mean_acc': 0.8378}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9977, 'acc_0_1': 0.9565, 'acc_1_0': 0.9464, 'acc_1_1': 0.9877, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.5224, 'acc_1_1': 0.9091, 'mean_acc': 0.86}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8084, 'acc_1_0': 0.5779, 'acc_1_1': 0.905, 'mean_acc': 0.865}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.9457, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.99}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.4635, 'acc_0_0': 0.9829, 'acc_0_1': 0.4635, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7433}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4692, 'acc_0_0': 0.9871, 'acc_0_1': 0.4692, 'acc_1_0': 0.6449, 'acc_1_1': 0.9673, 'mean_acc': 0.7454}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9946, 'acc_0_1': 0.7989, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5218, 'acc_0_0': 0.9951, 'acc_0_1': 0.8319, 'acc_1_0': 0.5218, 'acc_1_1': 0.8879, 'mean_acc': 0.8673}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.9022, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.4328, 'acc_0_0': 0.9957, 'acc_0_1': 0.8326, 'acc_1_0': 0.4328, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.4922, 'acc_0_0': 0.9938, 'acc_0_1': 0.855, 'acc_1_0': 0.4922, 'acc_1_1': 0.8769, 'mean_acc': 0.8712}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8696, 'acc_1_0': 0.8393, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3863, 'acc_0_0': 0.9701, 'acc_0_1': 0.3863, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7217}
Test(class): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.3951, 'acc_0_0': 0.969, 'acc_0_1': 0.3951, 'acc_1_0': 0.7165, 'acc_1_1': 0.972, 'mean_acc': 0.718}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5303, 'acc_0_0': 0.9957, 'acc_0_1': 0.721, 'acc_1_0': 0.5303, 'acc_1_1': 0.8358, 'mean_acc': 0.8197}
Val(class)(new adapter): {'weighted_mean_acc': 0.8409, 'worst_acc': 0.3182, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.5672, 'acc_1_1': 0.3182, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8424, 'worst_acc': 0.3318, 'acc_0_0': 0.9929, 'acc_0_1': 0.9845, 'acc_1_0': 0.6137, 'acc_1_1': 0.3318, 'mean_acc': 0.8744}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0909, 'acc_0_0': 0.8412, 'acc_0_1': 0.412, 'acc_1_0': 0.0909, 'acc_1_1': 0.791, 'mean_acc': 0.586}
Val(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.1416, 'acc_0_0': 0.9658, 'acc_0_1': 0.1416, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.62}
Test(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.1614, 'acc_0_0': 0.9712, 'acc_0_1': 0.1614, 'acc_1_0': 0.715, 'acc_1_1': 0.9891, 'mean_acc': 0.6296}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3485, 'acc_0_0': 0.9957, 'acc_0_1': 0.4678, 'acc_1_0': 0.3485, 'acc_1_1': 0.8955, 'mean_acc': 0.7078}
Val(class)(new adapter): {'weighted_mean_acc': 0.8425, 'worst_acc': 0.7424, 'acc_0_0': 0.8675, 'acc_0_1': 0.9356, 'acc_1_0': 0.8657, 'acc_1_1': 0.7424, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8469, 'worst_acc': 0.7445, 'acc_0_0': 0.8727, 'acc_0_1': 0.937, 'acc_1_0': 0.8692, 'acc_1_1': 0.7445, 'mean_acc': 0.8832}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8326, 'acc_0_1': 0.9313, 'acc_1_0': 0.8485, 'acc_1_1': 0.0, 'mean_acc': 0.7796}
Val(class)(new adapter): {'weighted_mean_acc': 0.7021, 'worst_acc': 0.5152, 'acc_0_0': 0.7436, 'acc_0_1': 0.9227, 'acc_1_0': 0.9104, 'acc_1_1': 0.5152, 'mean_acc': 0.8067}
Test(class)(new adapter): {'weighted_mean_acc': 0.6861, 'worst_acc': 0.5109, 'acc_0_0': 0.722, 'acc_0_1': 0.9401, 'acc_1_0': 0.9221, 'acc_1_1': 0.5109, 'mean_acc': 0.8057}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.597, 'acc_0_0': 0.9185, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.597, 'mean_acc': 0.8982}
Val(class)(new adapter): {'weighted_mean_acc': 0.8081, 'worst_acc': 0.6515, 'acc_0_0': 0.8462, 'acc_0_1': 0.9571, 'acc_1_0': 0.8955, 'acc_1_1': 0.6515, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.7962, 'worst_acc': 0.5748, 'acc_0_0': 0.8532, 'acc_0_1': 0.9534, 'acc_1_0': 0.8941, 'acc_1_1': 0.5748, 'mean_acc': 0.8659}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0299, 'acc_0_0': 0.8884, 'acc_0_1': 0.9614, 'acc_1_0': 0.8788, 'acc_1_1': 0.0299, 'mean_acc': 0.8197}
Val(class)(new adapter): {'weighted_mean_acc': 0.8967, 'worst_acc': 0.8333, 'acc_0_0': 0.9145, 'acc_0_1': 0.9227, 'acc_1_0': 0.8955, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8907, 'worst_acc': 0.7991, 'acc_0_0': 0.9171, 'acc_0_1': 0.9206, 'acc_1_0': 0.8738, 'acc_1_1': 0.7991, 'mean_acc': 0.9006}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9742, 'acc_1_0': 0.8182, 'acc_1_1': 0.9104, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8629, 'acc_0_0': 0.9366, 'acc_0_1': 0.8878, 'acc_1_0': 0.8629, 'acc_1_1': 0.891, 'mean_acc': 0.9044}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2239, 'acc_0_0': 0.927, 'acc_0_1': 0.9742, 'acc_1_0': 0.803, 'acc_1_1': 0.2239, 'mean_acc': 0.8531}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.8026, 'acc_0_0': 0.9274, 'acc_0_1': 0.8026, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8071, 'acc_0_0': 0.9255, 'acc_0_1': 0.8071, 'acc_1_0': 0.8785, 'acc_1_1': 0.9299, 'mean_acc': 0.8747}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9785, 'acc_0_1': 0.9056, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7554, 'acc_0_0': 0.9103, 'acc_0_1': 0.7554, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7583, 'acc_0_0': 0.9011, 'acc_0_1': 0.7583, 'acc_1_0': 0.891, 'acc_1_1': 0.9439, 'mean_acc': 0.8492}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9227, 'acc_0_1': 0.9871, 'acc_1_0': 0.8182, 'acc_1_1': 0.7313, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.8864, 'worst_acc': 0.691, 'acc_0_0': 0.8718, 'acc_0_1': 0.691, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8857, 'worst_acc': 0.7109, 'acc_0_0': 0.8758, 'acc_0_1': 0.7109, 'acc_1_0': 0.8925, 'acc_1_1': 0.9486, 'mean_acc': 0.8215}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9227, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.8818, 'worst_acc': 0.7339, 'acc_0_0': 0.859, 'acc_0_1': 0.7339, 'acc_1_0': 0.8507, 'acc_1_1': 0.9848, 'mean_acc': 0.8233}
Test(class)(new adapter): {'weighted_mean_acc': 0.8586, 'worst_acc': 0.7472, 'acc_0_0': 0.8412, 'acc_0_1': 0.7472, 'acc_1_0': 0.9034, 'acc_1_1': 0.933, 'mean_acc': 0.8217}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9099, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.6866, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7639, 'acc_0_0': 0.8974, 'acc_0_1': 0.7639, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class)(new adapter): {'weighted_mean_acc': 0.9001, 'worst_acc': 0.7752, 'acc_0_0': 0.8998, 'acc_0_1': 0.7752, 'acc_1_0': 0.8863, 'acc_1_1': 0.9237, 'mean_acc': 0.8524}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9914, 'acc_0_1': 0.9657, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.933, 'worst_acc': 0.794, 'acc_0_0': 0.9402, 'acc_0_1': 0.794, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.8208, 'acc_0_0': 0.9428, 'acc_0_1': 0.8208, 'acc_1_0': 0.8474, 'acc_1_1': 0.905, 'mean_acc': 0.8806}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9828, 'acc_0_1': 0.9356, 'acc_1_0': 0.8939, 'acc_1_1': 0.7313, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9396, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.8069, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.8279, 'acc_0_0': 0.945, 'acc_0_1': 0.8279, 'acc_1_0': 0.8427, 'acc_1_1': 0.9065, 'mean_acc': 0.8838}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9914, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8209, 'acc_0_0': 0.9316, 'acc_0_1': 0.8326, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.839, 'acc_0_0': 0.9317, 'acc_0_1': 0.839, 'acc_1_0': 0.8474, 'acc_1_1': 0.9034, 'mean_acc': 0.8832}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9528, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.8657, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.8369, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8474, 'acc_0_0': 0.9233, 'acc_0_1': 0.8488, 'acc_1_0': 0.8474, 'acc_1_1': 0.8863, 'mean_acc': 0.8818}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9785, 'acc_0_1': 0.97, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.8798, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.8318, 'acc_0_0': 0.9419, 'acc_0_1': 0.8816, 'acc_1_0': 0.8318, 'acc_1_1': 0.8692, 'mean_acc': 0.8982}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9399, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9104, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9325, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9258, 'worst_acc': 0.8037, 'acc_0_0': 0.9619, 'acc_0_1': 0.9162, 'acc_1_0': 0.8037, 'acc_1_1': 0.8146, 'mean_acc': 0.9103}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.7313, 'acc_0_0': 0.9744, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7664, 'acc_0_0': 0.9738, 'acc_0_1': 0.9344, 'acc_1_0': 0.7664, 'acc_1_1': 0.7773, 'mean_acc': 0.9137}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.9545, 'acc_1_1': 0.8955, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.7015, 'acc_0_0': 0.9744, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.743, 'acc_0_0': 0.9787, 'acc_0_1': 0.9415, 'acc_1_0': 0.743, 'acc_1_1': 0.7477, 'mean_acc': 0.9125}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7015, 'acc_0_0': 0.9744, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7321, 'acc_0_0': 0.9774, 'acc_0_1': 0.9424, 'acc_1_0': 0.7383, 'acc_1_1': 0.7321, 'mean_acc': 0.9101}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9357, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.7243, 'acc_0_0': 0.9778, 'acc_0_1': 0.9455, 'acc_1_0': 0.7352, 'acc_1_1': 0.7243, 'mean_acc': 0.9103}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.7015, 'acc_0_0': 0.9701, 'acc_0_1': 0.9528, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7212, 'acc_0_0': 0.9765, 'acc_0_1': 0.9477, 'acc_1_0': 0.7352, 'acc_1_1': 0.7212, 'mean_acc': 0.9103}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.7015, 'acc_0_0': 0.9744, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7336, 'acc_0_0': 0.9761, 'acc_0_1': 0.945, 'acc_1_0': 0.7336, 'acc_1_1': 0.7352, 'mean_acc': 0.9104}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9871, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.7015, 'acc_0_0': 0.9744, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7243, 'acc_0_0': 0.9756, 'acc_0_1': 0.9463, 'acc_1_0': 0.7383, 'acc_1_1': 0.7243, 'mean_acc': 0.9101}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.7164, 'acc_0_0': 0.9786, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.6963, 'acc_0_0': 0.9778, 'acc_0_1': 0.9565, 'acc_1_0': 0.7274, 'acc_1_1': 0.6963, 'mean_acc': 0.9106}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9328, 'worst_acc': 0.7164, 'acc_0_0': 0.9744, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.6885, 'acc_0_0': 0.9743, 'acc_0_1': 0.9548, 'acc_1_0': 0.7368, 'acc_1_1': 0.6885, 'mean_acc': 0.9087}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7015, 'acc_0_0': 0.9701, 'acc_0_1': 0.9571, 'acc_1_0': 0.7015, 'acc_1_1': 0.7879, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.6713, 'acc_0_0': 0.9703, 'acc_0_1': 0.9557, 'acc_1_0': 0.7399, 'acc_1_1': 0.6713, 'mean_acc': 0.9059}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7313, 'acc_0_0': 0.9744, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.7576, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9007, 'worst_acc': 0.6713, 'acc_0_0': 0.9694, 'acc_0_1': 0.9579, 'acc_1_0': 0.7477, 'acc_1_1': 0.6713, 'mean_acc': 0.9073}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.7313, 'acc_0_0': 0.9701, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.6807, 'acc_0_0': 0.9685, 'acc_0_1': 0.9539, 'acc_1_0': 0.7508, 'acc_1_1': 0.6807, 'mean_acc': 0.9068}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7313, 'acc_0_0': 0.9615, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7056, 'acc_0_0': 0.9654, 'acc_0_1': 0.9512, 'acc_1_0': 0.7757, 'acc_1_1': 0.7056, 'mean_acc': 0.9101}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7087, 'acc_0_0': 0.9619, 'acc_0_1': 0.9494, 'acc_1_0': 0.7804, 'acc_1_1': 0.7087, 'mean_acc': 0.9089}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.7103, 'acc_0_0': 0.9525, 'acc_0_1': 0.9441, 'acc_1_0': 0.7882, 'acc_1_1': 0.7103, 'mean_acc': 0.9042}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7259, 'acc_0_0': 0.9552, 'acc_0_1': 0.9375, 'acc_1_0': 0.7882, 'acc_1_1': 0.7259, 'mean_acc': 0.9044}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7313, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7181, 'acc_0_0': 0.9685, 'acc_0_1': 0.9415, 'acc_1_0': 0.7461, 'acc_1_1': 0.7181, 'mean_acc': 0.9056}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.715, 'acc_0_0': 0.9685, 'acc_0_1': 0.9432, 'acc_1_0': 0.7445, 'acc_1_1': 0.715, 'mean_acc': 0.9058}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7196, 'acc_0_0': 0.9685, 'acc_0_1': 0.9424, 'acc_1_0': 0.7445, 'acc_1_1': 0.7196, 'mean_acc': 0.9059}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7243, 'acc_0_0': 0.9685, 'acc_0_1': 0.9406, 'acc_1_0': 0.7445, 'acc_1_1': 0.7243, 'mean_acc': 0.9058}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7227, 'acc_0_0': 0.9659, 'acc_0_1': 0.9401, 'acc_1_0': 0.7492, 'acc_1_1': 0.7227, 'mean_acc': 0.9049}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9615, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7352, 'acc_0_0': 0.9627, 'acc_0_1': 0.9326, 'acc_1_0': 0.7695, 'acc_1_1': 0.7352, 'mean_acc': 0.9044}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9615, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7383, 'acc_0_0': 0.9605, 'acc_0_1': 0.9326, 'acc_1_0': 0.7788, 'acc_1_1': 0.7383, 'mean_acc': 0.9049}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7461, 'acc_0_0': 0.9588, 'acc_0_1': 0.929, 'acc_1_0': 0.7882, 'acc_1_1': 0.7461, 'mean_acc': 0.9047}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.757, 'acc_0_0': 0.9552, 'acc_0_1': 0.9277, 'acc_1_0': 0.7975, 'acc_1_1': 0.757, 'mean_acc': 0.9051}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7555, 'acc_0_0': 0.9543, 'acc_0_1': 0.9251, 'acc_1_0': 0.8022, 'acc_1_1': 0.7555, 'mean_acc': 0.904}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7492, 'acc_0_0': 0.9534, 'acc_0_1': 0.9259, 'acc_1_0': 0.7991, 'acc_1_1': 0.7492, 'mean_acc': 0.903}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7492, 'acc_0_0': 0.9521, 'acc_0_1': 0.9259, 'acc_1_0': 0.8022, 'acc_1_1': 0.7492, 'mean_acc': 0.9028}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7477, 'acc_0_0': 0.9525, 'acc_0_1': 0.9268, 'acc_1_0': 0.8022, 'acc_1_1': 0.7477, 'mean_acc': 0.9032}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.743, 'acc_0_0': 0.9534, 'acc_0_1': 0.9277, 'acc_1_0': 0.7928, 'acc_1_1': 0.743, 'mean_acc': 0.9023}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.7492, 'acc_0_0': 0.9525, 'acc_0_1': 0.9264, 'acc_1_0': 0.8006, 'acc_1_1': 0.7492, 'mean_acc': 0.903}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7461, 'acc_0_0': 0.9521, 'acc_0_1': 0.9273, 'acc_1_0': 0.8006, 'acc_1_1': 0.7461, 'mean_acc': 0.9028}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7461, 'acc_0_0': 0.9508, 'acc_0_1': 0.9273, 'acc_1_0': 0.8022, 'acc_1_1': 0.7461, 'mean_acc': 0.9025}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7523, 'acc_0_0': 0.9499, 'acc_0_1': 0.9255, 'acc_1_0': 0.81, 'acc_1_1': 0.7523, 'mean_acc': 0.903}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7508, 'acc_0_0': 0.9508, 'acc_0_1': 0.9255, 'acc_1_0': 0.8053, 'acc_1_1': 0.7508, 'mean_acc': 0.9027}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.7508, 'acc_0_0': 0.9503, 'acc_0_1': 0.9251, 'acc_1_0': 0.8053, 'acc_1_1': 0.7508, 'mean_acc': 0.9023}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.7508, 'acc_0_0': 0.9503, 'acc_0_1': 0.9246, 'acc_1_0': 0.8069, 'acc_1_1': 0.7508, 'mean_acc': 0.9023}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.757, 'acc_0_0': 0.9499, 'acc_0_1': 0.9224, 'acc_1_0': 0.8115, 'acc_1_1': 0.757, 'mean_acc': 0.9025}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7555, 'acc_0_0': 0.9494, 'acc_0_1': 0.9246, 'acc_1_0': 0.8115, 'acc_1_1': 0.7555, 'mean_acc': 0.903}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7492, 'acc_0_0': 0.9521, 'acc_0_1': 0.9259, 'acc_1_0': 0.8022, 'acc_1_1': 0.7492, 'mean_acc': 0.9028}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7523, 'acc_0_0': 0.9525, 'acc_0_1': 0.9255, 'acc_1_0': 0.8022, 'acc_1_1': 0.7523, 'mean_acc': 0.9032}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.7523, 'acc_0_0': 0.953, 'acc_0_1': 0.9251, 'acc_1_0': 0.8006, 'acc_1_1': 0.7523, 'mean_acc': 0.903}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9742, 'acc_1_0': 0.8182, 'acc_1_1': 0.9104, 'mean_acc': 0.9466}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
best test accuracy on [class]: {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8629, 'acc_0_0': 0.9366, 'acc_0_1': 0.8878, 'acc_1_0': 0.8629, 'acc_1_1': 0.891, 'mean_acc': 0.9044}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8629, 'acc_0_0': 0.9366, 'acc_0_1': 0.8878, 'acc_1_0': 0.8629, 'acc_1_1': 0.891, 'mean_acc': 0.9044}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5498, 'acc_0_0': 0.9601, 'acc_0_1': 0.9379, 'acc_1_0': 0.5498, 'acc_1_1': 0.9844, 'mean_acc': 0.9087}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9742, 'acc_1_0': 0.8182, 'acc_1_1': 0.9104, 'mean_acc': 0.9466}, 'Val': {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}, 'Test': {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8629, 'acc_0_0': 0.9366, 'acc_0_1': 0.8878, 'acc_1_0': 0.8629, 'acc_1_1': 0.891, 'mean_acc': 0.9044}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8629, 'acc_0_0': 0.9366, 'acc_0_1': 0.8878, 'acc_1_0': 0.8629, 'acc_1_1': 0.891, 'mean_acc': 0.9044}, 'spurious': {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5498, 'acc_0_0': 0.9601, 'acc_0_1': 0.9379, 'acc_1_0': 0.5498, 'acc_1_1': 0.9844, 'mean_acc': 0.9087}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9191     0.8598   0.9304  ...   0.8598   0.8894    0.9035
2                       0.9133     0.8364   0.9202  ...   0.8364   0.9081    0.8769
3                       0.9238     0.8629   0.9366  ...   0.8629   0.8910    0.9044
test_mean               0.9187     0.8530   0.9291  ...   0.8530   0.8962    0.8949
test_std                0.0043     0.0118   0.0068  ...   0.0118   0.0085    0.0128
1                       0.9619     0.6386   0.9627  ...   0.6386   0.9875    0.9035
2                       0.9714     0.4688   0.9814  ...   0.4688   0.9875    0.8707
3                       0.9598     0.5498   0.9601  ...   0.5498   0.9844    0.9087
zs_spu_mean             0.9644     0.5524   0.9681  ...   0.5524   0.9865    0.8943
zs_spu_std              0.0050     0.0693   0.0095  ...   0.0693   0.0015    0.0168
1                          NaN     0.1343   0.8455  ...   0.8788   0.1343    0.8197
2                          NaN     0.9394   0.9957  ...   0.9394   0.9851    0.9750
3                          NaN     0.8182   0.9657  ...   0.8182   0.9104    0.9466
tr_mean                    NaN     0.6306   0.9356  ...   0.8788   0.6766    0.9138
tr_std                     NaN     0.3544   0.0649  ...   0.0495   0.3847    0.0675
1                       0.9284     0.8806   0.9316  ...   0.8806   0.9242    0.9150
2                       0.9315     0.8209   0.9359  ...   0.8209   0.9394    0.8850
3                       0.9246     0.8657   0.9316  ...   0.8657   0.9091    0.9083
val_mean                0.9282     0.8557   0.9330  ...   0.8557   0.9242    0.9028
val_std                 0.0028     0.0254   0.0020  ...   0.0254   0.0124    0.0129
1                       0.9191     0.8598   0.9304  ...   0.8598   0.8894    0.9035
2                       0.9133     0.8364   0.9202  ...   0.8364   0.9081    0.8769
3                       0.9238     0.8629   0.9366  ...   0.8629   0.8910    0.9044
zs_tg_mean              0.9187     0.8530   0.9291  ...   0.8530   0.8962    0.8949
zs_tg_std               0.0043     0.0118   0.0068  ...   0.0118   0.0085    0.0128

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_10.0_lrr10.0_bsr256_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3696, 'acc_0_0': 0.9337, 'acc_0_1': 0.3696, 'acc_1_0': 0.5357, 'acc_1_1': 0.7228, 'mean_acc': 0.8609}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4034, 'acc_0_0': 1.0, 'acc_0_1': 0.4034, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.3605, 'acc_0_0': 0.9925, 'acc_0_1': 0.3605, 'acc_1_0': 0.5592, 'acc_1_1': 0.9548, 'mean_acc': 0.6943}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9946, 'acc_0_1': 0.5707, 'acc_1_0': 0.4821, 'acc_1_1': 0.9158, 'mean_acc': 0.955}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3734, 'acc_0_0': 0.9915, 'acc_0_1': 0.3734, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.71}
Test(class): {'weighted_mean_acc': 0.9542, 'worst_acc': 0.3729, 'acc_0_0': 0.9854, 'acc_0_1': 0.3729, 'acc_1_0': 0.6386, 'acc_1_1': 0.9688, 'mean_acc': 0.7068}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6141, 'acc_0_0': 0.9883, 'acc_0_1': 0.6141, 'acc_1_0': 0.6607, 'acc_1_1': 0.9499, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9889, 'acc_0_1': 0.7565, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8488}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9929, 'acc_0_1': 0.7446, 'acc_1_0': 0.6786, 'acc_1_1': 0.9385, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.5751, 'acc_0_0': 0.9957, 'acc_0_1': 0.5751, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.5525, 'acc_0_0': 0.9831, 'acc_0_1': 0.5525, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.7794}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9923, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9593, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6044, 'acc_0_0': 0.992, 'acc_0_1': 0.6816, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8215}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.996, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9574, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.6142, 'acc_0_0': 0.9889, 'acc_0_1': 0.6142, 'acc_1_0': 0.6386, 'acc_1_1': 0.9393, 'mean_acc': 0.7988}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9963, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9631, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6153, 'acc_0_0': 0.9907, 'acc_0_1': 0.6993, 'acc_1_0': 0.6153, 'acc_1_1': 0.9299, 'mean_acc': 0.829}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9949, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9612, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6417, 'acc_0_0': 0.9894, 'acc_0_1': 0.6891, 'acc_1_0': 0.6417, 'acc_1_1': 0.933, 'mean_acc': 0.8278}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9954, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8293}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.7143, 'acc_1_1': 0.9622, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6226, 'acc_0_0': 0.9889, 'acc_0_1': 0.6226, 'acc_1_0': 0.6464, 'acc_1_1': 0.9393, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9963, 'acc_0_1': 0.7391, 'acc_1_0': 0.7321, 'acc_1_1': 0.9707, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7055, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8298}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9974, 'acc_0_1': 0.7717, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.6616, 'acc_1_0': 0.6246, 'acc_1_1': 0.9377, 'mean_acc': 0.8162}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.998, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.9678, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.6355, 'acc_0_0': 0.9889, 'acc_0_1': 0.6727, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8203}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9974, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9811, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6168, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6168, 'acc_1_1': 0.9268, 'mean_acc': 0.836}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9991, 'acc_0_1': 0.8098, 'acc_1_0': 0.7321, 'acc_1_1': 0.9688, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.639, 'acc_0_0': 0.9867, 'acc_0_1': 0.639, 'acc_1_0': 0.6449, 'acc_1_1': 0.9393, 'mean_acc': 0.8082}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9983, 'acc_0_1': 0.7826, 'acc_1_0': 0.8571, 'acc_1_1': 0.9811, 'mean_acc': 0.9846}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6137, 'acc_0_0': 0.9894, 'acc_0_1': 0.7268, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.839}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6009, 'acc_0_0': 0.9829, 'acc_0_1': 0.6009, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.604, 'acc_0_0': 0.9854, 'acc_0_1': 0.604, 'acc_1_0': 0.6573, 'acc_1_1': 0.9439, 'mean_acc': 0.796}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7811, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5717, 'acc_0_0': 0.9925, 'acc_0_1': 0.757, 'acc_1_0': 0.5717, 'acc_1_1': 0.9237, 'mean_acc': 0.8466}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9983, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9839, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.741, 'acc_1_0': 0.5763, 'acc_1_1': 0.9221, 'mean_acc': 0.8405}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9991, 'acc_0_1': 0.8696, 'acc_1_0': 0.875, 'acc_1_1': 0.9849, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6137, 'acc_0_0': 0.9871, 'acc_0_1': 0.7029, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.829}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9997, 'acc_0_1': 0.8913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.662, 'acc_0_0': 0.984, 'acc_0_1': 0.6647, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8191}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6418, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6371, 'acc_0_0': 0.9858, 'acc_0_1': 0.6749, 'acc_1_0': 0.6371, 'acc_1_1': 0.9361, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6701, 'acc_1_0': 0.634, 'acc_1_1': 0.9346, 'mean_acc': 0.8188}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5903, 'acc_0_0': 0.9902, 'acc_0_1': 0.7406, 'acc_1_0': 0.5903, 'acc_1_1': 0.9237, 'mean_acc': 0.8414}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9885, 'acc_0_1': 0.7011, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.8262}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6012, 'acc_0_0': 0.9898, 'acc_0_1': 0.7286, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8381}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9728, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5935, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.5935, 'acc_1_1': 0.933, 'mean_acc': 0.8221}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9997, 'acc_0_1': 0.9348, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9962}
Val(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6866, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6866, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6402, 'acc_0_0': 0.9845, 'acc_0_1': 0.7282, 'acc_1_0': 0.6402, 'acc_1_1': 0.933, 'mean_acc': 0.8409}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.5997, 'acc_0_0': 0.9898, 'acc_0_1': 0.6772, 'acc_1_0': 0.5997, 'acc_1_1': 0.9408, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9643, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5763, 'acc_0_0': 0.992, 'acc_0_1': 0.7361, 'acc_1_0': 0.5763, 'acc_1_1': 0.9252, 'mean_acc': 0.839}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9643, 'acc_1_1': 0.9972, 'mean_acc': 0.9981}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.729, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8393}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6137, 'acc_0_0': 0.9885, 'acc_0_1': 0.7255, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8376}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9821, 'acc_1_1': 0.9962, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.5966, 'acc_0_0': 0.9898, 'acc_0_1': 0.7082, 'acc_1_0': 0.5966, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9985}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6433, 'acc_0_0': 0.9827, 'acc_0_1': 0.6439, 'acc_1_0': 0.6433, 'acc_1_1': 0.9455, 'mean_acc': 0.8091}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.648, 'acc_0_0': 0.9845, 'acc_0_1': 0.6851, 'acc_1_0': 0.648, 'acc_1_1': 0.9439, 'mean_acc': 0.8262}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.9987}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.595, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.8157}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9981, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5888, 'acc_0_0': 0.9925, 'acc_0_1': 0.7401, 'acc_1_0': 0.5888, 'acc_1_1': 0.9237, 'mean_acc': 0.8419}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5919, 'acc_0_0': 0.9902, 'acc_0_1': 0.7086, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8298}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.609, 'acc_0_0': 0.9889, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8284}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6519, 'acc_0_0': 0.9827, 'acc_0_1': 0.6519, 'acc_1_0': 0.6573, 'acc_1_1': 0.9377, 'mean_acc': 0.8129}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3939, 'acc_0_0': 0.9914, 'acc_0_1': 0.7253, 'acc_1_0': 0.3939, 'acc_1_1': 0.9403, 'mean_acc': 0.8164}
Val(class)(new adapter): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class)(new adapter): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6386, 'acc_0_0': 0.9867, 'acc_0_1': 0.6843, 'acc_1_0': 0.6386, 'acc_1_1': 0.9361, 'mean_acc': 0.8248}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0644, 'acc_0_0': 0.9914, 'acc_0_1': 0.0644, 'acc_1_0': 0.1364, 'acc_1_1': 0.7313, 'mean_acc': 0.5075}
Val(class)(new adapter): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6866, 'acc_0_0': 0.9744, 'acc_0_1': 0.7039, 'acc_1_0': 0.6866, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class)(new adapter): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.6834, 'acc_0_0': 0.9809, 'acc_0_1': 0.6834, 'acc_1_0': 0.6854, 'acc_1_1': 0.9424, 'mean_acc': 0.8281}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9828, 'acc_0_1': 0.8584, 'acc_1_0': 0.5758, 'acc_1_1': 0.9552, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.7313, 'acc_0_0': 0.9701, 'acc_0_1': 0.7897, 'acc_1_0': 0.7313, 'acc_1_1': 0.9242, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.7508, 'acc_0_0': 0.9707, 'acc_0_1': 0.7916, 'acc_1_0': 0.7508, 'acc_1_1': 0.9097, 'mean_acc': 0.8699}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.3176, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.2985, 'mean_acc': 0.5442}
Val(class)(new adapter): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.8627, 'acc_1_0': 0.7015, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9541, 'worst_acc': 0.6963, 'acc_0_0': 0.9836, 'acc_0_1': 0.8621, 'acc_1_0': 0.6963, 'acc_1_1': 0.8863, 'mean_acc': 0.8937}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.97, 'acc_0_1': 0.9013, 'acc_1_0': 0.7424, 'acc_1_1': 0.9254, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.4776, 'acc_1_1': 0.6515, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.4907, 'acc_0_0': 0.9982, 'acc_0_1': 0.9809, 'acc_1_0': 0.4907, 'acc_1_1': 0.6028, 'mean_acc': 0.8914}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0597, 'acc_0_0': 0.9828, 'acc_0_1': 0.8627, 'acc_1_0': 0.6515, 'acc_1_1': 0.0597, 'mean_acc': 0.7963}
Val(class)(new adapter): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.9614, 'acc_1_0': 0.5373, 'acc_1_1': 0.8333, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9421, 'worst_acc': 0.634, 'acc_0_0': 0.9942, 'acc_0_1': 0.9565, 'acc_1_0': 0.634, 'acc_1_1': 0.7835, 'mean_acc': 0.9163}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.7273, 'acc_1_1': 0.9552, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9492, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9453, 'worst_acc': 0.7804, 'acc_0_0': 0.9672, 'acc_0_1': 0.8909, 'acc_1_0': 0.7804, 'acc_1_1': 0.891, 'mean_acc': 0.9084}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9313, 'acc_0_1': 0.9099, 'acc_1_0': 0.803, 'acc_1_1': 0.7612, 'mean_acc': 0.8898}
Val(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.8155, 'acc_0_0': 0.9017, 'acc_0_1': 0.8155, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.8173, 'acc_0_0': 0.898, 'acc_0_1': 0.8173, 'acc_1_0': 0.8707, 'acc_1_1': 0.9283, 'mean_acc': 0.8669}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9099, 'acc_0_0': 0.9185, 'acc_0_1': 0.9099, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.8857, 'worst_acc': 0.8369, 'acc_0_0': 0.8632, 'acc_0_1': 0.8369, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.8552, 'worst_acc': 0.8373, 'acc_0_0': 0.8373, 'acc_0_1': 0.8528, 'acc_1_0': 0.8988, 'acc_1_1': 0.9128, 'mean_acc': 0.8585}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8455, 'acc_0_0': 0.8455, 'acc_0_1': 0.9657, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.886, 'worst_acc': 0.8209, 'acc_0_0': 0.8932, 'acc_0_1': 0.897, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8753, 'worst_acc': 0.8676, 'acc_0_0': 0.8758, 'acc_0_1': 0.9118, 'acc_1_0': 0.8707, 'acc_1_1': 0.8676, 'mean_acc': 0.8883}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.97, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9104, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.8302, 'acc_0_0': 0.9282, 'acc_0_1': 0.9273, 'acc_1_0': 0.8302, 'acc_1_1': 0.8364, 'mean_acc': 0.9068}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.97, 'acc_0_1': 0.9871, 'acc_1_0': 0.8182, 'acc_1_1': 0.8507, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.897, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.8084, 'acc_0_0': 0.949, 'acc_0_1': 0.9135, 'acc_1_0': 0.8084, 'acc_1_1': 0.8567, 'mean_acc': 0.9094}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.7424, 'acc_1_1': 0.9104, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.9394, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.8006, 'acc_0_0': 0.9494, 'acc_0_1': 0.8953, 'acc_1_0': 0.8006, 'acc_1_1': 0.8692, 'mean_acc': 0.903}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.9545, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.796, 'acc_0_0': 0.9472, 'acc_0_1': 0.894, 'acc_1_0': 0.796, 'acc_1_1': 0.8738, 'mean_acc': 0.9016}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.9394, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7991, 'acc_0_0': 0.945, 'acc_0_1': 0.9047, 'acc_1_0': 0.7991, 'acc_1_1': 0.8598, 'mean_acc': 0.9037}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9244, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7991, 'acc_0_0': 0.9392, 'acc_0_1': 0.9228, 'acc_1_0': 0.7991, 'acc_1_1': 0.838, 'mean_acc': 0.9061}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7928, 'acc_0_0': 0.941, 'acc_0_1': 0.9317, 'acc_1_0': 0.7928, 'acc_1_1': 0.8146, 'mean_acc': 0.907}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7835, 'acc_0_0': 0.9432, 'acc_0_1': 0.9348, 'acc_1_0': 0.7835, 'acc_1_1': 0.8069, 'mean_acc': 0.9071}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7015, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7757, 'acc_0_0': 0.9481, 'acc_0_1': 0.9348, 'acc_1_0': 0.7757, 'acc_1_1': 0.8069, 'mean_acc': 0.9082}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7015, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7726, 'acc_0_0': 0.9494, 'acc_0_1': 0.929, 'acc_1_0': 0.7726, 'acc_1_1': 0.8162, 'mean_acc': 0.9071}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7679, 'acc_0_0': 0.9521, 'acc_0_1': 0.9228, 'acc_1_0': 0.7679, 'acc_1_1': 0.8209, 'mean_acc': 0.9058}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7664, 'acc_0_0': 0.9525, 'acc_0_1': 0.9144, 'acc_1_0': 0.7664, 'acc_1_1': 0.8287, 'mean_acc': 0.9033}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7632, 'acc_0_0': 0.9508, 'acc_0_1': 0.91, 'acc_1_0': 0.7632, 'acc_1_1': 0.8318, 'mean_acc': 0.9009}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7664, 'acc_0_0': 0.9499, 'acc_0_1': 0.9104, 'acc_1_0': 0.7664, 'acc_1_1': 0.8302, 'mean_acc': 0.9009}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7695, 'acc_0_0': 0.9455, 'acc_0_1': 0.9184, 'acc_1_0': 0.7695, 'acc_1_1': 0.8209, 'mean_acc': 0.9016}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7164, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7944, 'acc_0_0': 0.9335, 'acc_0_1': 0.9175, 'acc_1_0': 0.7944, 'acc_1_1': 0.8178, 'mean_acc': 0.899}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8984, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9005, 'worst_acc': 0.8022, 'acc_0_0': 0.9295, 'acc_0_1': 0.9251, 'acc_1_0': 0.8022, 'acc_1_1': 0.8053, 'mean_acc': 0.8999}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9657, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7913, 'acc_0_0': 0.9366, 'acc_0_1': 0.9322, 'acc_1_0': 0.796, 'acc_1_1': 0.7913, 'mean_acc': 0.9032}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.6866, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.6866, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.7632, 'acc_0_0': 0.9517, 'acc_0_1': 0.9397, 'acc_1_0': 0.7695, 'acc_1_1': 0.7632, 'mean_acc': 0.9059}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7539, 'acc_0_0': 0.9596, 'acc_0_1': 0.9401, 'acc_1_0': 0.7617, 'acc_1_1': 0.7539, 'mean_acc': 0.9073}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7804, 'acc_0_0': 0.9557, 'acc_0_1': 0.9299, 'acc_1_0': 0.7804, 'acc_1_1': 0.7913, 'mean_acc': 0.908}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.9242, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.8146, 'acc_0_0': 0.9477, 'acc_0_1': 0.9047, 'acc_1_0': 0.8146, 'acc_1_1': 0.8333, 'mean_acc': 0.9035}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9132, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.8755, 'acc_1_0': 0.7463, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.8287, 'acc_0_0': 0.9361, 'acc_0_1': 0.8838, 'acc_1_0': 0.8287, 'acc_1_1': 0.8583, 'mean_acc': 0.8952}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.8712, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.8411, 'acc_0_0': 0.9277, 'acc_0_1': 0.8696, 'acc_1_0': 0.8411, 'acc_1_1': 0.8707, 'mean_acc': 0.8892}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.867, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.8489, 'acc_0_0': 0.922, 'acc_0_1': 0.8639, 'acc_1_0': 0.8489, 'acc_1_1': 0.8754, 'mean_acc': 0.8861}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.8798, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.8396, 'acc_0_0': 0.9361, 'acc_0_1': 0.8825, 'acc_1_0': 0.8396, 'acc_1_1': 0.8629, 'mean_acc': 0.8964}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.8349, 'acc_0_0': 0.9401, 'acc_0_1': 0.8896, 'acc_1_0': 0.8349, 'acc_1_1': 0.852, 'mean_acc': 0.899}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.8302, 'acc_0_0': 0.9437, 'acc_0_1': 0.894, 'acc_1_0': 0.8302, 'acc_1_1': 0.8458, 'mean_acc': 0.9009}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.8224, 'acc_0_0': 0.9486, 'acc_0_1': 0.9011, 'acc_1_0': 0.8224, 'acc_1_1': 0.8411, 'mean_acc': 0.9042}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.8162, 'acc_0_0': 0.9503, 'acc_0_1': 0.9126, 'acc_1_0': 0.8162, 'acc_1_1': 0.8287, 'mean_acc': 0.9073}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.8022, 'acc_0_0': 0.9543, 'acc_0_1': 0.9175, 'acc_1_0': 0.8022, 'acc_1_1': 0.8271, 'mean_acc': 0.909}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7944, 'acc_0_0': 0.9557, 'acc_0_1': 0.9242, 'acc_1_0': 0.7944, 'acc_1_1': 0.8255, 'mean_acc': 0.9111}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7928, 'acc_0_0': 0.9561, 'acc_0_1': 0.9246, 'acc_1_0': 0.7928, 'acc_1_1': 0.8255, 'mean_acc': 0.9113}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7975, 'acc_0_0': 0.9557, 'acc_0_1': 0.9246, 'acc_1_0': 0.7975, 'acc_1_1': 0.8255, 'mean_acc': 0.9116}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9258, 'worst_acc': 0.7897, 'acc_0_0': 0.9583, 'acc_0_1': 0.9259, 'acc_1_0': 0.7897, 'acc_1_1': 0.8255, 'mean_acc': 0.9123}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.8006, 'acc_0_0': 0.9561, 'acc_0_1': 0.9242, 'acc_1_0': 0.8006, 'acc_1_1': 0.8255, 'mean_acc': 0.912}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8006, 'acc_0_0': 0.9565, 'acc_0_1': 0.9246, 'acc_1_0': 0.8006, 'acc_1_1': 0.8255, 'mean_acc': 0.9123}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.796, 'acc_0_0': 0.9583, 'acc_0_1': 0.9268, 'acc_1_0': 0.796, 'acc_1_1': 0.8255, 'mean_acc': 0.9134}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.8037, 'acc_0_0': 0.9579, 'acc_0_1': 0.9251, 'acc_1_0': 0.8037, 'acc_1_1': 0.8255, 'mean_acc': 0.9134}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.7975, 'acc_0_0': 0.9583, 'acc_0_1': 0.9277, 'acc_1_0': 0.7975, 'acc_1_1': 0.824, 'mean_acc': 0.9137}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8037, 'acc_0_0': 0.9565, 'acc_0_1': 0.9237, 'acc_1_0': 0.8037, 'acc_1_1': 0.8255, 'mean_acc': 0.9123}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9249, 'worst_acc': 0.8037, 'acc_0_0': 0.957, 'acc_0_1': 0.9233, 'acc_1_0': 0.8037, 'acc_1_1': 0.8255, 'mean_acc': 0.9123}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.796, 'acc_0_0': 0.957, 'acc_0_1': 0.9268, 'acc_1_0': 0.796, 'acc_1_1': 0.824, 'mean_acc': 0.9127}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.8006, 'acc_0_0': 0.957, 'acc_0_1': 0.9268, 'acc_1_0': 0.8006, 'acc_1_1': 0.824, 'mean_acc': 0.9132}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7913, 'acc_0_0': 0.9588, 'acc_0_1': 0.9277, 'acc_1_0': 0.7913, 'acc_1_1': 0.8224, 'mean_acc': 0.913}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7913, 'acc_0_0': 0.9588, 'acc_0_1': 0.9277, 'acc_1_0': 0.7913, 'acc_1_1': 0.824, 'mean_acc': 0.9132}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.796, 'acc_0_0': 0.9592, 'acc_0_1': 0.9268, 'acc_1_0': 0.796, 'acc_1_1': 0.824, 'mean_acc': 0.9135}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.7944, 'acc_0_0': 0.9592, 'acc_0_1': 0.9264, 'acc_1_0': 0.7944, 'acc_1_1': 0.824, 'mean_acc': 0.9132}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9262, 'worst_acc': 0.7944, 'acc_0_0': 0.9592, 'acc_0_1': 0.9255, 'acc_1_0': 0.7944, 'acc_1_1': 0.824, 'mean_acc': 0.9128}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7928, 'acc_0_0': 0.9596, 'acc_0_1': 0.9268, 'acc_1_0': 0.7928, 'acc_1_1': 0.824, 'mean_acc': 0.9134}
========================================================================
> end of training. 

best epoch : 49
best training accuracy on [class]: {'worst_acc': 0.9099, 'acc_0_0': 0.9185, 'acc_0_1': 0.9099, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9232}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8857, 'worst_acc': 0.8369, 'acc_0_0': 0.8632, 'acc_0_1': 0.8369, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.865}
best test accuracy on [class]: {'weighted_mean_acc': 0.8552, 'worst_acc': 0.8373, 'acc_0_0': 0.8373, 'acc_0_1': 0.8528, 'acc_1_0': 0.8988, 'acc_1_1': 0.9128, 'mean_acc': 0.8585}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8552, 'worst_acc': 0.8373, 'acc_0_0': 0.8373, 'acc_0_1': 0.8528, 'acc_1_0': 0.8988, 'acc_1_1': 0.9128, 'mean_acc': 0.8585}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5592, 'acc_0_0': 0.9557, 'acc_0_1': 0.9255, 'acc_1_0': 0.5592, 'acc_1_1': 0.9922, 'mean_acc': 0.904}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 49': {'Train': {'worst_acc': 0.9099, 'acc_0_0': 0.9185, 'acc_0_1': 0.9099, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9232}, 'Val': {'weighted_mean_acc': 0.8857, 'worst_acc': 0.8369, 'acc_0_0': 0.8632, 'acc_0_1': 0.8369, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.865}, 'Test': {'weighted_mean_acc': 0.8552, 'worst_acc': 0.8373, 'acc_0_0': 0.8373, 'acc_0_1': 0.8528, 'acc_1_0': 0.8988, 'acc_1_1': 0.9128, 'mean_acc': 0.8585}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8552, 'worst_acc': 0.8373, 'acc_0_0': 0.8373, 'acc_0_1': 0.8528, 'acc_1_0': 0.8988, 'acc_1_1': 0.9128, 'mean_acc': 0.8585}, 'spurious': {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5592, 'acc_0_0': 0.9557, 'acc_0_1': 0.9255, 'acc_1_0': 0.5592, 'acc_1_1': 0.9922, 'mean_acc': 0.904}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9231, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.6433, 'mean_acc': 0.8375}
Val(class): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.1588, 'acc_0_0': 0.9786, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6317}
Test(class): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.1512, 'acc_0_0': 0.9641, 'acc_0_1': 0.1512, 'acc_1_0': 0.6916, 'acc_1_1': 0.9798, 'mean_acc': 0.6193}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9974, 'acc_0_1': 0.587, 'acc_1_0': 0.4286, 'acc_1_1': 0.9101, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.3476, 'acc_0_0': 0.9957, 'acc_0_1': 0.3476, 'acc_1_0': 0.597, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.3228, 'acc_0_0': 0.9796, 'acc_0_1': 0.3228, 'acc_1_0': 0.6121, 'acc_1_1': 0.9642, 'mean_acc': 0.6816}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4837, 'acc_0_0': 0.9857, 'acc_0_1': 0.4837, 'acc_1_0': 0.6607, 'acc_1_1': 0.9763, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.4592, 'acc_0_0': 0.9872, 'acc_0_1': 0.4592, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.4288, 'acc_0_0': 0.9712, 'acc_0_1': 0.4288, 'acc_1_0': 0.7118, 'acc_1_1': 0.9626, 'mean_acc': 0.7304}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9883, 'acc_0_1': 0.7011, 'acc_1_0': 0.6607, 'acc_1_1': 0.9177, 'mean_acc': 0.9579}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6215, 'acc_0_0': 0.984, 'acc_0_1': 0.6568, 'acc_1_0': 0.6215, 'acc_1_1': 0.9346, 'mean_acc': 0.811}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5652, 'acc_0_0': 0.9877, 'acc_0_1': 0.5652, 'acc_1_0': 0.6964, 'acc_1_1': 0.9697, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.533, 'acc_0_0': 0.9858, 'acc_0_1': 0.533, 'acc_1_0': 0.6199, 'acc_1_1': 0.9533, 'mean_acc': 0.7654}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9957, 'acc_0_1': 0.6739, 'acc_1_0': 0.6429, 'acc_1_1': 0.9584, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5888, 'acc_0_0': 0.9894, 'acc_0_1': 0.6186, 'acc_1_0': 0.5888, 'acc_1_1': 0.9424, 'mean_acc': 0.7955}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9934, 'acc_0_1': 0.6467, 'acc_1_0': 0.6607, 'acc_1_1': 0.9697, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9659, 'worst_acc': 0.5622, 'acc_0_0': 0.9915, 'acc_0_1': 0.5622, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5605, 'acc_0_0': 0.9871, 'acc_0_1': 0.5605, 'acc_1_0': 0.6246, 'acc_1_1': 0.9502, 'mean_acc': 0.7768}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9951, 'acc_0_1': 0.7228, 'acc_1_0': 0.6964, 'acc_1_1': 0.9622, 'mean_acc': 0.9739}
Val(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.6399, 'acc_1_0': 0.6137, 'acc_1_1': 0.9408, 'mean_acc': 0.8058}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9954, 'acc_0_1': 0.7228, 'acc_1_0': 0.7321, 'acc_1_1': 0.9697, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6059, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6059, 'acc_1_1': 0.9393, 'mean_acc': 0.8084}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9951, 'acc_0_1': 0.7011, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.609, 'acc_0_0': 0.9902, 'acc_0_1': 0.6678, 'acc_1_0': 0.609, 'acc_1_1': 0.9377, 'mean_acc': 0.8167}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.7554, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6246, 'acc_1_1': 0.9424, 'mean_acc': 0.8133}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9949, 'acc_0_1': 0.712, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6639, 'acc_1_0': 0.6153, 'acc_1_1': 0.9408, 'mean_acc': 0.8155}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.7663, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6012, 'acc_0_0': 0.988, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9346, 'mean_acc': 0.8208}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9969, 'acc_0_1': 0.7446, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6106, 'acc_0_0': 0.9889, 'acc_0_1': 0.6776, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8202}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.998, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9707, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6776, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8203}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7826, 'acc_0_0': 0.9971, 'acc_0_1': 0.7826, 'acc_1_0': 0.8036, 'acc_1_1': 0.9782, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6012, 'acc_0_0': 0.9894, 'acc_0_1': 0.7073, 'acc_1_0': 0.6012, 'acc_1_1': 0.933, 'mean_acc': 0.8303}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8315, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6433, 'acc_0_0': 0.9876, 'acc_0_1': 0.6763, 'acc_1_0': 0.6433, 'acc_1_1': 0.9393, 'mean_acc': 0.8229}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8587, 'acc_1_0': 0.8036, 'acc_1_1': 0.965, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9667, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.634, 'acc_0_0': 0.9871, 'acc_0_1': 0.6749, 'acc_1_0': 0.634, 'acc_1_1': 0.9439, 'mean_acc': 0.8217}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9957, 'acc_0_1': 0.7446, 'acc_1_0': 0.875, 'acc_1_1': 0.982, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.662, 'acc_0_0': 0.9863, 'acc_0_1': 0.6683, 'acc_1_0': 0.662, 'acc_1_1': 0.9455, 'mean_acc': 0.8221}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.9022, 'acc_1_0': 0.8393, 'acc_1_1': 0.9745, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.6371, 'acc_1_1': 0.9424, 'mean_acc': 0.8246}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6215, 'acc_0_0': 0.988, 'acc_0_1': 0.7073, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9991, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6075, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6075, 'acc_1_1': 0.9393, 'mean_acc': 0.8269}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9989, 'acc_0_1': 0.8641, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6293, 'acc_0_0': 0.9871, 'acc_0_1': 0.6976, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8295}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9701, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6371, 'acc_0_0': 0.988, 'acc_0_1': 0.6568, 'acc_1_0': 0.6371, 'acc_1_1': 0.9502, 'mean_acc': 0.816}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9997, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5919, 'acc_0_0': 0.9916, 'acc_0_1': 0.7676, 'acc_1_0': 0.5919, 'acc_1_1': 0.9299, 'mean_acc': 0.8533}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9565, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.995}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.6223, 'acc_0_0': 0.9872, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6284, 'acc_0_0': 0.9858, 'acc_0_1': 0.6284, 'acc_1_0': 0.6713, 'acc_1_1': 0.9517, 'mean_acc': 0.8081}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9565, 'acc_1_0': 0.9107, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9682, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6324, 'acc_0_0': 0.9898, 'acc_0_1': 0.7184, 'acc_1_0': 0.6324, 'acc_1_1': 0.9361, 'mean_acc': 0.8386}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9565, 'acc_0_0': 1.0, 'acc_0_1': 0.9565, 'acc_1_0': 0.9643, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9649, 'worst_acc': 0.6059, 'acc_0_0': 0.9911, 'acc_0_1': 0.6971, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.8288}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9674, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6695, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.634, 'acc_0_0': 0.9876, 'acc_0_1': 0.6736, 'acc_1_0': 0.634, 'acc_1_1': 0.9486, 'mean_acc': 0.8219}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9674, 'acc_1_0': 0.9643, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.7069, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8338}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9943, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.6475, 'acc_1_0': 0.6153, 'acc_1_1': 0.9486, 'mean_acc': 0.8103}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6293, 'acc_0_0': 0.9898, 'acc_0_1': 0.6945, 'acc_1_0': 0.6293, 'acc_1_1': 0.9408, 'mean_acc': 0.8295}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9821, 'acc_1_1': 0.9991, 'mean_acc': 0.9979}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6277, 'acc_0_0': 0.9894, 'acc_0_1': 0.7392, 'acc_1_0': 0.6277, 'acc_1_1': 0.9361, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 0.9821, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6044, 'acc_0_0': 0.9907, 'acc_0_1': 0.6967, 'acc_1_0': 0.6044, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7468, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5935, 'acc_0_0': 0.9907, 'acc_0_1': 0.7512, 'acc_1_0': 0.5935, 'acc_1_1': 0.9346, 'mean_acc': 0.8473}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 0.9991, 'mean_acc': 0.9994}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6976, 'acc_1_0': 0.6464, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9891, 'acc_0_0': 1.0, 'acc_0_1': 0.9891, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9996}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7029, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8315}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6215, 'acc_0_0': 0.9907, 'acc_0_1': 0.7118, 'acc_1_0': 0.6215, 'acc_1_1': 0.9408, 'mean_acc': 0.8357}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9946, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9998}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6277, 'acc_0_0': 0.9898, 'acc_0_1': 0.7171, 'acc_1_0': 0.6277, 'acc_1_1': 0.9408, 'mean_acc': 0.8381}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6293, 'acc_0_0': 0.9902, 'acc_0_1': 0.6922, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.829}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.4394, 'acc_1_1': 0.9104, 'mean_acc': 0.828}
Val(class)(new adapter): {'weighted_mean_acc': 0.9682, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.824, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.5358, 'acc_0_0': 0.9942, 'acc_0_1': 0.8302, 'acc_1_0': 0.5358, 'acc_1_1': 0.9081, 'mean_acc': 0.87}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0606, 'acc_0_0': 0.9957, 'acc_0_1': 0.2232, 'acc_1_0': 0.0606, 'acc_1_1': 0.791, 'mean_acc': 0.5693}
Val(class)(new adapter): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7811, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.855}
Test(class)(new adapter): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.6262, 'acc_0_0': 0.9907, 'acc_0_1': 0.7787, 'acc_1_0': 0.6262, 'acc_1_1': 0.9283, 'mean_acc': 0.8609}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6818, 'acc_0_0': 0.9828, 'acc_0_1': 0.8412, 'acc_1_0': 0.6818, 'acc_1_1': 0.9701, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.9555, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.8627, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.7025, 'acc_0_0': 0.9845, 'acc_0_1': 0.8506, 'acc_1_0': 0.7025, 'acc_1_1': 0.8956, 'mean_acc': 0.8913}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.3605, 'acc_0_1': 0.9871, 'acc_1_0': 0.0, 'acc_1_1': 0.2687, 'mean_acc': 0.5543}
Val(class)(new adapter): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6567, 'acc_0_0': 0.9744, 'acc_0_1': 0.9399, 'acc_1_0': 0.6567, 'acc_1_1': 0.9091, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.6604, 'acc_0_0': 0.9916, 'acc_0_1': 0.9202, 'acc_1_0': 0.6604, 'acc_1_1': 0.8411, 'mean_acc': 0.9104}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9657, 'acc_0_1': 0.927, 'acc_1_0': 0.7424, 'acc_1_1': 0.9701, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.9828, 'acc_1_0': 0.5522, 'acc_1_1': 0.6667, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.5919, 'acc_0_0': 0.9969, 'acc_0_1': 0.9845, 'acc_1_0': 0.5919, 'acc_1_1': 0.6417, 'mean_acc': 0.9078}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2388, 'acc_0_0': 0.9442, 'acc_0_1': 0.9142, 'acc_1_0': 0.7576, 'acc_1_1': 0.2388, 'mean_acc': 0.8331}
Val(class)(new adapter): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.7761, 'acc_0_0': 0.9744, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9283}
Test(class)(new adapter): {'weighted_mean_acc': 0.9415, 'worst_acc': 0.7539, 'acc_0_0': 0.9831, 'acc_0_1': 0.9543, 'acc_1_0': 0.7539, 'acc_1_1': 0.8115, 'mean_acc': 0.9275}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.7879, 'acc_1_1': 0.9403, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9384, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.8455, 'acc_1_0': 0.806, 'acc_1_1': 0.9697, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9367, 'worst_acc': 0.8275, 'acc_0_0': 0.9472, 'acc_0_1': 0.8275, 'acc_1_0': 0.852, 'acc_1_1': 0.9252, 'mean_acc': 0.8876}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.9614, 'acc_0_1': 0.9056, 'acc_1_0': 0.8485, 'acc_1_1': 0.6567, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.8896, 'worst_acc': 0.6695, 'acc_0_0': 0.8718, 'acc_0_1': 0.6695, 'acc_1_0': 0.9254, 'acc_1_1': 0.9848, 'mean_acc': 0.8117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8748, 'worst_acc': 0.6625, 'acc_0_0': 0.859, 'acc_0_1': 0.6625, 'acc_1_0': 0.905, 'acc_1_1': 0.9626, 'mean_acc': 0.7991}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9785, 'acc_0_1': 0.927, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.8427, 'worst_acc': 0.6609, 'acc_0_0': 0.8077, 'acc_0_1': 0.6609, 'acc_1_0': 0.9403, 'acc_1_1': 0.9848, 'mean_acc': 0.785}
Test(class)(new adapter): {'weighted_mean_acc': 0.8123, 'worst_acc': 0.6616, 'acc_0_0': 0.7721, 'acc_0_1': 0.6616, 'acc_1_0': 0.9283, 'acc_1_1': 0.9657, 'mean_acc': 0.7679}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9013, 'acc_0_1': 0.9485, 'acc_1_0': 0.9697, 'acc_1_1': 0.8657, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.8623, 'worst_acc': 0.7768, 'acc_0_0': 0.8376, 'acc_0_1': 0.7768, 'acc_1_0': 0.9403, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.8421, 'worst_acc': 0.7627, 'acc_0_0': 0.8186, 'acc_0_1': 0.7627, 'acc_1_0': 0.9159, 'acc_1_1': 0.9299, 'mean_acc': 0.82}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9403, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.8455, 'acc_0_0': 0.8889, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8766, 'worst_acc': 0.851, 'acc_0_0': 0.8754, 'acc_0_1': 0.851, 'acc_1_0': 0.8801, 'acc_1_1': 0.8847, 'mean_acc': 0.8674}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9485, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.8712, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.8489, 'acc_0_0': 0.9126, 'acc_0_1': 0.9007, 'acc_1_0': 0.8567, 'acc_1_1': 0.8489, 'mean_acc': 0.8947}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9254, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.8396, 'acc_0_0': 0.9277, 'acc_0_1': 0.9091, 'acc_1_0': 0.8442, 'acc_1_1': 0.8396, 'mean_acc': 0.9014}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9657, 'acc_0_1': 0.9957, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.6716, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.6716, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.8178, 'acc_0_0': 0.941, 'acc_0_1': 0.9193, 'acc_1_0': 0.8178, 'acc_1_1': 0.824, 'mean_acc': 0.9059}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9552, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.6866, 'acc_0_0': 0.9274, 'acc_0_1': 0.897, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.8115, 'acc_0_0': 0.9419, 'acc_0_1': 0.9197, 'acc_1_0': 0.8115, 'acc_1_1': 0.8162, 'mean_acc': 0.9049}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.8069, 'acc_0_0': 0.9366, 'acc_0_1': 0.9166, 'acc_1_0': 0.8162, 'acc_1_1': 0.8069, 'mean_acc': 0.9011}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9552, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8882, 'worst_acc': 0.791, 'acc_0_0': 0.8974, 'acc_0_1': 0.8841, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.8255, 'acc_0_0': 0.9237, 'acc_0_1': 0.9042, 'acc_1_0': 0.8411, 'acc_1_1': 0.8255, 'mean_acc': 0.8961}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.806, 'acc_0_0': 0.9017, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.8442, 'acc_0_0': 0.9104, 'acc_0_1': 0.8927, 'acc_1_0': 0.8536, 'acc_1_1': 0.8442, 'mean_acc': 0.8899}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.8209, 'acc_0_0': 0.8974, 'acc_0_1': 0.8712, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.896, 'worst_acc': 0.8567, 'acc_0_0': 0.9091, 'acc_0_1': 0.8803, 'acc_1_0': 0.8692, 'acc_1_1': 0.8567, 'mean_acc': 0.8876}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.8209, 'acc_0_0': 0.8974, 'acc_0_1': 0.867, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8551, 'acc_0_0': 0.9086, 'acc_0_1': 0.8798, 'acc_1_0': 0.8723, 'acc_1_1': 0.8551, 'mean_acc': 0.8875}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8209, 'acc_0_0': 0.8974, 'acc_0_1': 0.8884, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8933, 'worst_acc': 0.838, 'acc_0_0': 0.9104, 'acc_0_1': 0.8936, 'acc_1_0': 0.8645, 'acc_1_1': 0.838, 'mean_acc': 0.8907}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.896, 'worst_acc': 0.8115, 'acc_0_0': 0.9215, 'acc_0_1': 0.91, 'acc_1_0': 0.8489, 'acc_1_1': 0.8115, 'mean_acc': 0.8968}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8948, 'worst_acc': 0.7913, 'acc_0_0': 0.9255, 'acc_0_1': 0.9233, 'acc_1_0': 0.8349, 'acc_1_1': 0.7913, 'mean_acc': 0.8997}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8965, 'worst_acc': 0.7679, 'acc_0_0': 0.9344, 'acc_0_1': 0.937, 'acc_1_0': 0.8209, 'acc_1_1': 0.7679, 'mean_acc': 0.9044}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.7601, 'acc_0_0': 0.9401, 'acc_0_1': 0.9419, 'acc_1_0': 0.8022, 'acc_1_1': 0.7601, 'mean_acc': 0.9056}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7539, 'acc_0_0': 0.945, 'acc_0_1': 0.9463, 'acc_1_0': 0.7928, 'acc_1_1': 0.7539, 'mean_acc': 0.9075}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7461, 'acc_0_0': 0.9494, 'acc_0_1': 0.9481, 'acc_1_0': 0.7866, 'acc_1_1': 0.7461, 'mean_acc': 0.9084}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.7586, 'acc_0_0': 0.9494, 'acc_0_1': 0.9455, 'acc_1_0': 0.7819, 'acc_1_1': 0.7586, 'mean_acc': 0.9082}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.7632, 'acc_0_0': 0.9494, 'acc_0_1': 0.9441, 'acc_1_0': 0.7866, 'acc_1_1': 0.7632, 'mean_acc': 0.9087}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.771, 'acc_0_0': 0.9521, 'acc_0_1': 0.9424, 'acc_1_0': 0.7835, 'acc_1_1': 0.771, 'mean_acc': 0.9096}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7773, 'acc_0_0': 0.9534, 'acc_0_1': 0.9388, 'acc_1_0': 0.7773, 'acc_1_1': 0.785, 'mean_acc': 0.9096}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7804, 'acc_0_0': 0.9548, 'acc_0_1': 0.9348, 'acc_1_0': 0.7804, 'acc_1_1': 0.7991, 'mean_acc': 0.9104}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7804, 'acc_0_0': 0.9552, 'acc_0_1': 0.9295, 'acc_1_0': 0.7804, 'acc_1_1': 0.8053, 'mean_acc': 0.9092}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7788, 'acc_0_0': 0.9557, 'acc_0_1': 0.9251, 'acc_1_0': 0.7788, 'acc_1_1': 0.81, 'mean_acc': 0.908}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.7804, 'acc_0_0': 0.9548, 'acc_0_1': 0.9202, 'acc_1_0': 0.7804, 'acc_1_1': 0.8209, 'mean_acc': 0.9071}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.7788, 'acc_0_0': 0.9552, 'acc_0_1': 0.9202, 'acc_1_0': 0.7788, 'acc_1_1': 0.8224, 'mean_acc': 0.9073}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9204, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7773, 'acc_0_0': 0.957, 'acc_0_1': 0.9215, 'acc_1_0': 0.7773, 'acc_1_1': 0.8209, 'mean_acc': 0.9082}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7804, 'acc_0_0': 0.9561, 'acc_0_1': 0.9197, 'acc_1_0': 0.7804, 'acc_1_1': 0.8209, 'mean_acc': 0.9075}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7819, 'acc_0_0': 0.9552, 'acc_0_1': 0.9193, 'acc_1_0': 0.7819, 'acc_1_1': 0.8255, 'mean_acc': 0.9077}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7866, 'acc_0_0': 0.9543, 'acc_0_1': 0.9135, 'acc_1_0': 0.7866, 'acc_1_1': 0.8271, 'mean_acc': 0.9058}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.7819, 'acc_0_0': 0.9561, 'acc_0_1': 0.9193, 'acc_1_0': 0.7819, 'acc_1_1': 0.8193, 'mean_acc': 0.9073}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.7788, 'acc_0_0': 0.9561, 'acc_0_1': 0.9211, 'acc_1_0': 0.7788, 'acc_1_1': 0.8193, 'mean_acc': 0.9077}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7741, 'acc_0_0': 0.9574, 'acc_0_1': 0.9251, 'acc_1_0': 0.7741, 'acc_1_1': 0.8178, 'mean_acc': 0.909}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7741, 'acc_0_0': 0.9565, 'acc_0_1': 0.9251, 'acc_1_0': 0.7741, 'acc_1_1': 0.8178, 'mean_acc': 0.9087}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7773, 'acc_0_0': 0.9561, 'acc_0_1': 0.9246, 'acc_1_0': 0.7773, 'acc_1_1': 0.8178, 'mean_acc': 0.9087}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7741, 'acc_0_0': 0.9579, 'acc_0_1': 0.9277, 'acc_1_0': 0.7741, 'acc_1_1': 0.8131, 'mean_acc': 0.9097}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7773, 'acc_0_0': 0.957, 'acc_0_1': 0.9259, 'acc_1_0': 0.7773, 'acc_1_1': 0.8146, 'mean_acc': 0.9092}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7773, 'acc_0_0': 0.957, 'acc_0_1': 0.9268, 'acc_1_0': 0.7773, 'acc_1_1': 0.81, 'mean_acc': 0.909}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7819, 'acc_0_0': 0.9548, 'acc_0_1': 0.9259, 'acc_1_0': 0.7819, 'acc_1_1': 0.8146, 'mean_acc': 0.9089}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.7835, 'acc_0_0': 0.9534, 'acc_0_1': 0.9255, 'acc_1_0': 0.7835, 'acc_1_1': 0.8146, 'mean_acc': 0.9084}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7804, 'acc_0_0': 0.9539, 'acc_0_1': 0.9264, 'acc_1_0': 0.7804, 'acc_1_1': 0.8146, 'mean_acc': 0.9085}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9204, 'worst_acc': 0.7835, 'acc_0_0': 0.9539, 'acc_0_1': 0.9242, 'acc_1_0': 0.7835, 'acc_1_1': 0.8162, 'mean_acc': 0.9082}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7773, 'acc_0_0': 0.9574, 'acc_0_1': 0.9273, 'acc_1_0': 0.7773, 'acc_1_1': 0.81, 'mean_acc': 0.9094}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7757, 'acc_0_0': 0.9588, 'acc_0_1': 0.9273, 'acc_1_0': 0.7757, 'acc_1_1': 0.81, 'mean_acc': 0.9097}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7773, 'acc_0_0': 0.9583, 'acc_0_1': 0.9255, 'acc_1_0': 0.7773, 'acc_1_1': 0.8146, 'mean_acc': 0.9096}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7757, 'acc_0_0': 0.9592, 'acc_0_1': 0.9273, 'acc_1_0': 0.7757, 'acc_1_1': 0.8115, 'mean_acc': 0.9101}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7804, 'acc_0_0': 0.9561, 'acc_0_1': 0.9255, 'acc_1_0': 0.7804, 'acc_1_1': 0.8146, 'mean_acc': 0.909}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7819, 'acc_0_0': 0.9548, 'acc_0_1': 0.9264, 'acc_1_0': 0.7819, 'acc_1_1': 0.81, 'mean_acc': 0.9085}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7804, 'acc_0_0': 0.9557, 'acc_0_1': 0.9251, 'acc_1_0': 0.7804, 'acc_1_1': 0.8146, 'mean_acc': 0.9087}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7804, 'acc_0_0': 0.9548, 'acc_0_1': 0.9264, 'acc_1_0': 0.7804, 'acc_1_1': 0.8115, 'mean_acc': 0.9085}
========================================================================
> end of training. 

best epoch : 51
best training accuracy on [class]: {'worst_acc': 0.9091, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9403, 'mean_acc': 0.9733}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8979, 'worst_acc': 0.8455, 'acc_0_0': 0.8889, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8733}
best test accuracy on [class]: {'weighted_mean_acc': 0.8766, 'worst_acc': 0.851, 'acc_0_0': 0.8754, 'acc_0_1': 0.851, 'acc_1_0': 0.8801, 'acc_1_1': 0.8847, 'mean_acc': 0.8674}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8766, 'worst_acc': 0.851, 'acc_0_0': 0.8754, 'acc_0_1': 0.851, 'acc_1_0': 0.8801, 'acc_1_1': 0.8847, 'mean_acc': 0.8674}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.7134, 'acc_0_0': 0.9641, 'acc_0_1': 0.941, 'acc_1_0': 0.7134, 'acc_1_1': 0.986, 'mean_acc': 0.9298}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 51': {'Train': {'worst_acc': 0.9091, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9403, 'mean_acc': 0.9733}, 'Val': {'weighted_mean_acc': 0.8979, 'worst_acc': 0.8455, 'acc_0_0': 0.8889, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.8733}, 'Test': {'weighted_mean_acc': 0.8766, 'worst_acc': 0.851, 'acc_0_0': 0.8754, 'acc_0_1': 0.851, 'acc_1_0': 0.8801, 'acc_1_1': 0.8847, 'mean_acc': 0.8674}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8766, 'worst_acc': 0.851, 'acc_0_0': 0.8754, 'acc_0_1': 0.851, 'acc_1_0': 0.8801, 'acc_1_1': 0.8847, 'mean_acc': 0.8674}, 'spurious': {'weighted_mean_acc': 0.9651, 'worst_acc': 0.7134, 'acc_0_0': 0.9641, 'acc_0_1': 0.941, 'acc_1_0': 0.7134, 'acc_1_1': 0.986, 'mean_acc': 0.9298}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.3859, 'acc_0_0': 0.9483, 'acc_0_1': 0.3859, 'acc_1_0': 0.4286, 'acc_1_1': 0.7739, 'mean_acc': 0.8822}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.3433, 'acc_0_0': 0.9957, 'acc_0_1': 0.4592, 'acc_1_0': 0.3433, 'acc_1_1': 0.9697, 'mean_acc': 0.7117}
Test(class): {'weighted_mean_acc': 0.9539, 'worst_acc': 0.2804, 'acc_0_0': 0.9982, 'acc_0_1': 0.4182, 'acc_1_0': 0.2804, 'acc_1_1': 0.9361, 'mean_acc': 0.6861}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4286, 'acc_0_0': 0.9883, 'acc_0_1': 0.4946, 'acc_1_0': 0.4286, 'acc_1_1': 0.9413, 'mean_acc': 0.9525}
Val(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.2661, 'acc_0_0': 0.9573, 'acc_0_1': 0.2661, 'acc_1_0': 0.7313, 'acc_1_1': 1.0, 'mean_acc': 0.6683}
Test(class): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.2213, 'acc_0_0': 0.9503, 'acc_0_1': 0.2213, 'acc_1_0': 0.7523, 'acc_1_1': 0.9798, 'mean_acc': 0.6479}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9886, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.8855, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5751, 'acc_0_0': 0.9872, 'acc_0_1': 0.5751, 'acc_1_0': 0.7164, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.5357, 'acc_0_0': 0.9756, 'acc_0_1': 0.5357, 'acc_1_0': 0.6947, 'acc_1_1': 0.9455, 'mean_acc': 0.7699}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9823, 'acc_0_1': 0.6957, 'acc_1_0': 0.6607, 'acc_1_1': 0.9413, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5075, 'acc_0_0': 0.9957, 'acc_0_1': 0.7639, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.5312, 'acc_0_0': 0.9956, 'acc_0_1': 0.7388, 'acc_1_0': 0.5312, 'acc_1_1': 0.9065, 'mean_acc': 0.8343}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.663, 'acc_1_0': 0.5893, 'acc_1_1': 0.9442, 'mean_acc': 0.9658}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.7833}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5743, 'acc_0_0': 0.9929, 'acc_0_1': 0.5743, 'acc_1_0': 0.5763, 'acc_1_1': 0.9455, 'mean_acc': 0.7786}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9949, 'acc_0_1': 0.6739, 'acc_1_0': 0.5536, 'acc_1_1': 0.9461, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.5639, 'acc_0_0': 0.9938, 'acc_0_1': 0.6142, 'acc_1_0': 0.5639, 'acc_1_1': 0.9361, 'mean_acc': 0.792}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9943, 'acc_0_1': 0.6522, 'acc_1_0': 0.5893, 'acc_1_1': 0.9574, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.5779, 'acc_0_0': 0.9933, 'acc_0_1': 0.6217, 'acc_1_0': 0.5779, 'acc_1_1': 0.9408, 'mean_acc': 0.7969}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9963, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9451, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6438, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6059, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6059, 'acc_1_1': 0.9439, 'mean_acc': 0.7994}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9949, 'acc_0_1': 0.7446, 'acc_1_0': 0.625, 'acc_1_1': 0.9499, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6031, 'acc_0_0': 0.9916, 'acc_0_1': 0.6031, 'acc_1_0': 0.6184, 'acc_1_1': 0.9486, 'mean_acc': 0.7943}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9546, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5373, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5826, 'acc_0_0': 0.9938, 'acc_0_1': 0.6545, 'acc_1_0': 0.5826, 'acc_1_1': 0.9393, 'mean_acc': 0.8101}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9951, 'acc_0_1': 0.7446, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5483, 'acc_0_0': 0.9956, 'acc_0_1': 0.7268, 'acc_1_0': 0.5483, 'acc_1_1': 0.9283, 'mean_acc': 0.834}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.996, 'acc_0_1': 0.75, 'acc_1_0': 0.6429, 'acc_1_1': 0.9555, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.5654, 'acc_0_0': 0.9942, 'acc_0_1': 0.6927, 'acc_1_0': 0.5654, 'acc_1_1': 0.9377, 'mean_acc': 0.8231}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.6429, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.6896, 'acc_1_0': 0.5794, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.7826, 'acc_1_0': 0.6786, 'acc_1_1': 0.9697, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.5075, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.567, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.567, 'acc_1_1': 0.9393, 'mean_acc': 0.8278}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9977, 'acc_0_1': 0.7989, 'acc_1_0': 0.6786, 'acc_1_1': 0.964, 'mean_acc': 0.9789}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6352, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6004, 'acc_0_0': 0.9894, 'acc_0_1': 0.6004, 'acc_1_0': 0.6153, 'acc_1_1': 0.9455, 'mean_acc': 0.7917}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7854, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.5607, 'acc_0_0': 0.9942, 'acc_0_1': 0.761, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8483}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9966, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7086, 'acc_1_0': 0.5654, 'acc_1_1': 0.9346, 'mean_acc': 0.8288}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9991, 'acc_0_1': 0.8859, 'acc_1_0': 0.7679, 'acc_1_1': 0.9584, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6075, 'acc_0_0': 0.9925, 'acc_0_1': 0.6177, 'acc_1_0': 0.6075, 'acc_1_1': 0.947, 'mean_acc': 0.7989}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.983, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9942, 'acc_0_1': 0.7933, 'acc_1_0': 0.5545, 'acc_1_1': 0.919, 'mean_acc': 0.859}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.8214, 'acc_1_1': 0.983, 'mean_acc': 0.9881}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4925, 'acc_0_0': 0.9915, 'acc_0_1': 0.7682, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5654, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5654, 'acc_1_1': 0.9206, 'mean_acc': 0.8533}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.8967, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5672, 'acc_0_0': 0.9872, 'acc_0_1': 0.7425, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6044, 'acc_0_0': 0.9911, 'acc_0_1': 0.733, 'acc_1_0': 0.6044, 'acc_1_1': 0.9346, 'mean_acc': 0.8416}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.8929, 'acc_1_1': 0.9763, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6119, 'acc_0_0': 0.9786, 'acc_0_1': 0.6395, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5981, 'acc_0_0': 0.9925, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9502, 'mean_acc': 0.8098}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9896, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.7983, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5748, 'acc_0_0': 0.9938, 'acc_0_1': 0.8231, 'acc_1_0': 0.5748, 'acc_1_1': 0.9065, 'mean_acc': 0.8712}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.9076, 'acc_1_0': 0.8571, 'acc_1_1': 0.9886, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.6867, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6106, 'acc_0_0': 0.9894, 'acc_0_1': 0.6927, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9868, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6119, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6215, 'acc_0_0': 0.9894, 'acc_0_1': 0.7282, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.841}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9989, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.9962, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6044, 'acc_0_0': 0.9894, 'acc_0_1': 0.7548, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8485}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9991, 'acc_0_1': 0.9185, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6215, 'acc_0_0': 0.9876, 'acc_0_1': 0.7042, 'acc_1_0': 0.6215, 'acc_1_1': 0.9377, 'mean_acc': 0.8312}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9915, 'mean_acc': 0.9948}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7255, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8397}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9994, 'acc_0_1': 0.9402, 'acc_1_0': 0.9107, 'acc_1_1': 0.9953, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9732, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.5623, 'acc_0_0': 0.9956, 'acc_0_1': 0.7437, 'acc_1_0': 0.5623, 'acc_1_1': 0.9268, 'mean_acc': 0.8419}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.9022, 'acc_1_0': 0.8929, 'acc_1_1': 0.9915, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.7339, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6355, 'acc_0_0': 0.9854, 'acc_0_1': 0.745, 'acc_1_0': 0.6355, 'acc_1_1': 0.919, 'mean_acc': 0.8457}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9956}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.6269, 'acc_0_0': 0.9744, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6573, 'acc_0_0': 0.9867, 'acc_0_1': 0.6962, 'acc_1_0': 0.6573, 'acc_1_1': 0.9361, 'mean_acc': 0.8315}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.9286, 'acc_1_1': 0.9905, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6781, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6324, 'acc_0_0': 0.9867, 'acc_0_1': 0.6914, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.8272}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9674, 'acc_1_0': 0.9464, 'acc_1_1': 0.9943, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.721, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6199, 'acc_0_0': 0.9925, 'acc_0_1': 0.7499, 'acc_1_0': 0.6199, 'acc_1_1': 0.9252, 'mean_acc': 0.8493}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9286, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9286, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5966, 'acc_0_0': 0.9744, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.5863, 'acc_0_0': 0.9778, 'acc_0_1': 0.5863, 'acc_1_0': 0.6636, 'acc_1_1': 0.9517, 'mean_acc': 0.7877}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.7752, 'acc_1_0': 0.609, 'acc_1_1': 0.9206, 'mean_acc': 0.8567}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 0.9464, 'acc_1_1': 0.9962, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.597, 'acc_0_0': 0.9786, 'acc_0_1': 0.6609, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6542, 'acc_0_0': 0.9836, 'acc_0_1': 0.6625, 'acc_1_0': 0.6542, 'acc_1_1': 0.9439, 'mean_acc': 0.8177}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9997, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9981, 'mean_acc': 0.9977}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5623, 'acc_0_0': 0.9969, 'acc_0_1': 0.8284, 'acc_1_0': 0.5623, 'acc_1_1': 0.905, 'mean_acc': 0.873}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 1.0, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9972, 'mean_acc': 0.9983}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6352, 'acc_0_0': 0.9829, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.6381, 'acc_0_0': 0.9796, 'acc_0_1': 0.6381, 'acc_1_0': 0.6573, 'acc_1_1': 0.9533, 'mean_acc': 0.8081}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9821, 'acc_0_0': 1.0, 'acc_0_1': 0.9837, 'acc_1_0': 0.9821, 'acc_1_1': 1.0, 'mean_acc': 0.9992}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.7344, 'acc_1_0': 0.6277, 'acc_1_1': 0.9299, 'mean_acc': 0.8426}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 1.0, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9981, 'mean_acc': 0.999}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6542, 'acc_0_0': 0.9858, 'acc_0_1': 0.7007, 'acc_1_0': 0.6542, 'acc_1_1': 0.9408, 'mean_acc': 0.8331}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9914, 'acc_0_1': 0.7725, 'acc_1_0': 0.4394, 'acc_1_1': 0.9403, 'mean_acc': 0.8397}
Val(class)(new adapter): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7554, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6153, 'acc_0_0': 0.9916, 'acc_0_1': 0.7752, 'acc_1_0': 0.6153, 'acc_1_1': 0.9206, 'mean_acc': 0.8578}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0909, 'acc_0_0': 0.9871, 'acc_0_1': 0.1202, 'acc_1_0': 0.0909, 'acc_1_1': 0.8806, 'mean_acc': 0.5392}
Val(class)(new adapter): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6269, 'acc_0_0': 0.9786, 'acc_0_1': 0.7425, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class)(new adapter): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6729, 'acc_0_0': 0.9889, 'acc_0_1': 0.7676, 'acc_1_0': 0.6729, 'acc_1_1': 0.9252, 'mean_acc': 0.8607}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9871, 'acc_0_1': 0.9013, 'acc_1_0': 0.6061, 'acc_1_1': 0.8806, 'mean_acc': 0.8998}
Val(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.7164, 'acc_0_0': 0.9573, 'acc_0_1': 0.7983, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.9498, 'worst_acc': 0.7695, 'acc_0_0': 0.9756, 'acc_0_1': 0.8169, 'acc_1_0': 0.7695, 'acc_1_1': 0.8972, 'mean_acc': 0.8823}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0455, 'acc_0_0': 0.4979, 'acc_0_1': 1.0, 'acc_1_0': 0.0455, 'acc_1_1': 0.1642, 'mean_acc': 0.606}
Val(class)(new adapter): {'weighted_mean_acc': 0.946, 'worst_acc': 0.7313, 'acc_0_0': 0.9615, 'acc_0_1': 0.8412, 'acc_1_0': 0.7313, 'acc_1_1': 0.9242, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.7664, 'acc_0_0': 0.9756, 'acc_0_1': 0.8528, 'acc_1_0': 0.7664, 'acc_1_1': 0.8801, 'mean_acc': 0.894}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9914, 'acc_0_1': 0.9313, 'acc_1_0': 0.6667, 'acc_1_1': 0.8955, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.7761, 'acc_0_0': 0.9615, 'acc_0_1': 0.8798, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9452, 'worst_acc': 0.7944, 'acc_0_0': 0.9698, 'acc_0_1': 0.8692, 'acc_1_0': 0.7944, 'acc_1_1': 0.8847, 'mean_acc': 0.9018}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3433, 'acc_0_0': 0.9571, 'acc_0_1': 0.9056, 'acc_1_0': 0.7424, 'acc_1_1': 0.3433, 'mean_acc': 0.8447}
Val(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.7425, 'acc_0_0': 0.9274, 'acc_0_1': 0.7425, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7596, 'acc_0_0': 0.9313, 'acc_0_1': 0.7596, 'acc_1_0': 0.8707, 'acc_1_1': 0.9361, 'mean_acc': 0.8583}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8197, 'acc_0_0': 0.9528, 'acc_0_1': 0.8197, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.8948}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8657, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8567, 'acc_0_0': 0.9463, 'acc_0_1': 0.9104, 'acc_1_0': 0.8629, 'acc_1_1': 0.8567, 'mean_acc': 0.9132}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.597, 'acc_0_0': 0.9442, 'acc_0_1': 0.927, 'acc_1_0': 0.8788, 'acc_1_1': 0.597, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.8485, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.8657, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.7523, 'acc_0_0': 0.9361, 'acc_0_1': 0.9574, 'acc_1_0': 0.8723, 'acc_1_1': 0.7523, 'mean_acc': 0.917}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9742, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.8657, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.8756, 'worst_acc': 0.8485, 'acc_0_0': 0.8803, 'acc_0_1': 0.9442, 'acc_1_0': 0.8657, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8658, 'worst_acc': 0.7757, 'acc_0_0': 0.8882, 'acc_0_1': 0.9494, 'acc_1_0': 0.8879, 'acc_1_1': 0.7757, 'mean_acc': 0.8996}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9356, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.7313, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.8649, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8927, 'acc_1_0': 0.8657, 'acc_1_1': 0.8939, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8401, 'worst_acc': 0.8337, 'acc_0_0': 0.8337, 'acc_0_1': 0.8993, 'acc_1_0': 0.905, 'acc_1_1': 0.8474, 'mean_acc': 0.8687}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.9403, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8446, 'worst_acc': 0.8162, 'acc_0_0': 0.8162, 'acc_0_1': 0.8326, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class)(new adapter): {'weighted_mean_acc': 0.8277, 'worst_acc': 0.8044, 'acc_0_0': 0.8044, 'acc_0_1': 0.8457, 'acc_1_0': 0.9128, 'acc_1_1': 0.8972, 'mean_acc': 0.8428}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9399, 'acc_0_1': 0.9742, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.8358, 'acc_0_0': 0.8803, 'acc_0_1': 0.8627, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.8603, 'acc_0_0': 0.8891, 'acc_0_1': 0.8603, 'acc_1_0': 0.8769, 'acc_1_1': 0.891, 'mean_acc': 0.8768}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.8255, 'acc_0_0': 0.9477, 'acc_0_1': 0.9016, 'acc_1_0': 0.8255, 'acc_1_1': 0.866, 'mean_acc': 0.9071}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9957, 'acc_0_1': 0.9442, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8162, 'acc_0_0': 0.9472, 'acc_0_1': 0.9166, 'acc_1_0': 0.8162, 'acc_1_1': 0.8302, 'mean_acc': 0.9078}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.806, 'acc_0_0': 0.8974, 'acc_0_1': 0.9356, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.8255, 'acc_0_0': 0.9149, 'acc_0_1': 0.9175, 'acc_1_0': 0.8489, 'acc_1_1': 0.8255, 'mean_acc': 0.8987}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 0.9742, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8719, 'worst_acc': 0.8209, 'acc_0_0': 0.8675, 'acc_0_1': 0.9313, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8621, 'worst_acc': 0.8069, 'acc_0_0': 0.8758, 'acc_0_1': 0.9153, 'acc_1_0': 0.8738, 'acc_1_1': 0.8069, 'mean_acc': 0.8833}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.8689, 'worst_acc': 0.8358, 'acc_0_0': 0.8547, 'acc_0_1': 0.9185, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8379, 'worst_acc': 0.8037, 'acc_0_0': 0.8439, 'acc_0_1': 0.906, 'acc_1_0': 0.8816, 'acc_1_1': 0.8037, 'mean_acc': 0.8678}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9485, 'acc_0_0': 0.9485, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8656, 'worst_acc': 0.8358, 'acc_0_0': 0.8547, 'acc_0_1': 0.9185, 'acc_1_0': 0.8358, 'acc_1_1': 0.8939, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.841, 'worst_acc': 0.8037, 'acc_0_0': 0.8483, 'acc_0_1': 0.906, 'acc_1_0': 0.8738, 'acc_1_1': 0.8037, 'mean_acc': 0.8687}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8839, 'worst_acc': 0.791, 'acc_0_0': 0.8803, 'acc_0_1': 0.9227, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8643, 'worst_acc': 0.7975, 'acc_0_0': 0.8825, 'acc_0_1': 0.9051, 'acc_1_0': 0.8536, 'acc_1_1': 0.7975, 'mean_acc': 0.8787}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8851, 'worst_acc': 0.8022, 'acc_0_0': 0.91, 'acc_0_1': 0.9122, 'acc_1_0': 0.8084, 'acc_1_1': 0.8022, 'mean_acc': 0.8876}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8965, 'worst_acc': 0.7975, 'acc_0_0': 0.9233, 'acc_0_1': 0.9135, 'acc_1_0': 0.7975, 'acc_1_1': 0.81, 'mean_acc': 0.893}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7975, 'acc_0_0': 0.929, 'acc_0_1': 0.9118, 'acc_1_0': 0.7975, 'acc_1_1': 0.8162, 'mean_acc': 0.8952}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.8069, 'acc_0_0': 0.9273, 'acc_0_1': 0.8993, 'acc_1_0': 0.8069, 'acc_1_1': 0.8271, 'mean_acc': 0.892}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.8193, 'acc_0_0': 0.9233, 'acc_0_1': 0.8971, 'acc_1_0': 0.8193, 'acc_1_1': 0.8333, 'mean_acc': 0.8916}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.824, 'acc_0_0': 0.9211, 'acc_0_1': 0.8962, 'acc_1_0': 0.824, 'acc_1_1': 0.8349, 'mean_acc': 0.8911}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8948, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.897, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.8115, 'acc_0_0': 0.9313, 'acc_0_1': 0.9069, 'acc_1_0': 0.8115, 'acc_1_1': 0.8271, 'mean_acc': 0.897}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.8006, 'acc_0_0': 0.9348, 'acc_0_1': 0.9091, 'acc_1_0': 0.8006, 'acc_1_1': 0.8162, 'mean_acc': 0.8968}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.796, 'acc_0_0': 0.9353, 'acc_0_1': 0.9175, 'acc_1_0': 0.796, 'acc_1_1': 0.8069, 'mean_acc': 0.8987}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7866, 'acc_0_0': 0.9375, 'acc_0_1': 0.9215, 'acc_1_0': 0.7866, 'acc_1_1': 0.7897, 'mean_acc': 0.8982}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.7897, 'acc_0_0': 0.9366, 'acc_0_1': 0.9193, 'acc_1_0': 0.7928, 'acc_1_1': 0.7897, 'mean_acc': 0.8977}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8999, 'worst_acc': 0.7897, 'acc_0_0': 0.9339, 'acc_0_1': 0.918, 'acc_1_0': 0.7944, 'acc_1_1': 0.7897, 'mean_acc': 0.8963}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7835, 'acc_0_0': 0.9339, 'acc_0_1': 0.9188, 'acc_1_0': 0.7944, 'acc_1_1': 0.7835, 'mean_acc': 0.8959}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.785, 'acc_0_0': 0.9335, 'acc_0_1': 0.9202, 'acc_1_0': 0.7897, 'acc_1_1': 0.785, 'mean_acc': 0.8959}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8916, 'worst_acc': 0.7612, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.785, 'acc_0_0': 0.9348, 'acc_0_1': 0.9193, 'acc_1_0': 0.7928, 'acc_1_1': 0.785, 'mean_acc': 0.8964}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8952, 'worst_acc': 0.7463, 'acc_0_0': 0.9103, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7757, 'acc_0_0': 0.9397, 'acc_0_1': 0.9237, 'acc_1_0': 0.7804, 'acc_1_1': 0.7757, 'mean_acc': 0.8977}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9015, 'worst_acc': 0.771, 'acc_0_0': 0.9415, 'acc_0_1': 0.9304, 'acc_1_0': 0.7773, 'acc_1_1': 0.771, 'mean_acc': 0.9001}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.771, 'acc_0_0': 0.9437, 'acc_0_1': 0.9304, 'acc_1_0': 0.7773, 'acc_1_1': 0.771, 'mean_acc': 0.9009}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.7695, 'acc_0_0': 0.9463, 'acc_0_1': 0.9322, 'acc_1_0': 0.771, 'acc_1_1': 0.7695, 'mean_acc': 0.9018}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8916, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7664, 'acc_0_0': 0.9477, 'acc_0_1': 0.9344, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9025}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7695, 'acc_0_0': 0.9455, 'acc_0_1': 0.9322, 'acc_1_0': 0.7726, 'acc_1_1': 0.7695, 'mean_acc': 0.9016}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.7679, 'acc_0_0': 0.9463, 'acc_0_1': 0.9353, 'acc_1_0': 0.771, 'acc_1_1': 0.7679, 'mean_acc': 0.9028}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7679, 'acc_0_0': 0.9459, 'acc_0_1': 0.9344, 'acc_1_0': 0.7726, 'acc_1_1': 0.7679, 'mean_acc': 0.9025}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.771, 'acc_0_0': 0.9446, 'acc_0_1': 0.9313, 'acc_1_0': 0.7757, 'acc_1_1': 0.771, 'mean_acc': 0.9014}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.771, 'acc_0_0': 0.9446, 'acc_0_1': 0.9304, 'acc_1_0': 0.7757, 'acc_1_1': 0.771, 'mean_acc': 0.9011}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7695, 'acc_0_0': 0.9446, 'acc_0_1': 0.9326, 'acc_1_0': 0.7726, 'acc_1_1': 0.7695, 'mean_acc': 0.9014}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8886, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7695, 'acc_0_0': 0.9455, 'acc_0_1': 0.933, 'acc_1_0': 0.7757, 'acc_1_1': 0.7695, 'mean_acc': 0.9023}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7679, 'acc_0_0': 0.945, 'acc_0_1': 0.9339, 'acc_1_0': 0.7726, 'acc_1_1': 0.7679, 'mean_acc': 0.902}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7632, 'acc_0_0': 0.9477, 'acc_0_1': 0.9357, 'acc_1_0': 0.7632, 'acc_1_1': 0.7679, 'mean_acc': 0.9027}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8914, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7695, 'acc_0_0': 0.9472, 'acc_0_1': 0.933, 'acc_1_0': 0.7695, 'acc_1_1': 0.771, 'mean_acc': 0.9025}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8916, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.7695, 'acc_0_0': 0.9459, 'acc_0_1': 0.9335, 'acc_1_0': 0.7726, 'acc_1_1': 0.7695, 'mean_acc': 0.9023}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8917, 'worst_acc': 0.7463, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7695, 'acc_0_0': 0.9455, 'acc_0_1': 0.9335, 'acc_1_0': 0.771, 'acc_1_1': 0.7695, 'mean_acc': 0.902}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.771, 'acc_0_0': 0.9437, 'acc_0_1': 0.9317, 'acc_1_0': 0.7757, 'acc_1_1': 0.771, 'mean_acc': 0.9013}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.771, 'acc_0_0': 0.9441, 'acc_0_1': 0.9326, 'acc_1_0': 0.7757, 'acc_1_1': 0.771, 'mean_acc': 0.9018}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8886, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.771, 'acc_0_0': 0.9468, 'acc_0_1': 0.9317, 'acc_1_0': 0.7741, 'acc_1_1': 0.771, 'mean_acc': 0.9023}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.771, 'acc_0_0': 0.9459, 'acc_0_1': 0.9308, 'acc_1_0': 0.7726, 'acc_1_1': 0.771, 'mean_acc': 0.9014}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7788, 'acc_0_0': 0.945, 'acc_0_1': 0.9251, 'acc_1_0': 0.7788, 'acc_1_1': 0.7788, 'mean_acc': 0.9004}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7726, 'acc_0_0': 0.9432, 'acc_0_1': 0.9282, 'acc_1_0': 0.7773, 'acc_1_1': 0.7726, 'mean_acc': 0.9001}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7726, 'acc_0_0': 0.9446, 'acc_0_1': 0.9308, 'acc_1_0': 0.7757, 'acc_1_1': 0.7726, 'mean_acc': 0.9014}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7726, 'acc_0_0': 0.9463, 'acc_0_1': 0.9313, 'acc_1_0': 0.7726, 'acc_1_1': 0.7741, 'mean_acc': 0.9021}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.771, 'acc_0_0': 0.9468, 'acc_0_1': 0.9304, 'acc_1_0': 0.771, 'acc_1_1': 0.771, 'mean_acc': 0.9014}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8197, 'acc_0_0': 0.9528, 'acc_0_1': 0.8197, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.8948}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8657, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.915}
best test accuracy on [class]: {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8567, 'acc_0_0': 0.9463, 'acc_0_1': 0.9104, 'acc_1_0': 0.8629, 'acc_1_1': 0.8567, 'mean_acc': 0.9132}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8567, 'acc_0_0': 0.9463, 'acc_0_1': 0.9104, 'acc_1_0': 0.8629, 'acc_1_1': 0.8567, 'mean_acc': 0.9132}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.8131, 'acc_0_0': 0.984, 'acc_0_1': 0.8639, 'acc_1_0': 0.8131, 'acc_1_1': 0.9657, 'mean_acc': 0.9163}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8197, 'acc_0_0': 0.9528, 'acc_0_1': 0.8197, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.8948}, 'Val': {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8657, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.915}, 'Test': {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8567, 'acc_0_0': 0.9463, 'acc_0_1': 0.9104, 'acc_1_0': 0.8629, 'acc_1_1': 0.8567, 'mean_acc': 0.9132}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9242, 'worst_acc': 0.8567, 'acc_0_0': 0.9463, 'acc_0_1': 0.9104, 'acc_1_0': 0.8629, 'acc_1_1': 0.8567, 'mean_acc': 0.9132}, 'spurious': {'weighted_mean_acc': 0.9734, 'worst_acc': 0.8131, 'acc_0_0': 0.984, 'acc_0_1': 0.8639, 'acc_1_0': 0.8131, 'acc_1_1': 0.9657, 'mean_acc': 0.9163}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8552     0.8373   0.8373  ...   0.8988   0.9128    0.8585
2                       0.8766     0.8510   0.8754  ...   0.8801   0.8847    0.8674
3                       0.9242     0.8567   0.9463  ...   0.8629   0.8567    0.9132
test_mean               0.8853     0.8483   0.8863  ...   0.8806   0.8847    0.8797
test_std                0.0288     0.0081   0.0452  ...   0.0147   0.0229    0.0240
1                       0.9579     0.5592   0.9557  ...   0.5592   0.9922    0.9040
2                       0.9651     0.7134   0.9641  ...   0.7134   0.9860    0.9298
3                       0.9734     0.8131   0.9840  ...   0.8131   0.9657    0.9163
zs_spu_mean             0.9655     0.6952   0.9679  ...   0.6952   0.9813    0.9167
zs_spu_std              0.0063     0.1044   0.0119  ...   0.1044   0.0113    0.0105
1                          NaN     0.9099   0.9185  ...   0.9394   0.9701    0.9232
2                          NaN     0.9091   0.9871  ...   0.9091   0.9403    0.9733
3                          NaN     0.8197   0.9528  ...   0.8788   0.9701    0.8948
tr_mean                    NaN     0.8796   0.9528  ...   0.9091   0.9602    0.9304
tr_std                     NaN     0.0423   0.0280  ...   0.0247   0.0140    0.0325
1                       0.8857     0.8369   0.8632  ...   0.8657   0.9697    0.8650
2                       0.8979     0.8455   0.8889  ...   0.8507   0.9394    0.8733
3                       0.9282     0.8657   0.9359  ...   0.8657   0.9091    0.9150
val_mean                0.9039     0.8494   0.8960  ...   0.8607   0.9394    0.8844
val_std                 0.0179     0.0121   0.0301  ...   0.0071   0.0247    0.0219
1                       0.8552     0.8373   0.8373  ...   0.8988   0.9128    0.8585
2                       0.8766     0.8510   0.8754  ...   0.8801   0.8847    0.8674
3                       0.9242     0.8567   0.9463  ...   0.8629   0.8567    0.9132
zs_tg_mean              0.8853     0.8483   0.8863  ...   0.8806   0.8847    0.8797
zs_tg_std               0.0288     0.0081   0.0452  ...   0.0147   0.0229    0.0240

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_1.0_lrr1.0_bsr512_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0634, 'acc_0_0': 0.9643, 'acc_0_1': 0.9511, 'acc_1_0': 0.1071, 'acc_1_1': 0.0634, 'mean_acc': 0.7552}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3571, 'acc_0_0': 0.992, 'acc_0_1': 0.6957, 'acc_1_0': 0.3571, 'acc_1_1': 0.8023, 'mean_acc': 0.9314}
Val(class): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8798, 'acc_1_0': 0.4925, 'acc_1_1': 0.6061, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.4907, 'acc_0_0': 0.9938, 'acc_0_1': 0.8767, 'acc_1_0': 0.4907, 'acc_1_1': 0.6012, 'mean_acc': 0.849}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.9831, 'acc_0_1': 0.6576, 'acc_1_0': 0.5536, 'acc_1_1': 0.9243, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.8888, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.3284, 'acc_1_1': 0.5455, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.3754, 'acc_0_0': 0.9978, 'acc_0_1': 0.9135, 'acc_1_0': 0.3754, 'acc_1_1': 0.5763, 'mean_acc': 0.8493}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9889, 'acc_0_1': 0.6848, 'acc_1_0': 0.625, 'acc_1_1': 0.9347, 'mean_acc': 0.961}
Val(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8112, 'acc_1_0': 0.4776, 'acc_1_1': 0.8939, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9519, 'worst_acc': 0.5436, 'acc_0_0': 0.9925, 'acc_0_1': 0.8071, 'acc_1_0': 0.5436, 'acc_1_1': 0.8645, 'mean_acc': 0.8564}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9906, 'acc_0_1': 0.6685, 'acc_1_0': 0.6429, 'acc_1_1': 0.9565, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6012, 'acc_0_0': 0.9885, 'acc_0_1': 0.6373, 'acc_1_0': 0.6012, 'acc_1_1': 0.9486, 'mean_acc': 0.8045}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.663, 'acc_1_0': 0.6607, 'acc_1_1': 0.9631, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.5794, 'acc_0_0': 0.9957, 'acc_0_1': 0.5794, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5996, 'acc_0_0': 0.9871, 'acc_0_1': 0.5996, 'acc_1_0': 0.6106, 'acc_1_1': 0.9502, 'mean_acc': 0.7905}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9943, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9678, 'mean_acc': 0.9725}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.5665, 'acc_0_0': 0.9957, 'acc_0_1': 0.5665, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5809, 'acc_0_0': 0.9863, 'acc_0_1': 0.5809, 'acc_1_0': 0.6215, 'acc_1_1': 0.9548, 'mean_acc': 0.7846}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7065, 'acc_1_0': 0.6607, 'acc_1_1': 0.9612, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4635, 'acc_0_0': 0.9957, 'acc_0_1': 0.4635, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.5193, 'acc_0_0': 0.9814, 'acc_0_1': 0.5193, 'acc_1_0': 0.6745, 'acc_1_1': 0.9642, 'mean_acc': 0.7656}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9917, 'acc_0_1': 0.6848, 'acc_1_0': 0.6429, 'acc_1_1': 0.9612, 'mean_acc': 0.9691}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.4721, 'acc_0_0': 0.9957, 'acc_0_1': 0.4721, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.49, 'acc_0_0': 0.984, 'acc_0_1': 0.49, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7541}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.992, 'acc_0_1': 0.6793, 'acc_1_0': 0.7143, 'acc_1_1': 0.9688, 'mean_acc': 0.9716}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.553, 'acc_0_0': 0.9836, 'acc_0_1': 0.553, 'acc_1_0': 0.6604, 'acc_1_1': 0.9595, 'mean_acc': 0.7775}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.6964, 'acc_1_1': 0.9707, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5942, 'acc_0_0': 0.9863, 'acc_0_1': 0.5942, 'acc_1_0': 0.6417, 'acc_1_1': 0.9533, 'mean_acc': 0.7919}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.994, 'acc_0_1': 0.7337, 'acc_1_0': 0.7143, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6266, 'acc_0_0': 0.9915, 'acc_0_1': 0.6266, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.612, 'acc_0_0': 0.9863, 'acc_0_1': 0.612, 'acc_1_0': 0.6449, 'acc_1_1': 0.9517, 'mean_acc': 0.7989}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9929, 'acc_0_1': 0.7772, 'acc_1_0': 0.7679, 'acc_1_1': 0.9659, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.565, 'acc_0_0': 0.9831, 'acc_0_1': 0.565, 'acc_1_0': 0.6807, 'acc_1_1': 0.9564, 'mean_acc': 0.7839}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9963, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.4464, 'acc_0_0': 0.9872, 'acc_0_1': 0.4464, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7417}
Test(class): {'weighted_mean_acc': 0.9553, 'worst_acc': 0.4293, 'acc_0_0': 0.9831, 'acc_0_1': 0.4293, 'acc_1_0': 0.6885, 'acc_1_1': 0.9688, 'mean_acc': 0.7333}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9931, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9678, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.7322, 'acc_1_0': 0.6277, 'acc_1_1': 0.9377, 'mean_acc': 0.8431}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9969, 'acc_0_1': 0.7935, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.5923, 'acc_0_0': 0.9957, 'acc_0_1': 0.5923, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5787, 'acc_0_0': 0.9849, 'acc_0_1': 0.5787, 'acc_1_0': 0.6324, 'acc_1_1': 0.9486, 'mean_acc': 0.7837}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9969, 'acc_0_1': 0.8315, 'acc_1_0': 0.8393, 'acc_1_1': 0.9792, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5872, 'acc_0_0': 0.992, 'acc_0_1': 0.7951, 'acc_1_0': 0.5872, 'acc_1_1': 0.9128, 'mean_acc': 0.8618}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.8641, 'acc_1_0': 0.8036, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7854, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5576, 'acc_0_0': 0.9933, 'acc_0_1': 0.7933, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.8602}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9969, 'acc_0_1': 0.8587, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.4807, 'acc_0_0': 0.9744, 'acc_0_1': 0.4807, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7533}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4683, 'acc_0_0': 0.9823, 'acc_0_1': 0.4683, 'acc_1_0': 0.6729, 'acc_1_1': 0.9673, 'mean_acc': 0.7463}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9986, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.984, 'acc_0_1': 0.6736, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.8219}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9969, 'acc_0_1': 0.913, 'acc_1_0': 0.9464, 'acc_1_1': 0.9811, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.597, 'acc_0_0': 0.9872, 'acc_0_1': 0.6652, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5903, 'acc_0_0': 0.9863, 'acc_0_1': 0.6736, 'acc_1_0': 0.5903, 'acc_1_1': 0.933, 'mean_acc': 0.8148}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9943, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.982, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9703, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.5545, 'acc_0_0': 0.9925, 'acc_0_1': 0.6758, 'acc_1_0': 0.5545, 'acc_1_1': 0.9299, 'mean_acc': 0.8138}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.996, 'acc_0_1': 0.875, 'acc_1_0': 0.7857, 'acc_1_1': 0.9697, 'mean_acc': 0.9831}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6524, 'acc_0_0': 0.9829, 'acc_0_1': 0.6524, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6421, 'acc_0_0': 0.9854, 'acc_0_1': 0.6421, 'acc_1_0': 0.6449, 'acc_1_1': 0.9548, 'mean_acc': 0.8107}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9937, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5436, 'acc_0_0': 0.9929, 'acc_0_1': 0.7583, 'acc_1_0': 0.5436, 'acc_1_1': 0.9268, 'mean_acc': 0.8445}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.996, 'acc_0_1': 0.8533, 'acc_1_0': 0.875, 'acc_1_1': 0.9735, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.6309, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.6293, 'acc_0_0': 0.9792, 'acc_0_1': 0.6488, 'acc_1_0': 0.6293, 'acc_1_1': 0.9268, 'mean_acc': 0.806}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9954, 'acc_0_1': 0.8478, 'acc_1_0': 0.7857, 'acc_1_1': 0.9745, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.8884, 'acc_1_0': 0.4925, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.5, 'acc_0_0': 0.9965, 'acc_0_1': 0.8976, 'acc_1_0': 0.5, 'acc_1_1': 0.8583, 'mean_acc': 0.8876}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.875, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.944, 'worst_acc': 0.4292, 'acc_0_0': 0.9573, 'acc_0_1': 0.4292, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.4488, 'acc_0_0': 0.957, 'acc_0_1': 0.4488, 'acc_1_0': 0.7368, 'acc_1_1': 0.9688, 'mean_acc': 0.7361}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9929, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.9726, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.691, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.6807, 'acc_0_0': 0.9871, 'acc_0_1': 0.7091, 'acc_1_0': 0.6807, 'acc_1_1': 0.947, 'mean_acc': 0.8405}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.9669, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9728, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.7641, 'acc_1_0': 0.5576, 'acc_1_1': 0.9159, 'mean_acc': 0.8459}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9969, 'acc_0_1': 0.9022, 'acc_1_0': 0.9286, 'acc_1_1': 0.9811, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.952, 'worst_acc': 0.3731, 'acc_0_0': 0.9957, 'acc_0_1': 0.8927, 'acc_1_0': 0.3731, 'acc_1_1': 0.8485, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9476, 'worst_acc': 0.4097, 'acc_0_0': 0.9982, 'acc_0_1': 0.9029, 'acc_1_0': 0.4097, 'acc_1_1': 0.8162, 'mean_acc': 0.8757}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.8571, 'acc_1_1': 0.9877, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5794, 'acc_0_0': 0.9744, 'acc_0_1': 0.5794, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.5902, 'acc_0_0': 0.9725, 'acc_0_1': 0.5902, 'acc_1_0': 0.7056, 'acc_1_1': 0.9517, 'mean_acc': 0.7919}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9969, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9934, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5536, 'acc_0_0': 0.9829, 'acc_0_1': 0.5536, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.6226, 'acc_0_0': 0.9805, 'acc_0_1': 0.6226, 'acc_1_0': 0.6573, 'acc_1_1': 0.9486, 'mean_acc': 0.8019}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9989, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9972, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5579, 'acc_0_0': 0.9573, 'acc_0_1': 0.5579, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.942, 'worst_acc': 0.5548, 'acc_0_0': 0.9592, 'acc_0_1': 0.5548, 'acc_1_0': 0.7492, 'acc_1_1': 0.9626, 'mean_acc': 0.7789}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9991, 'acc_0_1': 0.9457, 'acc_1_0': 0.9643, 'acc_1_1': 0.9858, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.7095, 'acc_1_0': 0.5327, 'acc_1_1': 0.9268, 'mean_acc': 0.8238}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.913, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5075, 'acc_0_0': 0.9872, 'acc_0_1': 0.8112, 'acc_1_0': 0.5075, 'acc_1_1': 0.9091, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.5654, 'acc_0_0': 0.9907, 'acc_0_1': 0.8421, 'acc_1_0': 0.5654, 'acc_1_1': 0.8567, 'mean_acc': 0.8709}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9966, 'acc_0_1': 0.9565, 'acc_1_0': 0.8929, 'acc_1_1': 0.9849, 'mean_acc': 0.9912}
Val(class): {'weighted_mean_acc': 0.9526, 'worst_acc': 0.5107, 'acc_0_0': 0.9701, 'acc_0_1': 0.5107, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.486, 'acc_0_0': 0.9698, 'acc_0_1': 0.486, 'acc_1_0': 0.6604, 'acc_1_1': 0.9517, 'mean_acc': 0.7453}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9926, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9839}
Val(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6567, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9573, 'worst_acc': 0.6667, 'acc_0_0': 0.9836, 'acc_0_1': 0.694, 'acc_1_0': 0.6667, 'acc_1_1': 0.9315, 'mean_acc': 0.83}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9914, 'acc_0_1': 0.7609, 'acc_1_0': 0.6607, 'acc_1_1': 0.9423, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6395, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6526, 'acc_0_0': 0.9845, 'acc_0_1': 0.6656, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.819}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9906, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9631, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.8755, 'acc_1_0': 0.4776, 'acc_1_1': 0.9242, 'mean_acc': 0.885}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.514, 'acc_0_0': 0.9951, 'acc_0_1': 0.8426, 'acc_1_0': 0.514, 'acc_1_1': 0.8847, 'mean_acc': 0.8702}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9943, 'acc_0_1': 0.837, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5779, 'acc_0_0': 0.9889, 'acc_0_1': 0.8204, 'acc_1_0': 0.5779, 'acc_1_1': 0.8941, 'mean_acc': 0.8673}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9957, 'acc_0_1': 0.8283, 'acc_1_0': 0.4848, 'acc_1_1': 0.9403, 'mean_acc': 0.8681}
Val(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.5075, 'acc_0_0': 0.9872, 'acc_0_1': 0.9657, 'acc_1_0': 0.5075, 'acc_1_1': 0.6818, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8978, 'worst_acc': 0.5701, 'acc_0_0': 0.9925, 'acc_0_1': 0.9472, 'acc_1_0': 0.5701, 'acc_1_1': 0.5935, 'mean_acc': 0.8838}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0558, 'acc_0_0': 0.8283, 'acc_0_1': 0.0558, 'acc_1_0': 0.2121, 'acc_1_1': 0.1343, 'mean_acc': 0.3823}
Val(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.2103, 'acc_0_0': 0.9103, 'acc_0_1': 0.2103, 'acc_1_0': 0.8507, 'acc_1_1': 1.0, 'mean_acc': 0.6417}
Test(class)(new adapter): {'weighted_mean_acc': 0.8928, 'worst_acc': 0.1929, 'acc_0_0': 0.9016, 'acc_0_1': 0.1929, 'acc_1_0': 0.8567, 'acc_1_1': 0.9875, 'mean_acc': 0.6303}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3906, 'acc_0_0': 0.9485, 'acc_0_1': 0.3906, 'acc_1_0': 0.5909, 'acc_1_1': 0.9552, 'mean_acc': 0.6928}
Val(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9327, 'worst_acc': 0.7445, 'acc_0_0': 0.9778, 'acc_0_1': 0.9348, 'acc_1_0': 0.7445, 'acc_1_1': 0.7928, 'mean_acc': 0.9147}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.9614, 'acc_0_1': 0.897, 'acc_1_0': 0.6061, 'acc_1_1': 0.0, 'mean_acc': 0.7896}
Val(class)(new adapter): {'weighted_mean_acc': 0.8259, 'worst_acc': 0.4242, 'acc_0_0': 0.9402, 'acc_0_1': 0.9657, 'acc_1_0': 0.806, 'acc_1_1': 0.4242, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8246, 'worst_acc': 0.4174, 'acc_0_0': 0.9392, 'acc_0_1': 0.9814, 'acc_1_0': 0.8349, 'acc_1_1': 0.4174, 'mean_acc': 0.8863}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4925, 'acc_0_0': 0.9571, 'acc_0_1': 1.0, 'acc_1_0': 0.7424, 'acc_1_1': 0.4925, 'mean_acc': 0.8982}
Val(class)(new adapter): {'weighted_mean_acc': 0.8285, 'worst_acc': 0.6212, 'acc_0_0': 0.8846, 'acc_0_1': 0.9356, 'acc_1_0': 0.8806, 'acc_1_1': 0.6212, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8206, 'worst_acc': 0.5343, 'acc_0_0': 0.8989, 'acc_0_1': 0.9627, 'acc_1_0': 0.866, 'acc_1_1': 0.5343, 'mean_acc': 0.8797}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0448, 'acc_0_0': 0.7811, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.0448, 'mean_acc': 0.7813}
Val(class)(new adapter): {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8485, 'acc_0_0': 0.8846, 'acc_0_1': 0.8841, 'acc_1_0': 0.8955, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8761, 'worst_acc': 0.8209, 'acc_0_0': 0.8914, 'acc_0_1': 0.9024, 'acc_1_0': 0.8769, 'acc_1_1': 0.8209, 'mean_acc': 0.8863}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9227, 'acc_0_1': 0.9528, 'acc_1_0': 0.8333, 'acc_1_1': 0.9552, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.8541, 'acc_0_0': 0.9103, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8594, 'acc_0_0': 0.9126, 'acc_0_1': 0.8594, 'acc_1_0': 0.8692, 'acc_1_1': 0.8863, 'mean_acc': 0.8842}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3731, 'acc_0_0': 0.8798, 'acc_0_1': 0.9399, 'acc_1_0': 0.8788, 'acc_1_1': 0.3731, 'mean_acc': 0.8464}
Val(class)(new adapter): {'weighted_mean_acc': 0.9352, 'worst_acc': 0.8369, 'acc_0_0': 0.9402, 'acc_0_1': 0.8369, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.8364, 'acc_0_0': 0.9299, 'acc_0_1': 0.8364, 'acc_1_0': 0.8551, 'acc_1_1': 0.9097, 'mean_acc': 0.883}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9571, 'acc_0_1': 0.9313, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9332}
Val(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.8507, 'acc_0_0': 0.9402, 'acc_0_1': 0.8627, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8458, 'acc_0_0': 0.9415, 'acc_0_1': 0.8625, 'acc_1_0': 0.8458, 'acc_1_1': 0.9019, 'mean_acc': 0.8958}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6119, 'acc_0_0': 0.9013, 'acc_0_1': 0.9785, 'acc_1_0': 0.803, 'acc_1_1': 0.6119, 'mean_acc': 0.8881}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.8358, 'acc_0_0': 0.9487, 'acc_0_1': 0.8712, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9378, 'worst_acc': 0.8333, 'acc_0_0': 0.9543, 'acc_0_1': 0.8608, 'acc_1_0': 0.8333, 'acc_1_1': 0.9019, 'mean_acc': 0.8987}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.97, 'acc_0_1': 0.97, 'acc_1_0': 0.7727, 'acc_1_1': 0.9403, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.942, 'worst_acc': 0.8358, 'acc_0_0': 0.953, 'acc_0_1': 0.867, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9434, 'worst_acc': 0.8224, 'acc_0_0': 0.9614, 'acc_0_1': 0.8674, 'acc_1_0': 0.8224, 'acc_1_1': 0.9034, 'mean_acc': 0.903}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.9056, 'acc_0_1': 1.0, 'acc_1_0': 0.7424, 'acc_1_1': 0.6269, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.824, 'acc_0_0': 0.9573, 'acc_0_1': 0.824, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9418, 'worst_acc': 0.8255, 'acc_0_0': 0.9592, 'acc_0_1': 0.8395, 'acc_1_0': 0.8255, 'acc_1_1': 0.9081, 'mean_acc': 0.8921}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9828, 'acc_0_1': 0.9571, 'acc_1_0': 0.7727, 'acc_1_1': 0.9403, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.824, 'acc_0_0': 0.9615, 'acc_0_1': 0.824, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9429, 'worst_acc': 0.8255, 'acc_0_0': 0.9592, 'acc_0_1': 0.8337, 'acc_1_0': 0.8255, 'acc_1_1': 0.9143, 'mean_acc': 0.8906}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9485, 'acc_0_1': 0.9657, 'acc_1_0': 0.8182, 'acc_1_1': 0.8507, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.8283, 'acc_0_0': 0.9615, 'acc_0_1': 0.8283, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.8193, 'acc_0_0': 0.9596, 'acc_0_1': 0.8412, 'acc_1_0': 0.8193, 'acc_1_1': 0.9143, 'mean_acc': 0.893}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9871, 'acc_0_1': 0.9571, 'acc_1_0': 0.7727, 'acc_1_1': 0.9701, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.8358, 'acc_0_0': 0.9658, 'acc_0_1': 0.8584, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.8178, 'acc_0_0': 0.961, 'acc_0_1': 0.8767, 'acc_1_0': 0.8178, 'acc_1_1': 0.8988, 'mean_acc': 0.9054}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9528, 'acc_0_1': 0.97, 'acc_1_0': 0.8333, 'acc_1_1': 0.8507, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.8358, 'acc_0_0': 0.9658, 'acc_0_1': 0.897, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9385, 'worst_acc': 0.8146, 'acc_0_0': 0.961, 'acc_0_1': 0.9038, 'acc_1_0': 0.8146, 'acc_1_1': 0.8769, 'mean_acc': 0.9132}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.806, 'acc_0_0': 0.9658, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.81, 'acc_0_0': 0.9627, 'acc_0_1': 0.9259, 'acc_1_0': 0.81, 'acc_1_1': 0.852, 'mean_acc': 0.9192}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9442, 'acc_0_1': 0.9742, 'acc_1_0': 0.8939, 'acc_1_1': 0.8507, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.806, 'acc_0_0': 0.9615, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9324, 'worst_acc': 0.8069, 'acc_0_0': 0.9605, 'acc_0_1': 0.9251, 'acc_1_0': 0.8069, 'acc_1_1': 0.8474, 'mean_acc': 0.9172}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.806, 'acc_0_0': 0.9615, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7991, 'acc_0_0': 0.9605, 'acc_0_1': 0.9211, 'acc_1_0': 0.7991, 'acc_1_1': 0.8427, 'mean_acc': 0.9142}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9442, 'acc_0_1': 0.9742, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9413, 'worst_acc': 0.791, 'acc_0_0': 0.9615, 'acc_0_1': 0.8755, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.796, 'acc_0_0': 0.961, 'acc_0_1': 0.8989, 'acc_1_0': 0.796, 'acc_1_1': 0.8551, 'mean_acc': 0.9068}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9571, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9317, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.931, 'worst_acc': 0.7866, 'acc_0_0': 0.9632, 'acc_0_1': 0.9051, 'acc_1_0': 0.7866, 'acc_1_1': 0.8364, 'mean_acc': 0.907}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.97, 'acc_0_1': 0.9614, 'acc_1_0': 0.9242, 'acc_1_1': 0.9403, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9319, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.785, 'acc_0_0': 0.9614, 'acc_0_1': 0.9171, 'acc_1_0': 0.785, 'acc_1_1': 0.8115, 'mean_acc': 0.908}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7648, 'acc_0_0': 0.9539, 'acc_0_1': 0.9299, 'acc_1_0': 0.785, 'acc_1_1': 0.7648, 'mean_acc': 0.9049}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9254, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.757, 'acc_0_0': 0.9459, 'acc_0_1': 0.9375, 'acc_1_0': 0.7944, 'acc_1_1': 0.757, 'mean_acc': 0.9049}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8909, 'worst_acc': 0.7477, 'acc_0_0': 0.933, 'acc_0_1': 0.9415, 'acc_1_0': 0.796, 'acc_1_1': 0.7477, 'mean_acc': 0.9006}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9614, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.8955, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.8927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8867, 'worst_acc': 0.7788, 'acc_0_0': 0.918, 'acc_0_1': 0.9308, 'acc_1_0': 0.8271, 'acc_1_1': 0.7788, 'mean_acc': 0.8975}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9828, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8943, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8869, 'worst_acc': 0.7804, 'acc_0_0': 0.918, 'acc_0_1': 0.9277, 'acc_1_0': 0.8271, 'acc_1_1': 0.7804, 'mean_acc': 0.8964}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9185, 'acc_0_0': 0.9185, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.8712, 'acc_1_0': 0.8209, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.8022, 'acc_0_0': 0.9304, 'acc_0_1': 0.9188, 'acc_1_0': 0.8224, 'acc_1_1': 0.8022, 'mean_acc': 0.8997}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.8209, 'acc_0_0': 0.9359, 'acc_0_1': 0.8798, 'acc_1_0': 0.8209, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7897, 'acc_0_0': 0.9455, 'acc_0_1': 0.9211, 'acc_1_0': 0.8006, 'acc_1_1': 0.7897, 'mean_acc': 0.9027}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9957, 'acc_0_1': 0.97, 'acc_1_0': 0.8939, 'acc_1_1': 0.8507, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.8755, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.785, 'acc_0_0': 0.9508, 'acc_0_1': 0.918, 'acc_1_0': 0.785, 'acc_1_1': 0.7882, 'mean_acc': 0.9016}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7788, 'acc_0_0': 0.9503, 'acc_0_1': 0.9255, 'acc_1_0': 0.7882, 'acc_1_1': 0.7788, 'mean_acc': 0.9037}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.8955, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.8884, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9023, 'worst_acc': 0.7913, 'acc_0_0': 0.9366, 'acc_0_1': 0.9197, 'acc_1_0': 0.8022, 'acc_1_1': 0.7913, 'mean_acc': 0.899}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.8053, 'acc_0_0': 0.9193, 'acc_0_1': 0.9242, 'acc_1_0': 0.8193, 'acc_1_1': 0.8053, 'mean_acc': 0.8975}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.806, 'acc_0_0': 0.906, 'acc_0_1': 0.9013, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.886, 'worst_acc': 0.8193, 'acc_0_0': 0.9051, 'acc_0_1': 0.9237, 'acc_1_0': 0.8271, 'acc_1_1': 0.8193, 'mean_acc': 0.8942}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8856, 'worst_acc': 0.8209, 'acc_0_0': 0.8932, 'acc_0_1': 0.8884, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.879, 'worst_acc': 0.8333, 'acc_0_0': 0.8914, 'acc_0_1': 0.9211, 'acc_1_0': 0.8333, 'acc_1_1': 0.8333, 'mean_acc': 0.8901}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9442, 'acc_0_0': 0.9442, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.8209, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.8209, 'acc_0_0': 0.9073, 'acc_0_1': 0.9295, 'acc_1_0': 0.8209, 'acc_1_1': 0.8255, 'mean_acc': 0.8973}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.8209, 'acc_0_0': 0.9103, 'acc_0_1': 0.9099, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8224, 'acc_0_0': 0.9131, 'acc_0_1': 0.9308, 'acc_1_0': 0.8224, 'acc_1_1': 0.8287, 'mean_acc': 0.9006}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9614, 'acc_0_0': 0.9614, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.8209, 'acc_0_0': 0.9145, 'acc_0_1': 0.9056, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.8209, 'acc_0_0': 0.9211, 'acc_0_1': 0.929, 'acc_1_0': 0.8209, 'acc_1_1': 0.8349, 'mean_acc': 0.9035}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.8193, 'acc_0_0': 0.9268, 'acc_0_1': 0.9286, 'acc_1_0': 0.8193, 'acc_1_1': 0.8364, 'mean_acc': 0.9056}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9742, 'acc_0_0': 0.9742, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.8069, 'acc_0_0': 0.9317, 'acc_0_1': 0.9308, 'acc_1_0': 0.8069, 'acc_1_1': 0.8318, 'mean_acc': 0.9065}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.796, 'acc_0_0': 0.9353, 'acc_0_1': 0.9326, 'acc_1_0': 0.796, 'acc_1_1': 0.8333, 'mean_acc': 0.9075}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.796, 'acc_0_0': 0.9401, 'acc_0_1': 0.9335, 'acc_1_0': 0.796, 'acc_1_1': 0.8333, 'mean_acc': 0.9097}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7897, 'acc_0_0': 0.9432, 'acc_0_1': 0.9308, 'acc_1_0': 0.7897, 'acc_1_1': 0.8364, 'mean_acc': 0.9096}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7897, 'acc_0_0': 0.945, 'acc_0_1': 0.9295, 'acc_1_0': 0.7897, 'acc_1_1': 0.8411, 'mean_acc': 0.9103}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9204, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.7882, 'acc_0_0': 0.9477, 'acc_0_1': 0.9299, 'acc_1_0': 0.7882, 'acc_1_1': 0.838, 'mean_acc': 0.9109}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.8006, 'acc_0_0': 0.9468, 'acc_0_1': 0.9282, 'acc_1_0': 0.8006, 'acc_1_1': 0.8474, 'mean_acc': 0.9123}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7975, 'acc_0_0': 0.9468, 'acc_0_1': 0.9286, 'acc_1_0': 0.7975, 'acc_1_1': 0.8505, 'mean_acc': 0.9125}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7897, 'acc_0_0': 0.9486, 'acc_0_1': 0.929, 'acc_1_0': 0.7897, 'acc_1_1': 0.8427, 'mean_acc': 0.9116}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7975, 'acc_0_0': 0.9472, 'acc_0_1': 0.9255, 'acc_1_0': 0.7975, 'acc_1_1': 0.8458, 'mean_acc': 0.9109}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7944, 'acc_0_0': 0.9477, 'acc_0_1': 0.9264, 'acc_1_0': 0.7944, 'acc_1_1': 0.8396, 'mean_acc': 0.9104}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7991, 'acc_0_0': 0.9468, 'acc_0_1': 0.9255, 'acc_1_0': 0.7991, 'acc_1_1': 0.8442, 'mean_acc': 0.9108}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7991, 'acc_0_0': 0.9468, 'acc_0_1': 0.9246, 'acc_1_0': 0.7991, 'acc_1_1': 0.8474, 'mean_acc': 0.9108}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7944, 'acc_0_0': 0.9481, 'acc_0_1': 0.929, 'acc_1_0': 0.7944, 'acc_1_1': 0.838, 'mean_acc': 0.9115}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.796, 'acc_0_0': 0.9481, 'acc_0_1': 0.9286, 'acc_1_0': 0.796, 'acc_1_1': 0.8411, 'mean_acc': 0.9118}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.7944, 'acc_0_0': 0.949, 'acc_0_1': 0.9317, 'acc_1_0': 0.7944, 'acc_1_1': 0.838, 'mean_acc': 0.9128}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7944, 'acc_0_0': 0.9499, 'acc_0_1': 0.9304, 'acc_1_0': 0.7944, 'acc_1_1': 0.8396, 'mean_acc': 0.9128}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7944, 'acc_0_0': 0.9499, 'acc_0_1': 0.9295, 'acc_1_0': 0.7944, 'acc_1_1': 0.8427, 'mean_acc': 0.9128}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.796, 'acc_0_0': 0.9494, 'acc_0_1': 0.9268, 'acc_1_0': 0.796, 'acc_1_1': 0.8427, 'mean_acc': 0.9118}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.796, 'acc_0_0': 0.9494, 'acc_0_1': 0.9264, 'acc_1_0': 0.796, 'acc_1_1': 0.8427, 'mean_acc': 0.9116}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7944, 'acc_0_0': 0.9508, 'acc_0_1': 0.9286, 'acc_1_0': 0.7944, 'acc_1_1': 0.8427, 'mean_acc': 0.9128}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8333, 'acc_0_0': 0.9227, 'acc_0_1': 0.9528, 'acc_1_0': 0.8333, 'acc_1_1': 0.9552, 'mean_acc': 0.9282}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9075, 'worst_acc': 0.8541, 'acc_0_0': 0.9103, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.885}
best test accuracy on [class]: {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8594, 'acc_0_0': 0.9126, 'acc_0_1': 0.8594, 'acc_1_0': 0.8692, 'acc_1_1': 0.8863, 'mean_acc': 0.8842}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8594, 'acc_0_0': 0.9126, 'acc_0_1': 0.8594, 'acc_1_0': 0.8692, 'acc_1_1': 0.8863, 'mean_acc': 0.8842}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.8235, 'acc_0_0': 0.9836, 'acc_0_1': 0.8235, 'acc_1_0': 0.8427, 'acc_1_1': 0.9611, 'mean_acc': 0.9032}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8333, 'acc_0_0': 0.9227, 'acc_0_1': 0.9528, 'acc_1_0': 0.8333, 'acc_1_1': 0.9552, 'mean_acc': 0.9282}, 'Val': {'weighted_mean_acc': 0.9075, 'worst_acc': 0.8541, 'acc_0_0': 0.9103, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.885}, 'Test': {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8594, 'acc_0_0': 0.9126, 'acc_0_1': 0.8594, 'acc_1_0': 0.8692, 'acc_1_1': 0.8863, 'mean_acc': 0.8842}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8594, 'acc_0_0': 0.9126, 'acc_0_1': 0.8594, 'acc_1_0': 0.8692, 'acc_1_1': 0.8863, 'mean_acc': 0.8842}, 'spurious': {'weighted_mean_acc': 0.9708, 'worst_acc': 0.8235, 'acc_0_0': 0.9836, 'acc_0_1': 0.8235, 'acc_1_0': 0.8427, 'acc_1_1': 0.9611, 'mean_acc': 0.9032}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0357, 'acc_0_0': 0.9534, 'acc_0_1': 0.962, 'acc_1_0': 0.0357, 'acc_1_1': 0.0747, 'mean_acc': 0.7493}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2679, 'acc_0_0': 0.994, 'acc_0_1': 0.6902, 'acc_1_0': 0.2679, 'acc_1_1': 0.6168, 'mean_acc': 0.8907}
Val(class): {'weighted_mean_acc': 0.9389, 'worst_acc': 0.5966, 'acc_0_0': 0.9615, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9343, 'worst_acc': 0.5211, 'acc_0_0': 0.9614, 'acc_0_1': 0.5211, 'acc_1_0': 0.6807, 'acc_1_1': 0.9299, 'mean_acc': 0.7554}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9863, 'acc_0_1': 0.6141, 'acc_1_0': 0.5893, 'acc_1_1': 0.9338, 'mean_acc': 0.9558}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.6137, 'acc_1_0': 0.4776, 'acc_1_1': 0.9697, 'mean_acc': 0.7883}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.4502, 'acc_0_0': 0.9951, 'acc_0_1': 0.5885, 'acc_1_0': 0.4502, 'acc_1_1': 0.9377, 'mean_acc': 0.7701}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9891, 'acc_0_1': 0.5272, 'acc_1_0': 0.5, 'acc_1_1': 0.9603, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.72}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3543, 'acc_0_0': 0.9814, 'acc_0_1': 0.3543, 'acc_1_0': 0.6153, 'acc_1_1': 0.9657, 'mean_acc': 0.695}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5978, 'acc_0_0': 0.9874, 'acc_0_1': 0.5978, 'acc_1_0': 0.6429, 'acc_1_1': 0.9518, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3948, 'acc_0_0': 0.9872, 'acc_0_1': 0.3948, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.7283}
Test(class): {'weighted_mean_acc': 0.9461, 'worst_acc': 0.357, 'acc_0_0': 0.9738, 'acc_0_1': 0.357, 'acc_1_0': 0.7492, 'acc_1_1': 0.9673, 'mean_acc': 0.7081}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9917, 'acc_0_1': 0.6685, 'acc_1_0': 0.7143, 'acc_1_1': 0.9574, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.5708, 'acc_0_0': 0.9829, 'acc_0_1': 0.5708, 'acc_1_0': 0.7015, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.953, 'worst_acc': 0.518, 'acc_0_0': 0.98, 'acc_0_1': 0.518, 'acc_1_0': 0.7196, 'acc_1_1': 0.9517, 'mean_acc': 0.7682}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.7143, 'acc_1_1': 0.9603, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.7007, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.83}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.9934, 'acc_0_1': 0.6848, 'acc_1_0': 0.6964, 'acc_1_1': 0.9659, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9585, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5522, 'acc_1_1': 0.8636, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.5358, 'acc_0_0': 0.9947, 'acc_0_1': 0.8377, 'acc_1_0': 0.5358, 'acc_1_1': 0.9003, 'mean_acc': 0.8723}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.994, 'acc_0_1': 0.7609, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9771, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.595, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.595, 'acc_1_1': 0.9377, 'mean_acc': 0.8177}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9943, 'acc_0_1': 0.788, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.6524, 'acc_0_0': 0.9786, 'acc_0_1': 0.6524, 'acc_1_0': 0.7313, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9564, 'worst_acc': 0.612, 'acc_0_0': 0.9814, 'acc_0_1': 0.612, 'acc_1_0': 0.7025, 'acc_1_1': 0.947, 'mean_acc': 0.8029}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9946, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9678, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.5224, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.749, 'acc_1_0': 0.5312, 'acc_1_1': 0.9315, 'mean_acc': 0.8404}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9946, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9622, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5665, 'acc_0_0': 0.9701, 'acc_0_1': 0.5665, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.9536, 'worst_acc': 0.5588, 'acc_0_0': 0.9769, 'acc_0_1': 0.5588, 'acc_1_0': 0.7087, 'acc_1_1': 0.9579, 'mean_acc': 0.7824}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.7857, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5047, 'acc_0_0': 0.9956, 'acc_0_1': 0.8186, 'acc_1_0': 0.5047, 'acc_1_1': 0.9065, 'mean_acc': 0.8624}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9969, 'acc_0_1': 0.7989, 'acc_1_0': 0.7679, 'acc_1_1': 0.9688, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.937, 'worst_acc': 0.3991, 'acc_0_0': 0.953, 'acc_0_1': 0.3991, 'acc_1_0': 0.806, 'acc_1_1': 0.9848, 'mean_acc': 0.725}
Test(class): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.4124, 'acc_0_0': 0.9619, 'acc_0_1': 0.4124, 'acc_1_0': 0.7586, 'acc_1_1': 0.9766, 'mean_acc': 0.7271}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9957, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9716, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7167, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6308, 'acc_0_0': 0.9863, 'acc_0_1': 0.6843, 'acc_1_0': 0.6308, 'acc_1_1': 0.9299, 'mean_acc': 0.8231}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.8326, 'acc_1_0': 0.6418, 'acc_1_1': 0.8939, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9549, 'worst_acc': 0.6371, 'acc_0_0': 0.984, 'acc_0_1': 0.8106, 'acc_1_0': 0.6371, 'acc_1_1': 0.9003, 'mean_acc': 0.8688}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.824, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8767}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5187, 'acc_0_0': 0.9951, 'acc_0_1': 0.82, 'acc_1_0': 0.5187, 'acc_1_1': 0.8801, 'mean_acc': 0.8614}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9963, 'acc_0_1': 0.8533, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.648, 'acc_0_0': 0.9889, 'acc_0_1': 0.6812, 'acc_1_0': 0.648, 'acc_1_1': 0.9455, 'mean_acc': 0.8265}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9665, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7983, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5125, 'acc_0_0': 0.9947, 'acc_0_1': 0.78, 'acc_1_0': 0.5125, 'acc_1_1': 0.8925, 'mean_acc': 0.8464}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.75, 'acc_1_1': 0.9726, 'mean_acc': 0.9814}
Val(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7897, 'acc_1_0': 0.5522, 'acc_1_1': 0.8939, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7973, 'acc_1_0': 0.5981, 'acc_1_1': 0.9237, 'mean_acc': 0.8645}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9951, 'acc_0_1': 0.8641, 'acc_1_0': 0.8929, 'acc_1_1': 0.9707, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6524, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5841, 'acc_0_0': 0.9894, 'acc_0_1': 0.6497, 'acc_1_0': 0.5841, 'acc_1_1': 0.9393, 'mean_acc': 0.8067}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9971, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.9735, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9513, 'worst_acc': 0.6309, 'acc_0_0': 0.9615, 'acc_0_1': 0.6309, 'acc_1_0': 0.7313, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6071, 'acc_0_0': 0.9818, 'acc_0_1': 0.6071, 'acc_1_0': 0.6573, 'acc_1_1': 0.9517, 'mean_acc': 0.7967}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.75, 'acc_1_1': 0.983, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.897, 'acc_1_0': 0.5224, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.5374, 'acc_0_0': 0.9911, 'acc_0_1': 0.8701, 'acc_1_0': 0.5374, 'acc_1_1': 0.8676, 'mean_acc': 0.88}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9974, 'acc_0_1': 0.8696, 'acc_1_0': 0.7857, 'acc_1_1': 0.9792, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9662, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6526, 'acc_0_0': 0.9863, 'acc_0_1': 0.7286, 'acc_1_0': 0.6526, 'acc_1_1': 0.9393, 'mean_acc': 0.8438}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9977, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9792, 'mean_acc': 0.9896}
Val(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5193, 'acc_0_0': 0.9744, 'acc_0_1': 0.5193, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7683}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5202, 'acc_0_0': 0.9787, 'acc_0_1': 0.5202, 'acc_1_0': 0.6682, 'acc_1_1': 0.9704, 'mean_acc': 0.7649}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9896, 'mean_acc': 0.9914}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6293, 'acc_0_0': 0.9814, 'acc_0_1': 0.6971, 'acc_1_0': 0.6293, 'acc_1_1': 0.933, 'mean_acc': 0.8264}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9966, 'acc_0_1': 0.8967, 'acc_1_0': 0.8214, 'acc_1_1': 0.964, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.3433, 'acc_0_0': 0.9359, 'acc_0_1': 0.3433, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.3512, 'acc_0_0': 0.949, 'acc_0_1': 0.3512, 'acc_1_0': 0.8084, 'acc_1_1': 0.9782, 'mean_acc': 0.704}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9886, 'acc_0_1': 0.788, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7768, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5576, 'acc_0_0': 0.9907, 'acc_0_1': 0.7486, 'acc_1_0': 0.5576, 'acc_1_1': 0.9143, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9957, 'acc_0_1': 0.7989, 'acc_1_0': 0.6607, 'acc_1_1': 0.948, 'mean_acc': 0.9737}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5224, 'acc_0_0': 0.9829, 'acc_0_1': 0.7082, 'acc_1_0': 0.5224, 'acc_1_1': 0.9697, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.5748, 'acc_0_0': 0.9894, 'acc_0_1': 0.6754, 'acc_1_0': 0.5748, 'acc_1_1': 0.9377, 'mean_acc': 0.8155}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9934, 'acc_0_1': 0.7826, 'acc_1_0': 0.7679, 'acc_1_1': 0.9782, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.4421, 'acc_0_0': 0.9444, 'acc_0_1': 0.4421, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9431, 'worst_acc': 0.4705, 'acc_0_0': 0.9619, 'acc_0_1': 0.4705, 'acc_1_0': 0.7523, 'acc_1_1': 0.9735, 'mean_acc': 0.7487}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9909, 'acc_0_1': 0.8478, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8712, 'acc_1_0': 0.3731, 'acc_1_1': 0.8939, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.4548, 'acc_0_0': 0.9978, 'acc_0_1': 0.8559, 'acc_1_0': 0.4548, 'acc_1_1': 0.866, 'mean_acc': 0.8678}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.8207, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6269, 'acc_0_0': 0.9872, 'acc_0_1': 0.7682, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.7494, 'acc_1_0': 0.6153, 'acc_1_1': 0.9252, 'mean_acc': 0.8476}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9957, 'acc_0_1': 0.8804, 'acc_1_0': 0.7857, 'acc_1_1': 0.9669, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.6137, 'acc_0_0': 0.9744, 'acc_0_1': 0.6137, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.5978, 'acc_0_0': 0.9836, 'acc_0_1': 0.5978, 'acc_1_0': 0.634, 'acc_1_1': 0.9517, 'mean_acc': 0.7912}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.996, 'acc_0_1': 0.8478, 'acc_1_0': 0.8393, 'acc_1_1': 0.9726, 'mean_acc': 0.9833}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.609, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.609, 'acc_1_1': 0.9393, 'mean_acc': 0.8153}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6028, 'acc_0_0': 0.9902, 'acc_0_1': 0.6927, 'acc_1_0': 0.6028, 'acc_1_1': 0.9361, 'mean_acc': 0.8255}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.9946, 'acc_0_1': 0.8967, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.929, 'worst_acc': 0.4464, 'acc_0_0': 0.9402, 'acc_0_1': 0.4464, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.431, 'acc_0_0': 0.9455, 'acc_0_1': 0.431, 'acc_1_0': 0.7648, 'acc_1_1': 0.9782, 'mean_acc': 0.7289}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.6563, 'acc_1_0': 0.609, 'acc_1_1': 0.9439, 'mean_acc': 0.8134}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9957, 'acc_0_1': 0.8696, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8683}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5156, 'acc_0_0': 0.9956, 'acc_0_1': 0.8089, 'acc_1_0': 0.5156, 'acc_1_1': 0.8863, 'mean_acc': 0.8576}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9974, 'acc_0_1': 0.875, 'acc_1_0': 0.9464, 'acc_1_1': 0.9868, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.7164, 'acc_0_0': 0.9786, 'acc_0_1': 0.7296, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.6745, 'acc_0_0': 0.9783, 'acc_0_1': 0.7073, 'acc_1_0': 0.6745, 'acc_1_1': 0.9393, 'mean_acc': 0.8348}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.9022, 'acc_1_0': 0.8214, 'acc_1_1': 0.9896, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.6738, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6231, 'acc_0_0': 0.9916, 'acc_0_1': 0.6443, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8095}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9914, 'acc_0_1': 0.7639, 'acc_1_0': 0.4848, 'acc_1_1': 0.9403, 'mean_acc': 0.8414}
Val(class)(new adapter): {'weighted_mean_acc': 0.8322, 'worst_acc': 0.2727, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.3731, 'acc_1_1': 0.2727, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.8363, 'worst_acc': 0.2975, 'acc_0_0': 0.9978, 'acc_0_1': 0.9907, 'acc_1_0': 0.4097, 'acc_1_1': 0.2975, 'mean_acc': 0.8523}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8884, 'acc_0_1': 0.0944, 'acc_1_0': 0.0, 'acc_1_1': 0.209, 'mean_acc': 0.4057}
Val(class)(new adapter): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.2618, 'acc_0_0': 0.9915, 'acc_0_1': 0.2618, 'acc_1_0': 0.597, 'acc_1_1': 1.0, 'mean_acc': 0.665}
Test(class)(new adapter): {'weighted_mean_acc': 0.9507, 'worst_acc': 0.2714, 'acc_0_0': 0.9876, 'acc_0_1': 0.2714, 'acc_1_0': 0.4766, 'acc_1_1': 0.972, 'mean_acc': 0.6505}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4421, 'acc_0_0': 0.9957, 'acc_0_1': 0.4421, 'acc_1_0': 0.4545, 'acc_1_1': 0.9552, 'mean_acc': 0.7162}
Val(class)(new adapter): {'weighted_mean_acc': 0.893, 'worst_acc': 0.2836, 'acc_0_0': 1.0, 'acc_0_1': 0.9528, 'acc_1_0': 0.2836, 'acc_1_1': 0.5606, 'mean_acc': 0.8533}
Test(class)(new adapter): {'weighted_mean_acc': 0.8841, 'worst_acc': 0.3505, 'acc_0_0': 0.9987, 'acc_0_1': 0.9494, 'acc_1_0': 0.3505, 'acc_1_1': 0.5218, 'mean_acc': 0.8548}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.97, 'acc_0_1': 0.8498, 'acc_1_0': 0.5606, 'acc_1_1': 0.0, 'mean_acc': 0.7696}
Val(class)(new adapter): {'weighted_mean_acc': 0.8657, 'worst_acc': 0.5758, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.8358, 'acc_1_1': 0.5758, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8456, 'worst_acc': 0.4766, 'acc_0_0': 0.9512, 'acc_0_1': 0.9676, 'acc_1_0': 0.8131, 'acc_1_1': 0.4766, 'mean_acc': 0.8897}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9399, 'acc_0_1': 0.97, 'acc_1_0': 0.8182, 'acc_1_1': 0.6716, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.8599, 'worst_acc': 0.803, 'acc_0_0': 0.8718, 'acc_0_1': 0.9442, 'acc_1_0': 0.9104, 'acc_1_1': 0.803, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8368, 'worst_acc': 0.7321, 'acc_0_0': 0.8625, 'acc_0_1': 0.9339, 'acc_1_0': 0.891, 'acc_1_1': 0.7321, 'mean_acc': 0.879}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3284, 'acc_0_0': 0.6609, 'acc_0_1': 0.97, 'acc_1_0': 0.7727, 'acc_1_1': 0.3284, 'mean_acc': 0.7563}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.8798, 'acc_0_0': 0.906, 'acc_0_1': 0.8798, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.8621, 'acc_0_0': 0.9131, 'acc_0_1': 0.8621, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8854}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.8069, 'acc_0_0': 0.953, 'acc_0_1': 0.8069, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9403, 'worst_acc': 0.8006, 'acc_0_0': 0.9557, 'acc_0_1': 0.804, 'acc_1_0': 0.8006, 'acc_1_1': 0.9206, 'mean_acc': 0.8756}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2687, 'acc_0_0': 0.9742, 'acc_0_1': 0.8584, 'acc_1_0': 0.7727, 'acc_1_1': 0.2687, 'mean_acc': 0.828}
Val(class)(new adapter): {'weighted_mean_acc': 0.9533, 'worst_acc': 0.7468, 'acc_0_0': 0.9615, 'acc_0_1': 0.7468, 'acc_1_0': 0.806, 'acc_1_1': 0.9697, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9472, 'worst_acc': 0.7441, 'acc_0_0': 0.9663, 'acc_0_1': 0.7441, 'acc_1_0': 0.7804, 'acc_1_1': 0.9283, 'mean_acc': 0.855}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.697, 'acc_0_0': 0.9871, 'acc_0_1': 0.9399, 'acc_1_0': 0.697, 'acc_1_1': 0.9701, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9505, 'worst_acc': 0.7511, 'acc_0_0': 0.9573, 'acc_0_1': 0.7511, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9467, 'worst_acc': 0.745, 'acc_0_0': 0.965, 'acc_0_1': 0.745, 'acc_1_0': 0.7835, 'acc_1_1': 0.9299, 'mean_acc': 0.8554}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.9742, 'acc_0_1': 0.8627, 'acc_1_0': 0.7727, 'acc_1_1': 0.403, 'mean_acc': 0.8447}
Val(class)(new adapter): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.7554, 'acc_0_0': 0.953, 'acc_0_1': 0.7554, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.7534, 'acc_0_0': 0.961, 'acc_0_1': 0.7534, 'acc_1_0': 0.7928, 'acc_1_1': 0.9252, 'mean_acc': 0.8576}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9828, 'acc_0_1': 0.9185, 'acc_1_0': 0.7424, 'acc_1_1': 0.9701, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9433, 'worst_acc': 0.8026, 'acc_0_0': 0.9487, 'acc_0_1': 0.8026, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9391, 'worst_acc': 0.7987, 'acc_0_0': 0.9557, 'acc_0_1': 0.7987, 'acc_1_0': 0.8006, 'acc_1_1': 0.9159, 'mean_acc': 0.873}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.9142, 'acc_0_1': 0.9356, 'acc_1_0': 0.8636, 'acc_1_1': 0.6418, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.9444, 'worst_acc': 0.8283, 'acc_0_0': 0.9487, 'acc_0_1': 0.8283, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9349, 'worst_acc': 0.8129, 'acc_0_0': 0.949, 'acc_0_1': 0.8129, 'acc_1_0': 0.8146, 'acc_1_1': 0.9159, 'mean_acc': 0.8775}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9614, 'acc_0_1': 0.9313, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.8455, 'acc_0_0': 0.9487, 'acc_0_1': 0.8455, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.8255, 'acc_0_0': 0.9428, 'acc_0_1': 0.8404, 'acc_1_0': 0.8255, 'acc_1_1': 0.905, 'mean_acc': 0.8857}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.597, 'acc_0_0': 0.8498, 'acc_0_1': 0.9828, 'acc_1_0': 0.8333, 'acc_1_1': 0.597, 'mean_acc': 0.8715}
Val(class)(new adapter): {'weighted_mean_acc': 0.9419, 'worst_acc': 0.8498, 'acc_0_0': 0.9487, 'acc_0_1': 0.8498, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.824, 'acc_0_0': 0.945, 'acc_0_1': 0.8541, 'acc_1_0': 0.824, 'acc_1_1': 0.8988, 'mean_acc': 0.8911}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9528, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.8507, 'acc_0_0': 0.9487, 'acc_0_1': 0.867, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9325, 'worst_acc': 0.824, 'acc_0_0': 0.9481, 'acc_0_1': 0.8812, 'acc_1_0': 0.824, 'acc_1_1': 0.8956, 'mean_acc': 0.9025}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5373, 'acc_0_0': 0.8369, 'acc_0_1': 0.9957, 'acc_1_0': 0.803, 'acc_1_1': 0.5373, 'mean_acc': 0.8614}
Val(class)(new adapter): {'weighted_mean_acc': 0.946, 'worst_acc': 0.8358, 'acc_0_0': 0.953, 'acc_0_1': 0.8841, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9378, 'worst_acc': 0.8193, 'acc_0_0': 0.9561, 'acc_0_1': 0.8856, 'acc_1_0': 0.8193, 'acc_1_1': 0.8925, 'mean_acc': 0.9065}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9742, 'acc_0_1': 0.9657, 'acc_1_0': 0.8333, 'acc_1_1': 0.9552, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9461, 'worst_acc': 0.8358, 'acc_0_0': 0.953, 'acc_0_1': 0.8884, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.8006, 'acc_0_0': 0.9623, 'acc_0_1': 0.8967, 'acc_1_0': 0.8006, 'acc_1_1': 0.8863, 'mean_acc': 0.9104}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.8841, 'acc_0_1': 0.9957, 'acc_1_0': 0.8182, 'acc_1_1': 0.6716, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.9458, 'worst_acc': 0.8209, 'acc_0_0': 0.953, 'acc_0_1': 0.8841, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.7882, 'acc_0_0': 0.965, 'acc_0_1': 0.8936, 'acc_1_0': 0.7882, 'acc_1_1': 0.8879, 'mean_acc': 0.909}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9871, 'acc_0_1': 0.9571, 'acc_1_0': 0.803, 'acc_1_1': 0.9552, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.806, 'acc_0_0': 0.9615, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9438, 'worst_acc': 0.7804, 'acc_0_0': 0.9667, 'acc_0_1': 0.8887, 'acc_1_0': 0.7804, 'acc_1_1': 0.8863, 'mean_acc': 0.9068}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.9356, 'acc_0_1': 0.9785, 'acc_1_0': 0.8636, 'acc_1_1': 0.791, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.806, 'acc_0_0': 0.9658, 'acc_0_1': 0.867, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.7757, 'acc_0_0': 0.969, 'acc_0_1': 0.882, 'acc_1_0': 0.7757, 'acc_1_1': 0.891, 'mean_acc': 0.9051}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9914, 'acc_0_1': 0.9528, 'acc_1_0': 0.7727, 'acc_1_1': 0.9701, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.806, 'acc_0_0': 0.9658, 'acc_0_1': 0.8712, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9481, 'worst_acc': 0.771, 'acc_0_0': 0.9721, 'acc_0_1': 0.8834, 'acc_1_0': 0.771, 'acc_1_1': 0.8894, 'mean_acc': 0.9061}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9399, 'acc_0_1': 0.97, 'acc_1_0': 0.9091, 'acc_1_1': 0.8358, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.7761, 'acc_0_0': 0.9658, 'acc_0_1': 0.8755, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.7664, 'acc_0_0': 0.9725, 'acc_0_1': 0.8878, 'acc_1_0': 0.7664, 'acc_1_1': 0.8879, 'mean_acc': 0.9073}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9914, 'acc_0_1': 0.9528, 'acc_1_0': 0.7879, 'acc_1_1': 0.9701, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.791, 'acc_0_0': 0.9658, 'acc_0_1': 0.8841, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.7632, 'acc_0_0': 0.9729, 'acc_0_1': 0.8945, 'acc_1_0': 0.7632, 'acc_1_1': 0.8816, 'mean_acc': 0.909}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9442, 'acc_0_1': 0.9657, 'acc_1_0': 0.8939, 'acc_1_1': 0.8358, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.955, 'worst_acc': 0.791, 'acc_0_0': 0.9658, 'acc_0_1': 0.8884, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.7601, 'acc_0_0': 0.9743, 'acc_0_1': 0.9016, 'acc_1_0': 0.7601, 'acc_1_1': 0.8769, 'mean_acc': 0.9115}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9914, 'acc_0_1': 0.9657, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.956, 'worst_acc': 0.791, 'acc_0_0': 0.9658, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.7601, 'acc_0_0': 0.9743, 'acc_0_1': 0.9095, 'acc_1_0': 0.7601, 'acc_1_1': 0.8629, 'mean_acc': 0.913}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9528, 'acc_0_1': 0.97, 'acc_1_0': 0.9091, 'acc_1_1': 0.8507, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.791, 'acc_0_0': 0.9615, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9415, 'worst_acc': 0.7601, 'acc_0_0': 0.9738, 'acc_0_1': 0.9144, 'acc_1_0': 0.7601, 'acc_1_1': 0.8489, 'mean_acc': 0.9132}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9497, 'worst_acc': 0.791, 'acc_0_0': 0.9615, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.937, 'worst_acc': 0.7632, 'acc_0_0': 0.9712, 'acc_0_1': 0.9255, 'acc_1_0': 0.7632, 'acc_1_1': 0.8349, 'mean_acc': 0.9153}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.9242, 'acc_1_1': 0.806, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9464, 'worst_acc': 0.791, 'acc_0_0': 0.9573, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9353, 'worst_acc': 0.7726, 'acc_0_0': 0.9698, 'acc_0_1': 0.9228, 'acc_1_0': 0.7726, 'acc_1_1': 0.8318, 'mean_acc': 0.9144}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9466, 'worst_acc': 0.791, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7882, 'acc_0_0': 0.9667, 'acc_0_1': 0.9233, 'acc_1_0': 0.7882, 'acc_1_1': 0.8318, 'mean_acc': 0.9151}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.97, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.806, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9457, 'worst_acc': 0.791, 'acc_0_0': 0.9573, 'acc_0_1': 0.897, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9337, 'worst_acc': 0.7897, 'acc_0_0': 0.9654, 'acc_0_1': 0.9157, 'acc_1_0': 0.7897, 'acc_1_1': 0.8396, 'mean_acc': 0.9127}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9456, 'worst_acc': 0.791, 'acc_0_0': 0.9573, 'acc_0_1': 0.8927, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.7757, 'acc_0_0': 0.9663, 'acc_0_1': 0.9069, 'acc_1_0': 0.7757, 'acc_1_1': 0.852, 'mean_acc': 0.9094}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9742, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 0.8955, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9444, 'worst_acc': 0.791, 'acc_0_0': 0.9573, 'acc_0_1': 0.8627, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.7726, 'acc_0_0': 0.9663, 'acc_0_1': 0.8967, 'acc_1_0': 0.7726, 'acc_1_1': 0.8629, 'mean_acc': 0.9063}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.97, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.867, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9384, 'worst_acc': 0.7648, 'acc_0_0': 0.9685, 'acc_0_1': 0.8976, 'acc_1_0': 0.7648, 'acc_1_1': 0.8551, 'mean_acc': 0.9058}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9344, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8712, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.7492, 'acc_0_0': 0.9694, 'acc_0_1': 0.9002, 'acc_1_0': 0.7492, 'acc_1_1': 0.8536, 'mean_acc': 0.9052}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 0.9742, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9339, 'worst_acc': 0.7492, 'acc_0_0': 0.969, 'acc_0_1': 0.9024, 'acc_1_0': 0.7492, 'acc_1_1': 0.8333, 'mean_acc': 0.9037}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.931, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9333, 'worst_acc': 0.7539, 'acc_0_0': 0.9676, 'acc_0_1': 0.9016, 'acc_1_0': 0.7539, 'acc_1_1': 0.8349, 'mean_acc': 0.9035}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.933, 'worst_acc': 0.7555, 'acc_0_0': 0.9672, 'acc_0_1': 0.9016, 'acc_1_0': 0.7555, 'acc_1_1': 0.8349, 'mean_acc': 0.9035}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9314, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.934, 'worst_acc': 0.7586, 'acc_0_0': 0.9663, 'acc_0_1': 0.8984, 'acc_1_0': 0.7586, 'acc_1_1': 0.8427, 'mean_acc': 0.9032}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9345, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.7648, 'acc_0_0': 0.9645, 'acc_0_1': 0.8984, 'acc_1_0': 0.7648, 'acc_1_1': 0.8396, 'mean_acc': 0.9028}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9377, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.867, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7664, 'acc_0_0': 0.9619, 'acc_0_1': 0.8958, 'acc_1_0': 0.7664, 'acc_1_1': 0.8411, 'mean_acc': 0.9011}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7664, 'acc_0_0': 0.9619, 'acc_0_1': 0.898, 'acc_1_0': 0.7664, 'acc_1_1': 0.8349, 'mean_acc': 0.9013}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8755, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.7679, 'acc_0_0': 0.9619, 'acc_0_1': 0.8989, 'acc_1_0': 0.7679, 'acc_1_1': 0.8302, 'mean_acc': 0.9013}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7617, 'acc_0_0': 0.9619, 'acc_0_1': 0.9011, 'acc_1_0': 0.7617, 'acc_1_1': 0.824, 'mean_acc': 0.9008}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7664, 'acc_0_0': 0.9614, 'acc_0_1': 0.902, 'acc_1_0': 0.7664, 'acc_1_1': 0.824, 'mean_acc': 0.9014}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7726, 'acc_0_0': 0.9601, 'acc_0_1': 0.9016, 'acc_1_0': 0.7726, 'acc_1_1': 0.8271, 'mean_acc': 0.9018}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7695, 'acc_0_0': 0.9614, 'acc_0_1': 0.9042, 'acc_1_0': 0.7695, 'acc_1_1': 0.8224, 'mean_acc': 0.9025}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7741, 'acc_0_0': 0.9583, 'acc_0_1': 0.9038, 'acc_1_0': 0.7741, 'acc_1_1': 0.824, 'mean_acc': 0.9018}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9249, 'worst_acc': 0.7741, 'acc_0_0': 0.9588, 'acc_0_1': 0.906, 'acc_1_0': 0.7741, 'acc_1_1': 0.824, 'mean_acc': 0.9028}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7788, 'acc_0_0': 0.9579, 'acc_0_1': 0.9055, 'acc_1_0': 0.7788, 'acc_1_1': 0.824, 'mean_acc': 0.9028}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9785, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7804, 'acc_0_0': 0.9579, 'acc_0_1': 0.9064, 'acc_1_0': 0.7804, 'acc_1_1': 0.8224, 'mean_acc': 0.9032}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7773, 'acc_0_0': 0.9588, 'acc_0_1': 0.9055, 'acc_1_0': 0.7773, 'acc_1_1': 0.8224, 'mean_acc': 0.9028}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7804, 'acc_0_0': 0.9579, 'acc_0_1': 0.9029, 'acc_1_0': 0.7804, 'acc_1_1': 0.8255, 'mean_acc': 0.9021}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7741, 'acc_0_0': 0.9596, 'acc_0_1': 0.9073, 'acc_1_0': 0.7741, 'acc_1_1': 0.8193, 'mean_acc': 0.9032}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7741, 'acc_0_0': 0.9596, 'acc_0_1': 0.9064, 'acc_1_0': 0.7741, 'acc_1_1': 0.8178, 'mean_acc': 0.9027}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7773, 'acc_0_0': 0.9588, 'acc_0_1': 0.9055, 'acc_1_0': 0.7773, 'acc_1_1': 0.8209, 'mean_acc': 0.9027}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7757, 'acc_0_0': 0.9588, 'acc_0_1': 0.906, 'acc_1_0': 0.7757, 'acc_1_1': 0.8178, 'mean_acc': 0.9023}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7761, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7835, 'acc_0_0': 0.9579, 'acc_0_1': 0.9051, 'acc_1_0': 0.7835, 'acc_1_1': 0.824, 'mean_acc': 0.9032}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.97, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.785, 'acc_0_0': 0.9565, 'acc_0_1': 0.9064, 'acc_1_0': 0.785, 'acc_1_1': 0.8162, 'mean_acc': 0.9025}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.785, 'acc_0_0': 0.9565, 'acc_0_1': 0.9047, 'acc_1_0': 0.785, 'acc_1_1': 0.8209, 'mean_acc': 0.9023}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7835, 'acc_0_0': 0.9574, 'acc_0_1': 0.9064, 'acc_1_0': 0.7835, 'acc_1_1': 0.8178, 'mean_acc': 0.9028}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.3284, 'acc_0_0': 0.6609, 'acc_0_1': 0.97, 'acc_1_0': 0.7727, 'acc_1_1': 0.3284, 'mean_acc': 0.7563}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9122, 'worst_acc': 0.8798, 'acc_0_0': 0.906, 'acc_0_1': 0.8798, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8983}
best test accuracy on [class]: {'weighted_mean_acc': 0.906, 'worst_acc': 0.8621, 'acc_0_0': 0.9131, 'acc_0_1': 0.8621, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8854}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.906, 'worst_acc': 0.8621, 'acc_0_0': 0.9131, 'acc_0_1': 0.8621, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8854}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.5327, 'acc_0_0': 0.9765, 'acc_0_1': 0.8891, 'acc_1_0': 0.5327, 'acc_1_1': 0.9829, 'mean_acc': 0.894}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.3284, 'acc_0_0': 0.6609, 'acc_0_1': 0.97, 'acc_1_0': 0.7727, 'acc_1_1': 0.3284, 'mean_acc': 0.7563}, 'Val': {'weighted_mean_acc': 0.9122, 'worst_acc': 0.8798, 'acc_0_0': 0.906, 'acc_0_1': 0.8798, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8983}, 'Test': {'weighted_mean_acc': 0.906, 'worst_acc': 0.8621, 'acc_0_0': 0.9131, 'acc_0_1': 0.8621, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8854}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.906, 'worst_acc': 0.8621, 'acc_0_0': 0.9131, 'acc_0_1': 0.8621, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8854}, 'spurious': {'weighted_mean_acc': 0.9694, 'worst_acc': 0.5327, 'acc_0_0': 0.9765, 'acc_0_1': 0.8891, 'acc_1_0': 0.5327, 'acc_1_1': 0.9829, 'mean_acc': 0.894}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.1786, 'acc_0_0': 0.9688, 'acc_0_1': 0.7609, 'acc_1_0': 0.1786, 'acc_1_1': 0.3453, 'mean_acc': 0.8142}
Val(class): {'weighted_mean_acc': 0.9511, 'worst_acc': 0.2704, 'acc_0_0': 0.9829, 'acc_0_1': 0.2704, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.66}
Test(class): {'weighted_mean_acc': 0.9454, 'worst_acc': 0.2554, 'acc_0_0': 0.9814, 'acc_0_1': 0.2554, 'acc_1_0': 0.5841, 'acc_1_1': 0.9657, 'mean_acc': 0.6531}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1576, 'acc_0_0': 0.9568, 'acc_0_1': 0.1576, 'acc_1_0': 0.6429, 'acc_1_1': 0.9763, 'mean_acc': 0.9268}
Val(class): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.3562, 'acc_0_0': 0.9829, 'acc_0_1': 0.3562, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6967}
Test(class): {'weighted_mean_acc': 0.9527, 'worst_acc': 0.329, 'acc_0_0': 0.9871, 'acc_0_1': 0.329, 'acc_1_0': 0.6012, 'acc_1_1': 0.9657, 'mean_acc': 0.6859}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.375, 'acc_0_0': 0.9977, 'acc_0_1': 0.7228, 'acc_1_0': 0.375, 'acc_1_1': 0.8761, 'mean_acc': 0.9531}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5125, 'acc_0_0': 0.9951, 'acc_0_1': 0.663, 'acc_1_0': 0.5125, 'acc_1_1': 0.9128, 'mean_acc': 0.8032}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9946, 'acc_0_1': 0.6033, 'acc_1_0': 0.5357, 'acc_1_1': 0.9272, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.3948, 'acc_0_0': 0.9915, 'acc_0_1': 0.3948, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7233}
Test(class): {'weighted_mean_acc': 0.9543, 'worst_acc': 0.3871, 'acc_0_0': 0.9858, 'acc_0_1': 0.3871, 'acc_1_0': 0.6636, 'acc_1_1': 0.9642, 'mean_acc': 0.7147}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9886, 'acc_0_1': 0.4891, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9597}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.7047, 'acc_1_0': 0.6121, 'acc_1_1': 0.9174, 'mean_acc': 0.8297}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9937, 'acc_0_1': 0.75, 'acc_1_0': 0.6607, 'acc_1_1': 0.9139, 'mean_acc': 0.9629}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7854, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.7508, 'acc_1_0': 0.6028, 'acc_1_1': 0.9143, 'mean_acc': 0.8469}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.9906, 'acc_0_1': 0.663, 'acc_1_0': 0.7321, 'acc_1_1': 0.9413, 'mean_acc': 0.9641}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7167, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6121, 'acc_0_0': 0.9933, 'acc_0_1': 0.7033, 'acc_1_0': 0.6121, 'acc_1_1': 0.9221, 'mean_acc': 0.8303}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9926, 'acc_0_1': 0.75, 'acc_1_0': 0.6964, 'acc_1_1': 0.9395, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6269, 'acc_0_0': 1.0, 'acc_0_1': 0.7897, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.6012, 'acc_0_0': 0.9938, 'acc_0_1': 0.7543, 'acc_1_0': 0.6012, 'acc_1_1': 0.9174, 'mean_acc': 0.8486}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9917, 'acc_0_1': 0.7228, 'acc_1_0': 0.75, 'acc_1_1': 0.9461, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7033, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8307}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9926, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9413, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9724, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6137, 'acc_0_0': 0.9929, 'acc_0_1': 0.7135, 'acc_1_0': 0.6137, 'acc_1_1': 0.9252, 'mean_acc': 0.8347}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9917, 'acc_0_1': 0.7446, 'acc_1_0': 0.6964, 'acc_1_1': 0.9565, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8283, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5545, 'acc_0_0': 0.9956, 'acc_0_1': 0.7982, 'acc_1_0': 0.5545, 'acc_1_1': 0.905, 'mean_acc': 0.8599}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9937, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9536, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.7468, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.7255, 'acc_1_0': 0.5935, 'acc_1_1': 0.9252, 'mean_acc': 0.8371}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9946, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.5857, 'acc_0_0': 0.9938, 'acc_0_1': 0.7756, 'acc_1_0': 0.5857, 'acc_1_1': 0.919, 'mean_acc': 0.8554}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.994, 'acc_0_1': 0.7989, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9771}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.8018, 'acc_1_0': 0.567, 'acc_1_1': 0.9159, 'mean_acc': 0.8628}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9971, 'acc_0_1': 0.7935, 'acc_1_0': 0.7679, 'acc_1_1': 0.9546, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6464, 'acc_0_0': 0.988, 'acc_0_1': 0.6528, 'acc_1_0': 0.6464, 'acc_1_1': 0.9408, 'mean_acc': 0.8145}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.8393, 'acc_1_1': 0.964, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.6119, 'acc_0_0': 1.0, 'acc_0_1': 0.8326, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5935, 'acc_0_0': 0.9929, 'acc_0_1': 0.8248, 'acc_1_0': 0.5935, 'acc_1_1': 0.9112, 'mean_acc': 0.8742}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9949, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.8498, 'acc_1_0': 0.5373, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5421, 'acc_0_0': 0.9965, 'acc_0_1': 0.8333, 'acc_1_0': 0.5421, 'acc_1_1': 0.9034, 'mean_acc': 0.8723}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9974, 'acc_0_1': 0.837, 'acc_1_0': 0.8036, 'acc_1_1': 0.9603, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9761, 'worst_acc': 0.6996, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.7612, 'acc_1_1': 0.9848, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6869, 'acc_0_0': 0.9867, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9393, 'mean_acc': 0.8321}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.875, 'acc_1_1': 0.9726, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.7015, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.6869, 'acc_0_0': 0.9871, 'acc_0_1': 0.6869, 'acc_1_0': 0.6916, 'acc_1_1': 0.9486, 'mean_acc': 0.8333}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9989, 'acc_0_1': 0.8804, 'acc_1_0': 0.8393, 'acc_1_1': 0.9773, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9769, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.5903, 'acc_0_0': 0.9938, 'acc_0_1': 0.788, 'acc_1_0': 0.5903, 'acc_1_1': 0.9174, 'mean_acc': 0.8605}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.998, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.9877, 'mean_acc': 0.9898}
Val(class): {'weighted_mean_acc': 0.9782, 'worst_acc': 0.6418, 'acc_0_0': 1.0, 'acc_0_1': 0.8026, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6433, 'acc_0_0': 0.9929, 'acc_0_1': 0.8053, 'acc_1_0': 0.6433, 'acc_1_1': 0.9128, 'mean_acc': 0.8723}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 0.9983, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9782, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6953, 'acc_0_0': 0.9872, 'acc_0_1': 0.6953, 'acc_1_0': 0.7164, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6636, 'acc_0_0': 0.988, 'acc_0_1': 0.6767, 'acc_1_0': 0.6636, 'acc_1_1': 0.9424, 'mean_acc': 0.8259}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.875, 'acc_1_0': 0.8929, 'acc_1_1': 0.9858, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.7468, 'acc_0_0': 0.9829, 'acc_0_1': 0.7468, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9578, 'worst_acc': 0.7103, 'acc_0_0': 0.9823, 'acc_0_1': 0.7459, 'acc_1_0': 0.7103, 'acc_1_1': 0.9268, 'mean_acc': 0.854}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9966, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9754, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9814, 'worst_acc': 0.5821, 'acc_0_0': 1.0, 'acc_0_1': 0.8155, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8783}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.5654, 'acc_0_0': 0.996, 'acc_0_1': 0.8257, 'acc_1_0': 0.5654, 'acc_1_1': 0.8769, 'mean_acc': 0.8688}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9969, 'acc_0_1': 0.9076, 'acc_1_0': 0.9107, 'acc_1_1': 0.9792, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6716, 'acc_0_0': 0.9829, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9563, 'worst_acc': 0.6293, 'acc_0_0': 0.9849, 'acc_0_1': 0.7157, 'acc_1_0': 0.6293, 'acc_1_1': 0.9206, 'mean_acc': 0.8336}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9969, 'acc_0_1': 0.8533, 'acc_1_0': 0.9107, 'acc_1_1': 0.9688, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.6223, 'acc_0_0': 0.9658, 'acc_0_1': 0.6223, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.6137, 'acc_0_0': 0.9747, 'acc_0_1': 0.6137, 'acc_1_0': 0.6807, 'acc_1_1': 0.9424, 'mean_acc': 0.7981}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9971, 'acc_0_1': 0.8152, 'acc_1_0': 0.8214, 'acc_1_1': 0.9735, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.5452, 'acc_0_0': 0.9933, 'acc_0_1': 0.8009, 'acc_1_0': 0.5452, 'acc_1_1': 0.8879, 'mean_acc': 0.8571}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9926, 'acc_0_1': 0.8315, 'acc_1_0': 0.9107, 'acc_1_1': 0.9527, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5821, 'acc_0_0': 0.9872, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8617}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.5327, 'acc_0_0': 0.9942, 'acc_0_1': 0.7827, 'acc_1_0': 0.5327, 'acc_1_1': 0.9143, 'mean_acc': 0.8519}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9957, 'acc_0_1': 0.875, 'acc_1_0': 0.8036, 'acc_1_1': 0.9631, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.515, 'acc_0_0': 0.9829, 'acc_0_1': 0.515, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9579, 'worst_acc': 0.5401, 'acc_0_0': 0.9876, 'acc_0_1': 0.5401, 'acc_1_0': 0.6526, 'acc_1_1': 0.9486, 'mean_acc': 0.772}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8424, 'acc_1_0': 0.8393, 'acc_1_1': 0.9782, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6953, 'acc_0_0': 0.9744, 'acc_0_1': 0.6953, 'acc_1_0': 0.7761, 'acc_1_1': 0.9848, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.6851, 'acc_0_0': 0.9756, 'acc_0_1': 0.6851, 'acc_1_0': 0.743, 'acc_1_1': 0.9455, 'mean_acc': 0.8334}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 0.9983, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.983, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.4925, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.5171, 'acc_0_0': 0.9951, 'acc_0_1': 0.8537, 'acc_1_0': 0.5171, 'acc_1_1': 0.8956, 'mean_acc': 0.8761}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9963, 'acc_0_1': 0.8967, 'acc_1_0': 0.9107, 'acc_1_1': 0.9754, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.8627, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.8647, 'acc_1_0': 0.6012, 'acc_1_1': 0.8769, 'mean_acc': 0.8866}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9983, 'acc_0_1': 0.8804, 'acc_1_0': 0.9464, 'acc_1_1': 0.9735, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6153, 'acc_0_0': 0.9911, 'acc_0_1': 0.8111, 'acc_1_0': 0.6153, 'acc_1_1': 0.8941, 'mean_acc': 0.8687}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9983, 'acc_0_1': 0.875, 'acc_1_0': 0.9821, 'acc_1_1': 0.9763, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.8026, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6028, 'acc_0_0': 0.9933, 'acc_0_1': 0.8106, 'acc_1_0': 0.6028, 'acc_1_1': 0.9003, 'mean_acc': 0.8687}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.983, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.6866, 'acc_0_0': 0.9786, 'acc_0_1': 0.6953, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.6542, 'acc_0_0': 0.9778, 'acc_0_1': 0.7251, 'acc_1_0': 0.6542, 'acc_1_1': 0.9252, 'mean_acc': 0.8378}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9977, 'acc_0_1': 0.9565, 'acc_1_0': 0.9464, 'acc_1_1': 0.9877, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.5224, 'acc_1_1': 0.9091, 'mean_acc': 0.86}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8084, 'acc_1_0': 0.5779, 'acc_1_1': 0.905, 'mean_acc': 0.865}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9971, 'acc_0_1': 0.9457, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.99}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.4635, 'acc_0_0': 0.9829, 'acc_0_1': 0.4635, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7433}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4692, 'acc_0_0': 0.9871, 'acc_0_1': 0.4692, 'acc_1_0': 0.6449, 'acc_1_1': 0.9673, 'mean_acc': 0.7454}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9946, 'acc_0_1': 0.7989, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9806}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4776, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.4776, 'acc_1_1': 0.9394, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.5218, 'acc_0_0': 0.9951, 'acc_0_1': 0.8319, 'acc_1_0': 0.5218, 'acc_1_1': 0.8879, 'mean_acc': 0.8673}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.9949, 'acc_0_1': 0.9022, 'acc_1_0': 0.7679, 'acc_1_1': 0.9593, 'mean_acc': 0.9808}
Val(class): {'weighted_mean_acc': 0.9571, 'worst_acc': 0.4328, 'acc_0_0': 0.9957, 'acc_0_1': 0.8326, 'acc_1_0': 0.4328, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.4922, 'acc_0_0': 0.9938, 'acc_0_1': 0.855, 'acc_1_0': 0.4922, 'acc_1_1': 0.8769, 'mean_acc': 0.8712}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9971, 'acc_0_1': 0.8696, 'acc_1_0': 0.8393, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.3863, 'acc_0_0': 0.9701, 'acc_0_1': 0.3863, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.7217}
Test(class): {'weighted_mean_acc': 0.9447, 'worst_acc': 0.3951, 'acc_0_0': 0.969, 'acc_0_1': 0.3951, 'acc_1_0': 0.7165, 'acc_1_1': 0.972, 'mean_acc': 0.718}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5606, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.5606, 'acc_1_1': 0.9552, 'mean_acc': 0.788}
Val(class)(new adapter): {'weighted_mean_acc': 0.8787, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.9571, 'acc_1_0': 0.4776, 'acc_1_1': 0.4848, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8665, 'worst_acc': 0.433, 'acc_0_0': 0.9969, 'acc_0_1': 0.9769, 'acc_1_0': 0.5374, 'acc_1_1': 0.433, 'mean_acc': 0.8757}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0152, 'acc_0_0': 0.9571, 'acc_0_1': 0.1373, 'acc_1_0': 0.0152, 'acc_1_1': 0.2537, 'mean_acc': 0.4558}
Val(class)(new adapter): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.2961, 'acc_0_0': 0.9829, 'acc_0_1': 0.2961, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.6817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9484, 'worst_acc': 0.2887, 'acc_0_0': 0.9796, 'acc_0_1': 0.2887, 'acc_1_0': 0.662, 'acc_1_1': 0.9751, 'mean_acc': 0.675}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4545, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.4545, 'acc_1_1': 0.8955, 'mean_acc': 0.7462}
Val(class)(new adapter): {'weighted_mean_acc': 0.8542, 'worst_acc': 0.8462, 'acc_0_0': 0.8462, 'acc_0_1': 0.8627, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.8387, 'worst_acc': 0.8306, 'acc_0_0': 0.8306, 'acc_0_1': 0.8661, 'acc_1_0': 0.8894, 'acc_1_1': 0.8583, 'mean_acc': 0.854}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0896, 'acc_0_0': 0.7425, 'acc_0_1': 0.9442, 'acc_1_0': 0.8333, 'acc_1_1': 0.0896, 'mean_acc': 0.7579}
Val(class)(new adapter): {'weighted_mean_acc': 0.828, 'worst_acc': 0.6818, 'acc_0_0': 0.8675, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.6818, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.8291, 'worst_acc': 0.6885, 'acc_0_0': 0.8661, 'acc_0_1': 0.9193, 'acc_1_0': 0.8801, 'acc_1_1': 0.6885, 'mean_acc': 0.8687}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5224, 'acc_0_0': 0.9785, 'acc_0_1': 0.9742, 'acc_1_0': 0.7576, 'acc_1_1': 0.5224, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.8566, 'worst_acc': 0.7273, 'acc_0_0': 0.8932, 'acc_0_1': 0.9013, 'acc_1_0': 0.8657, 'acc_1_1': 0.7273, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8613, 'worst_acc': 0.7352, 'acc_0_0': 0.8971, 'acc_0_1': 0.9011, 'acc_1_0': 0.8754, 'acc_1_1': 0.7352, 'mean_acc': 0.8783}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0448, 'acc_0_0': 0.927, 'acc_0_1': 0.9227, 'acc_1_0': 0.8333, 'acc_1_1': 0.0448, 'mean_acc': 0.8164}
Val(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.867, 'acc_0_0': 0.8932, 'acc_0_1': 0.867, 'acc_1_0': 0.8955, 'acc_1_1': 0.9091, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8814, 'worst_acc': 0.8448, 'acc_0_0': 0.8869, 'acc_0_1': 0.8448, 'acc_1_0': 0.891, 'acc_1_1': 0.8692, 'mean_acc': 0.869}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.9657, 'acc_1_0': 0.803, 'acc_1_1': 0.8806, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.8412, 'acc_0_0': 0.8846, 'acc_0_1': 0.8412, 'acc_1_0': 0.8955, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8865, 'worst_acc': 0.8244, 'acc_0_0': 0.8829, 'acc_0_1': 0.8244, 'acc_1_0': 0.9019, 'acc_1_1': 0.9081, 'mean_acc': 0.865}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4925, 'acc_0_0': 0.9099, 'acc_0_1': 0.97, 'acc_1_0': 0.7879, 'acc_1_1': 0.4925, 'mean_acc': 0.8731}
Val(class)(new adapter): {'weighted_mean_acc': 0.8974, 'worst_acc': 0.8197, 'acc_0_0': 0.8889, 'acc_0_1': 0.8197, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8084, 'acc_0_0': 0.8918, 'acc_0_1': 0.8084, 'acc_1_0': 0.8956, 'acc_1_1': 0.9237, 'mean_acc': 0.8633}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9785, 'acc_0_1': 0.9313, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.8197, 'acc_0_0': 0.8974, 'acc_0_1': 0.8197, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.8062, 'acc_0_0': 0.8927, 'acc_0_1': 0.8062, 'acc_1_0': 0.8956, 'acc_1_1': 0.9252, 'mean_acc': 0.863}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.8927, 'acc_0_1': 0.9957, 'acc_1_0': 0.7727, 'acc_1_1': 0.6866, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.7768, 'acc_0_0': 0.8846, 'acc_0_1': 0.7768, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class)(new adapter): {'weighted_mean_acc': 0.8897, 'worst_acc': 0.7774, 'acc_0_0': 0.8834, 'acc_0_1': 0.7774, 'acc_1_0': 0.8956, 'acc_1_1': 0.9299, 'mean_acc': 0.8486}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.9185, 'acc_1_0': 0.8636, 'acc_1_1': 0.9552, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.8671, 'worst_acc': 0.7682, 'acc_0_0': 0.8504, 'acc_0_1': 0.7682, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class)(new adapter): {'weighted_mean_acc': 0.8643, 'worst_acc': 0.7707, 'acc_0_0': 0.8479, 'acc_0_1': 0.7707, 'acc_1_0': 0.9034, 'acc_1_1': 0.933, 'mean_acc': 0.8334}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9056, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.7313, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.8829, 'worst_acc': 0.7854, 'acc_0_0': 0.8761, 'acc_0_1': 0.7854, 'acc_1_0': 0.8507, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.8837, 'worst_acc': 0.7871, 'acc_0_0': 0.8767, 'acc_0_1': 0.7871, 'acc_1_0': 0.8832, 'acc_1_1': 0.9237, 'mean_acc': 0.8478}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9871, 'acc_0_1': 0.9528, 'acc_1_0': 0.803, 'acc_1_1': 0.9403, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.8283, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.8506, 'acc_0_0': 0.9184, 'acc_0_1': 0.8506, 'acc_1_0': 0.8536, 'acc_1_1': 0.8832, 'mean_acc': 0.8809}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6119, 'acc_0_0': 0.9785, 'acc_0_1': 0.927, 'acc_1_0': 0.8788, 'acc_1_1': 0.6119, 'mean_acc': 0.9065}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.8442, 'acc_0_0': 0.9282, 'acc_0_1': 0.8816, 'acc_1_0': 0.8442, 'acc_1_1': 0.8551, 'mean_acc': 0.8926}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.7727, 'acc_1_1': 0.8806, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.8209, 'acc_0_0': 0.9017, 'acc_0_1': 0.8798, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.8489, 'acc_0_0': 0.9104, 'acc_0_1': 0.8909, 'acc_1_0': 0.8629, 'acc_1_1': 0.8489, 'mean_acc': 0.8907}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7015, 'acc_0_0': 0.9485, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.7015, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.8864, 'worst_acc': 0.8358, 'acc_0_0': 0.8846, 'acc_0_1': 0.8927, 'acc_1_0': 0.8358, 'acc_1_1': 0.8939, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8869, 'worst_acc': 0.8551, 'acc_0_0': 0.8962, 'acc_0_1': 0.8953, 'acc_1_0': 0.8754, 'acc_1_1': 0.8551, 'mean_acc': 0.889}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9828, 'acc_0_1': 0.9657, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8863, 'worst_acc': 0.8209, 'acc_0_0': 0.8889, 'acc_0_1': 0.9013, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.891, 'worst_acc': 0.8427, 'acc_0_0': 0.9051, 'acc_0_1': 0.9069, 'acc_1_0': 0.8707, 'acc_1_1': 0.8427, 'mean_acc': 0.8951}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.8627, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.8507, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.8364, 'acc_0_0': 0.941, 'acc_0_1': 0.9193, 'acc_1_0': 0.8396, 'acc_1_1': 0.8364, 'mean_acc': 0.9097}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9871, 'acc_0_1': 0.97, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.7835, 'acc_0_0': 0.9654, 'acc_0_1': 0.9251, 'acc_1_0': 0.7835, 'acc_1_1': 0.8255, 'mean_acc': 0.914}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9871, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9104, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.938, 'worst_acc': 0.6418, 'acc_0_0': 0.9701, 'acc_0_1': 0.9313, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9374, 'worst_acc': 0.7445, 'acc_0_0': 0.9752, 'acc_0_1': 0.929, 'acc_1_0': 0.7445, 'acc_1_1': 0.824, 'mean_acc': 0.9149}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8636, 'acc_1_1': 0.9851, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9381, 'worst_acc': 0.6418, 'acc_0_0': 0.9701, 'acc_0_1': 0.9356, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9364, 'worst_acc': 0.7336, 'acc_0_0': 0.9761, 'acc_0_1': 0.9335, 'acc_1_0': 0.7336, 'acc_1_1': 0.8162, 'mean_acc': 0.9149}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9871, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.8806, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.6269, 'acc_0_0': 0.9615, 'acc_0_1': 0.9313, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.7445, 'acc_0_0': 0.9716, 'acc_0_1': 0.9277, 'acc_1_0': 0.7445, 'acc_1_1': 0.8255, 'mean_acc': 0.9132}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7601, 'acc_0_0': 0.9614, 'acc_0_1': 0.9202, 'acc_1_0': 0.7601, 'acc_1_1': 0.8333, 'mean_acc': 0.9089}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9552, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.6716, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.6716, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7819, 'acc_0_0': 0.9525, 'acc_0_1': 0.9073, 'acc_1_0': 0.7819, 'acc_1_1': 0.8489, 'mean_acc': 0.9046}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7015, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.7015, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7975, 'acc_0_0': 0.949, 'acc_0_1': 0.9033, 'acc_1_0': 0.7975, 'acc_1_1': 0.8442, 'mean_acc': 0.9028}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.6418, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.6418, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.771, 'acc_0_0': 0.9525, 'acc_0_1': 0.9109, 'acc_1_0': 0.771, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.6119, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.6119, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7492, 'acc_0_0': 0.9557, 'acc_0_1': 0.9153, 'acc_1_0': 0.7492, 'acc_1_1': 0.8209, 'mean_acc': 0.9021}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9552, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.6119, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.6119, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7368, 'acc_0_0': 0.9596, 'acc_0_1': 0.9215, 'acc_1_0': 0.7368, 'acc_1_1': 0.8037, 'mean_acc': 0.9028}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.6119, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.6119, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7134, 'acc_0_0': 0.9636, 'acc_0_1': 0.9233, 'acc_1_0': 0.7134, 'acc_1_1': 0.7991, 'mean_acc': 0.902}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9552, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.6269, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7118, 'acc_0_0': 0.9659, 'acc_0_1': 0.9122, 'acc_1_0': 0.7118, 'acc_1_1': 0.8162, 'mean_acc': 0.9002}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.6269, 'acc_0_0': 0.9444, 'acc_0_1': 0.897, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7181, 'acc_0_0': 0.9641, 'acc_0_1': 0.9029, 'acc_1_0': 0.7181, 'acc_1_1': 0.8193, 'mean_acc': 0.897}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9552, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.6269, 'acc_0_0': 0.9402, 'acc_0_1': 0.9099, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7196, 'acc_0_0': 0.9632, 'acc_0_1': 0.9051, 'acc_1_0': 0.7196, 'acc_1_1': 0.8069, 'mean_acc': 0.8963}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.6269, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7321, 'acc_0_0': 0.961, 'acc_0_1': 0.9095, 'acc_1_0': 0.7321, 'acc_1_1': 0.796, 'mean_acc': 0.8973}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.6269, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9188, 'worst_acc': 0.7352, 'acc_0_0': 0.9636, 'acc_0_1': 0.9171, 'acc_1_0': 0.7352, 'acc_1_1': 0.7804, 'mean_acc': 0.8999}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9376, 'worst_acc': 0.6269, 'acc_0_0': 0.9701, 'acc_0_1': 0.927, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7103, 'acc_0_0': 0.9698, 'acc_0_1': 0.9379, 'acc_1_0': 0.7103, 'acc_1_1': 0.7445, 'mean_acc': 0.9037}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9378, 'worst_acc': 0.6269, 'acc_0_0': 0.9701, 'acc_0_1': 0.9313, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7056, 'acc_0_0': 0.9698, 'acc_0_1': 0.9415, 'acc_1_0': 0.7056, 'acc_1_1': 0.7399, 'mean_acc': 0.904}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9378, 'worst_acc': 0.6269, 'acc_0_0': 0.9701, 'acc_0_1': 0.9313, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7056, 'acc_0_0': 0.9694, 'acc_0_1': 0.9406, 'acc_1_0': 0.7056, 'acc_1_1': 0.7383, 'mean_acc': 0.9033}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9378, 'worst_acc': 0.6269, 'acc_0_0': 0.9701, 'acc_0_1': 0.9313, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7056, 'acc_0_0': 0.9694, 'acc_0_1': 0.9415, 'acc_1_0': 0.7056, 'acc_1_1': 0.7383, 'mean_acc': 0.9037}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.6269, 'acc_0_0': 0.9658, 'acc_0_1': 0.9313, 'acc_1_0': 0.6269, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7072, 'acc_0_0': 0.9698, 'acc_0_1': 0.9424, 'acc_1_0': 0.7072, 'acc_1_1': 0.7352, 'mean_acc': 0.904}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.6418, 'acc_0_0': 0.953, 'acc_0_1': 0.927, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7321, 'acc_0_0': 0.9663, 'acc_0_1': 0.9392, 'acc_1_0': 0.7321, 'acc_1_1': 0.7477, 'mean_acc': 0.9056}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.6418, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7352, 'acc_0_0': 0.9659, 'acc_0_1': 0.9388, 'acc_1_0': 0.7352, 'acc_1_1': 0.7492, 'mean_acc': 0.9058}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.6418, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.743, 'acc_0_0': 0.9654, 'acc_0_1': 0.9375, 'acc_1_0': 0.743, 'acc_1_1': 0.7539, 'mean_acc': 0.9065}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.6418, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6418, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7555, 'acc_0_0': 0.9632, 'acc_0_1': 0.9339, 'acc_1_0': 0.7555, 'acc_1_1': 0.7648, 'mean_acc': 0.9068}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.757, 'acc_0_0': 0.9619, 'acc_0_1': 0.933, 'acc_1_0': 0.757, 'acc_1_1': 0.7695, 'mean_acc': 0.9066}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7555, 'acc_0_0': 0.9619, 'acc_0_1': 0.933, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9056}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.757, 'acc_0_0': 0.9605, 'acc_0_1': 0.9326, 'acc_1_0': 0.757, 'acc_1_1': 0.7632, 'mean_acc': 0.9052}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7555, 'acc_0_0': 0.9614, 'acc_0_1': 0.9335, 'acc_1_0': 0.7555, 'acc_1_1': 0.757, 'mean_acc': 0.9051}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7492, 'acc_0_0': 0.9627, 'acc_0_1': 0.9379, 'acc_1_0': 0.7508, 'acc_1_1': 0.7492, 'mean_acc': 0.9059}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7555, 'acc_0_0': 0.9605, 'acc_0_1': 0.9335, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9052}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7555, 'acc_0_0': 0.9605, 'acc_0_1': 0.9335, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9052}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.6716, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7555, 'acc_0_0': 0.9588, 'acc_0_1': 0.9326, 'acc_1_0': 0.7555, 'acc_1_1': 0.7586, 'mean_acc': 0.9039}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7601, 'acc_0_0': 0.9579, 'acc_0_1': 0.9326, 'acc_1_0': 0.7601, 'acc_1_1': 0.7695, 'mean_acc': 0.9052}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7617, 'acc_0_0': 0.9583, 'acc_0_1': 0.933, 'acc_1_0': 0.7617, 'acc_1_1': 0.7695, 'mean_acc': 0.9058}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7601, 'acc_0_0': 0.9583, 'acc_0_1': 0.9313, 'acc_1_0': 0.7601, 'acc_1_1': 0.7726, 'mean_acc': 0.9052}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7617, 'acc_0_0': 0.9588, 'acc_0_1': 0.9308, 'acc_1_0': 0.7617, 'acc_1_1': 0.7741, 'mean_acc': 0.9056}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7664, 'acc_0_0': 0.9574, 'acc_0_1': 0.9286, 'acc_1_0': 0.7664, 'acc_1_1': 0.7835, 'mean_acc': 0.9058}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7617, 'acc_0_0': 0.9574, 'acc_0_1': 0.929, 'acc_1_0': 0.7617, 'acc_1_1': 0.7788, 'mean_acc': 0.9049}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.757, 'acc_0_0': 0.961, 'acc_0_1': 0.9322, 'acc_1_0': 0.757, 'acc_1_1': 0.7741, 'mean_acc': 0.9065}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.757, 'acc_0_0': 0.9614, 'acc_0_1': 0.9322, 'acc_1_0': 0.757, 'acc_1_1': 0.7757, 'mean_acc': 0.9068}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.6567, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.6567, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7555, 'acc_0_0': 0.9619, 'acc_0_1': 0.9317, 'acc_1_0': 0.7555, 'acc_1_1': 0.7741, 'mean_acc': 0.9065}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.0448, 'acc_0_0': 0.927, 'acc_0_1': 0.9227, 'acc_1_0': 0.8333, 'acc_1_1': 0.0448, 'mean_acc': 0.8164}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8957, 'worst_acc': 0.867, 'acc_0_0': 0.8932, 'acc_0_1': 0.867, 'acc_1_0': 0.8955, 'acc_1_1': 0.9091, 'mean_acc': 0.885}
best test accuracy on [class]: {'weighted_mean_acc': 0.8814, 'worst_acc': 0.8448, 'acc_0_0': 0.8869, 'acc_0_1': 0.8448, 'acc_1_0': 0.891, 'acc_1_1': 0.8692, 'mean_acc': 0.869}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8814, 'worst_acc': 0.8448, 'acc_0_0': 0.8869, 'acc_0_1': 0.8448, 'acc_1_0': 0.891, 'acc_1_1': 0.8692, 'mean_acc': 0.869}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5047, 'acc_0_0': 0.9614, 'acc_0_1': 0.9237, 'acc_1_0': 0.5047, 'acc_1_1': 0.986, 'mean_acc': 0.8989}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.0448, 'acc_0_0': 0.927, 'acc_0_1': 0.9227, 'acc_1_0': 0.8333, 'acc_1_1': 0.0448, 'mean_acc': 0.8164}, 'Val': {'weighted_mean_acc': 0.8957, 'worst_acc': 0.867, 'acc_0_0': 0.8932, 'acc_0_1': 0.867, 'acc_1_0': 0.8955, 'acc_1_1': 0.9091, 'mean_acc': 0.885}, 'Test': {'weighted_mean_acc': 0.8814, 'worst_acc': 0.8448, 'acc_0_0': 0.8869, 'acc_0_1': 0.8448, 'acc_1_0': 0.891, 'acc_1_1': 0.8692, 'mean_acc': 0.869}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8814, 'worst_acc': 0.8448, 'acc_0_0': 0.8869, 'acc_0_1': 0.8448, 'acc_1_0': 0.891, 'acc_1_1': 0.8692, 'mean_acc': 0.869}, 'spurious': {'weighted_mean_acc': 0.9601, 'worst_acc': 0.5047, 'acc_0_0': 0.9614, 'acc_0_1': 0.9237, 'acc_1_0': 0.5047, 'acc_1_1': 0.986, 'mean_acc': 0.8989}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9043     0.8594   0.9126  ...   0.8692   0.8863    0.8842
2                       0.9060     0.8621   0.9131  ...   0.8629   0.8925    0.8854
3                       0.8814     0.8448   0.8869  ...   0.8910   0.8692    0.8690
test_mean               0.8972     0.8554   0.9042  ...   0.8744   0.8827    0.8795
test_std                0.0112     0.0076   0.0122  ...   0.0120   0.0099    0.0075
1                       0.9708     0.8235   0.9836  ...   0.8427   0.9611    0.9032
2                       0.9694     0.5327   0.9765  ...   0.5327   0.9829    0.8940
3                       0.9601     0.5047   0.9614  ...   0.5047   0.9860    0.8989
zs_spu_mean             0.9668     0.6203   0.9738  ...   0.6267   0.9767    0.8987
zs_spu_std              0.0047     0.1441   0.0093  ...   0.1532   0.0111    0.0038
1                          NaN     0.8333   0.9227  ...   0.8333   0.9552    0.9282
2                          NaN     0.3284   0.6609  ...   0.7727   0.3284    0.7563
3                          NaN     0.0448   0.9270  ...   0.8333   0.0448    0.8164
tr_mean                    NaN     0.4022   0.8369  ...   0.8131   0.4428    0.8336
tr_std                     NaN     0.3261   0.1244  ...   0.0286   0.3804    0.0712
1                       0.9075     0.8541   0.9103  ...   0.8806   0.9091    0.8850
2                       0.9122     0.8798   0.9060  ...   0.8955   0.9394    0.8983
3                       0.8957     0.8670   0.8932  ...   0.8955   0.9091    0.8850
val_mean                0.9051     0.8670   0.9032  ...   0.8905   0.9192    0.8894
val_std                 0.0069     0.0105   0.0073  ...   0.0070   0.0143    0.0063
1                       0.9043     0.8594   0.9126  ...   0.8692   0.8863    0.8842
2                       0.9060     0.8621   0.9131  ...   0.8629   0.8925    0.8854
3                       0.8814     0.8448   0.8869  ...   0.8910   0.8692    0.8690
zs_tg_mean              0.8972     0.8554   0.9042  ...   0.8744   0.8827    0.8795
zs_tg_std               0.0112     0.0076   0.0122  ...   0.0120   0.0099    0.0075

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_512_lr_10.0_lrr10.0_bsr512_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.2857, 'acc_0_0': 0.9028, 'acc_0_1': 0.663, 'acc_1_0': 0.2857, 'acc_1_1': 0.4759, 'mean_acc': 0.7923}
Val(class): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.1588, 'acc_0_0': 0.9274, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6117}
Test(class): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.1251, 'acc_0_0': 0.9392, 'acc_0_1': 0.1251, 'acc_1_0': 0.7259, 'acc_1_1': 0.9844, 'mean_acc': 0.6037}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2174, 'acc_0_0': 0.9768, 'acc_0_1': 0.2174, 'acc_1_0': 0.6786, 'acc_1_1': 0.9745, 'mean_acc': 0.9437}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3648, 'acc_0_0': 1.0, 'acc_0_1': 0.3648, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.6933}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.322, 'acc_0_0': 0.9942, 'acc_0_1': 0.322, 'acc_1_0': 0.5249, 'acc_1_1': 0.9564, 'mean_acc': 0.6764}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.6359, 'acc_1_0': 0.5, 'acc_1_1': 0.878, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5064, 'acc_0_0': 0.9957, 'acc_0_1': 0.5064, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.4678, 'acc_0_0': 0.9933, 'acc_0_1': 0.4678, 'acc_1_0': 0.553, 'acc_1_1': 0.9361, 'mean_acc': 0.7337}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5217, 'acc_0_0': 0.9886, 'acc_0_1': 0.5217, 'acc_1_0': 0.6964, 'acc_1_1': 0.9631, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4292, 'acc_0_0': 0.9915, 'acc_0_1': 0.4292, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7367}
Test(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3889, 'acc_0_0': 0.9805, 'acc_0_1': 0.3889, 'acc_1_0': 0.6791, 'acc_1_1': 0.9579, 'mean_acc': 0.7144}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5543, 'acc_0_0': 0.9848, 'acc_0_1': 0.5543, 'acc_1_0': 0.8036, 'acc_1_1': 0.964, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6262, 'acc_0_0': 0.988, 'acc_0_1': 0.6421, 'acc_1_0': 0.6262, 'acc_1_1': 0.9283, 'mean_acc': 0.8067}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9946, 'acc_0_1': 0.7772, 'acc_1_0': 0.6786, 'acc_1_1': 0.9224, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9566, 'worst_acc': 0.634, 'acc_0_0': 0.9858, 'acc_0_1': 0.6528, 'acc_1_0': 0.634, 'acc_1_1': 0.9299, 'mean_acc': 0.811}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.992, 'acc_0_1': 0.663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9518, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7717}
Test(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.5002, 'acc_0_0': 0.9809, 'acc_0_1': 0.5002, 'acc_1_0': 0.6854, 'acc_1_1': 0.9502, 'mean_acc': 0.7577}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6196, 'acc_0_0': 0.9914, 'acc_0_1': 0.6196, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.6288, 'acc_0_0': 0.9885, 'acc_0_1': 0.6288, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8031}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.7143, 'acc_1_1': 0.9499, 'mean_acc': 0.9708}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.6075, 'acc_0_0': 0.9907, 'acc_0_1': 0.6359, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8029}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.996, 'acc_0_1': 0.7065, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5672, 'acc_0_0': 0.9889, 'acc_0_1': 0.5672, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.7798}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6304, 'acc_0_0': 0.9937, 'acc_0_1': 0.6304, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9712}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6438, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6121, 'acc_0_0': 0.9911, 'acc_0_1': 0.6133, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.7957}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9974, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5794, 'acc_0_0': 0.9933, 'acc_0_1': 0.667, 'acc_1_0': 0.5794, 'acc_1_1': 0.9221, 'mean_acc': 0.8126}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9966, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.9729}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6121, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.7991}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9949, 'acc_0_1': 0.6902, 'acc_1_0': 0.7679, 'acc_1_1': 0.9622, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6106, 'acc_0_0': 0.9925, 'acc_0_1': 0.6302, 'acc_1_0': 0.6106, 'acc_1_1': 0.933, 'mean_acc': 0.8026}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.75, 'acc_1_1': 0.9622, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6012, 'acc_0_0': 0.9929, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8219}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9974, 'acc_0_1': 0.7391, 'acc_1_0': 0.7857, 'acc_1_1': 0.9565, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6457, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8076}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9963, 'acc_0_1': 0.7337, 'acc_1_0': 0.8214, 'acc_1_1': 0.9612, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6537, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8107}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9977, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.6732, 'acc_1_0': 0.6012, 'acc_1_1': 0.9283, 'mean_acc': 0.8177}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9974, 'acc_0_1': 0.7554, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.6625, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8148}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9966, 'acc_0_1': 0.7446, 'acc_1_0': 0.8393, 'acc_1_1': 0.9697, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6293, 'acc_0_0': 0.9907, 'acc_0_1': 0.655, 'acc_1_0': 0.6293, 'acc_1_1': 0.9346, 'mean_acc': 0.8138}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9925, 'acc_0_1': 0.6838, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.8234}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.7857, 'acc_1_1': 0.9631, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6812, 'acc_1_0': 0.6184, 'acc_1_1': 0.9315, 'mean_acc': 0.8222}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7717, 'acc_0_0': 0.998, 'acc_0_1': 0.7717, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6137, 'acc_0_0': 0.9902, 'acc_0_1': 0.6874, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9983, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6749, 'acc_1_0': 0.6184, 'acc_1_1': 0.933, 'mean_acc': 0.82}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9986, 'acc_0_1': 0.7935, 'acc_1_0': 0.8571, 'acc_1_1': 0.9697, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6812, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8219}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9994, 'acc_0_1': 0.788, 'acc_1_0': 0.8571, 'acc_1_1': 0.9716, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.6887, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8245}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8571, 'acc_1_1': 0.9678, 'mean_acc': 0.9837}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5997, 'acc_0_0': 0.9916, 'acc_0_1': 0.7166, 'acc_1_0': 0.5997, 'acc_1_1': 0.9299, 'mean_acc': 0.8343}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9986, 'acc_0_1': 0.8152, 'acc_1_0': 0.8929, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9663, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6106, 'acc_0_0': 0.9902, 'acc_0_1': 0.6634, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8152}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7511, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5903, 'acc_0_0': 0.9925, 'acc_0_1': 0.722, 'acc_1_0': 0.5903, 'acc_1_1': 0.9283, 'mean_acc': 0.8355}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.8859, 'acc_1_0': 0.8393, 'acc_1_1': 0.9688, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.9714, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.5919, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.5919, 'acc_1_1': 0.9315, 'mean_acc': 0.8264}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9889, 'acc_0_1': 0.6732, 'acc_1_0': 0.6153, 'acc_1_1': 0.9377, 'mean_acc': 0.819}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9991, 'acc_0_1': 0.837, 'acc_1_0': 0.9107, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.6847, 'acc_1_0': 0.6308, 'acc_1_1': 0.9361, 'mean_acc': 0.8248}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9735, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.7002, 'acc_1_0': 0.6153, 'acc_1_1': 0.9346, 'mean_acc': 0.8293}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 1.0, 'acc_0_1': 0.8913, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.6882, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8243}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 1.0, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6269, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6308, 'acc_1_1': 0.9377, 'mean_acc': 0.8165}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6931, 'acc_1_0': 0.6168, 'acc_1_1': 0.9346, 'mean_acc': 0.8269}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9239, 'acc_0_0': 1.0, 'acc_0_1': 0.9239, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8298}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9185, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.9643, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6741, 'acc_1_0': 0.6168, 'acc_1_1': 0.9377, 'mean_acc': 0.8198}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9868, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.609, 'acc_0_0': 0.9911, 'acc_0_1': 0.7033, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8305}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9896, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6059, 'acc_0_0': 0.9916, 'acc_0_1': 0.722, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8376}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9871, 'acc_0_1': 0.8712, 'acc_1_0': 0.5758, 'acc_1_1': 0.7612, 'mean_acc': 0.8715}
Val(class)(new adapter): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.7463, 'acc_0_0': 0.9658, 'acc_0_1': 0.8712, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.7383, 'acc_0_0': 0.9747, 'acc_0_1': 0.8683, 'acc_1_0': 0.7383, 'acc_1_1': 0.8894, 'mean_acc': 0.8977}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3636, 'acc_0_0': 0.897, 'acc_0_1': 0.7511, 'acc_1_0': 0.3636, 'acc_1_1': 0.6716, 'mean_acc': 0.7563}
Val(class)(new adapter): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.3605, 'acc_0_0': 0.9744, 'acc_0_1': 0.3605, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7}
Test(class)(new adapter): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.3468, 'acc_0_0': 0.9796, 'acc_0_1': 0.3468, 'acc_1_0': 0.662, 'acc_1_1': 0.9704, 'mean_acc': 0.6971}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7463, 'acc_0_0': 0.9742, 'acc_0_1': 0.8841, 'acc_1_0': 0.8182, 'acc_1_1': 0.7463, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.8377, 'worst_acc': 0.5909, 'acc_0_0': 0.906, 'acc_0_1': 0.9485, 'acc_1_0': 0.8657, 'acc_1_1': 0.5909, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8051, 'worst_acc': 0.5156, 'acc_0_0': 0.8838, 'acc_0_1': 0.9512, 'acc_1_0': 0.8692, 'acc_1_1': 0.5156, 'mean_acc': 0.8676}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4627, 'acc_0_0': 0.8584, 'acc_0_1': 0.897, 'acc_1_0': 0.8182, 'acc_1_1': 0.4627, 'mean_acc': 0.8247}
Val(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.5322, 'acc_0_0': 0.8974, 'acc_0_1': 0.5322, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.76}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.5175, 'acc_0_0': 0.9086, 'acc_0_1': 0.5175, 'acc_1_0': 0.8567, 'acc_1_1': 0.9517, 'mean_acc': 0.7554}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9914, 'acc_0_1': 0.9313, 'acc_1_0': 0.7121, 'acc_1_1': 0.8209, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.8434, 'worst_acc': 0.4848, 'acc_0_0': 0.9487, 'acc_0_1': 0.9657, 'acc_1_0': 0.6269, 'acc_1_1': 0.4848, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8352, 'worst_acc': 0.4174, 'acc_0_0': 0.9561, 'acc_0_1': 0.9818, 'acc_1_0': 0.69, 'acc_1_1': 0.4174, 'mean_acc': 0.8769}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.9227, 'acc_0_1': 0.9356, 'acc_1_0': 0.803, 'acc_1_1': 0.6269, 'mean_acc': 0.8815}
Val(class)(new adapter): {'weighted_mean_acc': 0.8712, 'worst_acc': 0.6996, 'acc_0_0': 0.8547, 'acc_0_1': 0.6996, 'acc_1_0': 0.8955, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class)(new adapter): {'weighted_mean_acc': 0.8653, 'worst_acc': 0.6843, 'acc_0_0': 0.8514, 'acc_0_1': 0.6843, 'acc_1_0': 0.8988, 'acc_1_1': 0.9408, 'mean_acc': 0.8015}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9657, 'acc_0_1': 0.9142, 'acc_1_0': 0.7273, 'acc_1_1': 0.8955, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.8483, 'worst_acc': 0.6667, 'acc_0_0': 0.8974, 'acc_0_1': 0.9657, 'acc_1_0': 0.8209, 'acc_1_1': 0.6667, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8389, 'worst_acc': 0.5685, 'acc_0_0': 0.914, 'acc_0_1': 0.9685, 'acc_1_0': 0.8287, 'acc_1_1': 0.5685, 'mean_acc': 0.8875}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.8712, 'acc_0_1': 0.9614, 'acc_1_0': 0.8939, 'acc_1_1': 0.6269, 'mean_acc': 0.8815}
Val(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.8412, 'acc_0_0': 0.8974, 'acc_0_1': 0.8412, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8239, 'acc_0_0': 0.8931, 'acc_0_1': 0.8239, 'acc_1_0': 0.8754, 'acc_1_1': 0.9159, 'mean_acc': 0.8668}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.9356, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.743, 'acc_0_0': 0.9738, 'acc_0_1': 0.9441, 'acc_1_0': 0.7523, 'acc_1_1': 0.743, 'mean_acc': 0.9122}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6515, 'acc_0_0': 0.9485, 'acc_0_1': 0.927, 'acc_1_0': 0.6515, 'acc_1_1': 0.791, 'mean_acc': 0.8898}
Val(class)(new adapter): {'weighted_mean_acc': 0.7904, 'worst_acc': 0.7436, 'acc_0_0': 0.7436, 'acc_0_1': 0.867, 'acc_1_0': 0.9403, 'acc_1_1': 0.9242, 'mean_acc': 0.8333}
Test(class)(new adapter): {'weighted_mean_acc': 0.7965, 'worst_acc': 0.7707, 'acc_0_0': 0.7707, 'acc_0_1': 0.8563, 'acc_1_0': 0.9283, 'acc_1_1': 0.8645, 'mean_acc': 0.8319}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9399, 'acc_0_0': 0.9399, 'acc_0_1': 0.9657, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.7612, 'acc_0_0': 0.9615, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7181, 'acc_0_0': 0.9676, 'acc_0_1': 0.933, 'acc_1_0': 0.7601, 'acc_1_1': 0.7181, 'mean_acc': 0.9035}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7121, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.7121, 'acc_1_1': 0.9104, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.8948, 'worst_acc': 0.8358, 'acc_0_0': 0.8932, 'acc_0_1': 0.8627, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8802, 'worst_acc': 0.838, 'acc_0_0': 0.8931, 'acc_0_1': 0.8772, 'acc_1_0': 0.8785, 'acc_1_1': 0.838, 'mean_acc': 0.8792}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9657, 'acc_0_0': 0.9657, 'acc_0_1': 0.9828, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.874, 'worst_acc': 0.7273, 'acc_0_0': 0.9145, 'acc_0_1': 0.9614, 'acc_1_0': 0.8209, 'acc_1_1': 0.7273, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8635, 'worst_acc': 0.662, 'acc_0_0': 0.9193, 'acc_0_1': 0.9641, 'acc_1_0': 0.8505, 'acc_1_1': 0.662, 'mean_acc': 0.9006}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.7445, 'acc_0_0': 0.9446, 'acc_0_1': 0.9432, 'acc_1_0': 0.8209, 'acc_1_1': 0.7445, 'mean_acc': 0.9082}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9317, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7632, 'acc_0_0': 0.9539, 'acc_0_1': 0.9326, 'acc_1_0': 0.8037, 'acc_1_1': 0.7632, 'mean_acc': 0.9078}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9313, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.757, 'acc_0_0': 0.9494, 'acc_0_1': 0.937, 'acc_1_0': 0.7975, 'acc_1_1': 0.757, 'mean_acc': 0.9065}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.7523, 'acc_0_0': 0.9446, 'acc_0_1': 0.937, 'acc_1_0': 0.8037, 'acc_1_1': 0.7523, 'mean_acc': 0.9047}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9188, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7819, 'acc_0_0': 0.9455, 'acc_0_1': 0.9255, 'acc_1_0': 0.8006, 'acc_1_1': 0.7819, 'mean_acc': 0.9035}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.8209, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.785, 'acc_0_0': 0.9472, 'acc_0_1': 0.9233, 'acc_1_0': 0.8022, 'acc_1_1': 0.785, 'mean_acc': 0.9039}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.9399, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9024, 'worst_acc': 0.7882, 'acc_0_0': 0.9375, 'acc_0_1': 0.9184, 'acc_1_0': 0.8146, 'acc_1_1': 0.7882, 'mean_acc': 0.8999}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9023, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7741, 'acc_0_0': 0.9317, 'acc_0_1': 0.9224, 'acc_1_0': 0.8178, 'acc_1_1': 0.7741, 'mean_acc': 0.898}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.803, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8933, 'worst_acc': 0.7445, 'acc_0_0': 0.9379, 'acc_0_1': 0.9295, 'acc_1_0': 0.7991, 'acc_1_1': 0.7445, 'mean_acc': 0.8978}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8968, 'worst_acc': 0.7383, 'acc_0_0': 0.9446, 'acc_0_1': 0.9317, 'acc_1_0': 0.7913, 'acc_1_1': 0.7383, 'mean_acc': 0.8997}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.757, 'acc_0_0': 0.9415, 'acc_0_1': 0.9259, 'acc_1_0': 0.7991, 'acc_1_1': 0.757, 'mean_acc': 0.8992}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7726, 'acc_0_0': 0.941, 'acc_0_1': 0.9193, 'acc_1_0': 0.8022, 'acc_1_1': 0.7726, 'mean_acc': 0.8985}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.8037, 'acc_0_0': 0.9237, 'acc_0_1': 0.9064, 'acc_1_0': 0.8287, 'acc_1_1': 0.8037, 'mean_acc': 0.8932}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.7726, 'acc_0_0': 0.9379, 'acc_0_1': 0.9259, 'acc_1_0': 0.8115, 'acc_1_1': 0.7726, 'mean_acc': 0.9009}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.7757, 'acc_0_0': 0.9459, 'acc_0_1': 0.9237, 'acc_1_0': 0.8053, 'acc_1_1': 0.7757, 'mean_acc': 0.9028}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.791, 'acc_0_0': 0.953, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7477, 'acc_0_0': 0.9525, 'acc_0_1': 0.9335, 'acc_1_0': 0.7788, 'acc_1_1': 0.7477, 'mean_acc': 0.9032}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7761, 'acc_0_0': 0.953, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7617, 'acc_0_0': 0.9574, 'acc_0_1': 0.9295, 'acc_1_0': 0.7695, 'acc_1_1': 0.7617, 'mean_acc': 0.904}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7761, 'acc_0_0': 0.9615, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.7879, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7243, 'acc_0_0': 0.9667, 'acc_0_1': 0.9486, 'acc_1_0': 0.7477, 'acc_1_1': 0.7243, 'mean_acc': 0.9085}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7757, 'acc_0_0': 0.9579, 'acc_0_1': 0.8745, 'acc_1_0': 0.7757, 'acc_1_1': 0.8396, 'mean_acc': 0.8921}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.8209, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9132, 'worst_acc': 0.7835, 'acc_0_0': 0.9534, 'acc_0_1': 0.9064, 'acc_1_0': 0.7835, 'acc_1_1': 0.7882, 'mean_acc': 0.898}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9055, 'worst_acc': 0.7727, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.7727, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7056, 'acc_0_0': 0.9565, 'acc_0_1': 0.949, 'acc_1_0': 0.7601, 'acc_1_1': 0.7056, 'mean_acc': 0.904}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8992, 'worst_acc': 0.7727, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.7727, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.704, 'acc_0_0': 0.9517, 'acc_0_1': 0.9481, 'acc_1_0': 0.785, 'acc_1_1': 0.704, 'mean_acc': 0.9044}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7576, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.806, 'acc_1_1': 0.7576, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.8943, 'worst_acc': 0.6822, 'acc_0_0': 0.9574, 'acc_0_1': 0.9534, 'acc_1_0': 0.7555, 'acc_1_1': 0.6822, 'mean_acc': 0.903}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.7879, 'acc_0_0': 0.9359, 'acc_0_1': 0.9614, 'acc_1_0': 0.791, 'acc_1_1': 0.7879, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7009, 'acc_0_0': 0.9534, 'acc_0_1': 0.9486, 'acc_1_0': 0.7617, 'acc_1_1': 0.7009, 'mean_acc': 0.9023}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.7879, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.7879, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.7227, 'acc_0_0': 0.9512, 'acc_0_1': 0.9397, 'acc_1_0': 0.7835, 'acc_1_1': 0.7227, 'mean_acc': 0.9028}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.7879, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.7879, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8996, 'worst_acc': 0.7274, 'acc_0_0': 0.9517, 'acc_0_1': 0.9375, 'acc_1_0': 0.7757, 'acc_1_1': 0.7274, 'mean_acc': 0.9018}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9055, 'worst_acc': 0.7879, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.791, 'acc_1_1': 0.7879, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7181, 'acc_0_0': 0.9521, 'acc_0_1': 0.945, 'acc_1_0': 0.7648, 'acc_1_1': 0.7181, 'mean_acc': 0.9027}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.803, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.803, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7445, 'acc_0_0': 0.9503, 'acc_0_1': 0.9357, 'acc_1_0': 0.785, 'acc_1_1': 0.7445, 'mean_acc': 0.9035}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.791, 'acc_1_1': 0.803, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7368, 'acc_0_0': 0.9517, 'acc_0_1': 0.9379, 'acc_1_0': 0.7804, 'acc_1_1': 0.7368, 'mean_acc': 0.9035}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7461, 'acc_0_0': 0.9508, 'acc_0_1': 0.9348, 'acc_1_0': 0.7882, 'acc_1_1': 0.7461, 'mean_acc': 0.9039}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.7508, 'acc_0_0': 0.9455, 'acc_0_1': 0.9322, 'acc_1_0': 0.796, 'acc_1_1': 0.7508, 'mean_acc': 0.9021}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.7492, 'acc_0_0': 0.9477, 'acc_0_1': 0.9344, 'acc_1_0': 0.7928, 'acc_1_1': 0.7492, 'mean_acc': 0.9033}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7492, 'acc_0_0': 0.9477, 'acc_0_1': 0.9344, 'acc_1_0': 0.7975, 'acc_1_1': 0.7492, 'mean_acc': 0.9039}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.7508, 'acc_0_0': 0.9477, 'acc_0_1': 0.9322, 'acc_1_0': 0.796, 'acc_1_1': 0.7508, 'mean_acc': 0.903}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7539, 'acc_0_0': 0.9499, 'acc_0_1': 0.933, 'acc_1_0': 0.796, 'acc_1_1': 0.7539, 'mean_acc': 0.9046}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9023, 'worst_acc': 0.7539, 'acc_0_0': 0.9472, 'acc_0_1': 0.9322, 'acc_1_0': 0.7991, 'acc_1_1': 0.7539, 'mean_acc': 0.9035}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.7539, 'acc_0_0': 0.9446, 'acc_0_1': 0.9317, 'acc_1_0': 0.8037, 'acc_1_1': 0.7539, 'mean_acc': 0.9028}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.7555, 'acc_0_0': 0.9424, 'acc_0_1': 0.9264, 'acc_1_0': 0.81, 'acc_1_1': 0.7555, 'mean_acc': 0.9008}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7539, 'acc_0_0': 0.9455, 'acc_0_1': 0.9299, 'acc_1_0': 0.7991, 'acc_1_1': 0.7539, 'mean_acc': 0.902}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7445, 'acc_0_0': 0.9481, 'acc_0_1': 0.9366, 'acc_1_0': 0.7866, 'acc_1_1': 0.7445, 'mean_acc': 0.9032}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.901, 'worst_acc': 0.7477, 'acc_0_0': 0.9472, 'acc_0_1': 0.9353, 'acc_1_0': 0.7991, 'acc_1_1': 0.7477, 'mean_acc': 0.904}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.7508, 'acc_0_0': 0.9494, 'acc_0_1': 0.9335, 'acc_1_0': 0.7944, 'acc_1_1': 0.7508, 'mean_acc': 0.904}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9002, 'worst_acc': 0.757, 'acc_0_0': 0.9437, 'acc_0_1': 0.9242, 'acc_1_0': 0.8069, 'acc_1_1': 0.757, 'mean_acc': 0.9002}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9033, 'worst_acc': 0.7539, 'acc_0_0': 0.9486, 'acc_0_1': 0.933, 'acc_1_0': 0.7975, 'acc_1_1': 0.7539, 'mean_acc': 0.9042}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7523, 'acc_0_0': 0.9512, 'acc_0_1': 0.9339, 'acc_1_0': 0.7726, 'acc_1_1': 0.7523, 'mean_acc': 0.9027}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7508, 'acc_0_0': 0.9499, 'acc_0_1': 0.9335, 'acc_1_0': 0.7866, 'acc_1_1': 0.7508, 'mean_acc': 0.9033}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.743, 'acc_0_0': 0.9517, 'acc_0_1': 0.9366, 'acc_1_0': 0.7757, 'acc_1_1': 0.743, 'mean_acc': 0.9032}
========================================================================
> end of training. 

best epoch : 48
best training accuracy on [class]: {'worst_acc': 0.6269, 'acc_0_0': 0.8712, 'acc_0_1': 0.9614, 'acc_1_0': 0.8939, 'acc_1_1': 0.6269, 'mean_acc': 0.8815}
best validation accuracy on [class]: {'weighted_mean_acc': 0.904, 'worst_acc': 0.8412, 'acc_0_0': 0.8974, 'acc_0_1': 0.8412, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
best test accuracy on [class]: {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8239, 'acc_0_0': 0.8931, 'acc_0_1': 0.8239, 'acc_1_0': 0.8754, 'acc_1_1': 0.9159, 'mean_acc': 0.8668}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8239, 'acc_0_0': 0.8931, 'acc_0_1': 0.8239, 'acc_1_0': 0.8754, 'acc_1_1': 0.9159, 'mean_acc': 0.8668}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.4969, 'acc_0_0': 0.9933, 'acc_0_1': 0.643, 'acc_1_0': 0.4969, 'acc_1_1': 0.9642, 'mean_acc': 0.7988}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 48': {'Train': {'worst_acc': 0.6269, 'acc_0_0': 0.8712, 'acc_0_1': 0.9614, 'acc_1_0': 0.8939, 'acc_1_1': 0.6269, 'mean_acc': 0.8815}, 'Val': {'weighted_mean_acc': 0.904, 'worst_acc': 0.8412, 'acc_0_0': 0.8974, 'acc_0_1': 0.8412, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.875}, 'Test': {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8239, 'acc_0_0': 0.8931, 'acc_0_1': 0.8239, 'acc_1_0': 0.8754, 'acc_1_1': 0.9159, 'mean_acc': 0.8668}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8953, 'worst_acc': 0.8239, 'acc_0_0': 0.8931, 'acc_0_1': 0.8239, 'acc_1_0': 0.8754, 'acc_1_1': 0.9159, 'mean_acc': 0.8668}, 'spurious': {'weighted_mean_acc': 0.9677, 'worst_acc': 0.4969, 'acc_0_0': 0.9933, 'acc_0_1': 0.643, 'acc_1_0': 0.4969, 'acc_1_1': 0.9642, 'mean_acc': 0.7988}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.25, 'acc_0_0': 0.8957, 'acc_0_1': 0.7717, 'acc_1_0': 0.25, 'acc_1_1': 0.2819, 'mean_acc': 0.7481}
Val(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.3047, 'acc_0_0': 0.9829, 'acc_0_1': 0.3047, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6767}
Test(class): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.2381, 'acc_0_0': 0.9676, 'acc_0_1': 0.2381, 'acc_1_0': 0.6168, 'acc_1_1': 0.9735, 'mean_acc': 0.6455}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1902, 'acc_0_0': 0.9565, 'acc_0_1': 0.1902, 'acc_1_0': 0.6964, 'acc_1_1': 0.9858, 'mean_acc': 0.9306}
Val(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.2403, 'acc_0_0': 0.9872, 'acc_0_1': 0.2403, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6583}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2124, 'acc_0_0': 0.9792, 'acc_0_1': 0.2124, 'acc_1_0': 0.6433, 'acc_1_1': 0.972, 'mean_acc': 0.6427}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.996, 'acc_0_1': 0.587, 'acc_1_0': 0.4464, 'acc_1_1': 0.9007, 'mean_acc': 0.9529}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.2961, 'acc_0_0': 1.0, 'acc_0_1': 0.2961, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.685}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.2736, 'acc_0_0': 0.9827, 'acc_0_1': 0.2736, 'acc_1_0': 0.6449, 'acc_1_1': 0.9688, 'mean_acc': 0.6678}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9946, 'acc_0_1': 0.625, 'acc_1_0': 0.5714, 'acc_1_1': 0.9338, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3262, 'acc_0_0': 0.9915, 'acc_0_1': 0.3262, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.6983}
Test(class): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.29, 'acc_0_0': 0.9778, 'acc_0_1': 0.29, 'acc_1_0': 0.6729, 'acc_1_1': 0.9704, 'mean_acc': 0.6755}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4348, 'acc_0_0': 0.9903, 'acc_0_1': 0.4348, 'acc_1_0': 0.6786, 'acc_1_1': 0.9763, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.4163, 'acc_0_0': 0.9915, 'acc_0_1': 0.4163, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.3579, 'acc_0_0': 0.9792, 'acc_0_1': 0.3579, 'acc_1_0': 0.6822, 'acc_1_1': 0.9657, 'mean_acc': 0.703}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5761, 'acc_0_0': 0.99, 'acc_0_1': 0.5761, 'acc_1_0': 0.7143, 'acc_1_1': 0.9707, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.618, 'acc_0_0': 0.9872, 'acc_0_1': 0.618, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5685, 'acc_0_0': 0.9849, 'acc_0_1': 0.5685, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.7813}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.6429, 'acc_1_1': 0.9376, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6402, 'acc_0_0': 0.9867, 'acc_0_1': 0.6838, 'acc_1_0': 0.6402, 'acc_1_1': 0.9159, 'mean_acc': 0.8226}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7337, 'acc_1_0': 0.6964, 'acc_1_1': 0.947, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5716, 'acc_0_0': 0.9854, 'acc_0_1': 0.5716, 'acc_1_0': 0.6495, 'acc_1_1': 0.9424, 'mean_acc': 0.7824}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9909, 'acc_0_1': 0.6467, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5446, 'acc_0_0': 0.9863, 'acc_0_1': 0.5446, 'acc_1_0': 0.6464, 'acc_1_1': 0.947, 'mean_acc': 0.7724}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9687, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6133, 'acc_0_0': 0.9885, 'acc_0_1': 0.6133, 'acc_1_0': 0.6137, 'acc_1_1': 0.933, 'mean_acc': 0.7948}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9957, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6059, 'acc_0_0': 0.9894, 'acc_0_1': 0.651, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8088}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9954, 'acc_0_1': 0.7065, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6093, 'acc_0_0': 0.9889, 'acc_0_1': 0.6093, 'acc_1_0': 0.634, 'acc_1_1': 0.9424, 'mean_acc': 0.7967}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.608, 'acc_0_0': 0.9889, 'acc_0_1': 0.608, 'acc_1_0': 0.6417, 'acc_1_1': 0.9424, 'mean_acc': 0.797}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9943, 'acc_0_1': 0.7065, 'acc_1_0': 0.8214, 'acc_1_1': 0.9688, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6231, 'acc_1_1': 0.9346, 'mean_acc': 0.8098}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9949, 'acc_0_1': 0.7283, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6168, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.6168, 'acc_1_1': 0.9393, 'mean_acc': 0.8098}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.994, 'acc_0_1': 0.7011, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9722, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6284, 'acc_1_0': 0.6153, 'acc_1_1': 0.9424, 'mean_acc': 0.8024}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9946, 'acc_0_1': 0.712, 'acc_1_0': 0.7857, 'acc_1_1': 0.964, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5981, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9393, 'mean_acc': 0.8077}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9971, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9738, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5779, 'acc_0_0': 0.9929, 'acc_0_1': 0.6918, 'acc_1_0': 0.5779, 'acc_1_1': 0.933, 'mean_acc': 0.8231}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6213, 'acc_0_0': 0.9894, 'acc_0_1': 0.6213, 'acc_1_0': 0.6215, 'acc_1_1': 0.9439, 'mean_acc': 0.8003}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9931, 'acc_0_1': 0.7228, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6199, 'acc_0_0': 0.9898, 'acc_0_1': 0.6461, 'acc_1_0': 0.6199, 'acc_1_1': 0.9439, 'mean_acc': 0.81}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9974, 'acc_0_1': 0.7772, 'acc_1_0': 0.8036, 'acc_1_1': 0.9669, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6798, 'acc_1_0': 0.5966, 'acc_1_1': 0.9377, 'mean_acc': 0.8207}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.998, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9622, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6714, 'acc_1_0': 0.5966, 'acc_1_1': 0.9408, 'mean_acc': 0.8177}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6315, 'acc_0_0': 0.9889, 'acc_0_1': 0.6315, 'acc_1_0': 0.6324, 'acc_1_1': 0.9439, 'mean_acc': 0.8053}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9971, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.6763, 'acc_1_0': 0.6121, 'acc_1_1': 0.9393, 'mean_acc': 0.8207}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9986, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.6692, 'acc_1_0': 0.6121, 'acc_1_1': 0.9408, 'mean_acc': 0.8184}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9977, 'acc_0_1': 0.788, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6603, 'acc_1_0': 0.6137, 'acc_1_1': 0.9424, 'mean_acc': 0.8152}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9977, 'acc_0_1': 0.8098, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.663, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8171}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9994, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9745, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6231, 'acc_0_0': 0.9911, 'acc_0_1': 0.678, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8224}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.9994, 'acc_0_1': 0.8424, 'acc_1_0': 0.9107, 'acc_1_1': 0.982, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.671, 'acc_1_0': 0.6231, 'acc_1_1': 0.9393, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9849, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8164}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9994, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9801, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6355, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.6355, 'acc_1_1': 0.9393, 'mean_acc': 0.8183}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9849, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.686, 'acc_1_0': 0.6215, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9997, 'acc_0_1': 0.8641, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6794, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 1.0, 'acc_0_1': 0.9076, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7073, 'acc_1_0': 0.5981, 'acc_1_1': 0.9377, 'mean_acc': 0.831}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.994}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.694, 'acc_1_0': 0.6137, 'acc_1_1': 0.9393, 'mean_acc': 0.8267}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9905, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6803, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8217}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.6661, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8171}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7153, 'acc_1_0': 0.5981, 'acc_1_1': 0.9361, 'mean_acc': 0.834}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6028, 'acc_0_0': 0.9894, 'acc_0_1': 0.7091, 'acc_1_0': 0.6028, 'acc_1_1': 0.9346, 'mean_acc': 0.8314}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9828, 'acc_0_1': 0.8712, 'acc_1_0': 0.5455, 'acc_1_1': 0.7761, 'mean_acc': 0.8681}
Val(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.7463, 'acc_0_0': 0.9658, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9402, 'worst_acc': 0.7212, 'acc_0_0': 0.9814, 'acc_0_1': 0.9273, 'acc_1_0': 0.7212, 'acc_1_1': 0.8178, 'mean_acc': 0.9134}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3788, 'acc_0_0': 0.8755, 'acc_0_1': 0.7854, 'acc_1_0': 0.3788, 'acc_1_1': 0.7313, 'mean_acc': 0.7696}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.1931, 'acc_0_0': 0.9274, 'acc_0_1': 0.1931, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.6383}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.1845, 'acc_0_0': 0.9419, 'acc_0_1': 0.1845, 'acc_1_0': 0.824, 'acc_1_1': 0.986, 'mean_acc': 0.6389}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9614, 'acc_0_1': 0.8712, 'acc_1_0': 0.7424, 'acc_1_1': 0.6716, 'mean_acc': 0.8698}
Val(class)(new adapter): {'weighted_mean_acc': 0.8359, 'worst_acc': 0.6667, 'acc_0_0': 0.8803, 'acc_0_1': 0.9399, 'acc_1_0': 0.9104, 'acc_1_1': 0.6667, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8018, 'worst_acc': 0.5888, 'acc_0_0': 0.8572, 'acc_0_1': 0.9392, 'acc_1_0': 0.9097, 'acc_1_1': 0.5888, 'mean_acc': 0.8652}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5224, 'acc_0_0': 0.8712, 'acc_0_1': 0.9056, 'acc_1_0': 0.8333, 'acc_1_1': 0.5224, 'mean_acc': 0.8414}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.5107, 'acc_0_0': 0.9017, 'acc_0_1': 0.5107, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class)(new adapter): {'weighted_mean_acc': 0.8864, 'worst_acc': 0.4984, 'acc_0_0': 0.8843, 'acc_0_1': 0.4984, 'acc_1_0': 0.8879, 'acc_1_1': 0.9611, 'mean_acc': 0.743}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9828, 'acc_0_1': 0.8798, 'acc_1_0': 0.7424, 'acc_1_1': 0.8507, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.8121, 'worst_acc': 0.3636, 'acc_0_0': 0.9402, 'acc_0_1': 0.9914, 'acc_1_0': 0.6866, 'acc_1_1': 0.3636, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8224, 'worst_acc': 0.3131, 'acc_0_0': 0.969, 'acc_0_1': 0.9925, 'acc_1_0': 0.7259, 'acc_1_1': 0.3131, 'mean_acc': 0.8785}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5373, 'acc_0_0': 0.8627, 'acc_0_1': 0.97, 'acc_1_0': 0.7576, 'acc_1_1': 0.5373, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7339, 'acc_0_0': 0.8718, 'acc_0_1': 0.7339, 'acc_1_0': 0.9104, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class)(new adapter): {'weighted_mean_acc': 0.8795, 'worst_acc': 0.7126, 'acc_0_0': 0.8683, 'acc_0_1': 0.7126, 'acc_1_0': 0.9112, 'acc_1_1': 0.9439, 'mean_acc': 0.8208}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9442, 'acc_0_1': 0.9227, 'acc_1_0': 0.8182, 'acc_1_1': 0.9552, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.4776, 'acc_0_0': 0.9872, 'acc_0_1': 0.9742, 'acc_1_0': 0.4776, 'acc_1_1': 0.7121, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.5748, 'acc_0_0': 0.9933, 'acc_0_1': 0.9778, 'acc_1_0': 0.5748, 'acc_1_1': 0.6511, 'mean_acc': 0.903}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3881, 'acc_0_0': 0.8541, 'acc_0_1': 0.8884, 'acc_1_0': 0.5909, 'acc_1_1': 0.3881, 'mean_acc': 0.7863}
Val(class)(new adapter): {'weighted_mean_acc': 0.8834, 'worst_acc': 0.7682, 'acc_0_0': 0.8675, 'acc_0_1': 0.7682, 'acc_1_0': 0.9104, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.8757, 'worst_acc': 0.7712, 'acc_0_0': 0.863, 'acc_0_1': 0.7712, 'acc_1_0': 0.9065, 'acc_1_1': 0.9346, 'mean_acc': 0.84}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9571, 'acc_0_1': 0.9356, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7576, 'acc_0_0': 0.953, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.7576, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.729, 'acc_0_0': 0.9703, 'acc_0_1': 0.9548, 'acc_1_0': 0.8053, 'acc_1_1': 0.729, 'mean_acc': 0.9192}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6212, 'acc_0_0': 0.9742, 'acc_0_1': 0.9442, 'acc_1_0': 0.6212, 'acc_1_1': 0.6866, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.8806, 'acc_0_0': 0.9103, 'acc_0_1': 0.9185, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.8349, 'acc_0_0': 0.9153, 'acc_0_1': 0.9149, 'acc_1_0': 0.8879, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9313, 'acc_0_0': 0.9313, 'acc_0_1': 0.9485, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9318, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9267}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.8022, 'acc_0_0': 0.9627, 'acc_0_1': 0.9428, 'acc_1_0': 0.8131, 'acc_1_1': 0.8022, 'mean_acc': 0.9206}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9254, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.97, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.6807, 'acc_0_0': 0.9743, 'acc_0_1': 0.9769, 'acc_1_0': 0.7835, 'acc_1_1': 0.6807, 'mean_acc': 0.9216}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.8209, 'acc_0_0': 0.9402, 'acc_0_1': 0.9657, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7445, 'acc_0_0': 0.957, 'acc_0_1': 0.9614, 'acc_1_0': 0.8209, 'acc_1_1': 0.7445, 'mean_acc': 0.9201}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.785, 'acc_0_0': 0.9548, 'acc_0_1': 0.9481, 'acc_1_0': 0.8162, 'acc_1_1': 0.785, 'mean_acc': 0.918}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.81, 'acc_0_0': 0.9565, 'acc_0_1': 0.9322, 'acc_1_0': 0.8131, 'acc_1_1': 0.81, 'mean_acc': 0.9149}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7913, 'acc_0_0': 0.9583, 'acc_0_1': 0.9388, 'acc_1_0': 0.8006, 'acc_1_1': 0.7913, 'mean_acc': 0.9147}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7944, 'acc_0_0': 0.961, 'acc_0_1': 0.9286, 'acc_1_0': 0.7944, 'acc_1_1': 0.7944, 'mean_acc': 0.9115}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8255, 'acc_0_0': 0.9534, 'acc_0_1': 0.91, 'acc_1_0': 0.8255, 'acc_1_1': 0.8318, 'mean_acc': 0.9089}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8006, 'acc_0_0': 0.9557, 'acc_0_1': 0.9233, 'acc_1_0': 0.8271, 'acc_1_1': 0.8006, 'mean_acc': 0.9116}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7913, 'acc_0_0': 0.9486, 'acc_0_1': 0.9268, 'acc_1_0': 0.8271, 'acc_1_1': 0.7913, 'mean_acc': 0.9092}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7757, 'acc_0_0': 0.9512, 'acc_0_1': 0.9353, 'acc_1_0': 0.8209, 'acc_1_1': 0.7757, 'mean_acc': 0.9111}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7773, 'acc_0_0': 0.9557, 'acc_0_1': 0.9344, 'acc_1_0': 0.8053, 'acc_1_1': 0.7773, 'mean_acc': 0.9109}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7741, 'acc_0_0': 0.9565, 'acc_0_1': 0.9322, 'acc_1_0': 0.7991, 'acc_1_1': 0.7741, 'mean_acc': 0.9094}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7648, 'acc_0_0': 0.9574, 'acc_0_1': 0.9379, 'acc_1_0': 0.7913, 'acc_1_1': 0.7648, 'mean_acc': 0.9101}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.757, 'acc_0_0': 0.961, 'acc_0_1': 0.941, 'acc_1_0': 0.7773, 'acc_1_1': 0.757, 'mean_acc': 0.9103}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7679, 'acc_0_0': 0.9596, 'acc_0_1': 0.9366, 'acc_1_0': 0.785, 'acc_1_1': 0.7679, 'mean_acc': 0.9101}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9614, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7134, 'acc_0_0': 0.9596, 'acc_0_1': 0.9539, 'acc_1_0': 0.7726, 'acc_1_1': 0.7134, 'mean_acc': 0.9094}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9614, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.8747, 'worst_acc': 0.8209, 'acc_0_0': 0.8846, 'acc_0_1': 0.9399, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8886, 'worst_acc': 0.7664, 'acc_0_0': 0.9242, 'acc_0_1': 0.9348, 'acc_1_0': 0.8209, 'acc_1_1': 0.7664, 'mean_acc': 0.8994}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.7492, 'acc_0_0': 0.9521, 'acc_0_1': 0.9401, 'acc_1_0': 0.7897, 'acc_1_1': 0.7492, 'mean_acc': 0.907}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7788, 'acc_0_0': 0.9397, 'acc_0_1': 0.9197, 'acc_1_0': 0.8131, 'acc_1_1': 0.7788, 'mean_acc': 0.9001}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.8131, 'acc_0_0': 0.9184, 'acc_0_1': 0.8998, 'acc_1_0': 0.8458, 'acc_1_1': 0.8131, 'mean_acc': 0.8914}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.898, 'worst_acc': 0.7523, 'acc_0_0': 0.9415, 'acc_0_1': 0.933, 'acc_1_0': 0.8178, 'acc_1_1': 0.7523, 'mean_acc': 0.9035}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7368, 'acc_0_0': 0.9503, 'acc_0_1': 0.9419, 'acc_1_0': 0.8037, 'acc_1_1': 0.7368, 'mean_acc': 0.9071}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.7399, 'acc_0_0': 0.9441, 'acc_0_1': 0.9392, 'acc_1_0': 0.8006, 'acc_1_1': 0.7399, 'mean_acc': 0.9037}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.7648, 'acc_0_0': 0.9406, 'acc_0_1': 0.9322, 'acc_1_0': 0.8131, 'acc_1_1': 0.7648, 'mean_acc': 0.9037}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8992, 'worst_acc': 0.7679, 'acc_0_0': 0.9384, 'acc_0_1': 0.9326, 'acc_1_0': 0.8178, 'acc_1_1': 0.7679, 'mean_acc': 0.9039}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9007, 'worst_acc': 0.7695, 'acc_0_0': 0.9401, 'acc_0_1': 0.9299, 'acc_1_0': 0.8209, 'acc_1_1': 0.7695, 'mean_acc': 0.904}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7632, 'acc_0_0': 0.9379, 'acc_0_1': 0.933, 'acc_1_0': 0.8209, 'acc_1_1': 0.7632, 'mean_acc': 0.9037}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.7632, 'acc_0_0': 0.9392, 'acc_0_1': 0.933, 'acc_1_0': 0.8193, 'acc_1_1': 0.7632, 'mean_acc': 0.904}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.89, 'worst_acc': 0.791, 'acc_0_0': 0.9017, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.7632, 'acc_0_0': 0.9335, 'acc_0_1': 0.9308, 'acc_1_0': 0.8255, 'acc_1_1': 0.7632, 'mean_acc': 0.9016}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.7601, 'acc_0_0': 0.9406, 'acc_0_1': 0.9335, 'acc_1_0': 0.8178, 'acc_1_1': 0.7601, 'mean_acc': 0.9042}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7523, 'acc_0_0': 0.9415, 'acc_0_1': 0.9353, 'acc_1_0': 0.8146, 'acc_1_1': 0.7523, 'mean_acc': 0.904}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7259, 'acc_0_0': 0.9494, 'acc_0_1': 0.9437, 'acc_1_0': 0.8006, 'acc_1_1': 0.7259, 'mean_acc': 0.9059}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8939, 'worst_acc': 0.7508, 'acc_0_0': 0.9361, 'acc_0_1': 0.9357, 'acc_1_0': 0.8224, 'acc_1_1': 0.7508, 'mean_acc': 0.9028}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8964, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9399, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8924, 'worst_acc': 0.7586, 'acc_0_0': 0.9317, 'acc_0_1': 0.9322, 'acc_1_0': 0.8318, 'acc_1_1': 0.7586, 'mean_acc': 0.9016}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8924, 'worst_acc': 0.7274, 'acc_0_0': 0.9406, 'acc_0_1': 0.9472, 'acc_1_0': 0.8162, 'acc_1_1': 0.7274, 'mean_acc': 0.9058}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8905, 'worst_acc': 0.7336, 'acc_0_0': 0.9361, 'acc_0_1': 0.9468, 'acc_1_0': 0.8178, 'acc_1_1': 0.7336, 'mean_acc': 0.9047}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8905, 'worst_acc': 0.7352, 'acc_0_0': 0.9357, 'acc_0_1': 0.9455, 'acc_1_0': 0.8178, 'acc_1_1': 0.7352, 'mean_acc': 0.9042}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8921, 'worst_acc': 0.7383, 'acc_0_0': 0.937, 'acc_0_1': 0.9428, 'acc_1_0': 0.8193, 'acc_1_1': 0.7383, 'mean_acc': 0.9042}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8912, 'worst_acc': 0.729, 'acc_0_0': 0.9384, 'acc_0_1': 0.9499, 'acc_1_0': 0.8178, 'acc_1_1': 0.729, 'mean_acc': 0.9063}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8904, 'worst_acc': 0.7336, 'acc_0_0': 0.9361, 'acc_0_1': 0.9446, 'acc_1_0': 0.8178, 'acc_1_1': 0.7336, 'mean_acc': 0.9039}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8875, 'worst_acc': 0.806, 'acc_0_0': 0.8974, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.7492, 'acc_0_0': 0.9344, 'acc_0_1': 0.9401, 'acc_1_0': 0.824, 'acc_1_1': 0.7492, 'mean_acc': 0.9039}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8935, 'worst_acc': 0.7243, 'acc_0_0': 0.9428, 'acc_0_1': 0.9521, 'acc_1_0': 0.8146, 'acc_1_1': 0.7243, 'mean_acc': 0.908}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8931, 'worst_acc': 0.7181, 'acc_0_0': 0.9441, 'acc_0_1': 0.9539, 'acc_1_0': 0.8131, 'acc_1_1': 0.7181, 'mean_acc': 0.9084}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.7352, 'acc_0_0': 0.9419, 'acc_0_1': 0.9446, 'acc_1_0': 0.8178, 'acc_1_1': 0.7352, 'mean_acc': 0.9063}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.7352, 'acc_0_0': 0.9401, 'acc_0_1': 0.9463, 'acc_1_0': 0.8178, 'acc_1_1': 0.7352, 'mean_acc': 0.9063}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.894, 'worst_acc': 0.7352, 'acc_0_0': 0.9406, 'acc_0_1': 0.9441, 'acc_1_0': 0.8162, 'acc_1_1': 0.7352, 'mean_acc': 0.9054}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.7243, 'acc_0_0': 0.9415, 'acc_0_1': 0.9517, 'acc_1_0': 0.8178, 'acc_1_1': 0.7243, 'mean_acc': 0.9077}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9062, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.743, 'acc_0_0': 0.9406, 'acc_0_1': 0.9441, 'acc_1_0': 0.8162, 'acc_1_1': 0.743, 'mean_acc': 0.9063}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.7368, 'acc_0_0': 0.9379, 'acc_0_1': 0.9463, 'acc_1_0': 0.8178, 'acc_1_1': 0.7368, 'mean_acc': 0.9056}
========================================================================
> end of training. 

best epoch : 50
best training accuracy on [class]: {'worst_acc': 0.6212, 'acc_0_0': 0.9742, 'acc_0_1': 0.9442, 'acc_1_0': 0.6212, 'acc_1_1': 0.6866, 'mean_acc': 0.8915}
best validation accuracy on [class]: {'weighted_mean_acc': 0.91, 'worst_acc': 0.8806, 'acc_0_0': 0.9103, 'acc_0_1': 0.9185, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
best test accuracy on [class]: {'weighted_mean_acc': 0.8972, 'worst_acc': 0.8349, 'acc_0_0': 0.9153, 'acc_0_1': 0.9149, 'acc_1_0': 0.8879, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.8349, 'acc_0_0': 0.9153, 'acc_0_1': 0.9149, 'acc_1_0': 0.8879, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4424, 'acc_0_0': 0.9681, 'acc_0_1': 0.9131, 'acc_1_0': 0.4424, 'acc_1_1': 0.9907, 'mean_acc': 0.8909}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 50': {'Train': {'worst_acc': 0.6212, 'acc_0_0': 0.9742, 'acc_0_1': 0.9442, 'acc_1_0': 0.6212, 'acc_1_1': 0.6866, 'mean_acc': 0.8915}, 'Val': {'weighted_mean_acc': 0.91, 'worst_acc': 0.8806, 'acc_0_0': 0.9103, 'acc_0_1': 0.9185, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.91}, 'Test': {'weighted_mean_acc': 0.8972, 'worst_acc': 0.8349, 'acc_0_0': 0.9153, 'acc_0_1': 0.9149, 'acc_1_0': 0.8879, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8972, 'worst_acc': 0.8349, 'acc_0_0': 0.9153, 'acc_0_1': 0.9149, 'acc_1_0': 0.8879, 'acc_1_1': 0.8349, 'mean_acc': 0.9032}, 'spurious': {'weighted_mean_acc': 0.9648, 'worst_acc': 0.4424, 'acc_0_0': 0.9681, 'acc_0_1': 0.9131, 'acc_1_0': 0.4424, 'acc_1_1': 0.9907, 'mean_acc': 0.8909}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.4457, 'acc_0_0': 0.9168, 'acc_0_1': 0.4457, 'acc_1_0': 0.4821, 'acc_1_1': 0.6377, 'mean_acc': 0.8321}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.2618, 'acc_0_0': 0.9915, 'acc_0_1': 0.2618, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6633}
Test(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.2293, 'acc_0_0': 0.9836, 'acc_0_1': 0.2293, 'acc_1_0': 0.5748, 'acc_1_1': 0.9704, 'mean_acc': 0.6433}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4643, 'acc_0_0': 0.9943, 'acc_0_1': 0.6196, 'acc_1_0': 0.4643, 'acc_1_1': 0.8723, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.3176, 'acc_0_0': 0.9957, 'acc_0_1': 0.3176, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6917}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.3193, 'acc_0_0': 0.9809, 'acc_0_1': 0.3193, 'acc_1_0': 0.6417, 'acc_1_1': 0.9642, 'mean_acc': 0.684}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9871, 'acc_0_1': 0.4891, 'acc_1_0': 0.6607, 'acc_1_1': 0.9527, 'mean_acc': 0.9566}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2918, 'acc_0_0': 0.9829, 'acc_0_1': 0.2918, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.6833}
Test(class): {'weighted_mean_acc': 0.941, 'worst_acc': 0.2878, 'acc_0_0': 0.9685, 'acc_0_1': 0.2878, 'acc_1_0': 0.7274, 'acc_1_1': 0.9751, 'mean_acc': 0.6776}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5272, 'acc_0_0': 0.9728, 'acc_0_1': 0.5272, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9514}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.6244, 'acc_0_0': 0.9858, 'acc_0_1': 0.6244, 'acc_1_0': 0.6386, 'acc_1_1': 0.933, 'mean_acc': 0.8008}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9977, 'acc_0_1': 0.8641, 'acc_1_0': 0.5357, 'acc_1_1': 0.8846, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6438, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6302, 'acc_0_0': 0.9831, 'acc_0_1': 0.6302, 'acc_1_0': 0.6838, 'acc_1_1': 0.9346, 'mean_acc': 0.8072}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9808, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9518, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.4893, 'acc_0_0': 0.9786, 'acc_0_1': 0.4893, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.4315, 'acc_0_0': 0.9685, 'acc_0_1': 0.4315, 'acc_1_0': 0.729, 'acc_1_1': 0.9611, 'mean_acc': 0.7321}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9926, 'acc_0_1': 0.6793, 'acc_1_0': 0.6429, 'acc_1_1': 0.9508, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.6738, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5312, 'acc_0_0': 0.9929, 'acc_0_1': 0.6834, 'acc_1_0': 0.5312, 'acc_1_1': 0.9143, 'mean_acc': 0.8126}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9994, 'acc_0_1': 0.7826, 'acc_1_0': 0.5, 'acc_1_1': 0.9234, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.5536, 'acc_0_0': 0.9915, 'acc_0_1': 0.5536, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.775}
Test(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5583, 'acc_0_0': 0.9876, 'acc_0_1': 0.5583, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.7713}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.996, 'acc_0_1': 0.6141, 'acc_1_0': 0.6071, 'acc_1_1': 0.9659, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5365, 'acc_0_0': 0.9872, 'acc_0_1': 0.5365, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7733}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.5153, 'acc_0_0': 0.9863, 'acc_0_1': 0.5153, 'acc_1_0': 0.6246, 'acc_1_1': 0.9439, 'mean_acc': 0.7582}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9969, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.948, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.5498, 'acc_0_0': 0.9916, 'acc_0_1': 0.6816, 'acc_1_0': 0.5498, 'acc_1_1': 0.9112, 'mean_acc': 0.8131}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.6071, 'acc_1_1': 0.9423, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.5522, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5748, 'acc_0_0': 0.9898, 'acc_0_1': 0.6612, 'acc_1_0': 0.5748, 'acc_1_1': 0.9159, 'mean_acc': 0.8077}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.6957, 'acc_1_0': 0.6786, 'acc_1_1': 0.9565, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.581, 'acc_0_0': 0.9916, 'acc_0_1': 0.651, 'acc_1_0': 0.581, 'acc_1_1': 0.919, 'mean_acc': 0.8055}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9977, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.6931, 'acc_1_0': 0.567, 'acc_1_1': 0.9128, 'mean_acc': 0.8202}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9983, 'acc_0_1': 0.7663, 'acc_1_0': 0.6964, 'acc_1_1': 0.9518, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5779, 'acc_0_0': 0.9925, 'acc_0_1': 0.6905, 'acc_1_0': 0.5779, 'acc_1_1': 0.9174, 'mean_acc': 0.8207}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9546, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.6829, 'acc_1_0': 0.5841, 'acc_1_1': 0.9221, 'mean_acc': 0.819}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.998, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9574, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5888, 'acc_0_0': 0.992, 'acc_0_1': 0.6838, 'acc_1_0': 0.5888, 'acc_1_1': 0.9252, 'mean_acc': 0.82}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9977, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9929, 'acc_0_1': 0.7029, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8271}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9489, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7091, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8293}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.6656, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8152}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9986, 'acc_0_1': 0.7772, 'acc_1_0': 0.75, 'acc_1_1': 0.9603, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5732, 'acc_0_0': 0.9938, 'acc_0_1': 0.7299, 'acc_1_0': 0.5732, 'acc_1_1': 0.9237, 'mean_acc': 0.8367}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6652, 'acc_1_0': 0.6137, 'acc_1_1': 0.9361, 'mean_acc': 0.8164}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9986, 'acc_0_1': 0.7609, 'acc_1_0': 0.875, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.595, 'acc_0_0': 0.9925, 'acc_0_1': 0.7069, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.83}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8214, 'acc_1_1': 0.9631, 'mean_acc': 0.9823}
Val(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5981, 'acc_0_0': 0.992, 'acc_0_1': 0.7069, 'acc_1_0': 0.5981, 'acc_1_1': 0.9268, 'mean_acc': 0.8302}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9983, 'acc_0_1': 0.8098, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9916, 'acc_0_1': 0.6914, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9986, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9707, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.7118, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8326}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9991, 'acc_0_1': 0.8207, 'acc_1_0': 0.875, 'acc_1_1': 0.9773, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8295}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6028, 'acc_0_0': 0.9925, 'acc_0_1': 0.7171, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.8348}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9726, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6028, 'acc_0_0': 0.9938, 'acc_0_1': 0.729, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.702, 'acc_1_0': 0.6106, 'acc_1_1': 0.9361, 'mean_acc': 0.8303}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9991, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.7166, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8359}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9782, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.9658, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7277, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8402}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9991, 'acc_0_1': 0.8587, 'acc_1_0': 0.9464, 'acc_1_1': 0.982, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.7095, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8331}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9997, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.609, 'acc_0_0': 0.9925, 'acc_0_1': 0.7424, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9997, 'acc_0_1': 0.8967, 'acc_1_0': 0.9464, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6012, 'acc_0_0': 0.9933, 'acc_0_1': 0.7614, 'acc_1_0': 0.6012, 'acc_1_1': 0.9237, 'mean_acc': 0.8519}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.7419, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.846}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9994, 'acc_0_1': 0.8913, 'acc_1_0': 0.9821, 'acc_1_1': 0.9905, 'mean_acc': 0.9931}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.7211, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8371}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9923}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9902, 'acc_0_1': 0.7295, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8397}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9997, 'acc_0_1': 0.9022, 'acc_1_0': 0.9821, 'acc_1_1': 0.9849, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.7197, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8374}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7694, 'acc_1_0': 0.6075, 'acc_1_1': 0.9268, 'mean_acc': 0.8548}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9944}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6121, 'acc_0_0': 0.9902, 'acc_0_1': 0.7415, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8454}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4697, 'acc_0_0': 0.9785, 'acc_0_1': 0.8541, 'acc_1_0': 0.4697, 'acc_1_1': 0.8209, 'mean_acc': 0.8564}
Val(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.8485, 'acc_0_0': 0.9487, 'acc_0_1': 0.8712, 'acc_1_0': 0.8507, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.8193, 'acc_0_0': 0.9508, 'acc_0_1': 0.8674, 'acc_1_0': 0.8193, 'acc_1_1': 0.8427, 'mean_acc': 0.8918}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3939, 'acc_0_0': 0.897, 'acc_0_1': 0.7983, 'acc_1_0': 0.3939, 'acc_1_1': 0.7612, 'mean_acc': 0.788}
Val(class)(new adapter): {'weighted_mean_acc': 0.8999, 'worst_acc': 0.2189, 'acc_0_0': 0.906, 'acc_0_1': 0.2189, 'acc_1_0': 0.8657, 'acc_1_1': 1.0, 'mean_acc': 0.645}
Test(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.2164, 'acc_0_0': 0.9135, 'acc_0_1': 0.2164, 'acc_1_0': 0.8349, 'acc_1_1': 0.9953, 'mean_acc': 0.6426}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.597, 'acc_0_0': 0.9571, 'acc_0_1': 0.8841, 'acc_1_0': 0.7121, 'acc_1_1': 0.597, 'mean_acc': 0.8614}
Val(class)(new adapter): {'weighted_mean_acc': 0.8349, 'worst_acc': 0.8162, 'acc_0_0': 0.8162, 'acc_0_1': 0.9056, 'acc_1_0': 0.9403, 'acc_1_1': 0.8788, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8172, 'worst_acc': 0.7928, 'acc_0_0': 0.8182, 'acc_0_1': 0.9055, 'acc_1_0': 0.9252, 'acc_1_1': 0.7928, 'mean_acc': 0.8612}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.8884, 'acc_0_1': 0.9399, 'acc_1_0': 0.803, 'acc_1_1': 0.6269, 'mean_acc': 0.8698}
Val(class)(new adapter): {'weighted_mean_acc': 0.894, 'worst_acc': 0.5107, 'acc_0_0': 0.8932, 'acc_0_1': 0.5107, 'acc_1_0': 0.7761, 'acc_1_1': 0.9697, 'mean_acc': 0.74}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.5432, 'acc_0_0': 0.9233, 'acc_0_1': 0.5432, 'acc_1_0': 0.8411, 'acc_1_1': 0.9579, 'mean_acc': 0.7701}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9785, 'acc_0_1': 0.9185, 'acc_1_0': 0.803, 'acc_1_1': 0.7313, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.8085, 'worst_acc': 0.3333, 'acc_0_0': 0.9444, 'acc_0_1': 0.9914, 'acc_1_0': 0.6866, 'acc_1_1': 0.3333, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.8091, 'worst_acc': 0.296, 'acc_0_0': 0.9561, 'acc_0_1': 0.9947, 'acc_1_0': 0.6994, 'acc_1_1': 0.296, 'mean_acc': 0.8695}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.8798, 'acc_0_1': 0.9399, 'acc_1_0': 0.9394, 'acc_1_1': 0.7761, 'mean_acc': 0.8982}
Val(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.5665, 'acc_0_0': 0.9615, 'acc_0_1': 0.5665, 'acc_1_0': 0.791, 'acc_1_1': 0.9697, 'mean_acc': 0.79}
Test(class)(new adapter): {'weighted_mean_acc': 0.9452, 'worst_acc': 0.5929, 'acc_0_0': 0.9641, 'acc_0_1': 0.5929, 'acc_1_0': 0.7726, 'acc_1_1': 0.9533, 'mean_acc': 0.7972}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9957, 'acc_0_1': 0.867, 'acc_1_0': 0.7424, 'acc_1_1': 0.9552, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.6818, 'acc_0_0': 0.9701, 'acc_0_1': 0.9657, 'acc_1_0': 0.7612, 'acc_1_1': 0.6818, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.648, 'acc_0_0': 0.9783, 'acc_0_1': 0.9672, 'acc_1_0': 0.7664, 'acc_1_1': 0.648, 'mean_acc': 0.9139}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.9571, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.6269, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.8767, 'worst_acc': 0.8412, 'acc_0_0': 0.8547, 'acc_0_1': 0.8412, 'acc_1_0': 0.8955, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.8645, 'worst_acc': 0.8208, 'acc_0_0': 0.8523, 'acc_0_1': 0.8208, 'acc_1_0': 0.9159, 'acc_1_1': 0.9097, 'mean_acc': 0.8535}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9485, 'acc_0_1': 0.9528, 'acc_1_0': 0.9091, 'acc_1_1': 0.9552, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9486, 'worst_acc': 0.7015, 'acc_0_0': 0.9786, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.6464, 'acc_0_0': 0.9885, 'acc_0_1': 0.9499, 'acc_1_0': 0.6464, 'acc_1_1': 0.7383, 'mean_acc': 0.9078}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.8636, 'acc_1_1': 0.8507, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.8209, 'acc_0_0': 0.9145, 'acc_0_1': 0.8884, 'acc_1_0': 0.8209, 'acc_1_1': 0.9242, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.8224, 'acc_0_0': 0.9379, 'acc_0_1': 0.9118, 'acc_1_0': 0.8349, 'acc_1_1': 0.8224, 'mean_acc': 0.9035}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9785, 'acc_0_0': 0.9785, 'acc_0_1': 0.9785, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.8358, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.7944, 'acc_0_0': 0.9286, 'acc_0_1': 0.9344, 'acc_1_0': 0.852, 'acc_1_1': 0.7944, 'mean_acc': 0.9075}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9254, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9742, 'acc_1_0': 0.7463, 'acc_1_1': 0.7576, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.662, 'acc_0_0': 0.9712, 'acc_0_1': 0.9778, 'acc_1_0': 0.757, 'acc_1_1': 0.662, 'mean_acc': 0.9158}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.806, 'acc_0_0': 0.9145, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8867, 'worst_acc': 0.757, 'acc_0_0': 0.9246, 'acc_0_1': 0.9295, 'acc_1_0': 0.8287, 'acc_1_1': 0.757, 'mean_acc': 0.8973}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9785, 'acc_0_1': 0.9485, 'acc_1_0': 0.9848, 'acc_1_1': 0.9104, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7632, 'acc_0_0': 0.9632, 'acc_0_1': 0.9273, 'acc_1_0': 0.7632, 'acc_1_1': 0.8006, 'mean_acc': 0.909}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9341, 'worst_acc': 0.7463, 'acc_0_0': 0.9615, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.925}
Test(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.7181, 'acc_0_0': 0.9769, 'acc_0_1': 0.9494, 'acc_1_0': 0.7181, 'acc_1_1': 0.771, 'mean_acc': 0.9147}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.791, 'acc_0_0': 0.9402, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7882, 'acc_0_0': 0.957, 'acc_0_1': 0.9211, 'acc_1_0': 0.7882, 'acc_1_1': 0.8115, 'mean_acc': 0.9082}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.771, 'acc_0_0': 0.9392, 'acc_0_1': 0.9353, 'acc_1_0': 0.796, 'acc_1_1': 0.771, 'mean_acc': 0.9032}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.6963, 'acc_0_0': 0.9636, 'acc_0_1': 0.9623, 'acc_1_0': 0.7477, 'acc_1_1': 0.6963, 'mean_acc': 0.9096}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9614, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7087, 'acc_0_0': 0.9676, 'acc_0_1': 0.9601, 'acc_1_0': 0.7508, 'acc_1_1': 0.7087, 'mean_acc': 0.912}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.7336, 'acc_0_0': 0.9557, 'acc_0_1': 0.9499, 'acc_1_0': 0.7819, 'acc_1_1': 0.7336, 'mean_acc': 0.9096}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.743, 'acc_0_0': 0.9543, 'acc_0_1': 0.949, 'acc_1_0': 0.7928, 'acc_1_1': 0.743, 'mean_acc': 0.9109}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7492, 'acc_0_0': 0.9672, 'acc_0_1': 0.9468, 'acc_1_0': 0.7586, 'acc_1_1': 0.7492, 'mean_acc': 0.912}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.729, 'acc_0_0': 0.9707, 'acc_0_1': 0.9521, 'acc_1_0': 0.729, 'acc_1_1': 0.7461, 'mean_acc': 0.9118}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7461, 'acc_0_0': 0.9667, 'acc_0_1': 0.9437, 'acc_1_0': 0.7461, 'acc_1_1': 0.7586, 'mean_acc': 0.9103}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.7632, 'acc_0_0': 0.9614, 'acc_0_1': 0.9375, 'acc_1_0': 0.7632, 'acc_1_1': 0.7679, 'mean_acc': 0.9087}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7555, 'acc_0_0': 0.9627, 'acc_0_1': 0.9441, 'acc_1_0': 0.7648, 'acc_1_1': 0.7555, 'mean_acc': 0.9106}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7523, 'acc_0_0': 0.9601, 'acc_0_1': 0.9468, 'acc_1_0': 0.7664, 'acc_1_1': 0.7523, 'mean_acc': 0.9104}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7555, 'acc_0_0': 0.9583, 'acc_0_1': 0.9463, 'acc_1_0': 0.771, 'acc_1_1': 0.7555, 'mean_acc': 0.9104}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7508, 'acc_0_0': 0.961, 'acc_0_1': 0.9468, 'acc_1_0': 0.7679, 'acc_1_1': 0.7508, 'mean_acc': 0.9108}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7555, 'acc_0_0': 0.9667, 'acc_0_1': 0.9428, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9113}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.6866, 'acc_0_0': 0.9658, 'acc_0_1': 0.9614, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.6947, 'acc_0_0': 0.9787, 'acc_0_1': 0.9552, 'acc_1_0': 0.6947, 'acc_1_1': 0.7336, 'mean_acc': 0.9109}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9336, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.729, 'acc_0_0': 0.9747, 'acc_0_1': 0.9494, 'acc_1_0': 0.729, 'acc_1_1': 0.7523, 'mean_acc': 0.913}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.931, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9233}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7555, 'acc_0_0': 0.9659, 'acc_0_1': 0.9459, 'acc_1_0': 0.7632, 'acc_1_1': 0.7555, 'mean_acc': 0.9123}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7897, 'acc_0_0': 0.9525, 'acc_0_1': 0.9304, 'acc_1_0': 0.8037, 'acc_1_1': 0.7897, 'mean_acc': 0.9094}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9186, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7726, 'acc_0_0': 0.9548, 'acc_0_1': 0.933, 'acc_1_0': 0.7928, 'acc_1_1': 0.7726, 'mean_acc': 0.9082}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.771, 'acc_0_0': 0.953, 'acc_0_1': 0.9344, 'acc_1_0': 0.8006, 'acc_1_1': 0.771, 'mean_acc': 0.9087}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7679, 'acc_0_0': 0.9552, 'acc_0_1': 0.9361, 'acc_1_0': 0.7944, 'acc_1_1': 0.7679, 'mean_acc': 0.9092}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.771, 'acc_0_0': 0.9583, 'acc_0_1': 0.9348, 'acc_1_0': 0.7866, 'acc_1_1': 0.771, 'mean_acc': 0.9094}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7664, 'acc_0_0': 0.9588, 'acc_0_1': 0.9375, 'acc_1_0': 0.7866, 'acc_1_1': 0.7664, 'mean_acc': 0.9101}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7695, 'acc_0_0': 0.9557, 'acc_0_1': 0.9348, 'acc_1_0': 0.7928, 'acc_1_1': 0.7695, 'mean_acc': 0.9089}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9126, 'worst_acc': 0.7617, 'acc_0_0': 0.9588, 'acc_0_1': 0.9397, 'acc_1_0': 0.7866, 'acc_1_1': 0.7617, 'mean_acc': 0.9104}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7679, 'acc_0_0': 0.9583, 'acc_0_1': 0.9379, 'acc_1_0': 0.785, 'acc_1_1': 0.7679, 'mean_acc': 0.9101}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9132, 'worst_acc': 0.771, 'acc_0_0': 0.957, 'acc_0_1': 0.9344, 'acc_1_0': 0.7913, 'acc_1_1': 0.771, 'mean_acc': 0.9092}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7773, 'acc_0_0': 0.9561, 'acc_0_1': 0.9339, 'acc_1_0': 0.7928, 'acc_1_1': 0.7773, 'mean_acc': 0.9096}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7632, 'acc_0_0': 0.9601, 'acc_0_1': 0.9397, 'acc_1_0': 0.7804, 'acc_1_1': 0.7632, 'mean_acc': 0.9104}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7695, 'acc_0_0': 0.9588, 'acc_0_1': 0.9353, 'acc_1_0': 0.7882, 'acc_1_1': 0.7695, 'mean_acc': 0.9097}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7648, 'acc_0_0': 0.9596, 'acc_0_1': 0.937, 'acc_1_0': 0.785, 'acc_1_1': 0.7648, 'mean_acc': 0.9099}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7617, 'acc_0_0': 0.9623, 'acc_0_1': 0.9406, 'acc_1_0': 0.7726, 'acc_1_1': 0.7617, 'mean_acc': 0.9106}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7726, 'acc_0_0': 0.9574, 'acc_0_1': 0.9348, 'acc_1_0': 0.7913, 'acc_1_1': 0.7726, 'mean_acc': 0.9097}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7679, 'acc_0_0': 0.9579, 'acc_0_1': 0.937, 'acc_1_0': 0.7819, 'acc_1_1': 0.7679, 'mean_acc': 0.9092}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7679, 'acc_0_0': 0.9592, 'acc_0_1': 0.9361, 'acc_1_0': 0.7788, 'acc_1_1': 0.7679, 'mean_acc': 0.909}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.785, 'acc_0_0': 0.953, 'acc_0_1': 0.9326, 'acc_1_0': 0.7991, 'acc_1_1': 0.785, 'mean_acc': 0.9094}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7757, 'acc_0_0': 0.9543, 'acc_0_1': 0.933, 'acc_1_0': 0.796, 'acc_1_1': 0.7757, 'mean_acc': 0.9087}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7679, 'acc_0_0': 0.9579, 'acc_0_1': 0.9353, 'acc_1_0': 0.7882, 'acc_1_1': 0.7679, 'mean_acc': 0.9092}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7632, 'acc_0_0': 0.9574, 'acc_0_1': 0.9366, 'acc_1_0': 0.7882, 'acc_1_1': 0.7632, 'mean_acc': 0.909}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.785, 'acc_0_0': 0.9534, 'acc_0_1': 0.9313, 'acc_1_0': 0.7975, 'acc_1_1': 0.785, 'mean_acc': 0.9089}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7664, 'acc_0_0': 0.9588, 'acc_0_1': 0.9366, 'acc_1_0': 0.785, 'acc_1_1': 0.7664, 'mean_acc': 0.9096}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7586, 'acc_0_0': 0.9623, 'acc_0_1': 0.9401, 'acc_1_0': 0.7726, 'acc_1_1': 0.7586, 'mean_acc': 0.9101}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7664, 'acc_0_0': 0.9627, 'acc_0_1': 0.9375, 'acc_1_0': 0.7773, 'acc_1_1': 0.7664, 'mean_acc': 0.9106}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7586, 'acc_0_0': 0.9667, 'acc_0_1': 0.9406, 'acc_1_0': 0.7632, 'acc_1_1': 0.7586, 'mean_acc': 0.9109}
========================================================================
> end of training. 

best epoch : 41
best training accuracy on [class]: {'worst_acc': 0.4697, 'acc_0_0': 0.9785, 'acc_0_1': 0.8541, 'acc_1_0': 0.4697, 'acc_1_1': 0.8209, 'mean_acc': 0.8564}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9225, 'worst_acc': 0.8485, 'acc_0_0': 0.9487, 'acc_0_1': 0.8712, 'acc_1_0': 0.8507, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
best test accuracy on [class]: {'weighted_mean_acc': 0.9222, 'worst_acc': 0.8193, 'acc_0_0': 0.9508, 'acc_0_1': 0.8674, 'acc_1_0': 0.8193, 'acc_1_1': 0.8427, 'mean_acc': 0.8918}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.8193, 'acc_0_0': 0.9508, 'acc_0_1': 0.8674, 'acc_1_0': 0.8193, 'acc_1_1': 0.8427, 'mean_acc': 0.8918}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.8563, 'worst_acc': 0.0656, 'acc_0_0': 0.9716, 'acc_0_1': 0.0656, 'acc_1_0': 0.2165, 'acc_1_1': 0.6464, 'mean_acc': 0.4993}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 41': {'Train': {'worst_acc': 0.4697, 'acc_0_0': 0.9785, 'acc_0_1': 0.8541, 'acc_1_0': 0.4697, 'acc_1_1': 0.8209, 'mean_acc': 0.8564}, 'Val': {'weighted_mean_acc': 0.9225, 'worst_acc': 0.8485, 'acc_0_0': 0.9487, 'acc_0_1': 0.8712, 'acc_1_0': 0.8507, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}, 'Test': {'weighted_mean_acc': 0.9222, 'worst_acc': 0.8193, 'acc_0_0': 0.9508, 'acc_0_1': 0.8674, 'acc_1_0': 0.8193, 'acc_1_1': 0.8427, 'mean_acc': 0.8918}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9222, 'worst_acc': 0.8193, 'acc_0_0': 0.9508, 'acc_0_1': 0.8674, 'acc_1_0': 0.8193, 'acc_1_1': 0.8427, 'mean_acc': 0.8918}, 'spurious': {'weighted_mean_acc': 0.8563, 'worst_acc': 0.0656, 'acc_0_0': 0.9716, 'acc_0_1': 0.0656, 'acc_1_0': 0.2165, 'acc_1_1': 0.6464, 'mean_acc': 0.4993}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8953     0.8239   0.8931  ...   0.8754   0.9159    0.8668
2                       0.8972     0.8349   0.9153  ...   0.8879   0.8349    0.9032
3                       0.9222     0.8193   0.9508  ...   0.8193   0.8427    0.8918
test_mean               0.9049     0.8260   0.9197  ...   0.8609   0.8645    0.8873
test_std                0.0123     0.0065   0.0238  ...   0.0298   0.0365    0.0152
1                       0.9677     0.4969   0.9933  ...   0.4969   0.9642    0.7988
2                       0.9648     0.4424   0.9681  ...   0.4424   0.9907    0.8909
3                       0.8563     0.0656   0.9716  ...   0.2165   0.6464    0.4993
zs_spu_mean             0.9296     0.3350   0.9777  ...   0.3853   0.8671    0.7297
zs_spu_std              0.0518     0.1918   0.0111  ...   0.1214   0.1564    0.1672
1                          NaN     0.6269   0.8712  ...   0.8939   0.6269    0.8815
2                          NaN     0.6212   0.9742  ...   0.6212   0.6866    0.8915
3                          NaN     0.4697   0.9785  ...   0.4697   0.8209    0.8564
tr_mean                    NaN     0.5726   0.9413  ...   0.6616   0.7115    0.8765
tr_std                     NaN     0.0728   0.0496  ...   0.1755   0.0811    0.0148
1                       0.9040     0.8412   0.8974  ...   0.8507   0.9394    0.8750
2                       0.9100     0.8806   0.9103  ...   0.8806   0.9091    0.9100
3                       0.9225     0.8485   0.9487  ...   0.8507   0.8485    0.8967
val_mean                0.9122     0.8568   0.9188  ...   0.8607   0.8990    0.8939
val_std                 0.0077     0.0171   0.0218  ...   0.0141   0.0378    0.0144
1                       0.8953     0.8239   0.8931  ...   0.8754   0.9159    0.8668
2                       0.8972     0.8349   0.9153  ...   0.8879   0.8349    0.9032
3                       0.9222     0.8193   0.9508  ...   0.8193   0.8427    0.8918
zs_tg_mean              0.9049     0.8260   0.9197  ...   0.8609   0.8645    0.8873
zs_tg_std               0.0123     0.0065   0.0238  ...   0.0298   0.0365    0.0152

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_1.0_lrr1.0_bsr64_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.122, 'acc_0_0': 0.9265, 'acc_0_1': 0.9348, 'acc_1_0': 0.1607, 'acc_1_1': 0.122, 'mean_acc': 0.7406}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7677, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.7685, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9969, 'acc_1_0': 0.0, 'acc_1_1': 0.0031, 'mean_acc': 0.7775}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9771, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.7465, 'mean_acc': 0.8997}
Val(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.2961, 'acc_0_0': 0.9786, 'acc_0_1': 0.2961, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6717}
Test(class): {'weighted_mean_acc': 0.9409, 'worst_acc': 0.247, 'acc_0_0': 0.9734, 'acc_0_1': 0.247, 'acc_1_0': 0.5732, 'acc_1_1': 0.9735, 'mean_acc': 0.6464}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3036, 'acc_0_0': 0.994, 'acc_0_1': 0.462, 'acc_1_0': 0.3036, 'acc_1_1': 0.9234, 'mean_acc': 0.9499}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.209, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.209, 'acc_1_1': 0.9091, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2259, 'acc_0_0': 0.9996, 'acc_0_1': 0.6341, 'acc_1_0': 0.2259, 'acc_1_1': 0.8738, 'mean_acc': 0.7577}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.2321, 'acc_0_0': 0.9986, 'acc_0_1': 0.6359, 'acc_1_0': 0.2321, 'acc_1_1': 0.8581, 'mean_acc': 0.9447}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.2985, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.2985, 'acc_1_1': 0.9242, 'mean_acc': 0.8017}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.3598, 'acc_0_0': 0.9987, 'acc_0_1': 0.6328, 'acc_1_0': 0.3598, 'acc_1_1': 0.9065, 'mean_acc': 0.7753}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4674, 'acc_0_0': 0.99, 'acc_0_1': 0.4674, 'acc_1_0': 0.5893, 'acc_1_1': 0.9612, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.3881, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.3881, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.4688, 'acc_0_0': 0.9951, 'acc_0_1': 0.6488, 'acc_1_0': 0.4688, 'acc_1_1': 0.9159, 'mean_acc': 0.7932}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9857, 'acc_0_1': 0.5109, 'acc_1_0': 0.6607, 'acc_1_1': 0.964, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.3284, 'acc_1_1': 0.8939, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.4361, 'acc_0_0': 0.9969, 'acc_0_1': 0.8115, 'acc_1_0': 0.4361, 'acc_1_1': 0.8769, 'mean_acc': 0.8493}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.99, 'acc_0_1': 0.712, 'acc_1_0': 0.6071, 'acc_1_1': 0.9338, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8455, 'acc_1_0': 0.3731, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4486, 'acc_0_0': 0.996, 'acc_0_1': 0.855, 'acc_1_0': 0.4486, 'acc_1_1': 0.866, 'mean_acc': 0.8661}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7391, 'acc_1_0': 0.625, 'acc_1_1': 0.929, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9716, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.581, 'acc_0_0': 0.9902, 'acc_0_1': 0.7038, 'acc_1_0': 0.581, 'acc_1_1': 0.9299, 'mean_acc': 0.8267}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.9866, 'acc_0_1': 0.6359, 'acc_1_0': 0.6964, 'acc_1_1': 0.9574, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9744, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.955, 'worst_acc': 0.5508, 'acc_0_0': 0.984, 'acc_0_1': 0.5508, 'acc_1_0': 0.6511, 'acc_1_1': 0.9455, 'mean_acc': 0.7742}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9886, 'acc_0_1': 0.625, 'acc_1_0': 0.6607, 'acc_1_1': 0.9593, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5401, 'acc_0_0': 0.9858, 'acc_0_1': 0.5401, 'acc_1_0': 0.6417, 'acc_1_1': 0.9517, 'mean_acc': 0.7705}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9937, 'acc_0_1': 0.6957, 'acc_1_0': 0.625, 'acc_1_1': 0.9565, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9731, 'worst_acc': 0.5665, 'acc_0_0': 0.9915, 'acc_0_1': 0.5665, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5042, 'acc_0_0': 0.9845, 'acc_0_1': 0.5042, 'acc_1_0': 0.6511, 'acc_1_1': 0.9564, 'mean_acc': 0.7575}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.6739, 'acc_1_0': 0.6071, 'acc_1_1': 0.9603, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9705, 'worst_acc': 0.4893, 'acc_0_0': 0.9915, 'acc_0_1': 0.4893, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.4381, 'acc_0_0': 0.9814, 'acc_0_1': 0.4381, 'acc_1_0': 0.6807, 'acc_1_1': 0.9611, 'mean_acc': 0.7344}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6087, 'acc_0_0': 0.9911, 'acc_0_1': 0.6087, 'acc_1_0': 0.6607, 'acc_1_1': 0.9707, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5322, 'acc_0_0': 0.9915, 'acc_0_1': 0.5322, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.9547, 'worst_acc': 0.4878, 'acc_0_0': 0.9823, 'acc_0_1': 0.4878, 'acc_1_0': 0.6729, 'acc_1_1': 0.9595, 'mean_acc': 0.753}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.6902, 'acc_1_0': 0.6607, 'acc_1_1': 0.9688, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9742, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9559, 'worst_acc': 0.5627, 'acc_0_0': 0.9836, 'acc_0_1': 0.5627, 'acc_1_0': 0.6589, 'acc_1_1': 0.9486, 'mean_acc': 0.7799}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.992, 'acc_0_1': 0.6359, 'acc_1_0': 0.7321, 'acc_1_1': 0.9726, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.545, 'acc_0_0': 0.9818, 'acc_0_1': 0.545, 'acc_1_0': 0.6822, 'acc_1_1': 0.9564, 'mean_acc': 0.7758}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9926, 'acc_0_1': 0.6685, 'acc_1_0': 0.7679, 'acc_1_1': 0.9726, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6137, 'acc_0_0': 0.9915, 'acc_0_1': 0.6137, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5765, 'acc_0_0': 0.9827, 'acc_0_1': 0.5765, 'acc_1_0': 0.6822, 'acc_1_1': 0.947, 'mean_acc': 0.7874}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9688, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5583, 'acc_0_0': 0.9823, 'acc_0_1': 0.5583, 'acc_1_0': 0.6807, 'acc_1_1': 0.9533, 'mean_acc': 0.7806}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.9931, 'acc_0_1': 0.6793, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.588, 'acc_0_0': 0.9845, 'acc_0_1': 0.588, 'acc_1_0': 0.6729, 'acc_1_1': 0.9455, 'mean_acc': 0.7913}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.7857, 'acc_1_1': 0.9754, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6481, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6164, 'acc_0_0': 0.9863, 'acc_0_1': 0.6164, 'acc_1_0': 0.6667, 'acc_1_1': 0.9455, 'mean_acc': 0.8024}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6341, 'acc_0_0': 0.9876, 'acc_0_1': 0.6341, 'acc_1_0': 0.6667, 'acc_1_1': 0.9424, 'mean_acc': 0.8095}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9943, 'acc_0_1': 0.7337, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6511, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6511, 'acc_1_1': 0.9408, 'mean_acc': 0.816}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9957, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9785}
Val(class): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6381, 'acc_0_0': 0.9863, 'acc_0_1': 0.6381, 'acc_1_0': 0.6558, 'acc_1_1': 0.9486, 'mean_acc': 0.81}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.994, 'acc_0_1': 0.7283, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6438, 'acc_0_0': 0.9872, 'acc_0_1': 0.6438, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6266, 'acc_0_0': 0.9867, 'acc_0_1': 0.6266, 'acc_1_0': 0.6558, 'acc_1_1': 0.947, 'mean_acc': 0.8055}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9966, 'acc_0_1': 0.7826, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9707, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6741, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.8214}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9943, 'acc_0_1': 0.75, 'acc_1_0': 0.8571, 'acc_1_1': 0.9773, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9739, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6402, 'acc_0_0': 0.9876, 'acc_0_1': 0.6727, 'acc_1_0': 0.6402, 'acc_1_1': 0.9424, 'mean_acc': 0.8215}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9603, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6589, 'acc_0_0': 0.9871, 'acc_0_1': 0.6692, 'acc_1_0': 0.6589, 'acc_1_1': 0.9455, 'mean_acc': 0.8224}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9946, 'acc_0_1': 0.7283, 'acc_1_0': 0.8929, 'acc_1_1': 0.982, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6355, 'acc_0_0': 0.9867, 'acc_0_1': 0.6355, 'acc_1_0': 0.6495, 'acc_1_1': 0.9455, 'mean_acc': 0.8081}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.75, 'acc_1_1': 0.9716, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.7091, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8338}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5622, 'acc_0_0': 0.9786, 'acc_0_1': 0.5622, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5481, 'acc_0_0': 0.9823, 'acc_0_1': 0.5481, 'acc_1_0': 0.69, 'acc_1_1': 0.9533, 'mean_acc': 0.7777}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.996, 'acc_0_1': 0.788, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6542, 'acc_0_0': 0.9876, 'acc_0_1': 0.6621, 'acc_1_0': 0.6542, 'acc_1_1': 0.9393, 'mean_acc': 0.8186}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9951, 'acc_0_1': 0.7772, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.662, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8271}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.913, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.588, 'acc_0_0': 0.9872, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5969, 'acc_0_0': 0.9885, 'acc_0_1': 0.5969, 'acc_1_0': 0.6308, 'acc_1_1': 0.9486, 'mean_acc': 0.792}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.7857, 'acc_1_1': 0.9877, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6464, 'acc_0_0': 0.9871, 'acc_0_1': 0.7419, 'acc_1_0': 0.6464, 'acc_1_1': 0.9237, 'mean_acc': 0.8469}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9957, 'acc_0_1': 0.8641, 'acc_1_0': 0.9107, 'acc_1_1': 0.9858, 'mean_acc': 0.9875}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5701, 'acc_0_0': 0.9925, 'acc_0_1': 0.69, 'acc_1_0': 0.5701, 'acc_1_1': 0.9237, 'mean_acc': 0.8203}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.8913, 'acc_1_0': 0.875, 'acc_1_1': 0.9792, 'mean_acc': 0.9883}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7639, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.634, 'acc_0_0': 0.988, 'acc_0_1': 0.7698, 'acc_1_0': 0.634, 'acc_1_1': 0.9206, 'mean_acc': 0.8564}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9963, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.7317, 'acc_1_0': 0.5545, 'acc_1_1': 0.9252, 'mean_acc': 0.8353}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9974, 'acc_0_1': 0.8913, 'acc_1_0': 0.9286, 'acc_1_1': 0.983, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5997, 'acc_0_0': 0.9863, 'acc_0_1': 0.7375, 'acc_1_0': 0.5997, 'acc_1_1': 0.9252, 'mean_acc': 0.8398}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.7468, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.6558, 'acc_0_0': 0.9836, 'acc_0_1': 0.7353, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8443}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9991, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9801, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.588, 'acc_0_0': 0.9658, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5787, 'acc_0_0': 0.9792, 'acc_0_1': 0.5787, 'acc_1_0': 0.6963, 'acc_1_1': 0.9548, 'mean_acc': 0.7893}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6364, 'acc_0_0': 0.9528, 'acc_0_1': 0.8927, 'acc_1_0': 0.6364, 'acc_1_1': 0.791, 'mean_acc': 0.8765}
Val(class)(new adapter): {'weighted_mean_acc': 0.7652, 'worst_acc': 0.1515, 'acc_0_0': 0.9402, 'acc_0_1': 0.9871, 'acc_1_0': 0.6866, 'acc_1_1': 0.1515, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.7693, 'worst_acc': 0.162, 'acc_0_0': 0.9415, 'acc_0_1': 0.9831, 'acc_1_0': 0.7726, 'acc_1_1': 0.162, 'mean_acc': 0.8526}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4697, 'acc_0_0': 0.867, 'acc_0_1': 0.8112, 'acc_1_0': 0.4697, 'acc_1_1': 0.7164, 'mean_acc': 0.7846}
Val(class)(new adapter): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.485, 'acc_0_0': 0.9615, 'acc_0_1': 0.485, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.7533}
Test(class)(new adapter): {'weighted_mean_acc': 0.9471, 'worst_acc': 0.463, 'acc_0_0': 0.969, 'acc_0_1': 0.463, 'acc_1_0': 0.7368, 'acc_1_1': 0.9704, 'mean_acc': 0.7465}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9742, 'acc_0_1': 0.8884, 'acc_1_0': 0.6667, 'acc_1_1': 0.8209, 'mean_acc': 0.8898}
Val(class)(new adapter): {'weighted_mean_acc': 0.8795, 'worst_acc': 0.7121, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.8657, 'acc_1_1': 0.7121, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8327, 'worst_acc': 0.5592, 'acc_0_0': 0.9086, 'acc_0_1': 0.9486, 'acc_1_0': 0.8692, 'acc_1_1': 0.5592, 'mean_acc': 0.8811}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5075, 'acc_0_0': 0.8369, 'acc_0_1': 0.8841, 'acc_1_0': 0.7576, 'acc_1_1': 0.5075, 'mean_acc': 0.8097}
Val(class)(new adapter): {'weighted_mean_acc': 0.939, 'worst_acc': 0.6223, 'acc_0_0': 0.9487, 'acc_0_1': 0.6223, 'acc_1_0': 0.791, 'acc_1_1': 0.9697, 'mean_acc': 0.8067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9446, 'worst_acc': 0.6027, 'acc_0_0': 0.9614, 'acc_0_1': 0.6027, 'acc_1_0': 0.8255, 'acc_1_1': 0.9548, 'mean_acc': 0.806}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6515, 'acc_0_0': 0.9914, 'acc_0_1': 0.9485, 'acc_1_0': 0.6515, 'acc_1_1': 0.8806, 'mean_acc': 0.9249}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8808, 'worst_acc': 0.662, 'acc_0_0': 0.9446, 'acc_0_1': 0.9432, 'acc_1_0': 0.8224, 'acc_1_1': 0.662, 'mean_acc': 0.8992}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5821, 'acc_0_0': 0.9013, 'acc_0_1': 0.9399, 'acc_1_0': 0.7879, 'acc_1_1': 0.5821, 'mean_acc': 0.8681}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.6009, 'acc_0_0': 0.9231, 'acc_0_1': 0.6009, 'acc_1_0': 0.8507, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.6271, 'acc_0_0': 0.9295, 'acc_0_1': 0.6271, 'acc_1_0': 0.8536, 'acc_1_1': 0.9611, 'mean_acc': 0.8069}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9657, 'acc_0_1': 0.9528, 'acc_1_0': 0.7727, 'acc_1_1': 0.8955, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.875, 'worst_acc': 0.6818, 'acc_0_0': 0.9316, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.6818, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8644, 'worst_acc': 0.5592, 'acc_0_0': 0.953, 'acc_0_1': 0.9654, 'acc_1_0': 0.7617, 'acc_1_1': 0.5592, 'mean_acc': 0.893}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9185, 'acc_0_1': 0.9356, 'acc_1_0': 0.8182, 'acc_1_1': 0.806, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7682, 'acc_0_0': 0.9359, 'acc_0_1': 0.7682, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7792, 'acc_0_0': 0.937, 'acc_0_1': 0.7792, 'acc_1_0': 0.8442, 'acc_1_1': 0.9346, 'mean_acc': 0.865}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9785, 'acc_0_1': 0.9485, 'acc_1_0': 0.8333, 'acc_1_1': 0.9851, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.7576, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.7576, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.892, 'worst_acc': 0.6854, 'acc_0_0': 0.953, 'acc_0_1': 0.9565, 'acc_1_0': 0.7679, 'acc_1_1': 0.6854, 'mean_acc': 0.9042}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9313, 'acc_0_1': 0.9571, 'acc_1_0': 0.7879, 'acc_1_1': 0.806, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.939, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.8841, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9288, 'worst_acc': 0.8006, 'acc_0_0': 0.9627, 'acc_0_1': 0.8971, 'acc_1_0': 0.8006, 'acc_1_1': 0.8287, 'mean_acc': 0.9044}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.8333, 'acc_1_1': 0.9701, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8888, 'worst_acc': 0.7414, 'acc_0_0': 0.9339, 'acc_0_1': 0.8984, 'acc_1_0': 0.8193, 'acc_1_1': 0.7414, 'mean_acc': 0.8861}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9614, 'acc_0_1': 0.9356, 'acc_1_0': 0.9091, 'acc_1_1': 0.9254, 'mean_acc': 0.9416}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.8927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7835, 'acc_0_0': 0.9446, 'acc_0_1': 0.918, 'acc_1_0': 0.8084, 'acc_1_1': 0.7835, 'mean_acc': 0.9013}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8616, 'worst_acc': 0.6061, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.6061, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.865, 'worst_acc': 0.5405, 'acc_0_0': 0.9588, 'acc_0_1': 0.9765, 'acc_1_0': 0.7632, 'acc_1_1': 0.5405, 'mean_acc': 0.8977}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9528, 'acc_0_1': 0.9571, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.8992, 'worst_acc': 0.6223, 'acc_0_0': 0.8889, 'acc_0_1': 0.6223, 'acc_1_0': 0.8358, 'acc_1_1': 0.9848, 'mean_acc': 0.79}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.6328, 'acc_0_0': 0.8958, 'acc_0_1': 0.6328, 'acc_1_0': 0.866, 'acc_1_1': 0.947, 'mean_acc': 0.7958}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.8636, 'acc_1_1': 0.9552, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.7576, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8774, 'worst_acc': 0.5748, 'acc_0_0': 0.9667, 'acc_0_1': 0.9579, 'acc_1_0': 0.7477, 'acc_1_1': 0.5748, 'mean_acc': 0.8956}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9785, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.8507, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.618, 'acc_0_0': 0.9103, 'acc_0_1': 0.618, 'acc_1_0': 0.8657, 'acc_1_1': 0.9848, 'mean_acc': 0.8}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.6213, 'acc_0_0': 0.9016, 'acc_0_1': 0.6213, 'acc_1_0': 0.8598, 'acc_1_1': 0.9642, 'mean_acc': 0.7948}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9828, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.8657, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.874, 'worst_acc': 0.7273, 'acc_0_0': 0.9145, 'acc_0_1': 0.9614, 'acc_1_0': 0.8209, 'acc_1_1': 0.7273, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8536, 'worst_acc': 0.5903, 'acc_0_0': 0.9277, 'acc_0_1': 0.9743, 'acc_1_0': 0.7975, 'acc_1_1': 0.5903, 'mean_acc': 0.894}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9657, 'acc_0_1': 0.9785, 'acc_1_0': 1.0, 'acc_1_1': 0.8806, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.7296, 'acc_0_0': 0.9402, 'acc_0_1': 0.7296, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.745, 'acc_0_0': 0.9667, 'acc_0_1': 0.745, 'acc_1_0': 0.7913, 'acc_1_1': 0.9346, 'mean_acc': 0.8574}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.97, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.8527, 'worst_acc': 0.6667, 'acc_0_0': 0.906, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.6667, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8575, 'worst_acc': 0.5981, 'acc_0_0': 0.9322, 'acc_0_1': 0.9424, 'acc_1_0': 0.8115, 'acc_1_1': 0.5981, 'mean_acc': 0.8857}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9657, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9104, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.8155, 'acc_1_0': 0.7612, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.9381, 'worst_acc': 0.7695, 'acc_0_0': 0.9659, 'acc_0_1': 0.8412, 'acc_1_0': 0.7695, 'acc_1_1': 0.8723, 'mean_acc': 0.8852}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 1.0, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.7988, 'worst_acc': 0.303, 'acc_0_0': 0.9402, 'acc_0_1': 0.97, 'acc_1_0': 0.7612, 'acc_1_1': 0.303, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.8087, 'worst_acc': 0.3037, 'acc_0_0': 0.9525, 'acc_0_1': 0.9849, 'acc_1_0': 0.7741, 'acc_1_1': 0.3037, 'mean_acc': 0.8735}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9528, 'acc_0_1': 0.9571, 'acc_1_0': 0.9091, 'acc_1_1': 0.8657, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.8209, 'acc_0_0': 0.9402, 'acc_0_1': 0.8927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.897, 'worst_acc': 0.7975, 'acc_0_0': 0.9295, 'acc_0_1': 0.8696, 'acc_1_0': 0.8396, 'acc_1_1': 0.7975, 'mean_acc': 0.8816}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9871, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.7727, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.885, 'worst_acc': 0.6308, 'acc_0_0': 0.9596, 'acc_0_1': 0.9592, 'acc_1_0': 0.7726, 'acc_1_1': 0.6308, 'mean_acc': 0.9023}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9528, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.8657, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.8657, 'acc_0_0': 0.9402, 'acc_0_1': 0.9013, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8892, 'worst_acc': 0.7664, 'acc_0_0': 0.9251, 'acc_0_1': 0.9259, 'acc_1_0': 0.8474, 'acc_1_1': 0.7664, 'mean_acc': 0.8992}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9657, 'acc_0_1': 0.9914, 'acc_1_0': 0.8182, 'acc_1_1': 0.9851, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.6866, 'acc_0_0': 0.9615, 'acc_0_1': 0.927, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.704, 'acc_0_0': 0.9818, 'acc_0_1': 0.945, 'acc_1_0': 0.704, 'acc_1_1': 0.7103, 'mean_acc': 0.9066}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9056, 'acc_0_1': 0.9185, 'acc_1_0': 0.803, 'acc_1_1': 0.9701, 'mean_acc': 0.9065}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.897, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8948, 'worst_acc': 0.7336, 'acc_0_0': 0.9437, 'acc_0_1': 0.9118, 'acc_1_0': 0.8255, 'acc_1_1': 0.7336, 'mean_acc': 0.8949}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9871, 'acc_0_1': 0.9785, 'acc_1_0': 0.8485, 'acc_1_1': 0.9254, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8905, 'worst_acc': 0.6838, 'acc_0_0': 0.9517, 'acc_0_1': 0.9353, 'acc_1_0': 0.8224, 'acc_1_1': 0.6838, 'mean_acc': 0.9013}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9313, 'acc_0_1': 0.9356, 'acc_1_0': 0.8788, 'acc_1_1': 0.8955, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.4979, 'acc_0_0': 0.9188, 'acc_0_1': 0.4979, 'acc_1_0': 0.8657, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.4803, 'acc_0_0': 0.9317, 'acc_0_1': 0.4803, 'acc_1_0': 0.8536, 'acc_1_1': 0.9704, 'mean_acc': 0.7516}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 1.0, 'acc_0_1': 0.9442, 'acc_1_0': 0.7879, 'acc_1_1': 0.8209, 'mean_acc': 0.9349}
Val(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.8115, 'acc_0_0': 0.9477, 'acc_0_1': 0.8998, 'acc_1_0': 0.8115, 'acc_1_1': 0.8614, 'mean_acc': 0.9044}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9356, 'acc_0_1': 0.8884, 'acc_1_0': 0.8485, 'acc_1_1': 0.806, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.5536, 'acc_0_0': 0.9188, 'acc_0_1': 0.5536, 'acc_1_0': 0.8657, 'acc_1_1': 0.9848, 'mean_acc': 0.7783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.5144, 'acc_0_0': 0.9082, 'acc_0_1': 0.5144, 'acc_1_0': 0.8692, 'acc_1_1': 0.9673, 'mean_acc': 0.7572}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.9742, 'acc_0_1': 0.9227, 'acc_1_0': 0.8788, 'acc_1_1': 0.7313, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.6667, 'acc_0_0': 0.9701, 'acc_0_1': 0.9742, 'acc_1_0': 0.7164, 'acc_1_1': 0.6667, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.5981, 'acc_0_0': 0.9867, 'acc_0_1': 0.9836, 'acc_1_0': 0.7134, 'acc_1_1': 0.5981, 'mean_acc': 0.9122}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6818, 'acc_0_0': 0.9528, 'acc_0_1': 0.9957, 'acc_1_0': 0.6818, 'acc_1_1': 0.7313, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.5579, 'acc_0_0': 0.9103, 'acc_0_1': 0.5579, 'acc_1_0': 0.8806, 'acc_1_1': 0.9848, 'mean_acc': 0.7783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.5206, 'acc_0_0': 0.9166, 'acc_0_1': 0.5206, 'acc_1_0': 0.8567, 'acc_1_1': 0.9735, 'mean_acc': 0.7622}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8326, 'acc_0_0': 0.9742, 'acc_0_1': 0.8326, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.8813, 'worst_acc': 0.6818, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.6818, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8719, 'worst_acc': 0.5779, 'acc_0_0': 0.9574, 'acc_0_1': 0.9596, 'acc_1_0': 0.7882, 'acc_1_1': 0.5779, 'mean_acc': 0.8975}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.9442, 'acc_1_0': 0.9242, 'acc_1_1': 0.6418, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.8369, 'acc_0_0': 0.9274, 'acc_0_1': 0.8369, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.8297, 'acc_0_0': 0.9286, 'acc_0_1': 0.8297, 'acc_1_0': 0.8536, 'acc_1_1': 0.8941, 'mean_acc': 0.878}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9528, 'acc_0_0': 0.9828, 'acc_0_1': 0.9528, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7804, 'acc_0_0': 0.9588, 'acc_0_1': 0.9463, 'acc_1_0': 0.7804, 'acc_1_1': 0.7866, 'mean_acc': 0.9151}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9442, 'acc_0_1': 1.0, 'acc_1_0': 0.7576, 'acc_1_1': 0.9403, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.9215, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.757, 'acc_0_0': 0.9681, 'acc_0_1': 0.9494, 'acc_1_0': 0.757, 'acc_1_1': 0.7726, 'mean_acc': 0.9158}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.7757, 'acc_0_0': 0.9681, 'acc_0_1': 0.937, 'acc_1_0': 0.7757, 'acc_1_1': 0.8022, 'mean_acc': 0.9163}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7944, 'acc_0_0': 0.9627, 'acc_0_1': 0.9286, 'acc_1_0': 0.7944, 'acc_1_1': 0.8146, 'mean_acc': 0.9144}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9337, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.7913, 'acc_0_0': 0.9636, 'acc_0_1': 0.9295, 'acc_1_0': 0.7913, 'acc_1_1': 0.8224, 'mean_acc': 0.9156}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.7788, 'acc_0_0': 0.9663, 'acc_0_1': 0.9375, 'acc_1_0': 0.7788, 'acc_1_1': 0.8053, 'mean_acc': 0.9165}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7913, 'acc_0_0': 0.9645, 'acc_0_1': 0.9313, 'acc_1_0': 0.7913, 'acc_1_1': 0.8209, 'mean_acc': 0.9165}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9305, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7835, 'acc_0_0': 0.9659, 'acc_0_1': 0.9322, 'acc_1_0': 0.7835, 'acc_1_1': 0.8146, 'mean_acc': 0.9158}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9306, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.8022, 'acc_0_0': 0.9605, 'acc_0_1': 0.9326, 'acc_1_0': 0.8022, 'acc_1_1': 0.8224, 'mean_acc': 0.9168}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9276, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.8053, 'acc_0_0': 0.9574, 'acc_0_1': 0.9282, 'acc_1_0': 0.8053, 'acc_1_1': 0.8224, 'mean_acc': 0.9142}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.796, 'acc_0_0': 0.9588, 'acc_0_1': 0.9322, 'acc_1_0': 0.796, 'acc_1_1': 0.8146, 'mean_acc': 0.9144}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9246, 'worst_acc': 0.8084, 'acc_0_0': 0.9579, 'acc_0_1': 0.9326, 'acc_1_0': 0.8084, 'acc_1_1': 0.8193, 'mean_acc': 0.9161}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.8053, 'acc_0_0': 0.9592, 'acc_0_1': 0.9304, 'acc_1_0': 0.8053, 'acc_1_1': 0.8224, 'mean_acc': 0.9158}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9283, 'worst_acc': 0.7991, 'acc_0_0': 0.9605, 'acc_0_1': 0.9277, 'acc_1_0': 0.7991, 'acc_1_1': 0.8287, 'mean_acc': 0.9153}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7975, 'acc_0_0': 0.957, 'acc_0_1': 0.9299, 'acc_1_0': 0.7975, 'acc_1_1': 0.8178, 'mean_acc': 0.9134}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.8006, 'acc_0_0': 0.957, 'acc_0_1': 0.9313, 'acc_1_0': 0.8006, 'acc_1_1': 0.8162, 'mean_acc': 0.914}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8084, 'acc_0_0': 0.9543, 'acc_0_1': 0.9273, 'acc_1_0': 0.8084, 'acc_1_1': 0.8287, 'mean_acc': 0.9137}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7991, 'acc_0_0': 0.9588, 'acc_0_1': 0.9268, 'acc_1_0': 0.7991, 'acc_1_1': 0.8271, 'mean_acc': 0.914}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9281, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.7913, 'acc_0_0': 0.9627, 'acc_0_1': 0.9344, 'acc_1_0': 0.7913, 'acc_1_1': 0.8131, 'mean_acc': 0.9161}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8022, 'acc_0_0': 0.9583, 'acc_0_1': 0.9317, 'acc_1_0': 0.8022, 'acc_1_1': 0.8146, 'mean_acc': 0.9147}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7975, 'acc_0_0': 0.961, 'acc_0_1': 0.9326, 'acc_1_0': 0.7975, 'acc_1_1': 0.8162, 'mean_acc': 0.9158}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.8084, 'acc_0_0': 0.9543, 'acc_0_1': 0.9251, 'acc_1_0': 0.8084, 'acc_1_1': 0.8287, 'mean_acc': 0.9128}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9276, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7991, 'acc_0_0': 0.9601, 'acc_0_1': 0.9282, 'acc_1_0': 0.7991, 'acc_1_1': 0.8255, 'mean_acc': 0.9149}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9309, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9274, 'worst_acc': 0.7757, 'acc_0_0': 0.9632, 'acc_0_1': 0.9317, 'acc_1_0': 0.7757, 'acc_1_1': 0.8162, 'mean_acc': 0.9139}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7897, 'acc_0_0': 0.961, 'acc_0_1': 0.9322, 'acc_1_0': 0.7897, 'acc_1_1': 0.8162, 'mean_acc': 0.9147}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8939, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7804, 'acc_0_0': 0.9636, 'acc_0_1': 0.9366, 'acc_1_0': 0.7804, 'acc_1_1': 0.8115, 'mean_acc': 0.9159}
========================================================================
> end of training. 

best epoch : 64
best training accuracy on [class]: {'worst_acc': 0.8657, 'acc_0_0': 0.9528, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.8657, 'mean_acc': 0.9516}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9243, 'worst_acc': 0.8657, 'acc_0_0': 0.9402, 'acc_0_1': 0.9013, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
best test accuracy on [class]: {'weighted_mean_acc': 0.8892, 'worst_acc': 0.7664, 'acc_0_0': 0.9251, 'acc_0_1': 0.9259, 'acc_1_0': 0.8474, 'acc_1_1': 0.7664, 'mean_acc': 0.8992}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8892, 'worst_acc': 0.7664, 'acc_0_0': 0.9251, 'acc_0_1': 0.9259, 'acc_1_0': 0.8474, 'acc_1_1': 0.7664, 'mean_acc': 0.8992}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6542, 'acc_0_0': 0.9743, 'acc_0_1': 0.7947, 'acc_1_0': 0.6542, 'acc_1_1': 0.9766, 'mean_acc': 0.8692}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 64': {'Train': {'worst_acc': 0.8657, 'acc_0_0': 0.9528, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.8657, 'mean_acc': 0.9516}, 'Val': {'weighted_mean_acc': 0.9243, 'worst_acc': 0.8657, 'acc_0_0': 0.9402, 'acc_0_1': 0.9013, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.91}, 'Test': {'weighted_mean_acc': 0.8892, 'worst_acc': 0.7664, 'acc_0_0': 0.9251, 'acc_0_1': 0.9259, 'acc_1_0': 0.8474, 'acc_1_1': 0.7664, 'mean_acc': 0.8992}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8892, 'worst_acc': 0.7664, 'acc_0_0': 0.9251, 'acc_0_1': 0.9259, 'acc_1_0': 0.8474, 'acc_1_1': 0.7664, 'mean_acc': 0.8992}, 'spurious': {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6542, 'acc_0_0': 0.9743, 'acc_0_1': 0.7947, 'acc_1_0': 0.6542, 'acc_1_1': 0.9766, 'mean_acc': 0.8692}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9048, 'acc_0_1': 0.8967, 'acc_1_0': 0.0714, 'acc_1_1': 0.1485, 'mean_acc': 0.7281}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9983, 'acc_0_1': 0.8424, 'acc_1_0': 0.0714, 'acc_1_1': 0.3226, 'mean_acc': 0.8325}
Val(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7017}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3481, 'acc_0_0': 0.9845, 'acc_0_1': 0.3481, 'acc_1_0': 0.4408, 'acc_1_1': 0.9595, 'mean_acc': 0.6738}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3315, 'acc_0_0': 0.9826, 'acc_0_1': 0.3315, 'acc_1_0': 0.4643, 'acc_1_1': 0.9612, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.515, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7517}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.4745, 'acc_0_0': 0.9902, 'acc_0_1': 0.4745, 'acc_1_0': 0.4875, 'acc_1_1': 0.947, 'mean_acc': 0.729}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9977, 'acc_0_1': 0.7283, 'acc_1_0': 0.3214, 'acc_1_1': 0.9026, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5202, 'acc_0_0': 0.9849, 'acc_0_1': 0.5202, 'acc_1_0': 0.6449, 'acc_1_1': 0.9486, 'mean_acc': 0.7623}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5435, 'acc_0_0': 0.9746, 'acc_0_1': 0.5435, 'acc_1_0': 0.6964, 'acc_1_1': 0.965, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.4776, 'acc_0_0': 0.9915, 'acc_0_1': 0.824, 'acc_1_0': 0.4776, 'acc_1_1': 0.8636, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.5421, 'acc_0_0': 0.9929, 'acc_0_1': 0.8381, 'acc_1_0': 0.5421, 'acc_1_1': 0.8567, 'mean_acc': 0.8676}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7554, 'acc_1_0': 0.625, 'acc_1_1': 0.9319, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5389, 'acc_0_0': 0.9925, 'acc_0_1': 0.6457, 'acc_1_0': 0.5389, 'acc_1_1': 0.9377, 'mean_acc': 0.8012}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9903, 'acc_0_1': 0.5109, 'acc_1_0': 0.7143, 'acc_1_1': 0.9763, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.77}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4851, 'acc_0_0': 0.9898, 'acc_0_1': 0.4851, 'acc_1_0': 0.5748, 'acc_1_1': 0.9595, 'mean_acc': 0.744}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.996, 'acc_0_1': 0.6304, 'acc_1_0': 0.5179, 'acc_1_1': 0.965, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.4989, 'acc_0_0': 0.988, 'acc_0_1': 0.4989, 'acc_1_0': 0.5857, 'acc_1_1': 0.9564, 'mean_acc': 0.7496}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5815, 'acc_0_0': 0.99, 'acc_0_1': 0.5815, 'acc_1_0': 0.625, 'acc_1_1': 0.9782, 'mean_acc': 0.9675}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5408, 'acc_0_0': 0.9915, 'acc_0_1': 0.5408, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.4989, 'acc_0_0': 0.9836, 'acc_0_1': 0.4989, 'acc_1_0': 0.6776, 'acc_1_1': 0.9611, 'mean_acc': 0.7585}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.994, 'acc_0_1': 0.6848, 'acc_1_0': 0.75, 'acc_1_1': 0.964, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6922, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8255}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9723}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6609, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6173, 'acc_0_0': 0.9863, 'acc_0_1': 0.6173, 'acc_1_0': 0.6558, 'acc_1_1': 0.9502, 'mean_acc': 0.802}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9909, 'acc_0_1': 0.6902, 'acc_1_0': 0.75, 'acc_1_1': 0.9735, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5607, 'acc_0_0': 0.9916, 'acc_0_1': 0.7144, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8291}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.7143, 'acc_1_1': 0.964, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.567, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.567, 'acc_1_1': 0.9346, 'mean_acc': 0.824}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9946, 'acc_0_1': 0.7065, 'acc_1_0': 0.7857, 'acc_1_1': 0.9801, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5576, 'acc_0_0': 0.9925, 'acc_0_1': 0.7561, 'acc_1_0': 0.5576, 'acc_1_1': 0.9268, 'mean_acc': 0.845}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9966, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.7557, 'acc_1_0': 0.5794, 'acc_1_1': 0.9315, 'mean_acc': 0.8479}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8043, 'acc_0_0': 0.9954, 'acc_0_1': 0.8043, 'acc_1_0': 0.8393, 'acc_1_1': 0.9716, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7525, 'acc_1_0': 0.5841, 'acc_1_1': 0.9299, 'mean_acc': 0.8469}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9971, 'acc_0_1': 0.8967, 'acc_1_0': 0.7143, 'acc_1_1': 0.9565, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.9808, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.6581, 'acc_1_0': 0.5545, 'acc_1_1': 0.9455, 'mean_acc': 0.8089}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6739, 'acc_0_0': 0.9954, 'acc_0_1': 0.6739, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6184, 'acc_0_0': 0.9885, 'acc_0_1': 0.7348, 'acc_1_0': 0.6184, 'acc_1_1': 0.9237, 'mean_acc': 0.8416}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.7419, 'acc_1_0': 0.5312, 'acc_1_1': 0.9252, 'mean_acc': 0.8369}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9977, 'acc_0_1': 0.837, 'acc_1_0': 0.8929, 'acc_1_1': 0.9905, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.6953, 'acc_0_0': 0.9829, 'acc_0_1': 0.6953, 'acc_1_0': 0.7015, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6604, 'acc_0_0': 0.9885, 'acc_0_1': 0.6931, 'acc_1_0': 0.6604, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5903, 'acc_0_0': 0.9916, 'acc_0_1': 0.6807, 'acc_1_0': 0.5903, 'acc_1_1': 0.9424, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8859, 'acc_0_0': 0.9989, 'acc_0_1': 0.8859, 'acc_1_0': 0.9107, 'acc_1_1': 0.9905, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8297, 'acc_1_0': 0.5779, 'acc_1_1': 0.9065, 'mean_acc': 0.8735}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8929, 'acc_1_1': 0.9839, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.6309, 'acc_0_0': 0.9829, 'acc_0_1': 0.6309, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5997, 'acc_0_0': 0.9911, 'acc_0_1': 0.6106, 'acc_1_0': 0.5997, 'acc_1_1': 0.9564, 'mean_acc': 0.7958}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.8283, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.8355, 'acc_1_0': 0.6168, 'acc_1_1': 0.8972, 'mean_acc': 0.8781}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4564, 'acc_0_0': 0.9973, 'acc_0_1': 0.7246, 'acc_1_0': 0.4564, 'acc_1_1': 0.9252, 'mean_acc': 0.8233}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.5672, 'acc_0_0': 0.9829, 'acc_0_1': 0.8369, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5343, 'acc_0_0': 0.9929, 'acc_0_1': 0.8373, 'acc_1_0': 0.5343, 'acc_1_1': 0.8988, 'mean_acc': 0.8711}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9986, 'acc_0_1': 0.9728, 'acc_1_0': 1.0, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.618, 'acc_0_0': 0.9744, 'acc_0_1': 0.618, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.596, 'acc_0_0': 0.9854, 'acc_0_1': 0.596, 'acc_1_0': 0.6293, 'acc_1_1': 0.9533, 'mean_acc': 0.7908}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9107, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7768, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5545, 'acc_0_0': 0.9929, 'acc_0_1': 0.7694, 'acc_1_0': 0.5545, 'acc_1_1': 0.9268, 'mean_acc': 0.85}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5821, 'acc_0_0': 0.9658, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6106, 'acc_0_0': 0.984, 'acc_0_1': 0.6945, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9953, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.9876, 'acc_0_1': 0.6732, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8198}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.609, 'acc_1_1': 0.9455, 'mean_acc': 0.8202}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.6266, 'acc_0_0': 0.9274, 'acc_0_1': 0.6266, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.6093, 'acc_0_0': 0.9392, 'acc_0_1': 0.6093, 'acc_1_0': 0.7928, 'acc_1_1': 0.9595, 'mean_acc': 0.7969}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9991, 'acc_0_1': 0.8804, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6119, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6231, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6231, 'acc_1_1': 0.9299, 'mean_acc': 0.8371}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9837, 'acc_1_0': 0.9464, 'acc_1_1': 0.983, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.472, 'acc_0_0': 0.9938, 'acc_0_1': 0.745, 'acc_1_0': 0.472, 'acc_1_1': 0.9174, 'mean_acc': 0.8307}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9989, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9962, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.8026, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.6293, 'acc_0_0': 0.9805, 'acc_0_1': 0.8009, 'acc_1_0': 0.6293, 'acc_1_1': 0.8925, 'mean_acc': 0.8619}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9293, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6567, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6231, 'acc_0_0': 0.9889, 'acc_0_1': 0.714, 'acc_1_0': 0.6231, 'acc_1_1': 0.933, 'mean_acc': 0.8352}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5075, 'acc_1_1': 0.8939, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5016, 'acc_0_0': 0.9956, 'acc_0_1': 0.8483, 'acc_1_0': 0.5016, 'acc_1_1': 0.8785, 'mean_acc': 0.8706}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9713, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8197, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5421, 'acc_0_0': 0.9894, 'acc_0_1': 0.8084, 'acc_1_0': 0.5421, 'acc_1_1': 0.9003, 'mean_acc': 0.8595}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 0.9997, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.5522, 'acc_0_0': 0.9786, 'acc_0_1': 0.6695, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.553, 'acc_0_0': 0.988, 'acc_0_1': 0.639, 'acc_1_0': 0.553, 'acc_1_1': 0.9424, 'mean_acc': 0.7989}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9356, 'acc_0_1': 0.8498, 'acc_1_0': 0.5758, 'acc_1_1': 0.806, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.737, 'worst_acc': 0.0758, 'acc_0_0': 0.9231, 'acc_0_1': 0.9871, 'acc_1_0': 0.7761, 'acc_1_1': 0.0758, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.7462, 'worst_acc': 0.0981, 'acc_0_0': 0.929, 'acc_0_1': 0.9911, 'acc_1_0': 0.7523, 'acc_1_1': 0.0981, 'mean_acc': 0.8416}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4091, 'acc_0_0': 0.8712, 'acc_0_1': 0.691, 'acc_1_0': 0.4091, 'acc_1_1': 0.7164, 'mean_acc': 0.7329}
Val(class)(new adapter): {'weighted_mean_acc': 0.9398, 'worst_acc': 0.3219, 'acc_0_0': 0.9573, 'acc_0_1': 0.3219, 'acc_1_0': 0.7463, 'acc_1_1': 1.0, 'mean_acc': 0.6917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.3255, 'acc_0_0': 0.9756, 'acc_0_1': 0.3255, 'acc_1_0': 0.7368, 'acc_1_1': 0.9813, 'mean_acc': 0.6968}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5606, 'acc_0_0': 0.9914, 'acc_0_1': 0.8197, 'acc_1_0': 0.5606, 'acc_1_1': 0.9104, 'mean_acc': 0.8681}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7576, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.7576, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8889, 'worst_acc': 0.6277, 'acc_0_0': 0.9663, 'acc_0_1': 0.9525, 'acc_1_0': 0.7773, 'acc_1_1': 0.6277, 'mean_acc': 0.9025}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2537, 'acc_0_0': 0.8498, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.2537, 'mean_acc': 0.813}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7511, 'acc_0_0': 0.9274, 'acc_0_1': 0.7511, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7814, 'acc_0_0': 0.9215, 'acc_0_1': 0.7814, 'acc_1_0': 0.8551, 'acc_1_1': 0.9268, 'mean_acc': 0.8602}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9399, 'acc_0_1': 0.9356, 'acc_1_0': 0.7727, 'acc_1_1': 0.8806, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.8209, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.9267}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7508, 'acc_0_0': 0.9721, 'acc_0_1': 0.9747, 'acc_1_0': 0.7788, 'acc_1_1': 0.7508, 'mean_acc': 0.9272}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.8841, 'acc_0_1': 0.927, 'acc_1_0': 0.6818, 'acc_1_1': 0.6567, 'mean_acc': 0.8531}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.691, 'acc_0_0': 0.9188, 'acc_0_1': 0.691, 'acc_1_0': 0.8657, 'acc_1_1': 0.9848, 'mean_acc': 0.8317}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.6829, 'acc_0_0': 0.9308, 'acc_0_1': 0.6829, 'acc_1_0': 0.852, 'acc_1_1': 0.9486, 'mean_acc': 0.8276}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.97, 'acc_0_1': 0.9399, 'acc_1_0': 0.7727, 'acc_1_1': 0.9104, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.697, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8922, 'worst_acc': 0.5997, 'acc_0_0': 0.9796, 'acc_0_1': 0.9698, 'acc_1_0': 0.7025, 'acc_1_1': 0.5997, 'mean_acc': 0.903}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4478, 'acc_0_0': 0.9013, 'acc_0_1': 0.9313, 'acc_1_0': 0.7576, 'acc_1_1': 0.4478, 'mean_acc': 0.8464}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7639, 'acc_0_0': 0.9316, 'acc_0_1': 0.7639, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7907, 'acc_0_0': 0.9299, 'acc_0_1': 0.7907, 'acc_1_0': 0.8474, 'acc_1_1': 0.9299, 'mean_acc': 0.8666}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9828, 'acc_0_1': 0.9442, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.8994, 'worst_acc': 0.7576, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.8657, 'acc_1_1': 0.7576, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8813, 'worst_acc': 0.6604, 'acc_0_0': 0.9446, 'acc_0_1': 0.9654, 'acc_1_0': 0.824, 'acc_1_1': 0.6604, 'mean_acc': 0.9078}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9657, 'acc_0_1': 0.9399, 'acc_1_0': 0.8333, 'acc_1_1': 0.806, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.8369, 'acc_0_0': 0.8803, 'acc_0_1': 0.8369, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.852, 'acc_0_0': 0.8953, 'acc_0_1': 0.8687, 'acc_1_0': 0.852, 'acc_1_1': 0.8816, 'mean_acc': 0.8787}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9614, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.6866, 'acc_1_1': 0.7424, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.6386, 'acc_0_0': 0.9756, 'acc_0_1': 0.9809, 'acc_1_0': 0.6854, 'acc_1_1': 0.6386, 'mean_acc': 0.9082}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9742, 'acc_0_1': 0.9785, 'acc_1_0': 0.9242, 'acc_1_1': 0.9254, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.597, 'acc_0_0': 0.9744, 'acc_0_1': 0.9785, 'acc_1_0': 0.597, 'acc_1_1': 0.6818, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8844, 'worst_acc': 0.5296, 'acc_0_0': 0.9907, 'acc_0_1': 0.9898, 'acc_1_0': 0.5966, 'acc_1_1': 0.5296, 'mean_acc': 0.8956}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.932, 'worst_acc': 0.7164, 'acc_0_0': 0.9573, 'acc_0_1': 0.9099, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.771, 'acc_0_0': 0.9663, 'acc_0_1': 0.9304, 'acc_1_0': 0.7773, 'acc_1_1': 0.771, 'mean_acc': 0.9097}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9657, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7015, 'acc_0_0': 0.9615, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.7121, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.6402, 'acc_0_0': 0.9721, 'acc_0_1': 0.9517, 'acc_1_0': 0.7134, 'acc_1_1': 0.6402, 'mean_acc': 0.8987}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.8333, 'acc_0_0': 0.9308, 'acc_0_1': 0.8891, 'acc_1_0': 0.8333, 'acc_1_1': 0.8396, 'mean_acc': 0.8937}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9742, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.796, 'acc_0_0': 0.9534, 'acc_0_1': 0.8896, 'acc_1_0': 0.796, 'acc_1_1': 0.852, 'mean_acc': 0.8999}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7056, 'acc_0_0': 0.9703, 'acc_0_1': 0.9561, 'acc_1_0': 0.7056, 'acc_1_1': 0.7212, 'mean_acc': 0.9078}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8524, 'worst_acc': 0.4545, 'acc_0_0': 0.9701, 'acc_0_1': 0.9828, 'acc_1_0': 0.5821, 'acc_1_1': 0.4545, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8606, 'worst_acc': 0.4283, 'acc_0_0': 0.9889, 'acc_0_1': 0.9898, 'acc_1_0': 0.5779, 'acc_1_1': 0.4283, 'mean_acc': 0.8816}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8294, 'worst_acc': 0.3939, 'acc_0_0': 0.9573, 'acc_0_1': 0.9742, 'acc_1_0': 0.5821, 'acc_1_1': 0.3939, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8399, 'worst_acc': 0.3567, 'acc_0_0': 0.9818, 'acc_0_1': 0.9854, 'acc_1_0': 0.6137, 'acc_1_1': 0.3567, 'mean_acc': 0.8731}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9485, 'acc_0_1': 0.9399, 'acc_1_0': 0.8788, 'acc_1_1': 0.8507, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9472, 'worst_acc': 0.6418, 'acc_0_0': 0.9701, 'acc_0_1': 0.9099, 'acc_1_0': 0.6418, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9503, 'worst_acc': 0.6511, 'acc_0_0': 0.988, 'acc_0_1': 0.8891, 'acc_1_0': 0.6511, 'acc_1_1': 0.852, 'mean_acc': 0.8971}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.8788, 'acc_1_1': 0.9104, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.8825, 'worst_acc': 0.8209, 'acc_0_0': 0.8803, 'acc_0_1': 0.8755, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8886, 'worst_acc': 0.8427, 'acc_0_0': 0.8914, 'acc_0_1': 0.8812, 'acc_1_0': 0.8427, 'acc_1_1': 0.8832, 'mean_acc': 0.8811}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9485, 'acc_0_1': 0.9571, 'acc_1_0': 0.8788, 'acc_1_1': 0.8209, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7167, 'acc_0_0': 0.9188, 'acc_0_1': 0.7167, 'acc_1_0': 0.7463, 'acc_1_1': 0.9848, 'mean_acc': 0.8283}
Test(class)(new adapter): {'weighted_mean_acc': 0.9375, 'worst_acc': 0.7126, 'acc_0_0': 0.9508, 'acc_0_1': 0.7126, 'acc_1_0': 0.7555, 'acc_1_1': 0.9424, 'mean_acc': 0.8355}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9914, 'acc_0_1': 0.97, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8615, 'worst_acc': 0.5909, 'acc_0_0': 0.9402, 'acc_0_1': 0.97, 'acc_1_0': 0.7015, 'acc_1_1': 0.5909, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8625, 'worst_acc': 0.5047, 'acc_0_0': 0.9663, 'acc_0_1': 0.9898, 'acc_1_0': 0.7165, 'acc_1_1': 0.5047, 'mean_acc': 0.8966}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9313, 'acc_0_1': 0.9485, 'acc_1_0': 0.8333, 'acc_1_1': 0.9104, 'mean_acc': 0.9249}
Val(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.8455, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7508, 'acc_0_0': 0.9539, 'acc_0_1': 0.8705, 'acc_1_0': 0.7508, 'acc_1_1': 0.8583, 'mean_acc': 0.8883}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8806, 'worst_acc': 0.6866, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.6866, 'acc_1_1': 0.7273, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.875, 'worst_acc': 0.6293, 'acc_0_0': 0.9468, 'acc_0_1': 0.9557, 'acc_1_0': 0.7679, 'acc_1_1': 0.6293, 'mean_acc': 0.8952}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9614, 'acc_0_1': 0.9828, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9359, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9291, 'worst_acc': 0.7523, 'acc_0_0': 0.9783, 'acc_0_1': 0.9104, 'acc_1_0': 0.7523, 'acc_1_1': 0.7788, 'mean_acc': 0.9047}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7768, 'acc_0_0': 0.9231, 'acc_0_1': 0.7768, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7987, 'acc_0_0': 0.9295, 'acc_0_1': 0.7987, 'acc_1_0': 0.8193, 'acc_1_1': 0.866, 'mean_acc': 0.8593}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9485, 'acc_0_1': 0.927, 'acc_1_0': 0.9091, 'acc_1_1': 0.8209, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9391, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.7523, 'acc_0_0': 0.98, 'acc_0_1': 0.8918, 'acc_1_0': 0.7523, 'acc_1_1': 0.8598, 'mean_acc': 0.9071}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.803, 'acc_1_1': 0.9552, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7664, 'acc_0_0': 0.9703, 'acc_0_1': 0.9632, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9225}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9403, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.5579, 'acc_0_0': 0.9017, 'acc_0_1': 0.5579, 'acc_1_0': 0.7761, 'acc_1_1': 1.0, 'mean_acc': 0.765}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.5534, 'acc_0_0': 0.9118, 'acc_0_1': 0.5534, 'acc_1_0': 0.8193, 'acc_1_1': 0.9673, 'mean_acc': 0.7682}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8358, 'acc_0_0': 1.0, 'acc_0_1': 0.9313, 'acc_1_0': 0.9394, 'acc_1_1': 0.8358, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.8809, 'worst_acc': 0.6212, 'acc_0_0': 0.9573, 'acc_0_1': 0.9742, 'acc_1_0': 0.7015, 'acc_1_1': 0.6212, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8856, 'worst_acc': 0.581, 'acc_0_0': 0.9752, 'acc_0_1': 0.9778, 'acc_1_0': 0.7383, 'acc_1_1': 0.581, 'mean_acc': 0.9063}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.897, 'acc_0_1': 0.8798, 'acc_1_0': 0.8485, 'acc_1_1': 0.9403, 'mean_acc': 0.8898}
Val(class)(new adapter): {'weighted_mean_acc': 0.9402, 'worst_acc': 0.6524, 'acc_0_0': 0.9444, 'acc_0_1': 0.6524, 'acc_1_0': 0.7761, 'acc_1_1': 0.9848, 'mean_acc': 0.8167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9453, 'worst_acc': 0.6408, 'acc_0_0': 0.9623, 'acc_0_1': 0.6408, 'acc_1_0': 0.796, 'acc_1_1': 0.9502, 'mean_acc': 0.8174}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 0.9399, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.6418, 'acc_0_0': 0.9701, 'acc_0_1': 0.9785, 'acc_1_0': 0.6418, 'acc_1_1': 0.697, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8928, 'worst_acc': 0.5717, 'acc_0_0': 0.9894, 'acc_0_1': 0.9809, 'acc_1_0': 0.6308, 'acc_1_1': 0.5717, 'mean_acc': 0.9001}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7015, 'acc_0_0': 0.9657, 'acc_0_1': 0.9571, 'acc_1_0': 0.8788, 'acc_1_1': 0.7015, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.882, 'worst_acc': 0.8209, 'acc_0_0': 0.8632, 'acc_0_1': 0.8412, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8922, 'worst_acc': 0.8559, 'acc_0_0': 0.8945, 'acc_0_1': 0.8559, 'acc_1_0': 0.8629, 'acc_1_1': 0.8925, 'mean_acc': 0.8757}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 0.9742, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.867, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7804, 'acc_0_0': 0.9521, 'acc_0_1': 0.8674, 'acc_1_0': 0.7804, 'acc_1_1': 0.8769, 'mean_acc': 0.8918}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9352, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9384, 'worst_acc': 0.7508, 'acc_0_0': 0.9712, 'acc_0_1': 0.9047, 'acc_1_0': 0.7508, 'acc_1_1': 0.8458, 'mean_acc': 0.907}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9363, 'worst_acc': 0.7679, 'acc_0_0': 0.9681, 'acc_0_1': 0.9042, 'acc_1_0': 0.7679, 'acc_1_1': 0.8458, 'mean_acc': 0.9075}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9914, 'acc_0_1': 0.9828, 'acc_1_0': 0.9242, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9397, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7741, 'acc_0_0': 0.9641, 'acc_0_1': 0.9055, 'acc_1_0': 0.7741, 'acc_1_1': 0.8442, 'mean_acc': 0.907}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.7866, 'acc_0_0': 0.9588, 'acc_0_1': 0.9073, 'acc_1_0': 0.7866, 'acc_1_1': 0.8442, 'mean_acc': 0.907}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.8006, 'acc_0_0': 0.9539, 'acc_0_1': 0.902, 'acc_1_0': 0.8006, 'acc_1_1': 0.8505, 'mean_acc': 0.9052}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9285, 'worst_acc': 0.7913, 'acc_0_0': 0.9579, 'acc_0_1': 0.9055, 'acc_1_0': 0.7913, 'acc_1_1': 0.8427, 'mean_acc': 0.9063}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.7866, 'acc_0_0': 0.9579, 'acc_0_1': 0.9078, 'acc_1_0': 0.7866, 'acc_1_1': 0.8396, 'mean_acc': 0.9063}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7679, 'acc_0_0': 0.961, 'acc_0_1': 0.9197, 'acc_1_0': 0.7679, 'acc_1_1': 0.8255, 'mean_acc': 0.9085}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7928, 'acc_0_0': 0.9561, 'acc_0_1': 0.9113, 'acc_1_0': 0.7928, 'acc_1_1': 0.8396, 'mean_acc': 0.9077}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.8037, 'acc_0_0': 0.9517, 'acc_0_1': 0.9016, 'acc_1_0': 0.8037, 'acc_1_1': 0.8489, 'mean_acc': 0.9044}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7975, 'acc_0_0': 0.9543, 'acc_0_1': 0.9086, 'acc_1_0': 0.7975, 'acc_1_1': 0.8364, 'mean_acc': 0.9061}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7975, 'acc_0_0': 0.953, 'acc_0_1': 0.91, 'acc_1_0': 0.7975, 'acc_1_1': 0.8333, 'mean_acc': 0.9058}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7928, 'acc_0_0': 0.9557, 'acc_0_1': 0.9135, 'acc_1_0': 0.7928, 'acc_1_1': 0.8287, 'mean_acc': 0.9071}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.796, 'acc_0_0': 0.9552, 'acc_0_1': 0.9144, 'acc_1_0': 0.796, 'acc_1_1': 0.8255, 'mean_acc': 0.9073}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.785, 'acc_0_0': 0.957, 'acc_0_1': 0.9211, 'acc_1_0': 0.785, 'acc_1_1': 0.824, 'mean_acc': 0.9092}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7897, 'acc_0_0': 0.9561, 'acc_0_1': 0.918, 'acc_1_0': 0.7897, 'acc_1_1': 0.8255, 'mean_acc': 0.9084}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7991, 'acc_0_0': 0.9517, 'acc_0_1': 0.9126, 'acc_1_0': 0.7991, 'acc_1_1': 0.8271, 'mean_acc': 0.9058}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7819, 'acc_0_0': 0.957, 'acc_0_1': 0.9202, 'acc_1_0': 0.7819, 'acc_1_1': 0.8224, 'mean_acc': 0.9084}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9301, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7741, 'acc_0_0': 0.9605, 'acc_0_1': 0.9264, 'acc_1_0': 0.7741, 'acc_1_1': 0.81, 'mean_acc': 0.9099}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7882, 'acc_0_0': 0.9557, 'acc_0_1': 0.9153, 'acc_1_0': 0.7882, 'acc_1_1': 0.8287, 'mean_acc': 0.9073}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.785, 'acc_0_0': 0.957, 'acc_0_1': 0.918, 'acc_1_0': 0.785, 'acc_1_1': 0.8255, 'mean_acc': 0.9082}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7866, 'acc_0_0': 0.957, 'acc_0_1': 0.9149, 'acc_1_0': 0.7866, 'acc_1_1': 0.8271, 'mean_acc': 0.9073}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.785, 'acc_0_0': 0.957, 'acc_0_1': 0.9228, 'acc_1_0': 0.785, 'acc_1_1': 0.8162, 'mean_acc': 0.909}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7866, 'acc_0_0': 0.9565, 'acc_0_1': 0.9162, 'acc_1_0': 0.7866, 'acc_1_1': 0.8255, 'mean_acc': 0.9075}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7882, 'acc_0_0': 0.9552, 'acc_0_1': 0.918, 'acc_1_0': 0.7882, 'acc_1_1': 0.8224, 'mean_acc': 0.9075}
========================================================================
> end of training. 

best epoch : 50
best training accuracy on [class]: {'worst_acc': 0.806, 'acc_0_0': 0.9657, 'acc_0_1': 0.9399, 'acc_1_0': 0.8333, 'acc_1_1': 0.806, 'mean_acc': 0.9232}
best validation accuracy on [class]: {'weighted_mean_acc': 0.895, 'worst_acc': 0.8369, 'acc_0_0': 0.8803, 'acc_0_1': 0.8369, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8717}
best test accuracy on [class]: {'weighted_mean_acc': 0.8908, 'worst_acc': 0.852, 'acc_0_0': 0.8953, 'acc_0_1': 0.8687, 'acc_1_0': 0.852, 'acc_1_1': 0.8816, 'mean_acc': 0.8787}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.852, 'acc_0_0': 0.8953, 'acc_0_1': 0.8687, 'acc_1_0': 0.852, 'acc_1_1': 0.8816, 'mean_acc': 0.8787}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.4517, 'acc_0_0': 0.9397, 'acc_0_1': 0.8789, 'acc_1_0': 0.4517, 'acc_1_1': 0.9922, 'mean_acc': 0.8678}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 50': {'Train': {'worst_acc': 0.806, 'acc_0_0': 0.9657, 'acc_0_1': 0.9399, 'acc_1_0': 0.8333, 'acc_1_1': 0.806, 'mean_acc': 0.9232}, 'Val': {'weighted_mean_acc': 0.895, 'worst_acc': 0.8369, 'acc_0_0': 0.8803, 'acc_0_1': 0.8369, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8717}, 'Test': {'weighted_mean_acc': 0.8908, 'worst_acc': 0.852, 'acc_0_0': 0.8953, 'acc_0_1': 0.8687, 'acc_1_0': 0.852, 'acc_1_1': 0.8816, 'mean_acc': 0.8787}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8908, 'worst_acc': 0.852, 'acc_0_0': 0.8953, 'acc_0_1': 0.8687, 'acc_1_0': 0.852, 'acc_1_1': 0.8816, 'mean_acc': 0.8787}, 'spurious': {'weighted_mean_acc': 0.9432, 'worst_acc': 0.4517, 'acc_0_0': 0.9397, 'acc_0_1': 0.8789, 'acc_1_0': 0.4517, 'acc_1_1': 0.9922, 'mean_acc': 0.8678}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0893, 'acc_0_0': 0.9182, 'acc_0_1': 0.8098, 'acc_1_0': 0.0893, 'acc_1_1': 0.211, 'mean_acc': 0.7485}
Val(class): {'weighted_mean_acc': 0.932, 'worst_acc': 0.1545, 'acc_0_0': 0.9615, 'acc_0_1': 0.1545, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.615}
Test(class): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.1397, 'acc_0_0': 0.9659, 'acc_0_1': 0.1397, 'acc_1_0': 0.6573, 'acc_1_1': 0.9766, 'mean_acc': 0.6113}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9917, 'acc_0_1': 0.4185, 'acc_1_0': 0.3393, 'acc_1_1': 0.8694, 'mean_acc': 0.9351}
Val(class): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.103, 'acc_0_0': 0.9188, 'acc_0_1': 0.103, 'acc_1_0': 0.6418, 'acc_1_1': 1.0, 'mean_acc': 0.58}
Test(class): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.0847, 'acc_0_0': 0.9308, 'acc_0_1': 0.0847, 'acc_1_0': 0.7227, 'acc_1_1': 0.986, 'mean_acc': 0.5846}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.2143, 'acc_0_0': 0.998, 'acc_0_1': 0.6033, 'acc_1_0': 0.2143, 'acc_1_1': 0.8288, 'mean_acc': 0.9364}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.2017, 'acc_0_0': 0.9829, 'acc_0_1': 0.2017, 'acc_1_0': 0.6119, 'acc_1_1': 1.0, 'mean_acc': 0.64}
Test(class): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.1703, 'acc_0_0': 0.9783, 'acc_0_1': 0.1703, 'acc_1_0': 0.5935, 'acc_1_1': 0.9688, 'mean_acc': 0.6201}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9971, 'acc_0_1': 0.5272, 'acc_1_0': 0.3214, 'acc_1_1': 0.9167, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.3348, 'acc_0_0': 1.0, 'acc_0_1': 0.3348, 'acc_1_0': 0.5373, 'acc_1_1': 0.9848, 'mean_acc': 0.6883}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.2812, 'acc_0_0': 0.9863, 'acc_0_1': 0.2812, 'acc_1_0': 0.5234, 'acc_1_1': 0.9673, 'mean_acc': 0.6584}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9954, 'acc_0_1': 0.4728, 'acc_1_0': 0.3393, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4506, 'acc_0_0': 1.0, 'acc_0_1': 0.4506, 'acc_1_0': 0.4776, 'acc_1_1': 0.9848, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.3969, 'acc_0_0': 0.9885, 'acc_0_1': 0.3969, 'acc_1_0': 0.4984, 'acc_1_1': 0.9595, 'mean_acc': 0.7007}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9937, 'acc_0_1': 0.4728, 'acc_1_0': 0.4464, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.5322, 'acc_1_0': 0.4627, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.4807, 'acc_0_0': 0.9902, 'acc_0_1': 0.4807, 'acc_1_0': 0.4891, 'acc_1_1': 0.9502, 'mean_acc': 0.732}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.9937, 'acc_0_1': 0.5217, 'acc_1_0': 0.5179, 'acc_1_1': 0.9508, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.4478, 'acc_0_0': 1.0, 'acc_0_1': 0.6052, 'acc_1_0': 0.4478, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4688, 'acc_0_0': 0.9911, 'acc_0_1': 0.5579, 'acc_1_0': 0.4688, 'acc_1_1': 0.9455, 'mean_acc': 0.7596}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9943, 'acc_0_1': 0.5924, 'acc_1_0': 0.4821, 'acc_1_1': 0.948, 'mean_acc': 0.9627}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4179, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.4179, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.4579, 'acc_0_0': 0.9933, 'acc_0_1': 0.6257, 'acc_1_0': 0.4579, 'acc_1_1': 0.9346, 'mean_acc': 0.7844}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9946, 'acc_0_1': 0.6522, 'acc_1_0': 0.4464, 'acc_1_1': 0.9404, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4439, 'acc_0_0': 0.9947, 'acc_0_1': 0.6825, 'acc_1_0': 0.4439, 'acc_1_1': 0.9283, 'mean_acc': 0.8048}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9954, 'acc_0_1': 0.6957, 'acc_1_0': 0.5, 'acc_1_1': 0.9347, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.4424, 'acc_0_0': 0.9956, 'acc_0_1': 0.7055, 'acc_1_0': 0.4424, 'acc_1_1': 0.919, 'mean_acc': 0.8129}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.4821, 'acc_1_1': 0.9357, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9736, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.4595, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.4595, 'acc_1_1': 0.9221, 'mean_acc': 0.8139}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.994, 'acc_0_1': 0.712, 'acc_1_0': 0.5536, 'acc_1_1': 0.9442, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.4627, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.486, 'acc_0_0': 0.9933, 'acc_0_1': 0.6914, 'acc_1_0': 0.486, 'acc_1_1': 0.9252, 'mean_acc': 0.812}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.5893, 'acc_1_1': 0.948, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5031, 'acc_0_0': 0.9929, 'acc_0_1': 0.6803, 'acc_1_0': 0.5031, 'acc_1_1': 0.9283, 'mean_acc': 0.8098}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9499, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5093, 'acc_0_0': 0.9925, 'acc_0_1': 0.6785, 'acc_1_0': 0.5093, 'acc_1_1': 0.9315, 'mean_acc': 0.81}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9931, 'acc_0_1': 0.6848, 'acc_1_0': 0.5714, 'acc_1_1': 0.9518, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9743, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5156, 'acc_0_0': 0.9929, 'acc_0_1': 0.6807, 'acc_1_0': 0.5156, 'acc_1_1': 0.9315, 'mean_acc': 0.8117}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9923, 'acc_0_1': 0.7174, 'acc_1_0': 0.625, 'acc_1_1': 0.9451, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9748, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5031, 'acc_0_0': 0.9933, 'acc_0_1': 0.6949, 'acc_1_0': 0.5031, 'acc_1_1': 0.9237, 'mean_acc': 0.8152}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6607, 'acc_1_1': 0.9451, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5062, 'acc_0_0': 0.992, 'acc_0_1': 0.6971, 'acc_1_0': 0.5062, 'acc_1_1': 0.9252, 'mean_acc': 0.816}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9929, 'acc_0_1': 0.7391, 'acc_1_0': 0.6429, 'acc_1_1': 0.9451, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9753, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.4925, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.5109, 'acc_0_0': 0.9929, 'acc_0_1': 0.7073, 'acc_1_0': 0.5109, 'acc_1_1': 0.9206, 'mean_acc': 0.8203}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9461, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.702, 'acc_1_0': 0.5327, 'acc_1_1': 0.9221, 'mean_acc': 0.8203}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7446, 'acc_1_0': 0.6607, 'acc_1_1': 0.947, 'mean_acc': 0.9689}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5436, 'acc_0_0': 0.9907, 'acc_0_1': 0.7078, 'acc_1_0': 0.5436, 'acc_1_1': 0.9221, 'mean_acc': 0.8234}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.75, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.5514, 'acc_0_0': 0.9898, 'acc_0_1': 0.6891, 'acc_1_0': 0.5514, 'acc_1_1': 0.9268, 'mean_acc': 0.8172}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9536, 'mean_acc': 0.9718}
Val(class): {'weighted_mean_acc': 0.9754, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.6936, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.82}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.788, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5872, 'acc_0_0': 0.9889, 'acc_0_1': 0.6763, 'acc_1_0': 0.5872, 'acc_1_1': 0.933, 'mean_acc': 0.8165}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9751, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6687, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8152}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9931, 'acc_0_1': 0.8098, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6028, 'acc_0_0': 0.9871, 'acc_0_1': 0.6825, 'acc_1_0': 0.6028, 'acc_1_1': 0.9315, 'mean_acc': 0.8198}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.994, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6246, 'acc_0_0': 0.9863, 'acc_0_1': 0.6585, 'acc_1_0': 0.6246, 'acc_1_1': 0.9393, 'mean_acc': 0.8134}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.994, 'acc_0_1': 0.8043, 'acc_1_0': 0.7857, 'acc_1_1': 0.9688, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6153, 'acc_0_0': 0.9867, 'acc_0_1': 0.6785, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8196}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.6964, 'acc_1_1': 0.9593, 'mean_acc': 0.9783}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5919, 'acc_0_0': 0.9898, 'acc_0_1': 0.7273, 'acc_1_0': 0.5919, 'acc_1_1': 0.9237, 'mean_acc': 0.8362}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.975, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.6059, 'acc_1_1': 0.9361, 'mean_acc': 0.8169}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9949, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9811, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.6199, 'acc_0_0': 0.9863, 'acc_0_1': 0.6789, 'acc_1_0': 0.6199, 'acc_1_1': 0.9346, 'mean_acc': 0.8203}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9699, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6199, 'acc_0_0': 0.9867, 'acc_0_1': 0.7042, 'acc_1_0': 0.6199, 'acc_1_1': 0.9268, 'mean_acc': 0.8295}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.837, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6121, 'acc_0_0': 0.988, 'acc_0_1': 0.6931, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.8255}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9969, 'acc_0_1': 0.8641, 'acc_1_0': 0.8393, 'acc_1_1': 0.9801, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6153, 'acc_0_0': 0.9871, 'acc_0_1': 0.7251, 'acc_1_0': 0.6153, 'acc_1_1': 0.9268, 'mean_acc': 0.8372}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.998, 'acc_0_1': 0.913, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9864}
Val(class): {'weighted_mean_acc': 0.973, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6168, 'acc_0_0': 0.9871, 'acc_0_1': 0.7033, 'acc_1_0': 0.6168, 'acc_1_1': 0.9315, 'mean_acc': 0.8295}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.8214, 'acc_1_1': 0.9839, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.6695, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6271, 'acc_0_0': 0.9827, 'acc_0_1': 0.6271, 'acc_1_0': 0.6558, 'acc_1_1': 0.9455, 'mean_acc': 0.8039}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9969, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.983, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6309, 'acc_0_0': 0.9786, 'acc_0_1': 0.6309, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.6004, 'acc_0_0': 0.9796, 'acc_0_1': 0.6004, 'acc_1_0': 0.6822, 'acc_1_1': 0.9439, 'mean_acc': 0.7951}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.8913, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6402, 'acc_0_0': 0.9854, 'acc_0_1': 0.6576, 'acc_1_0': 0.6402, 'acc_1_1': 0.9377, 'mean_acc': 0.8143}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.998, 'acc_0_1': 0.9293, 'acc_1_0': 0.8929, 'acc_1_1': 0.9801, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6262, 'acc_0_0': 0.9863, 'acc_0_1': 0.6776, 'acc_1_0': 0.6262, 'acc_1_1': 0.9315, 'mean_acc': 0.8202}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9983, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9906}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.6558, 'acc_0_0': 0.9854, 'acc_0_1': 0.6887, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8269}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9989, 'acc_0_1': 0.9457, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.634, 'acc_0_0': 0.9849, 'acc_0_1': 0.6687, 'acc_1_0': 0.634, 'acc_1_1': 0.933, 'mean_acc': 0.8172}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6515, 'acc_0_0': 0.9485, 'acc_0_1': 0.9013, 'acc_1_0': 0.6515, 'acc_1_1': 0.7463, 'mean_acc': 0.8748}
Val(class)(new adapter): {'weighted_mean_acc': 0.945, 'worst_acc': 0.7854, 'acc_0_0': 0.953, 'acc_0_1': 0.7854, 'acc_1_0': 0.791, 'acc_1_1': 0.9545, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.9357, 'worst_acc': 0.7809, 'acc_0_0': 0.9548, 'acc_0_1': 0.7809, 'acc_1_0': 0.8006, 'acc_1_1': 0.9065, 'mean_acc': 0.8647}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4091, 'acc_0_0': 0.867, 'acc_0_1': 0.8069, 'acc_1_0': 0.4091, 'acc_1_1': 0.8209, 'mean_acc': 0.788}
Val(class)(new adapter): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.4764, 'acc_0_0': 0.9829, 'acc_0_1': 0.4764, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7467}
Test(class)(new adapter): {'weighted_mean_acc': 0.9566, 'worst_acc': 0.5135, 'acc_0_0': 0.9898, 'acc_0_1': 0.5135, 'acc_1_0': 0.6386, 'acc_1_1': 0.9408, 'mean_acc': 0.7601}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9442, 'acc_0_1': 0.897, 'acc_1_0': 0.5758, 'acc_1_1': 0.8209, 'mean_acc': 0.8715}
Val(class)(new adapter): {'weighted_mean_acc': 0.8272, 'worst_acc': 0.8205, 'acc_0_0': 0.8205, 'acc_0_1': 0.8927, 'acc_1_0': 0.9104, 'acc_1_1': 0.8333, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8005, 'worst_acc': 0.7352, 'acc_0_0': 0.8133, 'acc_0_1': 0.8958, 'acc_1_0': 0.919, 'acc_1_1': 0.7352, 'mean_acc': 0.8485}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.8498, 'acc_0_1': 0.927, 'acc_1_0': 0.8636, 'acc_1_1': 0.5522, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.7313, 'acc_0_0': 0.9744, 'acc_0_1': 0.7983, 'acc_1_0': 0.7313, 'acc_1_1': 0.9697, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9573, 'worst_acc': 0.7788, 'acc_0_0': 0.9787, 'acc_0_1': 0.7978, 'acc_1_0': 0.7788, 'acc_1_1': 0.9237, 'mean_acc': 0.88}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9957, 'acc_0_1': 0.9571, 'acc_1_0': 0.6061, 'acc_1_1': 0.9104, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.8283, 'acc_0_0': 0.8889, 'acc_0_1': 0.8283, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.8239, 'acc_0_0': 0.8984, 'acc_0_1': 0.8239, 'acc_1_0': 0.8879, 'acc_1_1': 0.8988, 'mean_acc': 0.8683}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8155, 'acc_0_0': 0.8155, 'acc_0_1': 0.8884, 'acc_1_0': 0.9394, 'acc_1_1': 0.8507, 'mean_acc': 0.8614}
Val(class)(new adapter): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.7612, 'acc_0_0': 0.9744, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9464, 'worst_acc': 0.7336, 'acc_0_0': 0.9854, 'acc_0_1': 0.9379, 'acc_1_0': 0.7336, 'acc_1_1': 0.8302, 'mean_acc': 0.9218}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.803, 'acc_1_1': 0.9552, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.7727, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7648, 'acc_0_0': 0.969, 'acc_0_1': 0.9619, 'acc_1_0': 0.7866, 'acc_1_1': 0.7648, 'mean_acc': 0.9234}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9142, 'acc_0_1': 0.97, 'acc_1_0': 0.7121, 'acc_1_1': 0.7164, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.9251, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.8412, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9387, 'worst_acc': 0.8209, 'acc_0_0': 0.9517, 'acc_0_1': 0.8404, 'acc_1_0': 0.8209, 'acc_1_1': 0.919, 'mean_acc': 0.8902}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9871, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.8806, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.8773, 'worst_acc': 0.806, 'acc_0_0': 0.8889, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8816, 'worst_acc': 0.7679, 'acc_0_0': 0.9135, 'acc_0_1': 0.9401, 'acc_1_0': 0.8427, 'acc_1_1': 0.7679, 'mean_acc': 0.8999}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9313, 'acc_0_1': 0.9227, 'acc_1_0': 0.8333, 'acc_1_1': 0.7612, 'mean_acc': 0.8982}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7639, 'acc_0_0': 0.9017, 'acc_0_1': 0.7639, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7973, 'acc_0_0': 0.9361, 'acc_0_1': 0.7973, 'acc_1_0': 0.8567, 'acc_1_1': 0.9097, 'mean_acc': 0.8704}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8822, 'worst_acc': 0.7424, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.7424, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8875, 'worst_acc': 0.6963, 'acc_0_0': 0.9428, 'acc_0_1': 0.9565, 'acc_1_0': 0.8162, 'acc_1_1': 0.6963, 'mean_acc': 0.9068}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.927, 'acc_0_1': 0.9828, 'acc_1_0': 0.8788, 'acc_1_1': 0.8657, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9354, 'worst_acc': 0.7882, 'acc_0_0': 0.9672, 'acc_0_1': 0.9086, 'acc_1_0': 0.7882, 'acc_1_1': 0.8427, 'mean_acc': 0.9108}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9914, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8069, 'worst_acc': 0.4697, 'acc_0_0': 0.9017, 'acc_0_1': 0.97, 'acc_1_0': 0.7164, 'acc_1_1': 0.4697, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8092, 'worst_acc': 0.391, 'acc_0_0': 0.9277, 'acc_0_1': 0.98, 'acc_1_0': 0.7368, 'acc_1_1': 0.391, 'mean_acc': 0.8674}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9185, 'acc_0_1': 0.867, 'acc_1_0': 0.8485, 'acc_1_1': 0.806, 'mean_acc': 0.8781}
Val(class)(new adapter): {'weighted_mean_acc': 0.9513, 'worst_acc': 0.7463, 'acc_0_0': 0.9615, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.9394, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.7819, 'acc_0_0': 0.9676, 'acc_0_1': 0.8905, 'acc_1_0': 0.7819, 'acc_1_1': 0.8707, 'mean_acc': 0.9063}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8773, 'worst_acc': 0.8182, 'acc_0_0': 0.8932, 'acc_0_1': 0.9227, 'acc_1_0': 0.8507, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8667, 'worst_acc': 0.6994, 'acc_0_0': 0.9131, 'acc_0_1': 0.9424, 'acc_1_0': 0.8785, 'acc_1_1': 0.6994, 'mean_acc': 0.897}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9742, 'acc_0_1': 0.9828, 'acc_1_0': 0.8788, 'acc_1_1': 0.8209, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.8963, 'worst_acc': 0.806, 'acc_0_0': 0.8932, 'acc_0_1': 0.824, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.8217, 'acc_0_0': 0.9246, 'acc_0_1': 0.8217, 'acc_1_0': 0.8442, 'acc_1_1': 0.9065, 'mean_acc': 0.8737}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8782, 'worst_acc': 0.6667, 'acc_0_0': 0.9402, 'acc_0_1': 0.9742, 'acc_1_0': 0.6866, 'acc_1_1': 0.6667, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8683, 'worst_acc': 0.5639, 'acc_0_0': 0.9565, 'acc_0_1': 0.9809, 'acc_1_0': 0.7368, 'acc_1_1': 0.5639, 'mean_acc': 0.8982}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.97, 'acc_0_1': 0.9785, 'acc_1_0': 0.9697, 'acc_1_1': 0.9254, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.8781, 'worst_acc': 0.8507, 'acc_0_0': 0.8803, 'acc_0_1': 0.927, 'acc_1_0': 0.8507, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8917, 'worst_acc': 0.8069, 'acc_0_0': 0.9162, 'acc_0_1': 0.9206, 'acc_1_0': 0.8723, 'acc_1_1': 0.8069, 'mean_acc': 0.9009}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8857, 'worst_acc': 0.806, 'acc_0_0': 0.8846, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8837, 'worst_acc': 0.8131, 'acc_0_0': 0.9055, 'acc_0_1': 0.8838, 'acc_1_0': 0.8536, 'acc_1_1': 0.8131, 'mean_acc': 0.8811}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9528, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.7259, 'acc_0_0': 0.9561, 'acc_0_1': 0.949, 'acc_1_0': 0.796, 'acc_1_1': 0.7259, 'mean_acc': 0.9101}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.803, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7523, 'acc_0_0': 0.9521, 'acc_0_1': 0.945, 'acc_1_0': 0.796, 'acc_1_1': 0.7523, 'mean_acc': 0.9099}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8535, 'worst_acc': 0.8112, 'acc_0_0': 0.8291, 'acc_0_1': 0.8112, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class)(new adapter): {'weighted_mean_acc': 0.8437, 'worst_acc': 0.8266, 'acc_0_0': 0.8293, 'acc_0_1': 0.8266, 'acc_1_0': 0.9097, 'acc_1_1': 0.891, 'mean_acc': 0.844}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7009, 'acc_0_0': 0.9565, 'acc_0_1': 0.9548, 'acc_1_0': 0.7835, 'acc_1_1': 0.7009, 'mean_acc': 0.9084}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8657, 'acc_0_0': 0.906, 'acc_0_1': 0.867, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8442, 'acc_0_0': 0.9144, 'acc_0_1': 0.8736, 'acc_1_0': 0.8442, 'acc_1_1': 0.8536, 'mean_acc': 0.884}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8882, 'worst_acc': 0.7273, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.7273, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8741, 'worst_acc': 0.595, 'acc_0_0': 0.9561, 'acc_0_1': 0.9659, 'acc_1_0': 0.7181, 'acc_1_1': 0.595, 'mean_acc': 0.8935}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.796, 'acc_0_0': 0.9463, 'acc_0_1': 0.8758, 'acc_1_0': 0.796, 'acc_1_1': 0.8427, 'mean_acc': 0.8907}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7305, 'acc_0_0': 0.9623, 'acc_0_1': 0.949, 'acc_1_0': 0.7804, 'acc_1_1': 0.7305, 'mean_acc': 0.9113}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.97, 'acc_0_1': 0.9828, 'acc_1_0': 0.8485, 'acc_1_1': 0.8806, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9532, 'worst_acc': 0.7761, 'acc_0_0': 0.9701, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.93}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7461, 'acc_0_0': 0.9712, 'acc_0_1': 0.9322, 'acc_1_0': 0.7461, 'acc_1_1': 0.7804, 'mean_acc': 0.9099}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9871, 'acc_0_1': 0.97, 'acc_1_0': 0.9242, 'acc_1_1': 0.8955, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.97, 'acc_1_0': 0.7313, 'acc_1_1': 0.7727, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7072, 'acc_0_0': 0.9663, 'acc_0_1': 0.9623, 'acc_1_0': 0.7648, 'acc_1_1': 0.7072, 'mean_acc': 0.9137}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9742, 'acc_0_1': 0.9657, 'acc_1_0': 0.8788, 'acc_1_1': 0.8209, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9392, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.9394, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9344, 'worst_acc': 0.8178, 'acc_0_0': 0.9605, 'acc_0_1': 0.9024, 'acc_1_0': 0.8178, 'acc_1_1': 0.8598, 'mean_acc': 0.9109}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.8955, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8776, 'worst_acc': 0.7761, 'acc_0_0': 0.8889, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8769, 'worst_acc': 0.7726, 'acc_0_0': 0.9051, 'acc_0_1': 0.949, 'acc_1_0': 0.8474, 'acc_1_1': 0.7726, 'mean_acc': 0.9011}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.97, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.794, 'acc_1_0': 0.791, 'acc_1_1': 0.9697, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.94, 'worst_acc': 0.7765, 'acc_0_0': 0.9565, 'acc_0_1': 0.7765, 'acc_1_0': 0.8069, 'acc_1_1': 0.9206, 'mean_acc': 0.8659}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9871, 'acc_0_1': 0.9614, 'acc_1_0': 0.9848, 'acc_1_1': 0.9403, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.7424, 'acc_0_0': 0.9359, 'acc_0_1': 0.97, 'acc_1_0': 0.7612, 'acc_1_1': 0.7424, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.6822, 'acc_0_0': 0.9477, 'acc_0_1': 0.9725, 'acc_1_0': 0.7882, 'acc_1_1': 0.6822, 'mean_acc': 0.9103}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9571, 'acc_0_1': 0.9657, 'acc_1_0': 0.9242, 'acc_1_1': 0.8358, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.7854, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.7951, 'acc_0_0': 0.9539, 'acc_0_1': 0.7951, 'acc_1_0': 0.8193, 'acc_1_1': 0.8801, 'mean_acc': 0.869}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8482, 'worst_acc': 0.5, 'acc_0_0': 0.9487, 'acc_0_1': 0.9742, 'acc_1_0': 0.7313, 'acc_1_1': 0.5, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8476, 'worst_acc': 0.4439, 'acc_0_0': 0.9645, 'acc_0_1': 0.9823, 'acc_1_0': 0.7227, 'acc_1_1': 0.4439, 'mean_acc': 0.887}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.9957, 'acc_0_1': 0.7768, 'acc_1_0': 1.0, 'acc_1_1': 0.7761, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.8921, 'worst_acc': 0.7576, 'acc_0_0': 0.9316, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.7576, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8776, 'worst_acc': 0.6713, 'acc_0_0': 0.9375, 'acc_0_1': 0.9521, 'acc_1_0': 0.7882, 'acc_1_1': 0.6713, 'mean_acc': 0.8971}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.7612, 'acc_0_0': 0.9188, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8877, 'worst_acc': 0.7492, 'acc_0_0': 0.9286, 'acc_0_1': 0.9335, 'acc_1_0': 0.796, 'acc_1_1': 0.7492, 'mean_acc': 0.8959}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8974, 'worst_acc': 0.7804, 'acc_0_0': 0.933, 'acc_0_1': 0.9233, 'acc_1_0': 0.7928, 'acc_1_1': 0.7804, 'mean_acc': 0.8968}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.7632, 'acc_0_0': 0.9353, 'acc_0_1': 0.9313, 'acc_1_0': 0.796, 'acc_1_1': 0.7632, 'mean_acc': 0.8992}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9001, 'worst_acc': 0.7804, 'acc_0_0': 0.9361, 'acc_0_1': 0.933, 'acc_1_0': 0.7975, 'acc_1_1': 0.7804, 'mean_acc': 0.9023}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.7586, 'acc_0_0': 0.9366, 'acc_0_1': 0.9424, 'acc_1_0': 0.785, 'acc_1_1': 0.7586, 'mean_acc': 0.9023}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.771, 'acc_0_0': 0.9375, 'acc_0_1': 0.9375, 'acc_1_0': 0.7913, 'acc_1_1': 0.771, 'mean_acc': 0.9028}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.785, 'acc_0_0': 0.9366, 'acc_0_1': 0.9339, 'acc_1_0': 0.796, 'acc_1_1': 0.785, 'mean_acc': 0.9032}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.785, 'acc_0_0': 0.9357, 'acc_0_1': 0.9326, 'acc_1_0': 0.8006, 'acc_1_1': 0.785, 'mean_acc': 0.9028}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.7648, 'acc_0_0': 0.937, 'acc_0_1': 0.945, 'acc_1_0': 0.7804, 'acc_1_1': 0.7648, 'mean_acc': 0.9037}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.7835, 'acc_0_0': 0.9361, 'acc_0_1': 0.9326, 'acc_1_0': 0.7991, 'acc_1_1': 0.7835, 'mean_acc': 0.9027}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7664, 'acc_0_0': 0.937, 'acc_0_1': 0.9432, 'acc_1_0': 0.7882, 'acc_1_1': 0.7664, 'mean_acc': 0.904}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8998, 'worst_acc': 0.7664, 'acc_0_0': 0.9397, 'acc_0_1': 0.9455, 'acc_1_0': 0.7804, 'acc_1_1': 0.7664, 'mean_acc': 0.9051}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8997, 'worst_acc': 0.7819, 'acc_0_0': 0.9353, 'acc_0_1': 0.9313, 'acc_1_0': 0.7944, 'acc_1_1': 0.7819, 'mean_acc': 0.9011}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9007, 'worst_acc': 0.7757, 'acc_0_0': 0.9384, 'acc_0_1': 0.9357, 'acc_1_0': 0.7928, 'acc_1_1': 0.7757, 'mean_acc': 0.9032}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.7726, 'acc_0_0': 0.9388, 'acc_0_1': 0.9397, 'acc_1_0': 0.785, 'acc_1_1': 0.7726, 'mean_acc': 0.9037}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.8984, 'worst_acc': 0.7835, 'acc_0_0': 0.933, 'acc_0_1': 0.9295, 'acc_1_0': 0.8053, 'acc_1_1': 0.7835, 'mean_acc': 0.9009}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8962, 'worst_acc': 0.7773, 'acc_0_0': 0.9317, 'acc_0_1': 0.9335, 'acc_1_0': 0.8037, 'acc_1_1': 0.7773, 'mean_acc': 0.9011}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9005, 'worst_acc': 0.7726, 'acc_0_0': 0.9388, 'acc_0_1': 0.9388, 'acc_1_0': 0.7928, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.7726, 'acc_0_0': 0.937, 'acc_0_1': 0.9379, 'acc_1_0': 0.7913, 'acc_1_1': 0.7726, 'mean_acc': 0.903}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.8968, 'worst_acc': 0.7819, 'acc_0_0': 0.9313, 'acc_0_1': 0.9273, 'acc_1_0': 0.8084, 'acc_1_1': 0.7819, 'mean_acc': 0.8996}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.771, 'acc_0_0': 0.9353, 'acc_0_1': 0.9375, 'acc_1_0': 0.796, 'acc_1_1': 0.771, 'mean_acc': 0.9025}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8982, 'worst_acc': 0.7664, 'acc_0_0': 0.9375, 'acc_0_1': 0.9419, 'acc_1_0': 0.7913, 'acc_1_1': 0.7664, 'mean_acc': 0.904}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7695, 'acc_0_0': 0.9366, 'acc_0_1': 0.9375, 'acc_1_0': 0.7897, 'acc_1_1': 0.7695, 'mean_acc': 0.9021}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.7617, 'acc_0_0': 0.9401, 'acc_0_1': 0.945, 'acc_1_0': 0.7819, 'acc_1_1': 0.7617, 'mean_acc': 0.9047}
========================================================================
> end of training. 

best epoch : 64
best training accuracy on [class]: {'worst_acc': 0.9851, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8657, 'acc_0_0': 0.906, 'acc_0_1': 0.867, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.89}
best test accuracy on [class]: {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8442, 'acc_0_0': 0.9144, 'acc_0_1': 0.8736, 'acc_1_0': 0.8442, 'acc_1_1': 0.8536, 'mean_acc': 0.884}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8442, 'acc_0_0': 0.9144, 'acc_0_1': 0.8736, 'acc_1_0': 0.8442, 'acc_1_1': 0.8536, 'mean_acc': 0.884}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9664, 'worst_acc': 0.7243, 'acc_0_0': 0.9707, 'acc_0_1': 0.8984, 'acc_1_0': 0.7243, 'acc_1_1': 0.9766, 'mean_acc': 0.9159}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 64': {'Train': {'worst_acc': 0.9851, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.99}, 'Val': {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8657, 'acc_0_0': 0.906, 'acc_0_1': 0.867, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.89}, 'Test': {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8442, 'acc_0_0': 0.9144, 'acc_0_1': 0.8736, 'acc_1_0': 0.8442, 'acc_1_1': 0.8536, 'mean_acc': 0.884}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8442, 'acc_0_0': 0.9144, 'acc_0_1': 0.8736, 'acc_1_0': 0.8442, 'acc_1_1': 0.8536, 'mean_acc': 0.884}, 'spurious': {'weighted_mean_acc': 0.9664, 'worst_acc': 0.7243, 'acc_0_0': 0.9707, 'acc_0_1': 0.8984, 'acc_1_0': 0.7243, 'acc_1_1': 0.9766, 'mean_acc': 0.9159}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8892     0.7664   0.9251  ...   0.8474   0.7664    0.8992
2                       0.8908     0.8520   0.8953  ...   0.8520   0.8816    0.8787
3                       0.8986     0.8442   0.9144  ...   0.8442   0.8536    0.8840
test_mean               0.8929     0.8209   0.9116  ...   0.8479   0.8339    0.8873
test_std                0.0041     0.0386   0.0123  ...   0.0032   0.0491    0.0087
1                       0.9642     0.6542   0.9743  ...   0.6542   0.9766    0.8692
2                       0.9432     0.4517   0.9397  ...   0.4517   0.9922    0.8678
3                       0.9664     0.7243   0.9707  ...   0.7243   0.9766    0.9159
zs_spu_mean             0.9579     0.6101   0.9616  ...   0.6101   0.9818    0.8843
zs_spu_std              0.0105     0.1156   0.0155  ...   0.1156   0.0074    0.0224
1                          NaN     0.8657   0.9528  ...   0.9394   0.8657    0.9516
2                          NaN     0.8060   0.9657  ...   0.8333   0.8060    0.9232
3                          NaN     0.9851   0.9871  ...   1.0000   0.9851    0.9900
tr_mean                    NaN     0.8856   0.9685  ...   0.9242   0.8856    0.9549
tr_std                     NaN     0.0745   0.0141  ...   0.0689   0.0745    0.0274
1                       0.9243     0.8657   0.9402  ...   0.8657   0.8788    0.9100
2                       0.8950     0.8369   0.8803  ...   0.8806   0.9545    0.8717
3                       0.9114     0.8657   0.9060  ...   0.8657   0.9394    0.8900
val_mean                0.9102     0.8561   0.9088  ...   0.8707   0.9242    0.8906
val_std                 0.0120     0.0136   0.0245  ...   0.0070   0.0327    0.0156
1                       0.8892     0.7664   0.9251  ...   0.8474   0.7664    0.8992
2                       0.8908     0.8520   0.8953  ...   0.8520   0.8816    0.8787
3                       0.8986     0.8442   0.9144  ...   0.8442   0.8536    0.8840
zs_tg_mean              0.8929     0.8209   0.9116  ...   0.8479   0.8339    0.8873
zs_tg_std               0.0041     0.0386   0.0123  ...   0.0032   0.0491    0.0087

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_10.0_lrr10.0_bsr64_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.2857, 'acc_0_0': 0.9028, 'acc_0_1': 0.663, 'acc_1_0': 0.2857, 'acc_1_1': 0.4759, 'mean_acc': 0.7923}
Val(class): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.1588, 'acc_0_0': 0.9274, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6117}
Test(class): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.1251, 'acc_0_0': 0.9392, 'acc_0_1': 0.1251, 'acc_1_0': 0.7259, 'acc_1_1': 0.9844, 'mean_acc': 0.6037}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2174, 'acc_0_0': 0.9768, 'acc_0_1': 0.2174, 'acc_1_0': 0.6786, 'acc_1_1': 0.9745, 'mean_acc': 0.9437}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3648, 'acc_0_0': 1.0, 'acc_0_1': 0.3648, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.6933}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.322, 'acc_0_0': 0.9942, 'acc_0_1': 0.322, 'acc_1_0': 0.5249, 'acc_1_1': 0.9564, 'mean_acc': 0.6764}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.6359, 'acc_1_0': 0.5, 'acc_1_1': 0.878, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5064, 'acc_0_0': 0.9957, 'acc_0_1': 0.5064, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.4678, 'acc_0_0': 0.9933, 'acc_0_1': 0.4678, 'acc_1_0': 0.553, 'acc_1_1': 0.9361, 'mean_acc': 0.7337}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5217, 'acc_0_0': 0.9886, 'acc_0_1': 0.5217, 'acc_1_0': 0.6964, 'acc_1_1': 0.9631, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4292, 'acc_0_0': 0.9915, 'acc_0_1': 0.4292, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7367}
Test(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3889, 'acc_0_0': 0.9805, 'acc_0_1': 0.3889, 'acc_1_0': 0.6791, 'acc_1_1': 0.9579, 'mean_acc': 0.7144}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5543, 'acc_0_0': 0.9848, 'acc_0_1': 0.5543, 'acc_1_0': 0.8036, 'acc_1_1': 0.964, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6262, 'acc_0_0': 0.988, 'acc_0_1': 0.6421, 'acc_1_0': 0.6262, 'acc_1_1': 0.9283, 'mean_acc': 0.8067}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9946, 'acc_0_1': 0.7772, 'acc_1_0': 0.6786, 'acc_1_1': 0.9224, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9566, 'worst_acc': 0.634, 'acc_0_0': 0.9858, 'acc_0_1': 0.6528, 'acc_1_0': 0.634, 'acc_1_1': 0.9299, 'mean_acc': 0.811}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.992, 'acc_0_1': 0.663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9518, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7717}
Test(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.5002, 'acc_0_0': 0.9809, 'acc_0_1': 0.5002, 'acc_1_0': 0.6854, 'acc_1_1': 0.9502, 'mean_acc': 0.7577}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6196, 'acc_0_0': 0.9914, 'acc_0_1': 0.6196, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.6288, 'acc_0_0': 0.9885, 'acc_0_1': 0.6288, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8031}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.7143, 'acc_1_1': 0.9499, 'mean_acc': 0.9708}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.6075, 'acc_0_0': 0.9907, 'acc_0_1': 0.6359, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8029}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.996, 'acc_0_1': 0.7065, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5672, 'acc_0_0': 0.9889, 'acc_0_1': 0.5672, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.7798}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6304, 'acc_0_0': 0.9937, 'acc_0_1': 0.6304, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9712}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6438, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6121, 'acc_0_0': 0.9911, 'acc_0_1': 0.6133, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.7957}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9974, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5794, 'acc_0_0': 0.9933, 'acc_0_1': 0.667, 'acc_1_0': 0.5794, 'acc_1_1': 0.9221, 'mean_acc': 0.8126}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9966, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.9729}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6121, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.7991}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9949, 'acc_0_1': 0.6902, 'acc_1_0': 0.7679, 'acc_1_1': 0.9622, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6106, 'acc_0_0': 0.9925, 'acc_0_1': 0.6302, 'acc_1_0': 0.6106, 'acc_1_1': 0.933, 'mean_acc': 0.8026}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.75, 'acc_1_1': 0.9622, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6012, 'acc_0_0': 0.9929, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8219}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9974, 'acc_0_1': 0.7391, 'acc_1_0': 0.7857, 'acc_1_1': 0.9565, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6457, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8076}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9963, 'acc_0_1': 0.7337, 'acc_1_0': 0.8214, 'acc_1_1': 0.9612, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6537, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8107}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9977, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.6732, 'acc_1_0': 0.6012, 'acc_1_1': 0.9283, 'mean_acc': 0.8177}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9974, 'acc_0_1': 0.7554, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.6625, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8148}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9966, 'acc_0_1': 0.7446, 'acc_1_0': 0.8393, 'acc_1_1': 0.9697, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6293, 'acc_0_0': 0.9907, 'acc_0_1': 0.655, 'acc_1_0': 0.6293, 'acc_1_1': 0.9346, 'mean_acc': 0.8138}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9925, 'acc_0_1': 0.6838, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.8234}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.7857, 'acc_1_1': 0.9631, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6812, 'acc_1_0': 0.6184, 'acc_1_1': 0.9315, 'mean_acc': 0.8222}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7717, 'acc_0_0': 0.998, 'acc_0_1': 0.7717, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6137, 'acc_0_0': 0.9902, 'acc_0_1': 0.6874, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9983, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6749, 'acc_1_0': 0.6184, 'acc_1_1': 0.933, 'mean_acc': 0.82}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9986, 'acc_0_1': 0.7935, 'acc_1_0': 0.8571, 'acc_1_1': 0.9697, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6812, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8219}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9994, 'acc_0_1': 0.788, 'acc_1_0': 0.8571, 'acc_1_1': 0.9716, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.6887, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8245}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8571, 'acc_1_1': 0.9678, 'mean_acc': 0.9837}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5997, 'acc_0_0': 0.9916, 'acc_0_1': 0.7166, 'acc_1_0': 0.5997, 'acc_1_1': 0.9299, 'mean_acc': 0.8343}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9986, 'acc_0_1': 0.8152, 'acc_1_0': 0.8929, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9663, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6106, 'acc_0_0': 0.9902, 'acc_0_1': 0.6634, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8152}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7511, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5903, 'acc_0_0': 0.9925, 'acc_0_1': 0.722, 'acc_1_0': 0.5903, 'acc_1_1': 0.9283, 'mean_acc': 0.8355}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.8859, 'acc_1_0': 0.8393, 'acc_1_1': 0.9688, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.9714, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.5919, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.5919, 'acc_1_1': 0.9315, 'mean_acc': 0.8264}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9889, 'acc_0_1': 0.6732, 'acc_1_0': 0.6153, 'acc_1_1': 0.9377, 'mean_acc': 0.819}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9991, 'acc_0_1': 0.837, 'acc_1_0': 0.9107, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.6847, 'acc_1_0': 0.6308, 'acc_1_1': 0.9361, 'mean_acc': 0.8248}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9735, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.7002, 'acc_1_0': 0.6153, 'acc_1_1': 0.9346, 'mean_acc': 0.8293}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 1.0, 'acc_0_1': 0.8913, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.6882, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8243}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 1.0, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6269, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6308, 'acc_1_1': 0.9377, 'mean_acc': 0.8165}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6931, 'acc_1_0': 0.6168, 'acc_1_1': 0.9346, 'mean_acc': 0.8269}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9239, 'acc_0_0': 1.0, 'acc_0_1': 0.9239, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8298}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9185, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.9643, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6741, 'acc_1_0': 0.6168, 'acc_1_1': 0.9377, 'mean_acc': 0.8198}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9868, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.609, 'acc_0_0': 0.9911, 'acc_0_1': 0.7033, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8305}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9896, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6059, 'acc_0_0': 0.9916, 'acc_0_1': 0.722, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8376}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.8197, 'acc_1_0': 0.5, 'acc_1_1': 0.8955, 'mean_acc': 0.8614}
Val(class)(new adapter): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.5522, 'acc_0_0': 0.9829, 'acc_0_1': 0.9142, 'acc_1_0': 0.5522, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9518, 'worst_acc': 0.5981, 'acc_0_0': 0.9956, 'acc_0_1': 0.9086, 'acc_1_0': 0.5981, 'acc_1_1': 0.8333, 'mean_acc': 0.8997}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.197, 'acc_0_0': 0.8755, 'acc_0_1': 0.5236, 'acc_1_0': 0.197, 'acc_1_1': 0.6418, 'mean_acc': 0.6377}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.2532, 'acc_0_0': 0.9274, 'acc_0_1': 0.2532, 'acc_1_0': 0.8358, 'acc_1_1': 1.0, 'mean_acc': 0.6633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.2306, 'acc_0_0': 0.9313, 'acc_0_1': 0.2306, 'acc_1_0': 0.8084, 'acc_1_1': 0.9829, 'mean_acc': 0.6507}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5606, 'acc_0_0': 0.9828, 'acc_0_1': 0.7597, 'acc_1_0': 0.5606, 'acc_1_1': 0.6716, 'mean_acc': 0.8147}
Val(class)(new adapter): {'weighted_mean_acc': 0.8001, 'worst_acc': 0.2273, 'acc_0_0': 0.9658, 'acc_0_1': 0.97, 'acc_1_0': 0.7015, 'acc_1_1': 0.2273, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.8146, 'worst_acc': 0.2523, 'acc_0_0': 0.9769, 'acc_0_1': 0.9871, 'acc_1_0': 0.7227, 'acc_1_1': 0.2523, 'mean_acc': 0.8725}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0896, 'acc_0_0': 0.8498, 'acc_0_1': 0.9442, 'acc_1_0': 0.8333, 'acc_1_1': 0.0896, 'mean_acc': 0.7997}
Val(class)(new adapter): {'weighted_mean_acc': 0.8545, 'worst_acc': 0.7511, 'acc_0_0': 0.8291, 'acc_0_1': 0.7511, 'acc_1_0': 0.8955, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class)(new adapter): {'weighted_mean_acc': 0.8262, 'worst_acc': 0.7357, 'acc_0_0': 0.7987, 'acc_0_1': 0.7357, 'acc_1_0': 0.9143, 'acc_1_1': 0.9283, 'mean_acc': 0.8013}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.927, 'acc_0_1': 0.9185, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.7983, 'acc_1_0': 0.7612, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.7975, 'acc_0_0': 0.9596, 'acc_0_1': 0.8031, 'acc_1_0': 0.7975, 'acc_1_1': 0.9097, 'mean_acc': 0.8752}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.97, 'acc_0_1': 0.9528, 'acc_1_0': 0.6667, 'acc_1_1': 0.6269, 'mean_acc': 0.8915}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.8927, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.8411, 'acc_0_0': 0.9202, 'acc_0_1': 0.8865, 'acc_1_0': 0.8411, 'acc_1_1': 0.8769, 'mean_acc': 0.8935}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.8802, 'worst_acc': 0.8358, 'acc_0_0': 0.8718, 'acc_0_1': 0.8884, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8745, 'acc_0_0': 0.8745, 'acc_0_1': 0.8851, 'acc_1_0': 0.8754, 'acc_1_1': 0.8832, 'mean_acc': 0.8797}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9614, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.8657, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.895, 'worst_acc': 0.806, 'acc_0_0': 0.8932, 'acc_0_1': 0.8755, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.8551, 'acc_0_0': 0.9069, 'acc_0_1': 0.8816, 'acc_1_0': 0.8551, 'acc_1_1': 0.8863, 'mean_acc': 0.889}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.791, 'acc_0_0': 0.8932, 'acc_0_1': 0.8927, 'acc_1_0': 0.791, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.8396, 'acc_0_0': 0.9122, 'acc_0_1': 0.8931, 'acc_1_0': 0.8396, 'acc_1_1': 0.8676, 'mean_acc': 0.8918}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 1.0, 'acc_0_1': 0.9742, 'acc_1_0': 0.9697, 'acc_1_1': 0.9254, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8939, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8084, 'acc_0_0': 0.9264, 'acc_0_1': 0.9038, 'acc_1_0': 0.8084, 'acc_1_1': 0.8364, 'mean_acc': 0.8945}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.7368, 'acc_0_0': 0.9685, 'acc_0_1': 0.9503, 'acc_1_0': 0.7368, 'acc_1_1': 0.7726, 'mean_acc': 0.914}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9426, 'worst_acc': 0.7164, 'acc_0_0': 0.9658, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.6947, 'acc_0_0': 0.9747, 'acc_0_1': 0.9384, 'acc_1_0': 0.6947, 'acc_1_1': 0.7913, 'mean_acc': 0.9092}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9328, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7181, 'acc_0_0': 0.9685, 'acc_0_1': 0.9304, 'acc_1_0': 0.7181, 'acc_1_1': 0.7991, 'mean_acc': 0.9071}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7726, 'acc_0_0': 0.9499, 'acc_0_1': 0.9055, 'acc_1_0': 0.7726, 'acc_1_1': 0.8271, 'mean_acc': 0.8994}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8942, 'worst_acc': 0.7612, 'acc_0_0': 0.9017, 'acc_0_1': 0.8798, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.81, 'acc_0_0': 0.9313, 'acc_0_1': 0.8967, 'acc_1_0': 0.81, 'acc_1_1': 0.8271, 'mean_acc': 0.8928}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9004, 'worst_acc': 0.7612, 'acc_0_0': 0.9145, 'acc_0_1': 0.8841, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.796, 'acc_0_0': 0.937, 'acc_0_1': 0.9113, 'acc_1_0': 0.796, 'acc_1_1': 0.7975, 'mean_acc': 0.8959}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.771, 'acc_0_0': 0.945, 'acc_0_1': 0.9299, 'acc_1_0': 0.771, 'acc_1_1': 0.7757, 'mean_acc': 0.9011}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7508, 'acc_0_0': 0.953, 'acc_0_1': 0.9251, 'acc_1_0': 0.7508, 'acc_1_1': 0.7804, 'mean_acc': 0.9006}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7352, 'acc_0_0': 0.9588, 'acc_0_1': 0.9273, 'acc_1_0': 0.7352, 'acc_1_1': 0.785, 'mean_acc': 0.9025}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7461, 'acc_0_0': 0.9588, 'acc_0_1': 0.9259, 'acc_1_0': 0.7461, 'acc_1_1': 0.7866, 'mean_acc': 0.9033}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7383, 'acc_0_0': 0.9605, 'acc_0_1': 0.9335, 'acc_1_0': 0.7383, 'acc_1_1': 0.7819, 'mean_acc': 0.9056}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7352, 'acc_0_0': 0.9596, 'acc_0_1': 0.9357, 'acc_1_0': 0.7352, 'acc_1_1': 0.7741, 'mean_acc': 0.9049}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7477, 'acc_0_0': 0.9557, 'acc_0_1': 0.9348, 'acc_1_0': 0.7477, 'acc_1_1': 0.7741, 'mean_acc': 0.9044}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7492, 'acc_0_0': 0.9543, 'acc_0_1': 0.9366, 'acc_1_0': 0.7492, 'acc_1_1': 0.7741, 'mean_acc': 0.9047}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7648, 'acc_0_0': 0.949, 'acc_0_1': 0.9401, 'acc_1_0': 0.7695, 'acc_1_1': 0.7648, 'mean_acc': 0.9052}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9007, 'worst_acc': 0.7555, 'acc_0_0': 0.9441, 'acc_0_1': 0.9428, 'acc_1_0': 0.7913, 'acc_1_1': 0.7555, 'mean_acc': 0.9058}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7555, 'acc_0_0': 0.9486, 'acc_0_1': 0.9446, 'acc_1_0': 0.7897, 'acc_1_1': 0.7555, 'mean_acc': 0.908}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.791, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7523, 'acc_0_0': 0.9592, 'acc_0_1': 0.9468, 'acc_1_0': 0.7695, 'acc_1_1': 0.7523, 'mean_acc': 0.9104}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7227, 'acc_0_0': 0.9703, 'acc_0_1': 0.9512, 'acc_1_0': 0.7227, 'acc_1_1': 0.7399, 'mean_acc': 0.9099}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.7196, 'acc_0_0': 0.9725, 'acc_0_1': 0.9508, 'acc_1_0': 0.7196, 'acc_1_1': 0.743, 'mean_acc': 0.9106}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7761, 'acc_0_0': 0.953, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7445, 'acc_0_0': 0.9627, 'acc_0_1': 0.9441, 'acc_1_0': 0.7445, 'acc_1_1': 0.7617, 'mean_acc': 0.909}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7586, 'acc_0_0': 0.9534, 'acc_0_1': 0.933, 'acc_1_0': 0.7586, 'acc_1_1': 0.7788, 'mean_acc': 0.9046}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7679, 'acc_0_0': 0.9486, 'acc_0_1': 0.9317, 'acc_1_0': 0.7679, 'acc_1_1': 0.7819, 'mean_acc': 0.9035}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7601, 'acc_0_0': 0.9494, 'acc_0_1': 0.9339, 'acc_1_0': 0.7601, 'acc_1_1': 0.7773, 'mean_acc': 0.9033}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7601, 'acc_0_0': 0.9486, 'acc_0_1': 0.9344, 'acc_1_0': 0.7601, 'acc_1_1': 0.7757, 'mean_acc': 0.903}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7586, 'acc_0_0': 0.9503, 'acc_0_1': 0.9379, 'acc_1_0': 0.7586, 'acc_1_1': 0.7726, 'mean_acc': 0.9046}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.7601, 'acc_0_0': 0.949, 'acc_0_1': 0.9379, 'acc_1_0': 0.7601, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7601, 'acc_0_0': 0.9494, 'acc_0_1': 0.9375, 'acc_1_0': 0.7601, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7617, 'acc_0_0': 0.9494, 'acc_0_1': 0.9375, 'acc_1_0': 0.7617, 'acc_1_1': 0.7726, 'mean_acc': 0.9044}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9069, 'worst_acc': 0.7601, 'acc_0_0': 0.949, 'acc_0_1': 0.9397, 'acc_1_0': 0.7601, 'acc_1_1': 0.7695, 'mean_acc': 0.9046}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7601, 'acc_0_0': 0.949, 'acc_0_1': 0.9397, 'acc_1_0': 0.7601, 'acc_1_1': 0.771, 'mean_acc': 0.9047}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7601, 'acc_0_0': 0.9517, 'acc_0_1': 0.9392, 'acc_1_0': 0.7601, 'acc_1_1': 0.771, 'mean_acc': 0.9056}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7601, 'acc_0_0': 0.9499, 'acc_0_1': 0.9375, 'acc_1_0': 0.7601, 'acc_1_1': 0.7741, 'mean_acc': 0.9046}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7617, 'acc_0_0': 0.949, 'acc_0_1': 0.9366, 'acc_1_0': 0.7617, 'acc_1_1': 0.7741, 'mean_acc': 0.904}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7601, 'acc_0_0': 0.9494, 'acc_0_1': 0.9375, 'acc_1_0': 0.7601, 'acc_1_1': 0.7741, 'mean_acc': 0.9044}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7632, 'acc_0_0': 0.9481, 'acc_0_1': 0.9366, 'acc_1_0': 0.7632, 'acc_1_1': 0.7773, 'mean_acc': 0.9042}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7632, 'acc_0_0': 0.949, 'acc_0_1': 0.937, 'acc_1_0': 0.7632, 'acc_1_1': 0.7741, 'mean_acc': 0.9044}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7617, 'acc_0_0': 0.949, 'acc_0_1': 0.9366, 'acc_1_0': 0.7617, 'acc_1_1': 0.7741, 'mean_acc': 0.904}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7632, 'acc_0_0': 0.9481, 'acc_0_1': 0.9344, 'acc_1_0': 0.7632, 'acc_1_1': 0.7773, 'mean_acc': 0.9033}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7632, 'acc_0_0': 0.9481, 'acc_0_1': 0.937, 'acc_1_0': 0.7632, 'acc_1_1': 0.7741, 'mean_acc': 0.904}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9069, 'worst_acc': 0.7648, 'acc_0_0': 0.9477, 'acc_0_1': 0.9366, 'acc_1_0': 0.7648, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7632, 'acc_0_0': 0.9477, 'acc_0_1': 0.9335, 'acc_1_0': 0.7632, 'acc_1_1': 0.7773, 'mean_acc': 0.9028}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7617, 'acc_0_0': 0.9486, 'acc_0_1': 0.9379, 'acc_1_0': 0.7617, 'acc_1_1': 0.771, 'mean_acc': 0.904}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7632, 'acc_0_0': 0.9481, 'acc_0_1': 0.937, 'acc_1_0': 0.7632, 'acc_1_1': 0.7726, 'mean_acc': 0.9039}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7601, 'acc_0_0': 0.9503, 'acc_0_1': 0.9384, 'acc_1_0': 0.7601, 'acc_1_1': 0.7726, 'mean_acc': 0.9049}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7601, 'acc_0_0': 0.9508, 'acc_0_1': 0.9375, 'acc_1_0': 0.7601, 'acc_1_1': 0.7726, 'mean_acc': 0.9047}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7601, 'acc_0_0': 0.9508, 'acc_0_1': 0.9366, 'acc_1_0': 0.7601, 'acc_1_1': 0.7757, 'mean_acc': 0.9047}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7617, 'acc_0_0': 0.9503, 'acc_0_1': 0.9361, 'acc_1_0': 0.7617, 'acc_1_1': 0.7757, 'mean_acc': 0.9046}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7601, 'acc_0_0': 0.9508, 'acc_0_1': 0.9375, 'acc_1_0': 0.7601, 'acc_1_1': 0.7741, 'mean_acc': 0.9049}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7601, 'acc_0_0': 0.9508, 'acc_0_1': 0.937, 'acc_1_0': 0.7601, 'acc_1_1': 0.7741, 'mean_acc': 0.9047}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.9394, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9683}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8802, 'worst_acc': 0.8358, 'acc_0_0': 0.8718, 'acc_0_1': 0.8884, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
best test accuracy on [class]: {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8745, 'acc_0_0': 0.8745, 'acc_0_1': 0.8851, 'acc_1_0': 0.8754, 'acc_1_1': 0.8832, 'mean_acc': 0.8797}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8745, 'acc_0_0': 0.8745, 'acc_0_1': 0.8851, 'acc_1_0': 0.8754, 'acc_1_1': 0.8832, 'mean_acc': 0.8797}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.4875, 'acc_0_0': 0.9698, 'acc_0_1': 0.8838, 'acc_1_0': 0.4875, 'acc_1_1': 0.986, 'mean_acc': 0.8847}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.9394, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9683}, 'Val': {'weighted_mean_acc': 0.8802, 'worst_acc': 0.8358, 'acc_0_0': 0.8718, 'acc_0_1': 0.8884, 'acc_1_0': 0.8358, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}, 'Test': {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8745, 'acc_0_0': 0.8745, 'acc_0_1': 0.8851, 'acc_1_0': 0.8754, 'acc_1_1': 0.8832, 'mean_acc': 0.8797}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8768, 'worst_acc': 0.8745, 'acc_0_0': 0.8745, 'acc_0_1': 0.8851, 'acc_1_0': 0.8754, 'acc_1_1': 0.8832, 'mean_acc': 0.8797}, 'spurious': {'weighted_mean_acc': 0.9645, 'worst_acc': 0.4875, 'acc_0_0': 0.9698, 'acc_0_1': 0.8838, 'acc_1_0': 0.4875, 'acc_1_1': 0.986, 'mean_acc': 0.8847}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.25, 'acc_0_0': 0.8957, 'acc_0_1': 0.7717, 'acc_1_0': 0.25, 'acc_1_1': 0.2819, 'mean_acc': 0.7481}
Val(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.3047, 'acc_0_0': 0.9829, 'acc_0_1': 0.3047, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6767}
Test(class): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.2381, 'acc_0_0': 0.9676, 'acc_0_1': 0.2381, 'acc_1_0': 0.6168, 'acc_1_1': 0.9735, 'mean_acc': 0.6455}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1902, 'acc_0_0': 0.9565, 'acc_0_1': 0.1902, 'acc_1_0': 0.6964, 'acc_1_1': 0.9858, 'mean_acc': 0.9306}
Val(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.2403, 'acc_0_0': 0.9872, 'acc_0_1': 0.2403, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6583}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2124, 'acc_0_0': 0.9792, 'acc_0_1': 0.2124, 'acc_1_0': 0.6433, 'acc_1_1': 0.972, 'mean_acc': 0.6427}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.996, 'acc_0_1': 0.587, 'acc_1_0': 0.4464, 'acc_1_1': 0.9007, 'mean_acc': 0.9529}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.2961, 'acc_0_0': 1.0, 'acc_0_1': 0.2961, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.685}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.2736, 'acc_0_0': 0.9827, 'acc_0_1': 0.2736, 'acc_1_0': 0.6449, 'acc_1_1': 0.9688, 'mean_acc': 0.6678}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9946, 'acc_0_1': 0.625, 'acc_1_0': 0.5714, 'acc_1_1': 0.9338, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3262, 'acc_0_0': 0.9915, 'acc_0_1': 0.3262, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.6983}
Test(class): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.29, 'acc_0_0': 0.9778, 'acc_0_1': 0.29, 'acc_1_0': 0.6729, 'acc_1_1': 0.9704, 'mean_acc': 0.6755}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4348, 'acc_0_0': 0.9903, 'acc_0_1': 0.4348, 'acc_1_0': 0.6786, 'acc_1_1': 0.9763, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.4163, 'acc_0_0': 0.9915, 'acc_0_1': 0.4163, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.3579, 'acc_0_0': 0.9792, 'acc_0_1': 0.3579, 'acc_1_0': 0.6822, 'acc_1_1': 0.9657, 'mean_acc': 0.703}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5761, 'acc_0_0': 0.99, 'acc_0_1': 0.5761, 'acc_1_0': 0.7143, 'acc_1_1': 0.9707, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.618, 'acc_0_0': 0.9872, 'acc_0_1': 0.618, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5685, 'acc_0_0': 0.9849, 'acc_0_1': 0.5685, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.7813}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.6429, 'acc_1_1': 0.9376, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6402, 'acc_0_0': 0.9867, 'acc_0_1': 0.6838, 'acc_1_0': 0.6402, 'acc_1_1': 0.9159, 'mean_acc': 0.8226}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7337, 'acc_1_0': 0.6964, 'acc_1_1': 0.947, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5716, 'acc_0_0': 0.9854, 'acc_0_1': 0.5716, 'acc_1_0': 0.6495, 'acc_1_1': 0.9424, 'mean_acc': 0.7824}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9909, 'acc_0_1': 0.6467, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5446, 'acc_0_0': 0.9863, 'acc_0_1': 0.5446, 'acc_1_0': 0.6464, 'acc_1_1': 0.947, 'mean_acc': 0.7724}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9687, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6133, 'acc_0_0': 0.9885, 'acc_0_1': 0.6133, 'acc_1_0': 0.6137, 'acc_1_1': 0.933, 'mean_acc': 0.7948}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9957, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6059, 'acc_0_0': 0.9894, 'acc_0_1': 0.651, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8088}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9954, 'acc_0_1': 0.7065, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6093, 'acc_0_0': 0.9889, 'acc_0_1': 0.6093, 'acc_1_0': 0.634, 'acc_1_1': 0.9424, 'mean_acc': 0.7967}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.608, 'acc_0_0': 0.9889, 'acc_0_1': 0.608, 'acc_1_0': 0.6417, 'acc_1_1': 0.9424, 'mean_acc': 0.797}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9943, 'acc_0_1': 0.7065, 'acc_1_0': 0.8214, 'acc_1_1': 0.9688, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6231, 'acc_1_1': 0.9346, 'mean_acc': 0.8098}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9949, 'acc_0_1': 0.7283, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6168, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.6168, 'acc_1_1': 0.9393, 'mean_acc': 0.8098}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.994, 'acc_0_1': 0.7011, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9722, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6284, 'acc_1_0': 0.6153, 'acc_1_1': 0.9424, 'mean_acc': 0.8024}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9946, 'acc_0_1': 0.712, 'acc_1_0': 0.7857, 'acc_1_1': 0.964, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5981, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9393, 'mean_acc': 0.8077}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9971, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9738, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5779, 'acc_0_0': 0.9929, 'acc_0_1': 0.6918, 'acc_1_0': 0.5779, 'acc_1_1': 0.933, 'mean_acc': 0.8231}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6213, 'acc_0_0': 0.9894, 'acc_0_1': 0.6213, 'acc_1_0': 0.6215, 'acc_1_1': 0.9439, 'mean_acc': 0.8003}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9931, 'acc_0_1': 0.7228, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6199, 'acc_0_0': 0.9898, 'acc_0_1': 0.6461, 'acc_1_0': 0.6199, 'acc_1_1': 0.9439, 'mean_acc': 0.81}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9974, 'acc_0_1': 0.7772, 'acc_1_0': 0.8036, 'acc_1_1': 0.9669, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6798, 'acc_1_0': 0.5966, 'acc_1_1': 0.9377, 'mean_acc': 0.8207}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.998, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9622, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6714, 'acc_1_0': 0.5966, 'acc_1_1': 0.9408, 'mean_acc': 0.8177}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6315, 'acc_0_0': 0.9889, 'acc_0_1': 0.6315, 'acc_1_0': 0.6324, 'acc_1_1': 0.9439, 'mean_acc': 0.8053}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9971, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.6763, 'acc_1_0': 0.6121, 'acc_1_1': 0.9393, 'mean_acc': 0.8207}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9986, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.6692, 'acc_1_0': 0.6121, 'acc_1_1': 0.9408, 'mean_acc': 0.8184}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9977, 'acc_0_1': 0.788, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6603, 'acc_1_0': 0.6137, 'acc_1_1': 0.9424, 'mean_acc': 0.8152}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9977, 'acc_0_1': 0.8098, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.663, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8171}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9994, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9745, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6231, 'acc_0_0': 0.9911, 'acc_0_1': 0.678, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8224}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.9994, 'acc_0_1': 0.8424, 'acc_1_0': 0.9107, 'acc_1_1': 0.982, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.671, 'acc_1_0': 0.6231, 'acc_1_1': 0.9393, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9849, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8164}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9994, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9801, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6355, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.6355, 'acc_1_1': 0.9393, 'mean_acc': 0.8183}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9849, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.686, 'acc_1_0': 0.6215, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9997, 'acc_0_1': 0.8641, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6794, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 1.0, 'acc_0_1': 0.9076, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7073, 'acc_1_0': 0.5981, 'acc_1_1': 0.9377, 'mean_acc': 0.831}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.994}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.694, 'acc_1_0': 0.6137, 'acc_1_1': 0.9393, 'mean_acc': 0.8267}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9905, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6803, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8217}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.6661, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8171}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7153, 'acc_1_0': 0.5981, 'acc_1_1': 0.9361, 'mean_acc': 0.834}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6028, 'acc_0_0': 0.9894, 'acc_0_1': 0.7091, 'acc_1_0': 0.6028, 'acc_1_1': 0.9346, 'mean_acc': 0.8314}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9957, 'acc_0_1': 0.8112, 'acc_1_0': 0.4848, 'acc_1_1': 0.8507, 'mean_acc': 0.8514}
Val(class)(new adapter): {'weighted_mean_acc': 0.9292, 'worst_acc': 0.4627, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.4627, 'acc_1_1': 0.7273, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.5078, 'acc_0_0': 0.9965, 'acc_0_1': 0.9596, 'acc_1_0': 0.5078, 'acc_1_1': 0.6558, 'mean_acc': 0.8902}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1515, 'acc_0_0': 0.8884, 'acc_0_1': 0.5966, 'acc_1_0': 0.1515, 'acc_1_1': 0.7015, 'mean_acc': 0.6728}
Val(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.2189, 'acc_0_0': 0.9316, 'acc_0_1': 0.2189, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.65}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.2075, 'acc_0_0': 0.9415, 'acc_0_1': 0.2075, 'acc_1_0': 0.8302, 'acc_1_1': 0.986, 'mean_acc': 0.6484}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.9657, 'acc_0_1': 0.721, 'acc_1_0': 0.7424, 'acc_1_1': 0.6567, 'mean_acc': 0.8114}
Val(class)(new adapter): {'weighted_mean_acc': 0.7709, 'worst_acc': 0.1061, 'acc_0_0': 0.9615, 'acc_0_1': 0.9914, 'acc_1_0': 0.6866, 'acc_1_1': 0.1061, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.7981, 'worst_acc': 0.148, 'acc_0_0': 0.9854, 'acc_0_1': 0.9956, 'acc_1_0': 0.7196, 'acc_1_1': 0.148, 'mean_acc': 0.8671}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1343, 'acc_0_0': 0.8712, 'acc_0_1': 0.9657, 'acc_1_0': 0.8485, 'acc_1_1': 0.1343, 'mean_acc': 0.823}
Val(class)(new adapter): {'weighted_mean_acc': 0.8937, 'worst_acc': 0.8889, 'acc_0_0': 0.8889, 'acc_0_1': 0.8927, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8536, 'acc_0_0': 0.8887, 'acc_0_1': 0.8785, 'acc_1_0': 0.8972, 'acc_1_1': 0.8536, 'mean_acc': 0.8818}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9657, 'acc_0_1': 0.9442, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.8507, 'acc_0_0': 0.9188, 'acc_0_1': 0.8841, 'acc_1_0': 0.8507, 'acc_1_1': 0.9242, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9132, 'worst_acc': 0.8629, 'acc_0_0': 0.9197, 'acc_0_1': 0.8687, 'acc_1_0': 0.8629, 'acc_1_1': 0.9019, 'mean_acc': 0.8916}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.9356, 'acc_0_1': 0.9657, 'acc_1_0': 0.7879, 'acc_1_1': 0.7761, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.8909, 'worst_acc': 0.8636, 'acc_0_0': 0.8974, 'acc_0_1': 0.9313, 'acc_1_0': 0.8657, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8735, 'worst_acc': 0.8442, 'acc_0_0': 0.8803, 'acc_0_1': 0.9153, 'acc_1_0': 0.8629, 'acc_1_1': 0.8442, 'mean_acc': 0.888}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9055, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9005, 'worst_acc': 0.7726, 'acc_0_0': 0.9388, 'acc_0_1': 0.9406, 'acc_1_0': 0.7866, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.8939, 'acc_1_1': 0.8955, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.865, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8798, 'acc_1_0': 0.9104, 'acc_1_1': 0.8939, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8444, 'worst_acc': 0.8341, 'acc_0_0': 0.8341, 'acc_0_1': 0.8741, 'acc_1_0': 0.8941, 'acc_1_1': 0.8707, 'mean_acc': 0.8604}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.867, 'worst_acc': 0.8541, 'acc_0_0': 0.8547, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.9091, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.8613, 'worst_acc': 0.8479, 'acc_0_0': 0.8612, 'acc_0_1': 0.8479, 'acc_1_0': 0.8832, 'acc_1_1': 0.8629, 'mean_acc': 0.8586}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9254, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.8915, 'worst_acc': 0.8358, 'acc_0_0': 0.8932, 'acc_0_1': 0.8627, 'acc_1_0': 0.8358, 'acc_1_1': 0.8939, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8929, 'worst_acc': 0.8598, 'acc_0_0': 0.9029, 'acc_0_1': 0.8674, 'acc_1_0': 0.8598, 'acc_1_1': 0.866, 'mean_acc': 0.8802}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8826, 'worst_acc': 0.8358, 'acc_0_0': 0.8932, 'acc_0_1': 0.8927, 'acc_1_0': 0.8358, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.8333, 'acc_0_0': 0.9144, 'acc_0_1': 0.9078, 'acc_1_0': 0.8567, 'acc_1_1': 0.8333, 'mean_acc': 0.8964}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7835, 'acc_0_0': 0.961, 'acc_0_1': 0.9432, 'acc_1_0': 0.7913, 'acc_1_1': 0.7835, 'mean_acc': 0.9156}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9299, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7648, 'acc_0_0': 0.9672, 'acc_0_1': 0.9366, 'acc_1_0': 0.7648, 'acc_1_1': 0.796, 'mean_acc': 0.9139}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.8022, 'acc_0_0': 0.9486, 'acc_0_1': 0.9251, 'acc_1_0': 0.8022, 'acc_1_1': 0.8069, 'mean_acc': 0.9075}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8942, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.8884, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9002, 'worst_acc': 0.8084, 'acc_0_0': 0.9282, 'acc_0_1': 0.918, 'acc_1_0': 0.8318, 'acc_1_1': 0.8084, 'mean_acc': 0.9002}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.8037, 'acc_0_0': 0.9353, 'acc_0_1': 0.9202, 'acc_1_0': 0.8209, 'acc_1_1': 0.8037, 'mean_acc': 0.9021}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7835, 'acc_0_0': 0.9552, 'acc_0_1': 0.9299, 'acc_1_0': 0.7882, 'acc_1_1': 0.7835, 'mean_acc': 0.9078}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7804, 'acc_0_0': 0.9623, 'acc_0_1': 0.9304, 'acc_1_0': 0.7804, 'acc_1_1': 0.785, 'mean_acc': 0.9101}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.7648, 'acc_0_0': 0.9667, 'acc_0_1': 0.9366, 'acc_1_0': 0.7648, 'acc_1_1': 0.7757, 'mean_acc': 0.9115}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.771, 'acc_0_0': 0.9654, 'acc_0_1': 0.9348, 'acc_1_0': 0.771, 'acc_1_1': 0.7757, 'mean_acc': 0.9109}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7664, 'acc_0_0': 0.9645, 'acc_0_1': 0.9406, 'acc_1_0': 0.7773, 'acc_1_1': 0.7664, 'mean_acc': 0.9125}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7617, 'acc_0_0': 0.9619, 'acc_0_1': 0.941, 'acc_1_0': 0.7804, 'acc_1_1': 0.7617, 'mean_acc': 0.9115}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7601, 'acc_0_0': 0.9605, 'acc_0_1': 0.9401, 'acc_1_0': 0.785, 'acc_1_1': 0.7601, 'mean_acc': 0.9109}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7555, 'acc_0_0': 0.9592, 'acc_0_1': 0.9415, 'acc_1_0': 0.785, 'acc_1_1': 0.7555, 'mean_acc': 0.9104}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7523, 'acc_0_0': 0.9601, 'acc_0_1': 0.9441, 'acc_1_0': 0.7804, 'acc_1_1': 0.7523, 'mean_acc': 0.9109}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7477, 'acc_0_0': 0.9601, 'acc_0_1': 0.945, 'acc_1_0': 0.7773, 'acc_1_1': 0.7477, 'mean_acc': 0.9104}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7414, 'acc_0_0': 0.9596, 'acc_0_1': 0.9463, 'acc_1_0': 0.7773, 'acc_1_1': 0.7414, 'mean_acc': 0.9101}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7523, 'acc_0_0': 0.9557, 'acc_0_1': 0.9415, 'acc_1_0': 0.7866, 'acc_1_1': 0.7523, 'mean_acc': 0.9089}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7539, 'acc_0_0': 0.9534, 'acc_0_1': 0.9441, 'acc_1_0': 0.7944, 'acc_1_1': 0.7539, 'mean_acc': 0.9101}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.757, 'acc_0_0': 0.9539, 'acc_0_1': 0.9432, 'acc_1_0': 0.7944, 'acc_1_1': 0.757, 'mean_acc': 0.9103}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.7664, 'acc_0_0': 0.9548, 'acc_0_1': 0.9379, 'acc_1_0': 0.7928, 'acc_1_1': 0.7664, 'mean_acc': 0.9094}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7695, 'acc_0_0': 0.9521, 'acc_0_1': 0.9348, 'acc_1_0': 0.7991, 'acc_1_1': 0.7695, 'mean_acc': 0.9082}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7726, 'acc_0_0': 0.9512, 'acc_0_1': 0.9339, 'acc_1_0': 0.8022, 'acc_1_1': 0.7726, 'mean_acc': 0.9082}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.771, 'acc_0_0': 0.9477, 'acc_0_1': 0.9348, 'acc_1_0': 0.8069, 'acc_1_1': 0.771, 'mean_acc': 0.9075}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.7726, 'acc_0_0': 0.9463, 'acc_0_1': 0.9322, 'acc_1_0': 0.8084, 'acc_1_1': 0.7726, 'mean_acc': 0.9063}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.771, 'acc_0_0': 0.9477, 'acc_0_1': 0.9339, 'acc_1_0': 0.8069, 'acc_1_1': 0.771, 'mean_acc': 0.9071}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.771, 'acc_0_0': 0.9494, 'acc_0_1': 0.9344, 'acc_1_0': 0.8037, 'acc_1_1': 0.771, 'mean_acc': 0.9077}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.771, 'acc_0_0': 0.9494, 'acc_0_1': 0.9344, 'acc_1_0': 0.8037, 'acc_1_1': 0.771, 'mean_acc': 0.9077}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.771, 'acc_0_0': 0.949, 'acc_0_1': 0.9344, 'acc_1_0': 0.8053, 'acc_1_1': 0.771, 'mean_acc': 0.9077}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.771, 'acc_0_0': 0.9477, 'acc_0_1': 0.9335, 'acc_1_0': 0.8069, 'acc_1_1': 0.771, 'mean_acc': 0.907}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7679, 'acc_0_0': 0.9494, 'acc_0_1': 0.9353, 'acc_1_0': 0.8022, 'acc_1_1': 0.7679, 'mean_acc': 0.9075}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.771, 'acc_0_0': 0.9499, 'acc_0_1': 0.9348, 'acc_1_0': 0.8022, 'acc_1_1': 0.771, 'mean_acc': 0.9078}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7648, 'acc_0_0': 0.9508, 'acc_0_1': 0.9366, 'acc_1_0': 0.7944, 'acc_1_1': 0.7648, 'mean_acc': 0.9073}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7664, 'acc_0_0': 0.9503, 'acc_0_1': 0.9357, 'acc_1_0': 0.7944, 'acc_1_1': 0.7664, 'mean_acc': 0.907}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.7679, 'acc_0_0': 0.9499, 'acc_0_1': 0.9348, 'acc_1_0': 0.8006, 'acc_1_1': 0.7679, 'mean_acc': 0.9073}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7648, 'acc_0_0': 0.9508, 'acc_0_1': 0.937, 'acc_1_0': 0.7944, 'acc_1_1': 0.7648, 'mean_acc': 0.9075}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7664, 'acc_0_0': 0.9503, 'acc_0_1': 0.9353, 'acc_1_0': 0.7975, 'acc_1_1': 0.7664, 'mean_acc': 0.9071}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.7679, 'acc_0_0': 0.9499, 'acc_0_1': 0.9361, 'acc_1_0': 0.7975, 'acc_1_1': 0.7679, 'mean_acc': 0.9075}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7695, 'acc_0_0': 0.9499, 'acc_0_1': 0.9353, 'acc_1_0': 0.7991, 'acc_1_1': 0.7695, 'mean_acc': 0.9075}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7664, 'acc_0_0': 0.9499, 'acc_0_1': 0.9361, 'acc_1_0': 0.7991, 'acc_1_1': 0.7664, 'mean_acc': 0.9075}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7648, 'acc_0_0': 0.9503, 'acc_0_1': 0.937, 'acc_1_0': 0.7944, 'acc_1_1': 0.7648, 'mean_acc': 0.9073}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7679, 'acc_0_0': 0.9499, 'acc_0_1': 0.9348, 'acc_1_0': 0.796, 'acc_1_1': 0.7679, 'mean_acc': 0.9068}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7632, 'acc_0_0': 0.9512, 'acc_0_1': 0.9375, 'acc_1_0': 0.7944, 'acc_1_1': 0.7632, 'mean_acc': 0.9077}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7617, 'acc_0_0': 0.9512, 'acc_0_1': 0.9375, 'acc_1_0': 0.7897, 'acc_1_1': 0.7617, 'mean_acc': 0.907}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7679, 'acc_0_0': 0.9512, 'acc_0_1': 0.9357, 'acc_1_0': 0.7944, 'acc_1_1': 0.7679, 'mean_acc': 0.9075}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7648, 'acc_0_0': 0.9508, 'acc_0_1': 0.937, 'acc_1_0': 0.7928, 'acc_1_1': 0.7648, 'mean_acc': 0.9073}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7664, 'acc_0_0': 0.9503, 'acc_0_1': 0.9366, 'acc_1_0': 0.7944, 'acc_1_1': 0.7664, 'mean_acc': 0.9073}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7601, 'acc_0_0': 0.9503, 'acc_0_1': 0.9388, 'acc_1_0': 0.7944, 'acc_1_1': 0.7601, 'mean_acc': 0.9075}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7648, 'acc_0_0': 0.9508, 'acc_0_1': 0.9375, 'acc_1_0': 0.7944, 'acc_1_1': 0.7648, 'mean_acc': 0.9077}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7601, 'acc_0_0': 0.9503, 'acc_0_1': 0.9384, 'acc_1_0': 0.7928, 'acc_1_1': 0.7601, 'mean_acc': 0.9071}
========================================================================
> end of training. 

best epoch : 44
best training accuracy on [class]: {'worst_acc': 0.1343, 'acc_0_0': 0.8712, 'acc_0_1': 0.9657, 'acc_1_0': 0.8485, 'acc_1_1': 0.1343, 'mean_acc': 0.823}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8937, 'worst_acc': 0.8889, 'acc_0_0': 0.8889, 'acc_0_1': 0.8927, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
best test accuracy on [class]: {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8536, 'acc_0_0': 0.8887, 'acc_0_1': 0.8785, 'acc_1_0': 0.8972, 'acc_1_1': 0.8536, 'mean_acc': 0.8818}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8536, 'acc_0_0': 0.8887, 'acc_0_1': 0.8785, 'acc_1_0': 0.8972, 'acc_1_1': 0.8536, 'mean_acc': 0.8818}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.3536, 'acc_0_0': 0.9645, 'acc_0_1': 0.8878, 'acc_1_0': 0.3536, 'acc_1_1': 0.9875, 'mean_acc': 0.8695}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 44': {'Train': {'worst_acc': 0.1343, 'acc_0_0': 0.8712, 'acc_0_1': 0.9657, 'acc_1_0': 0.8485, 'acc_1_1': 0.1343, 'mean_acc': 0.823}, 'Val': {'weighted_mean_acc': 0.8937, 'worst_acc': 0.8889, 'acc_0_0': 0.8889, 'acc_0_1': 0.8927, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.895}, 'Test': {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8536, 'acc_0_0': 0.8887, 'acc_0_1': 0.8785, 'acc_1_0': 0.8972, 'acc_1_1': 0.8536, 'mean_acc': 0.8818}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8807, 'worst_acc': 0.8536, 'acc_0_0': 0.8887, 'acc_0_1': 0.8785, 'acc_1_0': 0.8972, 'acc_1_1': 0.8536, 'mean_acc': 0.8818}, 'spurious': {'weighted_mean_acc': 0.9595, 'worst_acc': 0.3536, 'acc_0_0': 0.9645, 'acc_0_1': 0.8878, 'acc_1_0': 0.3536, 'acc_1_1': 0.9875, 'mean_acc': 0.8695}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.4457, 'acc_0_0': 0.9168, 'acc_0_1': 0.4457, 'acc_1_0': 0.4821, 'acc_1_1': 0.6377, 'mean_acc': 0.8321}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.2618, 'acc_0_0': 0.9915, 'acc_0_1': 0.2618, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6633}
Test(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.2293, 'acc_0_0': 0.9836, 'acc_0_1': 0.2293, 'acc_1_0': 0.5748, 'acc_1_1': 0.9704, 'mean_acc': 0.6433}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4643, 'acc_0_0': 0.9943, 'acc_0_1': 0.6196, 'acc_1_0': 0.4643, 'acc_1_1': 0.8723, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.3176, 'acc_0_0': 0.9957, 'acc_0_1': 0.3176, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6917}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.3193, 'acc_0_0': 0.9809, 'acc_0_1': 0.3193, 'acc_1_0': 0.6417, 'acc_1_1': 0.9642, 'mean_acc': 0.684}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9871, 'acc_0_1': 0.4891, 'acc_1_0': 0.6607, 'acc_1_1': 0.9527, 'mean_acc': 0.9566}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2918, 'acc_0_0': 0.9829, 'acc_0_1': 0.2918, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.6833}
Test(class): {'weighted_mean_acc': 0.941, 'worst_acc': 0.2878, 'acc_0_0': 0.9685, 'acc_0_1': 0.2878, 'acc_1_0': 0.7274, 'acc_1_1': 0.9751, 'mean_acc': 0.6776}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5272, 'acc_0_0': 0.9728, 'acc_0_1': 0.5272, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9514}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.6244, 'acc_0_0': 0.9858, 'acc_0_1': 0.6244, 'acc_1_0': 0.6386, 'acc_1_1': 0.933, 'mean_acc': 0.8008}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9977, 'acc_0_1': 0.8641, 'acc_1_0': 0.5357, 'acc_1_1': 0.8846, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6438, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6302, 'acc_0_0': 0.9831, 'acc_0_1': 0.6302, 'acc_1_0': 0.6838, 'acc_1_1': 0.9346, 'mean_acc': 0.8072}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9808, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9518, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.4893, 'acc_0_0': 0.9786, 'acc_0_1': 0.4893, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.4315, 'acc_0_0': 0.9685, 'acc_0_1': 0.4315, 'acc_1_0': 0.729, 'acc_1_1': 0.9611, 'mean_acc': 0.7321}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9926, 'acc_0_1': 0.6793, 'acc_1_0': 0.6429, 'acc_1_1': 0.9508, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.6738, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5312, 'acc_0_0': 0.9929, 'acc_0_1': 0.6834, 'acc_1_0': 0.5312, 'acc_1_1': 0.9143, 'mean_acc': 0.8126}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9994, 'acc_0_1': 0.7826, 'acc_1_0': 0.5, 'acc_1_1': 0.9234, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.5536, 'acc_0_0': 0.9915, 'acc_0_1': 0.5536, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.775}
Test(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5583, 'acc_0_0': 0.9876, 'acc_0_1': 0.5583, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.7713}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.996, 'acc_0_1': 0.6141, 'acc_1_0': 0.6071, 'acc_1_1': 0.9659, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5365, 'acc_0_0': 0.9872, 'acc_0_1': 0.5365, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7733}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.5153, 'acc_0_0': 0.9863, 'acc_0_1': 0.5153, 'acc_1_0': 0.6246, 'acc_1_1': 0.9439, 'mean_acc': 0.7582}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9969, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.948, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.5498, 'acc_0_0': 0.9916, 'acc_0_1': 0.6816, 'acc_1_0': 0.5498, 'acc_1_1': 0.9112, 'mean_acc': 0.8131}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.6071, 'acc_1_1': 0.9423, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.5522, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5748, 'acc_0_0': 0.9898, 'acc_0_1': 0.6612, 'acc_1_0': 0.5748, 'acc_1_1': 0.9159, 'mean_acc': 0.8077}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.6957, 'acc_1_0': 0.6786, 'acc_1_1': 0.9565, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.581, 'acc_0_0': 0.9916, 'acc_0_1': 0.651, 'acc_1_0': 0.581, 'acc_1_1': 0.919, 'mean_acc': 0.8055}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9977, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.6931, 'acc_1_0': 0.567, 'acc_1_1': 0.9128, 'mean_acc': 0.8202}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9983, 'acc_0_1': 0.7663, 'acc_1_0': 0.6964, 'acc_1_1': 0.9518, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5779, 'acc_0_0': 0.9925, 'acc_0_1': 0.6905, 'acc_1_0': 0.5779, 'acc_1_1': 0.9174, 'mean_acc': 0.8207}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9546, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.6829, 'acc_1_0': 0.5841, 'acc_1_1': 0.9221, 'mean_acc': 0.819}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.998, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9574, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5888, 'acc_0_0': 0.992, 'acc_0_1': 0.6838, 'acc_1_0': 0.5888, 'acc_1_1': 0.9252, 'mean_acc': 0.82}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9977, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9929, 'acc_0_1': 0.7029, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8271}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9489, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7091, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8293}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.6656, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8152}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9986, 'acc_0_1': 0.7772, 'acc_1_0': 0.75, 'acc_1_1': 0.9603, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5732, 'acc_0_0': 0.9938, 'acc_0_1': 0.7299, 'acc_1_0': 0.5732, 'acc_1_1': 0.9237, 'mean_acc': 0.8367}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6652, 'acc_1_0': 0.6137, 'acc_1_1': 0.9361, 'mean_acc': 0.8164}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9986, 'acc_0_1': 0.7609, 'acc_1_0': 0.875, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.595, 'acc_0_0': 0.9925, 'acc_0_1': 0.7069, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.83}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8214, 'acc_1_1': 0.9631, 'mean_acc': 0.9823}
Val(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5981, 'acc_0_0': 0.992, 'acc_0_1': 0.7069, 'acc_1_0': 0.5981, 'acc_1_1': 0.9268, 'mean_acc': 0.8302}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9983, 'acc_0_1': 0.8098, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9916, 'acc_0_1': 0.6914, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9986, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9707, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.7118, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8326}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9991, 'acc_0_1': 0.8207, 'acc_1_0': 0.875, 'acc_1_1': 0.9773, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8295}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6028, 'acc_0_0': 0.9925, 'acc_0_1': 0.7171, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.8348}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9726, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6028, 'acc_0_0': 0.9938, 'acc_0_1': 0.729, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.702, 'acc_1_0': 0.6106, 'acc_1_1': 0.9361, 'mean_acc': 0.8303}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9991, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.7166, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8359}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9782, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.9658, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7277, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8402}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9991, 'acc_0_1': 0.8587, 'acc_1_0': 0.9464, 'acc_1_1': 0.982, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.7095, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8331}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9997, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.609, 'acc_0_0': 0.9925, 'acc_0_1': 0.7424, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9997, 'acc_0_1': 0.8967, 'acc_1_0': 0.9464, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6012, 'acc_0_0': 0.9933, 'acc_0_1': 0.7614, 'acc_1_0': 0.6012, 'acc_1_1': 0.9237, 'mean_acc': 0.8519}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.7419, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.846}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9994, 'acc_0_1': 0.8913, 'acc_1_0': 0.9821, 'acc_1_1': 0.9905, 'mean_acc': 0.9931}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.7211, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8371}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9923}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9902, 'acc_0_1': 0.7295, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8397}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9997, 'acc_0_1': 0.9022, 'acc_1_0': 0.9821, 'acc_1_1': 0.9849, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.7197, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8374}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7694, 'acc_1_0': 0.6075, 'acc_1_1': 0.9268, 'mean_acc': 0.8548}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9944}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6121, 'acc_0_0': 0.9902, 'acc_0_1': 0.7415, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8454}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3788, 'acc_0_0': 0.9957, 'acc_0_1': 0.794, 'acc_1_0': 0.3788, 'acc_1_1': 0.8955, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.9491, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.9227, 'acc_1_0': 0.597, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9437, 'worst_acc': 0.5997, 'acc_0_0': 0.9947, 'acc_0_1': 0.9286, 'acc_1_0': 0.5997, 'acc_1_1': 0.796, 'mean_acc': 0.9032}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0606, 'acc_0_0': 0.8927, 'acc_0_1': 0.5837, 'acc_1_0': 0.0606, 'acc_1_1': 0.7612, 'mean_acc': 0.6661}
Val(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.279, 'acc_0_0': 0.9316, 'acc_0_1': 0.279, 'acc_1_0': 0.8806, 'acc_1_1': 1.0, 'mean_acc': 0.68}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.2825, 'acc_0_0': 0.929, 'acc_0_1': 0.2825, 'acc_1_0': 0.8271, 'acc_1_1': 0.9875, 'mean_acc': 0.6726}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 0.9871, 'acc_0_1': 0.8197, 'acc_1_0': 0.6061, 'acc_1_1': 0.6119, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.7609, 'worst_acc': 0.4091, 'acc_0_0': 0.8547, 'acc_0_1': 0.9614, 'acc_1_0': 0.8806, 'acc_1_1': 0.4091, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.7624, 'worst_acc': 0.3941, 'acc_0_0': 0.8612, 'acc_0_1': 0.9663, 'acc_1_0': 0.8754, 'acc_1_1': 0.3941, 'mean_acc': 0.8519}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2836, 'acc_0_0': 0.8369, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.2836, 'mean_acc': 0.8247}
Val(class)(new adapter): {'weighted_mean_acc': 0.8556, 'worst_acc': 0.7725, 'acc_0_0': 0.8333, 'acc_0_1': 0.7725, 'acc_1_0': 0.9403, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class)(new adapter): {'weighted_mean_acc': 0.8591, 'worst_acc': 0.7738, 'acc_0_0': 0.8417, 'acc_0_1': 0.7738, 'acc_1_0': 0.9159, 'acc_1_1': 0.9283, 'mean_acc': 0.8331}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7121, 'acc_0_0': 0.9871, 'acc_0_1': 0.9185, 'acc_1_0': 0.7121, 'acc_1_1': 0.9552, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.8838, 'worst_acc': 0.8803, 'acc_0_0': 0.8803, 'acc_0_1': 0.8927, 'acc_1_0': 0.8806, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8564, 'worst_acc': 0.852, 'acc_0_0': 0.855, 'acc_0_1': 0.8971, 'acc_1_0': 0.8956, 'acc_1_1': 0.852, 'mean_acc': 0.8756}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6119, 'acc_0_0': 0.9614, 'acc_0_1': 0.9785, 'acc_1_0': 0.7727, 'acc_1_1': 0.6119, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.7146, 'worst_acc': 0.6368, 'acc_0_0': 0.6368, 'acc_0_1': 0.8197, 'acc_1_0': 0.9851, 'acc_1_1': 0.9394, 'mean_acc': 0.78}
Test(class)(new adapter): {'weighted_mean_acc': 0.6897, 'worst_acc': 0.6155, 'acc_0_0': 0.6155, 'acc_0_1': 0.8452, 'acc_1_0': 0.9579, 'acc_1_1': 0.8941, 'mean_acc': 0.7737}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8798, 'acc_0_0': 0.8798, 'acc_0_1': 0.9571, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.8841, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.8333, 'acc_0_0': 0.9415, 'acc_0_1': 0.8803, 'acc_1_0': 0.8333, 'acc_1_1': 0.8723, 'mean_acc': 0.898}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6364, 'acc_0_0': 1.0, 'acc_0_1': 0.9614, 'acc_1_0': 0.6364, 'acc_1_1': 0.8657, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9337, 'worst_acc': 0.806, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.9091, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.8006, 'acc_0_0': 0.9557, 'acc_0_1': 0.9078, 'acc_1_0': 0.8006, 'acc_1_1': 0.8333, 'mean_acc': 0.9063}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9552, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.8741, 'worst_acc': 0.8507, 'acc_0_0': 0.8718, 'acc_0_1': 0.897, 'acc_1_0': 0.8507, 'acc_1_1': 0.8788, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8682, 'worst_acc': 0.8333, 'acc_0_0': 0.8767, 'acc_0_1': 0.9033, 'acc_1_0': 0.8769, 'acc_1_1': 0.8333, 'mean_acc': 0.8823}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9442, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.8926, 'worst_acc': 0.8209, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.8022, 'acc_0_0': 0.9135, 'acc_0_1': 0.9175, 'acc_1_0': 0.8396, 'acc_1_1': 0.8022, 'mean_acc': 0.8945}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7586, 'acc_0_0': 0.9525, 'acc_0_1': 0.9392, 'acc_1_0': 0.7773, 'acc_1_1': 0.7586, 'mean_acc': 0.9065}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 1.0, 'acc_0_1': 0.9742, 'acc_1_0': 0.9545, 'acc_1_1': 0.9254, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7991, 'acc_0_0': 0.9401, 'acc_0_1': 0.9091, 'acc_1_0': 0.7991, 'acc_1_1': 0.8146, 'mean_acc': 0.8985}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7761, 'acc_0_0': 0.9103, 'acc_0_1': 0.867, 'acc_1_0': 0.7761, 'acc_1_1': 0.9242, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9047, 'worst_acc': 0.8146, 'acc_0_0': 0.9268, 'acc_0_1': 0.8865, 'acc_1_0': 0.8146, 'acc_1_1': 0.8396, 'mean_acc': 0.889}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7897, 'acc_0_0': 0.9401, 'acc_0_1': 0.91, 'acc_1_0': 0.7897, 'acc_1_1': 0.81, 'mean_acc': 0.8973}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7399, 'acc_0_0': 0.9605, 'acc_0_1': 0.9428, 'acc_1_0': 0.7399, 'acc_1_1': 0.7477, 'mean_acc': 0.9056}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.729, 'acc_0_0': 0.9636, 'acc_0_1': 0.9463, 'acc_1_0': 0.7321, 'acc_1_1': 0.729, 'mean_acc': 0.9052}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7368, 'acc_0_0': 0.9623, 'acc_0_1': 0.9468, 'acc_1_0': 0.7383, 'acc_1_1': 0.7368, 'mean_acc': 0.9065}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7274, 'acc_0_0': 0.9601, 'acc_0_1': 0.9499, 'acc_1_0': 0.7508, 'acc_1_1': 0.7274, 'mean_acc': 0.9071}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7336, 'acc_0_0': 0.9588, 'acc_0_1': 0.9503, 'acc_1_0': 0.757, 'acc_1_1': 0.7336, 'mean_acc': 0.9082}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7368, 'acc_0_0': 0.9588, 'acc_0_1': 0.9486, 'acc_1_0': 0.7555, 'acc_1_1': 0.7368, 'mean_acc': 0.9077}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7383, 'acc_0_0': 0.9561, 'acc_0_1': 0.9455, 'acc_1_0': 0.7632, 'acc_1_1': 0.7383, 'mean_acc': 0.9065}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7461, 'acc_0_0': 0.9552, 'acc_0_1': 0.9441, 'acc_1_0': 0.7664, 'acc_1_1': 0.7461, 'mean_acc': 0.9068}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7492, 'acc_0_0': 0.9534, 'acc_0_1': 0.9428, 'acc_1_0': 0.7632, 'acc_1_1': 0.7492, 'mean_acc': 0.9056}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7492, 'acc_0_0': 0.953, 'acc_0_1': 0.9419, 'acc_1_0': 0.7632, 'acc_1_1': 0.7492, 'mean_acc': 0.9051}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8987, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7539, 'acc_0_0': 0.9499, 'acc_0_1': 0.9392, 'acc_1_0': 0.7679, 'acc_1_1': 0.7539, 'mean_acc': 0.9039}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7461, 'acc_0_0': 0.9548, 'acc_0_1': 0.9441, 'acc_1_0': 0.7586, 'acc_1_1': 0.7461, 'mean_acc': 0.9058}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.743, 'acc_0_0': 0.9565, 'acc_0_1': 0.9446, 'acc_1_0': 0.7508, 'acc_1_1': 0.743, 'mean_acc': 0.9054}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.7399, 'acc_0_0': 0.957, 'acc_0_1': 0.945, 'acc_1_0': 0.7508, 'acc_1_1': 0.7399, 'mean_acc': 0.9054}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7336, 'acc_0_0': 0.9632, 'acc_0_1': 0.949, 'acc_1_0': 0.7414, 'acc_1_1': 0.7336, 'mean_acc': 0.9077}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7414, 'acc_0_0': 0.9641, 'acc_0_1': 0.9432, 'acc_1_0': 0.7414, 'acc_1_1': 0.7508, 'mean_acc': 0.9077}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7445, 'acc_0_0': 0.9632, 'acc_0_1': 0.9384, 'acc_1_0': 0.7445, 'acc_1_1': 0.7555, 'mean_acc': 0.9063}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9126, 'worst_acc': 0.743, 'acc_0_0': 0.961, 'acc_0_1': 0.9379, 'acc_1_0': 0.743, 'acc_1_1': 0.757, 'mean_acc': 0.9052}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7508, 'acc_0_0': 0.9588, 'acc_0_1': 0.9379, 'acc_1_0': 0.7508, 'acc_1_1': 0.757, 'mean_acc': 0.9052}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9048, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7601, 'acc_0_0': 0.9548, 'acc_0_1': 0.9335, 'acc_1_0': 0.7601, 'acc_1_1': 0.7601, 'mean_acc': 0.9033}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7539, 'acc_0_0': 0.9561, 'acc_0_1': 0.9379, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9044}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7539, 'acc_0_0': 0.9565, 'acc_0_1': 0.9406, 'acc_1_0': 0.7539, 'acc_1_1': 0.7539, 'mean_acc': 0.9054}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7523, 'acc_0_0': 0.9579, 'acc_0_1': 0.9392, 'acc_1_0': 0.7523, 'acc_1_1': 0.7555, 'mean_acc': 0.9054}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7508, 'acc_0_0': 0.9596, 'acc_0_1': 0.9401, 'acc_1_0': 0.7508, 'acc_1_1': 0.7555, 'mean_acc': 0.9063}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7508, 'acc_0_0': 0.9583, 'acc_0_1': 0.9419, 'acc_1_0': 0.7508, 'acc_1_1': 0.7508, 'mean_acc': 0.9059}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7555, 'acc_0_0': 0.957, 'acc_0_1': 0.9397, 'acc_1_0': 0.7555, 'acc_1_1': 0.7555, 'mean_acc': 0.9056}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7508, 'acc_0_0': 0.9583, 'acc_0_1': 0.9415, 'acc_1_0': 0.7508, 'acc_1_1': 0.7508, 'mean_acc': 0.9058}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7555, 'acc_0_0': 0.9565, 'acc_0_1': 0.9392, 'acc_1_0': 0.7555, 'acc_1_1': 0.7555, 'mean_acc': 0.9052}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7601, 'acc_0_0': 0.9557, 'acc_0_1': 0.9366, 'acc_1_0': 0.7617, 'acc_1_1': 0.7601, 'mean_acc': 0.9051}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7586, 'acc_0_0': 0.9548, 'acc_0_1': 0.9357, 'acc_1_0': 0.7648, 'acc_1_1': 0.7586, 'mean_acc': 0.9046}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7539, 'acc_0_0': 0.9561, 'acc_0_1': 0.9375, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9042}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7539, 'acc_0_0': 0.9557, 'acc_0_1': 0.9384, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9044}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7539, 'acc_0_0': 0.9561, 'acc_0_1': 0.9392, 'acc_1_0': 0.7539, 'acc_1_1': 0.7539, 'mean_acc': 0.9047}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7508, 'acc_0_0': 0.9583, 'acc_0_1': 0.9419, 'acc_1_0': 0.7508, 'acc_1_1': 0.7508, 'mean_acc': 0.9059}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7539, 'acc_0_0': 0.9565, 'acc_0_1': 0.9388, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7523, 'acc_0_0': 0.957, 'acc_0_1': 0.9388, 'acc_1_0': 0.7523, 'acc_1_1': 0.7539, 'mean_acc': 0.9047}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7523, 'acc_0_0': 0.9574, 'acc_0_1': 0.9388, 'acc_1_0': 0.7523, 'acc_1_1': 0.7523, 'mean_acc': 0.9047}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7555, 'acc_0_0': 0.9548, 'acc_0_1': 0.9379, 'acc_1_0': 0.7664, 'acc_1_1': 0.7555, 'mean_acc': 0.9052}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7555, 'acc_0_0': 0.9557, 'acc_0_1': 0.9388, 'acc_1_0': 0.757, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7539, 'acc_0_0': 0.957, 'acc_0_1': 0.9384, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.757, 'acc_0_0': 0.9561, 'acc_0_1': 0.9375, 'acc_1_0': 0.7586, 'acc_1_1': 0.757, 'mean_acc': 0.9049}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7586, 'acc_0_0': 0.9552, 'acc_0_1': 0.9344, 'acc_1_0': 0.7664, 'acc_1_1': 0.7586, 'mean_acc': 0.9044}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9049, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7555, 'acc_0_0': 0.9552, 'acc_0_1': 0.9379, 'acc_1_0': 0.7617, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7539, 'acc_0_0': 0.9565, 'acc_0_1': 0.9388, 'acc_1_0': 0.7539, 'acc_1_1': 0.7539, 'mean_acc': 0.9047}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7523, 'acc_0_0': 0.957, 'acc_0_1': 0.9388, 'acc_1_0': 0.7523, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7523, 'acc_0_0': 0.9574, 'acc_0_1': 0.9384, 'acc_1_0': 0.7523, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.7121, 'acc_0_0': 0.9871, 'acc_0_1': 0.9185, 'acc_1_0': 0.7121, 'acc_1_1': 0.9552, 'mean_acc': 0.9265}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8838, 'worst_acc': 0.8803, 'acc_0_0': 0.8803, 'acc_0_1': 0.8927, 'acc_1_0': 0.8806, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
best test accuracy on [class]: {'weighted_mean_acc': 0.8564, 'worst_acc': 0.852, 'acc_0_0': 0.855, 'acc_0_1': 0.8971, 'acc_1_0': 0.8956, 'acc_1_1': 0.852, 'mean_acc': 0.8756}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8564, 'worst_acc': 0.852, 'acc_0_0': 0.855, 'acc_0_1': 0.8971, 'acc_1_0': 0.8956, 'acc_1_1': 0.852, 'mean_acc': 0.8756}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9658, 'worst_acc': 0.5171, 'acc_0_0': 0.9685, 'acc_0_1': 0.9264, 'acc_1_0': 0.5171, 'acc_1_1': 0.9875, 'mean_acc': 0.9042}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.7121, 'acc_0_0': 0.9871, 'acc_0_1': 0.9185, 'acc_1_0': 0.7121, 'acc_1_1': 0.9552, 'mean_acc': 0.9265}, 'Val': {'weighted_mean_acc': 0.8838, 'worst_acc': 0.8803, 'acc_0_0': 0.8803, 'acc_0_1': 0.8927, 'acc_1_0': 0.8806, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}, 'Test': {'weighted_mean_acc': 0.8564, 'worst_acc': 0.852, 'acc_0_0': 0.855, 'acc_0_1': 0.8971, 'acc_1_0': 0.8956, 'acc_1_1': 0.852, 'mean_acc': 0.8756}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8564, 'worst_acc': 0.852, 'acc_0_0': 0.855, 'acc_0_1': 0.8971, 'acc_1_0': 0.8956, 'acc_1_1': 0.852, 'mean_acc': 0.8756}, 'spurious': {'weighted_mean_acc': 0.9658, 'worst_acc': 0.5171, 'acc_0_0': 0.9685, 'acc_0_1': 0.9264, 'acc_1_0': 0.5171, 'acc_1_1': 0.9875, 'mean_acc': 0.9042}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8768     0.8745   0.8745  ...   0.8754   0.8832    0.8797
2                       0.8807     0.8536   0.8887  ...   0.8972   0.8536    0.8818
3                       0.8564     0.8520   0.8550  ...   0.8956   0.8520    0.8756
test_mean               0.8713     0.8600   0.8727  ...   0.8894   0.8629    0.8790
test_std                0.0107     0.0103   0.0138  ...   0.0099   0.0143    0.0026
1                       0.9645     0.4875   0.9698  ...   0.4875   0.9860    0.8847
2                       0.9595     0.3536   0.9645  ...   0.3536   0.9875    0.8695
3                       0.9658     0.5171   0.9685  ...   0.5171   0.9875    0.9042
zs_spu_mean             0.9633     0.4527   0.9676  ...   0.4527   0.9870    0.8861
zs_spu_std              0.0027     0.0711   0.0023  ...   0.0711   0.0007    0.0142
1                          NaN     0.9394   0.9571  ...   0.9394   0.9851    0.9683
2                          NaN     0.1343   0.8712  ...   0.8485   0.1343    0.8230
3                          NaN     0.7121   0.9871  ...   0.7121   0.9552    0.9265
tr_mean                    NaN     0.5953   0.9385  ...   0.8333   0.6915    0.9059
tr_std                     NaN     0.3389   0.0491  ...   0.0934   0.3942    0.0611
1                       0.8802     0.8358   0.8718  ...   0.8358   0.9091    0.8783
2                       0.8937     0.8889   0.8889  ...   0.9104   0.9091    0.8950
3                       0.8838     0.8803   0.8803  ...   0.8806   0.8939    0.8867
val_mean                0.8859     0.8683   0.8803  ...   0.8756   0.9040    0.8867
val_std                 0.0057     0.0233   0.0070  ...   0.0307   0.0072    0.0068
1                       0.8768     0.8745   0.8745  ...   0.8754   0.8832    0.8797
2                       0.8807     0.8536   0.8887  ...   0.8972   0.8536    0.8818
3                       0.8564     0.8520   0.8550  ...   0.8956   0.8520    0.8756
zs_tg_mean              0.8713     0.8600   0.8727  ...   0.8894   0.8629    0.8790
zs_tg_std               0.0107     0.0103   0.0138  ...   0.0099   0.0143    0.0026

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_1.0_lrr1.0_bsr128_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.122, 'acc_0_0': 0.9265, 'acc_0_1': 0.9348, 'acc_1_0': 0.1607, 'acc_1_1': 0.122, 'mean_acc': 0.7406}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7677, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.7685, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9969, 'acc_1_0': 0.0, 'acc_1_1': 0.0031, 'mean_acc': 0.7775}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9771, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.7465, 'mean_acc': 0.8997}
Val(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.2961, 'acc_0_0': 0.9786, 'acc_0_1': 0.2961, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6717}
Test(class): {'weighted_mean_acc': 0.9409, 'worst_acc': 0.247, 'acc_0_0': 0.9734, 'acc_0_1': 0.247, 'acc_1_0': 0.5732, 'acc_1_1': 0.9735, 'mean_acc': 0.6464}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3036, 'acc_0_0': 0.994, 'acc_0_1': 0.462, 'acc_1_0': 0.3036, 'acc_1_1': 0.9234, 'mean_acc': 0.9499}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.209, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.209, 'acc_1_1': 0.9091, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2259, 'acc_0_0': 0.9996, 'acc_0_1': 0.6341, 'acc_1_0': 0.2259, 'acc_1_1': 0.8738, 'mean_acc': 0.7577}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.2321, 'acc_0_0': 0.9986, 'acc_0_1': 0.6359, 'acc_1_0': 0.2321, 'acc_1_1': 0.8581, 'mean_acc': 0.9447}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.2985, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.2985, 'acc_1_1': 0.9242, 'mean_acc': 0.8017}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.3598, 'acc_0_0': 0.9987, 'acc_0_1': 0.6328, 'acc_1_0': 0.3598, 'acc_1_1': 0.9065, 'mean_acc': 0.7753}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4674, 'acc_0_0': 0.99, 'acc_0_1': 0.4674, 'acc_1_0': 0.5893, 'acc_1_1': 0.9612, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.3881, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.3881, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.4688, 'acc_0_0': 0.9951, 'acc_0_1': 0.6488, 'acc_1_0': 0.4688, 'acc_1_1': 0.9159, 'mean_acc': 0.7932}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9857, 'acc_0_1': 0.5109, 'acc_1_0': 0.6607, 'acc_1_1': 0.964, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.3284, 'acc_1_1': 0.8939, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.4361, 'acc_0_0': 0.9969, 'acc_0_1': 0.8115, 'acc_1_0': 0.4361, 'acc_1_1': 0.8769, 'mean_acc': 0.8493}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.99, 'acc_0_1': 0.712, 'acc_1_0': 0.6071, 'acc_1_1': 0.9338, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8455, 'acc_1_0': 0.3731, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4486, 'acc_0_0': 0.996, 'acc_0_1': 0.855, 'acc_1_0': 0.4486, 'acc_1_1': 0.866, 'mean_acc': 0.8661}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7391, 'acc_1_0': 0.625, 'acc_1_1': 0.929, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9716, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.581, 'acc_0_0': 0.9902, 'acc_0_1': 0.7038, 'acc_1_0': 0.581, 'acc_1_1': 0.9299, 'mean_acc': 0.8267}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.9866, 'acc_0_1': 0.6359, 'acc_1_0': 0.6964, 'acc_1_1': 0.9574, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9744, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.955, 'worst_acc': 0.5508, 'acc_0_0': 0.984, 'acc_0_1': 0.5508, 'acc_1_0': 0.6511, 'acc_1_1': 0.9455, 'mean_acc': 0.7742}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9886, 'acc_0_1': 0.625, 'acc_1_0': 0.6607, 'acc_1_1': 0.9593, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5401, 'acc_0_0': 0.9858, 'acc_0_1': 0.5401, 'acc_1_0': 0.6417, 'acc_1_1': 0.9517, 'mean_acc': 0.7705}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9937, 'acc_0_1': 0.6957, 'acc_1_0': 0.625, 'acc_1_1': 0.9565, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9731, 'worst_acc': 0.5665, 'acc_0_0': 0.9915, 'acc_0_1': 0.5665, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5042, 'acc_0_0': 0.9845, 'acc_0_1': 0.5042, 'acc_1_0': 0.6511, 'acc_1_1': 0.9564, 'mean_acc': 0.7575}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.6739, 'acc_1_0': 0.6071, 'acc_1_1': 0.9603, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9705, 'worst_acc': 0.4893, 'acc_0_0': 0.9915, 'acc_0_1': 0.4893, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.4381, 'acc_0_0': 0.9814, 'acc_0_1': 0.4381, 'acc_1_0': 0.6807, 'acc_1_1': 0.9611, 'mean_acc': 0.7344}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6087, 'acc_0_0': 0.9911, 'acc_0_1': 0.6087, 'acc_1_0': 0.6607, 'acc_1_1': 0.9707, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5322, 'acc_0_0': 0.9915, 'acc_0_1': 0.5322, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.9547, 'worst_acc': 0.4878, 'acc_0_0': 0.9823, 'acc_0_1': 0.4878, 'acc_1_0': 0.6729, 'acc_1_1': 0.9595, 'mean_acc': 0.753}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.6902, 'acc_1_0': 0.6607, 'acc_1_1': 0.9688, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9742, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9559, 'worst_acc': 0.5627, 'acc_0_0': 0.9836, 'acc_0_1': 0.5627, 'acc_1_0': 0.6589, 'acc_1_1': 0.9486, 'mean_acc': 0.7799}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.992, 'acc_0_1': 0.6359, 'acc_1_0': 0.7321, 'acc_1_1': 0.9726, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.545, 'acc_0_0': 0.9818, 'acc_0_1': 0.545, 'acc_1_0': 0.6822, 'acc_1_1': 0.9564, 'mean_acc': 0.7758}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9926, 'acc_0_1': 0.6685, 'acc_1_0': 0.7679, 'acc_1_1': 0.9726, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6137, 'acc_0_0': 0.9915, 'acc_0_1': 0.6137, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5765, 'acc_0_0': 0.9827, 'acc_0_1': 0.5765, 'acc_1_0': 0.6822, 'acc_1_1': 0.947, 'mean_acc': 0.7874}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9688, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5583, 'acc_0_0': 0.9823, 'acc_0_1': 0.5583, 'acc_1_0': 0.6807, 'acc_1_1': 0.9533, 'mean_acc': 0.7806}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.9931, 'acc_0_1': 0.6793, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.588, 'acc_0_0': 0.9845, 'acc_0_1': 0.588, 'acc_1_0': 0.6729, 'acc_1_1': 0.9455, 'mean_acc': 0.7913}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.7857, 'acc_1_1': 0.9754, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6481, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6164, 'acc_0_0': 0.9863, 'acc_0_1': 0.6164, 'acc_1_0': 0.6667, 'acc_1_1': 0.9455, 'mean_acc': 0.8024}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6341, 'acc_0_0': 0.9876, 'acc_0_1': 0.6341, 'acc_1_0': 0.6667, 'acc_1_1': 0.9424, 'mean_acc': 0.8095}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9943, 'acc_0_1': 0.7337, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6511, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6511, 'acc_1_1': 0.9408, 'mean_acc': 0.816}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9957, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9785}
Val(class): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6381, 'acc_0_0': 0.9863, 'acc_0_1': 0.6381, 'acc_1_0': 0.6558, 'acc_1_1': 0.9486, 'mean_acc': 0.81}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.994, 'acc_0_1': 0.7283, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6438, 'acc_0_0': 0.9872, 'acc_0_1': 0.6438, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6266, 'acc_0_0': 0.9867, 'acc_0_1': 0.6266, 'acc_1_0': 0.6558, 'acc_1_1': 0.947, 'mean_acc': 0.8055}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9966, 'acc_0_1': 0.7826, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9707, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6741, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.8214}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9943, 'acc_0_1': 0.75, 'acc_1_0': 0.8571, 'acc_1_1': 0.9773, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9739, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6402, 'acc_0_0': 0.9876, 'acc_0_1': 0.6727, 'acc_1_0': 0.6402, 'acc_1_1': 0.9424, 'mean_acc': 0.8215}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9603, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6589, 'acc_0_0': 0.9871, 'acc_0_1': 0.6692, 'acc_1_0': 0.6589, 'acc_1_1': 0.9455, 'mean_acc': 0.8224}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9946, 'acc_0_1': 0.7283, 'acc_1_0': 0.8929, 'acc_1_1': 0.982, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6355, 'acc_0_0': 0.9867, 'acc_0_1': 0.6355, 'acc_1_0': 0.6495, 'acc_1_1': 0.9455, 'mean_acc': 0.8081}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.75, 'acc_1_1': 0.9716, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.7091, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8338}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5622, 'acc_0_0': 0.9786, 'acc_0_1': 0.5622, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5481, 'acc_0_0': 0.9823, 'acc_0_1': 0.5481, 'acc_1_0': 0.69, 'acc_1_1': 0.9533, 'mean_acc': 0.7777}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.996, 'acc_0_1': 0.788, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6542, 'acc_0_0': 0.9876, 'acc_0_1': 0.6621, 'acc_1_0': 0.6542, 'acc_1_1': 0.9393, 'mean_acc': 0.8186}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9951, 'acc_0_1': 0.7772, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.662, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8271}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.913, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.588, 'acc_0_0': 0.9872, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5969, 'acc_0_0': 0.9885, 'acc_0_1': 0.5969, 'acc_1_0': 0.6308, 'acc_1_1': 0.9486, 'mean_acc': 0.792}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.7857, 'acc_1_1': 0.9877, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6464, 'acc_0_0': 0.9871, 'acc_0_1': 0.7419, 'acc_1_0': 0.6464, 'acc_1_1': 0.9237, 'mean_acc': 0.8469}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9957, 'acc_0_1': 0.8641, 'acc_1_0': 0.9107, 'acc_1_1': 0.9858, 'mean_acc': 0.9875}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5701, 'acc_0_0': 0.9925, 'acc_0_1': 0.69, 'acc_1_0': 0.5701, 'acc_1_1': 0.9237, 'mean_acc': 0.8203}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.8913, 'acc_1_0': 0.875, 'acc_1_1': 0.9792, 'mean_acc': 0.9883}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7639, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.634, 'acc_0_0': 0.988, 'acc_0_1': 0.7698, 'acc_1_0': 0.634, 'acc_1_1': 0.9206, 'mean_acc': 0.8564}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9963, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.7317, 'acc_1_0': 0.5545, 'acc_1_1': 0.9252, 'mean_acc': 0.8353}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9974, 'acc_0_1': 0.8913, 'acc_1_0': 0.9286, 'acc_1_1': 0.983, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5997, 'acc_0_0': 0.9863, 'acc_0_1': 0.7375, 'acc_1_0': 0.5997, 'acc_1_1': 0.9252, 'mean_acc': 0.8398}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.7468, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.6558, 'acc_0_0': 0.9836, 'acc_0_1': 0.7353, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8443}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9991, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9801, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.588, 'acc_0_0': 0.9658, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5787, 'acc_0_0': 0.9792, 'acc_0_1': 0.5787, 'acc_1_0': 0.6963, 'acc_1_1': 0.9548, 'mean_acc': 0.7893}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5152, 'acc_0_0': 0.9742, 'acc_0_1': 0.8326, 'acc_1_0': 0.5152, 'acc_1_1': 0.6866, 'mean_acc': 0.8364}
Val(class)(new adapter): {'weighted_mean_acc': 0.8611, 'worst_acc': 0.5, 'acc_0_0': 0.9658, 'acc_0_1': 0.9742, 'acc_1_0': 0.7612, 'acc_1_1': 0.5, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8462, 'worst_acc': 0.4283, 'acc_0_0': 0.9663, 'acc_0_1': 0.9805, 'acc_1_0': 0.7882, 'acc_1_1': 0.4283, 'mean_acc': 0.8925}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3939, 'acc_0_0': 0.8326, 'acc_0_1': 0.7725, 'acc_1_0': 0.3939, 'acc_1_1': 0.7761, 'mean_acc': 0.7546}
Val(class)(new adapter): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.4549, 'acc_0_0': 0.9872, 'acc_0_1': 0.4549, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.725}
Test(class)(new adapter): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.4479, 'acc_0_0': 0.992, 'acc_0_1': 0.4479, 'acc_1_0': 0.528, 'acc_1_1': 0.9595, 'mean_acc': 0.7252}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5758, 'acc_0_0': 0.9914, 'acc_0_1': 0.7897, 'acc_1_0': 0.5758, 'acc_1_1': 0.7761, 'mean_acc': 0.8431}
Val(class)(new adapter): {'weighted_mean_acc': 0.8324, 'worst_acc': 0.4697, 'acc_0_0': 0.9359, 'acc_0_1': 0.9614, 'acc_1_0': 0.791, 'acc_1_1': 0.4697, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8427, 'worst_acc': 0.4548, 'acc_0_0': 0.9543, 'acc_0_1': 0.9588, 'acc_1_0': 0.8115, 'acc_1_1': 0.4548, 'mean_acc': 0.8849}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1642, 'acc_0_0': 0.867, 'acc_0_1': 0.9142, 'acc_1_0': 0.803, 'acc_1_1': 0.1642, 'mean_acc': 0.7997}
Val(class)(new adapter): {'weighted_mean_acc': 0.8893, 'worst_acc': 0.7682, 'acc_0_0': 0.8761, 'acc_0_1': 0.7682, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.8637, 'worst_acc': 0.7827, 'acc_0_0': 0.8541, 'acc_0_1': 0.7827, 'acc_1_0': 0.8879, 'acc_1_1': 0.9081, 'mean_acc': 0.836}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.867, 'acc_0_0': 0.867, 'acc_0_1': 0.927, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.8507, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.8507, 'acc_1_1': 0.8788, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.8489, 'acc_0_0': 0.9463, 'acc_0_1': 0.9126, 'acc_1_0': 0.8505, 'acc_1_1': 0.8489, 'mean_acc': 0.9118}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4925, 'acc_0_0': 0.9056, 'acc_0_1': 0.9442, 'acc_1_0': 0.5758, 'acc_1_1': 0.4925, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.8209, 'acc_0_0': 0.9487, 'acc_0_1': 0.8755, 'acc_1_0': 0.8209, 'acc_1_1': 0.9394, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.943, 'worst_acc': 0.8255, 'acc_0_0': 0.9601, 'acc_0_1': 0.8643, 'acc_1_0': 0.8255, 'acc_1_1': 0.9065, 'mean_acc': 0.902}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.97, 'acc_0_1': 0.9657, 'acc_1_0': 0.7879, 'acc_1_1': 0.9552, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9346, 'worst_acc': 0.7339, 'acc_0_0': 0.9359, 'acc_0_1': 0.7339, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class)(new adapter): {'weighted_mean_acc': 0.9318, 'worst_acc': 0.7765, 'acc_0_0': 0.9379, 'acc_0_1': 0.7765, 'acc_1_0': 0.8333, 'acc_1_1': 0.9439, 'mean_acc': 0.8642}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9657, 'acc_0_1': 0.8927, 'acc_1_0': 0.8788, 'acc_1_1': 0.6716, 'mean_acc': 0.8948}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7811, 'acc_0_0': 0.9145, 'acc_0_1': 0.7811, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.8067, 'acc_0_0': 0.9011, 'acc_0_1': 0.8067, 'acc_1_0': 0.8598, 'acc_1_1': 0.9268, 'mean_acc': 0.8626}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9614, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.8939, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.8333, 'acc_0_0': 0.9246, 'acc_0_1': 0.8984, 'acc_1_0': 0.8333, 'acc_1_1': 0.8427, 'mean_acc': 0.8952}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9185, 'acc_0_1': 0.9914, 'acc_1_0': 0.8333, 'acc_1_1': 0.8358, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.6567, 'acc_0_0': 0.953, 'acc_0_1': 0.9056, 'acc_1_0': 0.6567, 'acc_1_1': 0.8182, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7118, 'acc_0_0': 0.9769, 'acc_0_1': 0.918, 'acc_1_0': 0.7118, 'acc_1_1': 0.7882, 'mean_acc': 0.9037}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.7576, 'acc_1_1': 0.9552, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9241, 'worst_acc': 0.7882, 'acc_0_0': 0.965, 'acc_0_1': 0.9259, 'acc_1_0': 0.7882, 'acc_1_1': 0.796, 'mean_acc': 0.9115}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9785, 'acc_0_1': 0.9442, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.8197, 'acc_0_0': 0.9103, 'acc_0_1': 0.8197, 'acc_1_0': 0.8806, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8823, 'worst_acc': 0.835, 'acc_0_0': 0.8856, 'acc_0_1': 0.835, 'acc_1_0': 0.8769, 'acc_1_1': 0.8801, 'mean_acc': 0.8643}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9657, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.8541, 'acc_0_0': 0.9145, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8795, 'worst_acc': 0.8349, 'acc_0_0': 0.894, 'acc_0_1': 0.8643, 'acc_1_0': 0.8676, 'acc_1_1': 0.8349, 'mean_acc': 0.873}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9552, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.8841, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.7882, 'acc_0_0': 0.9348, 'acc_0_1': 0.9051, 'acc_1_0': 0.824, 'acc_1_1': 0.7882, 'mean_acc': 0.8947}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.7492, 'acc_0_0': 0.9521, 'acc_0_1': 0.9264, 'acc_1_0': 0.7819, 'acc_1_1': 0.7492, 'mean_acc': 0.9008}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9069, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.7586, 'acc_0_0': 0.9432, 'acc_0_1': 0.9237, 'acc_1_0': 0.7928, 'acc_1_1': 0.7586, 'mean_acc': 0.8985}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8933, 'worst_acc': 0.7664, 'acc_0_0': 0.9317, 'acc_0_1': 0.9188, 'acc_1_0': 0.8037, 'acc_1_1': 0.7664, 'mean_acc': 0.8942}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7788, 'acc_0_0': 0.9459, 'acc_0_1': 0.9184, 'acc_1_0': 0.7788, 'acc_1_1': 0.7835, 'mean_acc': 0.8987}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7399, 'acc_0_0': 0.9623, 'acc_0_1': 0.9259, 'acc_1_0': 0.7399, 'acc_1_1': 0.7648, 'mean_acc': 0.9016}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7555, 'acc_0_0': 0.9614, 'acc_0_1': 0.9237, 'acc_1_0': 0.7555, 'acc_1_1': 0.7788, 'mean_acc': 0.9037}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7523, 'acc_0_0': 0.9614, 'acc_0_1': 0.9277, 'acc_1_0': 0.7523, 'acc_1_1': 0.7757, 'mean_acc': 0.9046}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7492, 'acc_0_0': 0.9627, 'acc_0_1': 0.9304, 'acc_1_0': 0.7492, 'acc_1_1': 0.7757, 'mean_acc': 0.9058}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7523, 'acc_0_0': 0.9601, 'acc_0_1': 0.9295, 'acc_1_0': 0.7523, 'acc_1_1': 0.771, 'mean_acc': 0.9042}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7399, 'acc_0_0': 0.961, 'acc_0_1': 0.9322, 'acc_1_0': 0.7399, 'acc_1_1': 0.771, 'mean_acc': 0.9042}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9326, 'acc_1_0': 0.757, 'acc_1_1': 0.7586, 'mean_acc': 0.9033}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.771, 'acc_0_0': 0.9446, 'acc_0_1': 0.9259, 'acc_1_0': 0.785, 'acc_1_1': 0.771, 'mean_acc': 0.9004}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.7492, 'acc_0_0': 0.949, 'acc_0_1': 0.9304, 'acc_1_0': 0.7741, 'acc_1_1': 0.7492, 'mean_acc': 0.9002}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7445, 'acc_0_0': 0.9619, 'acc_0_1': 0.9361, 'acc_1_0': 0.7445, 'acc_1_1': 0.7461, 'mean_acc': 0.9039}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9204, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7134, 'acc_0_0': 0.9725, 'acc_0_1': 0.9419, 'acc_1_0': 0.7134, 'acc_1_1': 0.7368, 'mean_acc': 0.9058}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7399, 'acc_0_0': 0.9712, 'acc_0_1': 0.9375, 'acc_1_0': 0.7399, 'acc_1_1': 0.7648, 'mean_acc': 0.9096}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7819, 'acc_0_0': 0.9623, 'acc_0_1': 0.9295, 'acc_1_0': 0.7819, 'acc_1_1': 0.7835, 'mean_acc': 0.9097}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7227, 'acc_0_0': 0.9676, 'acc_0_1': 0.9468, 'acc_1_0': 0.7617, 'acc_1_1': 0.7227, 'mean_acc': 0.9096}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.662, 'acc_0_0': 0.965, 'acc_0_1': 0.9557, 'acc_1_0': 0.7632, 'acc_1_1': 0.662, 'mean_acc': 0.9054}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.6866, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.648, 'acc_0_0': 0.9663, 'acc_0_1': 0.957, 'acc_1_0': 0.7477, 'acc_1_1': 0.648, 'mean_acc': 0.9032}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.7727, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.6589, 'acc_0_0': 0.9685, 'acc_0_1': 0.9525, 'acc_1_0': 0.7321, 'acc_1_1': 0.6589, 'mean_acc': 0.9018}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7025, 'acc_0_0': 0.9645, 'acc_0_1': 0.9463, 'acc_1_0': 0.7477, 'acc_1_1': 0.7025, 'mean_acc': 0.9044}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.743, 'acc_0_0': 0.961, 'acc_0_1': 0.9317, 'acc_1_0': 0.7648, 'acc_1_1': 0.743, 'mean_acc': 0.9037}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9132, 'worst_acc': 0.7664, 'acc_0_0': 0.9592, 'acc_0_1': 0.9233, 'acc_1_0': 0.7804, 'acc_1_1': 0.7664, 'mean_acc': 0.904}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7788, 'acc_0_0': 0.957, 'acc_0_1': 0.9197, 'acc_1_0': 0.7866, 'acc_1_1': 0.7788, 'mean_acc': 0.9039}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.785, 'acc_0_0': 0.9579, 'acc_0_1': 0.9184, 'acc_1_0': 0.7882, 'acc_1_1': 0.785, 'mean_acc': 0.9046}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7866, 'acc_0_0': 0.9583, 'acc_0_1': 0.9188, 'acc_1_0': 0.7882, 'acc_1_1': 0.7866, 'mean_acc': 0.9051}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.785, 'acc_0_0': 0.9592, 'acc_0_1': 0.9197, 'acc_1_0': 0.7882, 'acc_1_1': 0.785, 'mean_acc': 0.9056}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.785, 'acc_0_0': 0.9588, 'acc_0_1': 0.9197, 'acc_1_0': 0.7897, 'acc_1_1': 0.785, 'mean_acc': 0.9056}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7804, 'acc_0_0': 0.9574, 'acc_0_1': 0.9188, 'acc_1_0': 0.7928, 'acc_1_1': 0.7804, 'mean_acc': 0.9046}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7726, 'acc_0_0': 0.9592, 'acc_0_1': 0.9228, 'acc_1_0': 0.7897, 'acc_1_1': 0.7726, 'mean_acc': 0.9056}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7648, 'acc_0_0': 0.9614, 'acc_0_1': 0.9273, 'acc_1_0': 0.7819, 'acc_1_1': 0.7648, 'mean_acc': 0.9065}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7555, 'acc_0_0': 0.9641, 'acc_0_1': 0.9295, 'acc_1_0': 0.7679, 'acc_1_1': 0.7555, 'mean_acc': 0.9058}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7586, 'acc_0_0': 0.965, 'acc_0_1': 0.9308, 'acc_1_0': 0.7648, 'acc_1_1': 0.7586, 'mean_acc': 0.9066}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7679, 'acc_0_0': 0.9619, 'acc_0_1': 0.9304, 'acc_1_0': 0.771, 'acc_1_1': 0.7679, 'mean_acc': 0.907}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7679, 'acc_0_0': 0.9605, 'acc_0_1': 0.9299, 'acc_1_0': 0.7741, 'acc_1_1': 0.7679, 'mean_acc': 0.9066}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7695, 'acc_0_0': 0.9579, 'acc_0_1': 0.9273, 'acc_1_0': 0.7788, 'acc_1_1': 0.7695, 'mean_acc': 0.9052}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7726, 'acc_0_0': 0.9574, 'acc_0_1': 0.9251, 'acc_1_0': 0.7757, 'acc_1_1': 0.7726, 'mean_acc': 0.9042}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7648, 'acc_0_0': 0.9579, 'acc_0_1': 0.9286, 'acc_1_0': 0.7757, 'acc_1_1': 0.7648, 'mean_acc': 0.9049}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7664, 'acc_0_0': 0.9561, 'acc_0_1': 0.9277, 'acc_1_0': 0.7804, 'acc_1_1': 0.7664, 'mean_acc': 0.9046}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7648, 'acc_0_0': 0.9592, 'acc_0_1': 0.9295, 'acc_1_0': 0.7741, 'acc_1_1': 0.7648, 'mean_acc': 0.9056}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7648, 'acc_0_0': 0.9596, 'acc_0_1': 0.9286, 'acc_1_0': 0.7741, 'acc_1_1': 0.7648, 'mean_acc': 0.9054}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7664, 'acc_0_0': 0.9596, 'acc_0_1': 0.9277, 'acc_1_0': 0.7757, 'acc_1_1': 0.7664, 'mean_acc': 0.9054}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7679, 'acc_0_0': 0.9601, 'acc_0_1': 0.9264, 'acc_1_0': 0.7741, 'acc_1_1': 0.7679, 'mean_acc': 0.9051}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7664, 'acc_0_0': 0.9601, 'acc_0_1': 0.9286, 'acc_1_0': 0.7741, 'acc_1_1': 0.7664, 'mean_acc': 0.9058}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7632, 'acc_0_0': 0.9601, 'acc_0_1': 0.9282, 'acc_1_0': 0.7741, 'acc_1_1': 0.7632, 'mean_acc': 0.9052}
========================================================================
> end of training. 

best epoch : 53
best training accuracy on [class]: {'worst_acc': 0.9545, 'acc_0_0': 0.9657, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.98}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9006, 'worst_acc': 0.8541, 'acc_0_0': 0.9145, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
best test accuracy on [class]: {'weighted_mean_acc': 0.8795, 'worst_acc': 0.8349, 'acc_0_0': 0.894, 'acc_0_1': 0.8643, 'acc_1_0': 0.8676, 'acc_1_1': 0.8349, 'mean_acc': 0.873}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8795, 'worst_acc': 0.8349, 'acc_0_0': 0.894, 'acc_0_1': 0.8643, 'acc_1_0': 0.8676, 'acc_1_1': 0.8349, 'mean_acc': 0.873}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5498, 'acc_0_0': 0.9774, 'acc_0_1': 0.8186, 'acc_1_0': 0.5498, 'acc_1_1': 0.9673, 'mean_acc': 0.8671}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 53': {'Train': {'worst_acc': 0.9545, 'acc_0_0': 0.9657, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.98}, 'Val': {'weighted_mean_acc': 0.9006, 'worst_acc': 0.8541, 'acc_0_0': 0.9145, 'acc_0_1': 0.8541, 'acc_1_0': 0.8806, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}, 'Test': {'weighted_mean_acc': 0.8795, 'worst_acc': 0.8349, 'acc_0_0': 0.894, 'acc_0_1': 0.8643, 'acc_1_0': 0.8676, 'acc_1_1': 0.8349, 'mean_acc': 0.873}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8795, 'worst_acc': 0.8349, 'acc_0_0': 0.894, 'acc_0_1': 0.8643, 'acc_1_0': 0.8676, 'acc_1_1': 0.8349, 'mean_acc': 0.873}, 'spurious': {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5498, 'acc_0_0': 0.9774, 'acc_0_1': 0.8186, 'acc_1_0': 0.5498, 'acc_1_1': 0.9673, 'mean_acc': 0.8671}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9048, 'acc_0_1': 0.8967, 'acc_1_0': 0.0714, 'acc_1_1': 0.1485, 'mean_acc': 0.7281}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9983, 'acc_0_1': 0.8424, 'acc_1_0': 0.0714, 'acc_1_1': 0.3226, 'mean_acc': 0.8325}
Val(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7017}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3481, 'acc_0_0': 0.9845, 'acc_0_1': 0.3481, 'acc_1_0': 0.4408, 'acc_1_1': 0.9595, 'mean_acc': 0.6738}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3315, 'acc_0_0': 0.9826, 'acc_0_1': 0.3315, 'acc_1_0': 0.4643, 'acc_1_1': 0.9612, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.515, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7517}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.4745, 'acc_0_0': 0.9902, 'acc_0_1': 0.4745, 'acc_1_0': 0.4875, 'acc_1_1': 0.947, 'mean_acc': 0.729}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9977, 'acc_0_1': 0.7283, 'acc_1_0': 0.3214, 'acc_1_1': 0.9026, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5202, 'acc_0_0': 0.9849, 'acc_0_1': 0.5202, 'acc_1_0': 0.6449, 'acc_1_1': 0.9486, 'mean_acc': 0.7623}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5435, 'acc_0_0': 0.9746, 'acc_0_1': 0.5435, 'acc_1_0': 0.6964, 'acc_1_1': 0.965, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.4776, 'acc_0_0': 0.9915, 'acc_0_1': 0.824, 'acc_1_0': 0.4776, 'acc_1_1': 0.8636, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.5421, 'acc_0_0': 0.9929, 'acc_0_1': 0.8381, 'acc_1_0': 0.5421, 'acc_1_1': 0.8567, 'mean_acc': 0.8676}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7554, 'acc_1_0': 0.625, 'acc_1_1': 0.9319, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5389, 'acc_0_0': 0.9925, 'acc_0_1': 0.6457, 'acc_1_0': 0.5389, 'acc_1_1': 0.9377, 'mean_acc': 0.8012}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9903, 'acc_0_1': 0.5109, 'acc_1_0': 0.7143, 'acc_1_1': 0.9763, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.77}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4851, 'acc_0_0': 0.9898, 'acc_0_1': 0.4851, 'acc_1_0': 0.5748, 'acc_1_1': 0.9595, 'mean_acc': 0.744}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.996, 'acc_0_1': 0.6304, 'acc_1_0': 0.5179, 'acc_1_1': 0.965, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.4989, 'acc_0_0': 0.988, 'acc_0_1': 0.4989, 'acc_1_0': 0.5857, 'acc_1_1': 0.9564, 'mean_acc': 0.7496}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5815, 'acc_0_0': 0.99, 'acc_0_1': 0.5815, 'acc_1_0': 0.625, 'acc_1_1': 0.9782, 'mean_acc': 0.9675}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5408, 'acc_0_0': 0.9915, 'acc_0_1': 0.5408, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.4989, 'acc_0_0': 0.9836, 'acc_0_1': 0.4989, 'acc_1_0': 0.6776, 'acc_1_1': 0.9611, 'mean_acc': 0.7585}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.994, 'acc_0_1': 0.6848, 'acc_1_0': 0.75, 'acc_1_1': 0.964, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6922, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8255}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9723}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6609, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6173, 'acc_0_0': 0.9863, 'acc_0_1': 0.6173, 'acc_1_0': 0.6558, 'acc_1_1': 0.9502, 'mean_acc': 0.802}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9909, 'acc_0_1': 0.6902, 'acc_1_0': 0.75, 'acc_1_1': 0.9735, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5607, 'acc_0_0': 0.9916, 'acc_0_1': 0.7144, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8291}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.7143, 'acc_1_1': 0.964, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.567, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.567, 'acc_1_1': 0.9346, 'mean_acc': 0.824}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9946, 'acc_0_1': 0.7065, 'acc_1_0': 0.7857, 'acc_1_1': 0.9801, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5576, 'acc_0_0': 0.9925, 'acc_0_1': 0.7561, 'acc_1_0': 0.5576, 'acc_1_1': 0.9268, 'mean_acc': 0.845}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9966, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.7557, 'acc_1_0': 0.5794, 'acc_1_1': 0.9315, 'mean_acc': 0.8479}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8043, 'acc_0_0': 0.9954, 'acc_0_1': 0.8043, 'acc_1_0': 0.8393, 'acc_1_1': 0.9716, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7525, 'acc_1_0': 0.5841, 'acc_1_1': 0.9299, 'mean_acc': 0.8469}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9971, 'acc_0_1': 0.8967, 'acc_1_0': 0.7143, 'acc_1_1': 0.9565, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.9808, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.6581, 'acc_1_0': 0.5545, 'acc_1_1': 0.9455, 'mean_acc': 0.8089}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6739, 'acc_0_0': 0.9954, 'acc_0_1': 0.6739, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6184, 'acc_0_0': 0.9885, 'acc_0_1': 0.7348, 'acc_1_0': 0.6184, 'acc_1_1': 0.9237, 'mean_acc': 0.8416}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.7419, 'acc_1_0': 0.5312, 'acc_1_1': 0.9252, 'mean_acc': 0.8369}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9977, 'acc_0_1': 0.837, 'acc_1_0': 0.8929, 'acc_1_1': 0.9905, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.6953, 'acc_0_0': 0.9829, 'acc_0_1': 0.6953, 'acc_1_0': 0.7015, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6604, 'acc_0_0': 0.9885, 'acc_0_1': 0.6931, 'acc_1_0': 0.6604, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5903, 'acc_0_0': 0.9916, 'acc_0_1': 0.6807, 'acc_1_0': 0.5903, 'acc_1_1': 0.9424, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8859, 'acc_0_0': 0.9989, 'acc_0_1': 0.8859, 'acc_1_0': 0.9107, 'acc_1_1': 0.9905, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8297, 'acc_1_0': 0.5779, 'acc_1_1': 0.9065, 'mean_acc': 0.8735}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8929, 'acc_1_1': 0.9839, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.6309, 'acc_0_0': 0.9829, 'acc_0_1': 0.6309, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5997, 'acc_0_0': 0.9911, 'acc_0_1': 0.6106, 'acc_1_0': 0.5997, 'acc_1_1': 0.9564, 'mean_acc': 0.7958}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.8283, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.8355, 'acc_1_0': 0.6168, 'acc_1_1': 0.8972, 'mean_acc': 0.8781}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4564, 'acc_0_0': 0.9973, 'acc_0_1': 0.7246, 'acc_1_0': 0.4564, 'acc_1_1': 0.9252, 'mean_acc': 0.8233}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.5672, 'acc_0_0': 0.9829, 'acc_0_1': 0.8369, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5343, 'acc_0_0': 0.9929, 'acc_0_1': 0.8373, 'acc_1_0': 0.5343, 'acc_1_1': 0.8988, 'mean_acc': 0.8711}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9986, 'acc_0_1': 0.9728, 'acc_1_0': 1.0, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.618, 'acc_0_0': 0.9744, 'acc_0_1': 0.618, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.596, 'acc_0_0': 0.9854, 'acc_0_1': 0.596, 'acc_1_0': 0.6293, 'acc_1_1': 0.9533, 'mean_acc': 0.7908}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9107, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7768, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5545, 'acc_0_0': 0.9929, 'acc_0_1': 0.7694, 'acc_1_0': 0.5545, 'acc_1_1': 0.9268, 'mean_acc': 0.85}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5821, 'acc_0_0': 0.9658, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6106, 'acc_0_0': 0.984, 'acc_0_1': 0.6945, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9953, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.9876, 'acc_0_1': 0.6732, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8198}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.609, 'acc_1_1': 0.9455, 'mean_acc': 0.8202}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.6266, 'acc_0_0': 0.9274, 'acc_0_1': 0.6266, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.6093, 'acc_0_0': 0.9392, 'acc_0_1': 0.6093, 'acc_1_0': 0.7928, 'acc_1_1': 0.9595, 'mean_acc': 0.7969}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9991, 'acc_0_1': 0.8804, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6119, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6231, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6231, 'acc_1_1': 0.9299, 'mean_acc': 0.8371}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9837, 'acc_1_0': 0.9464, 'acc_1_1': 0.983, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.472, 'acc_0_0': 0.9938, 'acc_0_1': 0.745, 'acc_1_0': 0.472, 'acc_1_1': 0.9174, 'mean_acc': 0.8307}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9989, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9962, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.8026, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.6293, 'acc_0_0': 0.9805, 'acc_0_1': 0.8009, 'acc_1_0': 0.6293, 'acc_1_1': 0.8925, 'mean_acc': 0.8619}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9293, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6567, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6231, 'acc_0_0': 0.9889, 'acc_0_1': 0.714, 'acc_1_0': 0.6231, 'acc_1_1': 0.933, 'mean_acc': 0.8352}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5075, 'acc_1_1': 0.8939, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5016, 'acc_0_0': 0.9956, 'acc_0_1': 0.8483, 'acc_1_0': 0.5016, 'acc_1_1': 0.8785, 'mean_acc': 0.8706}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9713, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8197, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5421, 'acc_0_0': 0.9894, 'acc_0_1': 0.8084, 'acc_1_0': 0.5421, 'acc_1_1': 0.9003, 'mean_acc': 0.8595}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 0.9997, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.5522, 'acc_0_0': 0.9786, 'acc_0_1': 0.6695, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.553, 'acc_0_0': 0.988, 'acc_0_1': 0.639, 'acc_1_0': 0.553, 'acc_1_1': 0.9424, 'mean_acc': 0.7989}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5303, 'acc_0_0': 0.9828, 'acc_0_1': 0.8412, 'acc_1_0': 0.5303, 'acc_1_1': 0.7164, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.81, 'acc_0_0': 0.9481, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.81, 'mean_acc': 0.9078}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2727, 'acc_0_0': 0.8841, 'acc_0_1': 0.7339, 'acc_1_0': 0.2727, 'acc_1_1': 0.791, 'mean_acc': 0.7479}
Val(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.2275, 'acc_0_0': 0.9231, 'acc_0_1': 0.2275, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.65}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.2341, 'acc_0_0': 0.9353, 'acc_0_1': 0.2341, 'acc_1_0': 0.796, 'acc_1_1': 0.9938, 'mean_acc': 0.6534}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9871, 'acc_0_1': 0.7296, 'acc_1_0': 0.6667, 'acc_1_1': 0.8806, 'mean_acc': 0.8397}
Val(class)(new adapter): {'weighted_mean_acc': 0.8131, 'worst_acc': 0.3788, 'acc_0_0': 0.9359, 'acc_0_1': 0.97, 'acc_1_0': 0.8209, 'acc_1_1': 0.3788, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8227, 'worst_acc': 0.3894, 'acc_0_0': 0.9463, 'acc_0_1': 0.9743, 'acc_1_0': 0.7835, 'acc_1_1': 0.3894, 'mean_acc': 0.8775}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0299, 'acc_0_0': 0.8712, 'acc_0_1': 0.9528, 'acc_1_0': 0.8485, 'acc_1_1': 0.0299, 'mean_acc': 0.8063}
Val(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.8584, 'acc_0_0': 0.8889, 'acc_0_1': 0.8584, 'acc_1_0': 0.8955, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8919, 'worst_acc': 0.8435, 'acc_0_0': 0.8945, 'acc_0_1': 0.8435, 'acc_1_0': 0.8754, 'acc_1_1': 0.8925, 'mean_acc': 0.8723}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9099, 'acc_0_1': 0.9313, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.8507, 'acc_0_0': 0.9487, 'acc_0_1': 0.8884, 'acc_1_0': 0.8507, 'acc_1_1': 0.9394, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.8255, 'acc_0_0': 0.953, 'acc_0_1': 0.8825, 'acc_1_0': 0.8255, 'acc_1_1': 0.8972, 'mean_acc': 0.9052}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4776, 'acc_0_0': 0.9442, 'acc_0_1': 0.9828, 'acc_1_0': 0.7576, 'acc_1_1': 0.4776, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.6824, 'acc_0_0': 0.9274, 'acc_0_1': 0.6824, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.6976, 'acc_0_0': 0.9388, 'acc_0_1': 0.6976, 'acc_1_0': 0.8442, 'acc_1_1': 0.9408, 'mean_acc': 0.8347}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9785, 'acc_0_1': 0.9099, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9382}
Val(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7854, 'acc_0_0': 0.9103, 'acc_0_1': 0.7854, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.8067, 'acc_0_0': 0.9264, 'acc_0_1': 0.8067, 'acc_1_0': 0.8411, 'acc_1_1': 0.9252, 'mean_acc': 0.8702}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6119, 'acc_0_0': 0.9399, 'acc_0_1': 0.9442, 'acc_1_0': 0.8939, 'acc_1_1': 0.6119, 'mean_acc': 0.8998}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.791, 'acc_0_0': 0.8974, 'acc_0_1': 0.8798, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.8474, 'acc_0_0': 0.9082, 'acc_0_1': 0.8856, 'acc_1_0': 0.8474, 'acc_1_1': 0.8676, 'mean_acc': 0.8882}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7463, 'acc_0_0': 0.9145, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.8022, 'acc_0_0': 0.9397, 'acc_0_1': 0.9175, 'acc_1_0': 0.8022, 'acc_1_1': 0.8396, 'mean_acc': 0.9047}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9657, 'acc_0_1': 0.9785, 'acc_1_0': 0.8939, 'acc_1_1': 0.9254, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9336, 'worst_acc': 0.6418, 'acc_0_0': 0.9573, 'acc_0_1': 0.8884, 'acc_1_0': 0.6418, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9436, 'worst_acc': 0.6698, 'acc_0_0': 0.9796, 'acc_0_1': 0.9135, 'acc_1_0': 0.6698, 'acc_1_1': 0.8442, 'mean_acc': 0.9046}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9377, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.8884, 'acc_1_0': 0.6866, 'acc_1_1': 0.9091, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9332, 'worst_acc': 0.7461, 'acc_0_0': 0.9654, 'acc_0_1': 0.9078, 'acc_1_0': 0.7461, 'acc_1_1': 0.8411, 'mean_acc': 0.9049}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.8798, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.8037, 'acc_0_0': 0.9228, 'acc_0_1': 0.9153, 'acc_1_0': 0.824, 'acc_1_1': 0.8037, 'mean_acc': 0.8958}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8919, 'worst_acc': 0.7773, 'acc_0_0': 0.9259, 'acc_0_1': 0.929, 'acc_1_0': 0.81, 'acc_1_1': 0.7773, 'mean_acc': 0.8978}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9828, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7695, 'acc_0_0': 0.9614, 'acc_0_1': 0.9264, 'acc_1_0': 0.7695, 'acc_1_1': 0.7819, 'mean_acc': 0.9066}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9227, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7321, 'acc_0_0': 0.9725, 'acc_0_1': 0.9268, 'acc_1_0': 0.7321, 'acc_1_1': 0.7648, 'mean_acc': 0.9051}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.6716, 'acc_0_0': 0.953, 'acc_0_1': 0.9099, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7352, 'acc_0_0': 0.9676, 'acc_0_1': 0.9171, 'acc_1_0': 0.7352, 'acc_1_1': 0.7897, 'mean_acc': 0.9025}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.743, 'acc_0_0': 0.961, 'acc_0_1': 0.9197, 'acc_1_0': 0.743, 'acc_1_1': 0.7741, 'mean_acc': 0.9001}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7414, 'acc_0_0': 0.9601, 'acc_0_1': 0.9242, 'acc_1_0': 0.7414, 'acc_1_1': 0.7679, 'mean_acc': 0.9006}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.6716, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.6716, 'acc_1_1': 0.803, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7165, 'acc_0_0': 0.9672, 'acc_0_1': 0.9432, 'acc_1_0': 0.7165, 'acc_1_1': 0.7383, 'mean_acc': 0.9047}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9403, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.7352, 'acc_0_0': 0.9627, 'acc_0_1': 0.9295, 'acc_1_0': 0.7352, 'acc_1_1': 0.7664, 'mean_acc': 0.9028}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.7648, 'acc_0_0': 0.9579, 'acc_0_1': 0.933, 'acc_1_0': 0.7648, 'acc_1_1': 0.7928, 'mean_acc': 0.9085}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.6567, 'acc_0_0': 0.9573, 'acc_0_1': 0.9528, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.6698, 'acc_0_0': 0.9805, 'acc_0_1': 0.9627, 'acc_1_0': 0.6698, 'acc_1_1': 0.6869, 'mean_acc': 0.9066}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.6269, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.6269, 'acc_1_1': 0.7424, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.896, 'worst_acc': 0.6308, 'acc_0_0': 0.9765, 'acc_0_1': 0.9632, 'acc_1_0': 0.6542, 'acc_1_1': 0.6308, 'mean_acc': 0.8973}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9254, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8976, 'worst_acc': 0.8006, 'acc_0_0': 0.9273, 'acc_0_1': 0.9188, 'acc_1_0': 0.8053, 'acc_1_1': 0.8006, 'mean_acc': 0.8964}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8845, 'worst_acc': 0.7761, 'acc_0_0': 0.8889, 'acc_0_1': 0.867, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.8396, 'acc_0_0': 0.9144, 'acc_0_1': 0.9033, 'acc_1_0': 0.8427, 'acc_1_1': 0.8396, 'mean_acc': 0.8939}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9323, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.7679, 'acc_0_0': 0.9667, 'acc_0_1': 0.9313, 'acc_1_0': 0.7679, 'acc_1_1': 0.796, 'mean_acc': 0.912}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9331, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9485, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7072, 'acc_0_0': 0.98, 'acc_0_1': 0.9565, 'acc_1_0': 0.7072, 'acc_1_1': 0.7072, 'mean_acc': 0.9104}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7741, 'acc_0_0': 0.9503, 'acc_0_1': 0.937, 'acc_1_0': 0.7741, 'acc_1_1': 0.7773, 'mean_acc': 0.9065}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.8115, 'acc_0_0': 0.9295, 'acc_0_1': 0.9366, 'acc_1_0': 0.8115, 'acc_1_1': 0.8131, 'mean_acc': 0.9063}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9272, 'worst_acc': 0.6866, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9348, 'worst_acc': 0.7103, 'acc_0_0': 0.9787, 'acc_0_1': 0.9481, 'acc_1_0': 0.7103, 'acc_1_1': 0.7991, 'mean_acc': 0.9172}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.97, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.97, 'acc_1_0': 0.7015, 'acc_1_1': 0.7727, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8963, 'worst_acc': 0.6589, 'acc_0_0': 0.9672, 'acc_0_1': 0.9619, 'acc_1_0': 0.7368, 'acc_1_1': 0.6589, 'mean_acc': 0.9054}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9828, 'acc_0_1': 0.9442, 'acc_1_0': 0.9697, 'acc_1_1': 0.8507, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7461, 'acc_0_0': 0.9561, 'acc_0_1': 0.9295, 'acc_1_0': 0.7788, 'acc_1_1': 0.7461, 'mean_acc': 0.9028}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.8197, 'acc_0_0': 0.9145, 'acc_0_1': 0.8197, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.8318, 'acc_0_0': 0.9317, 'acc_0_1': 0.8381, 'acc_1_0': 0.8318, 'acc_1_1': 0.8863, 'mean_acc': 0.8792}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9399, 'acc_0_1': 0.9871, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.8971, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.867, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8968, 'worst_acc': 0.7835, 'acc_0_0': 0.933, 'acc_0_1': 0.8882, 'acc_1_0': 0.8022, 'acc_1_1': 0.7835, 'mean_acc': 0.8845}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.803, 'acc_1_1': 0.9552, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.715, 'acc_0_0': 0.9521, 'acc_0_1': 0.9428, 'acc_1_0': 0.8006, 'acc_1_1': 0.715, 'mean_acc': 0.9054}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 1.0, 'acc_0_1': 0.9313, 'acc_1_0': 1.0, 'acc_1_1': 0.8507, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7477, 'acc_0_0': 0.9521, 'acc_0_1': 0.9317, 'acc_1_0': 0.8084, 'acc_1_1': 0.7477, 'mean_acc': 0.9056}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7695, 'acc_0_0': 0.9468, 'acc_0_1': 0.9282, 'acc_1_0': 0.8131, 'acc_1_1': 0.7695, 'mean_acc': 0.9051}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 1.0, 'acc_1_1': 0.9403, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7835, 'acc_0_0': 0.9428, 'acc_0_1': 0.9237, 'acc_1_0': 0.8131, 'acc_1_1': 0.7835, 'mean_acc': 0.9033}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7835, 'acc_0_0': 0.9437, 'acc_0_1': 0.9233, 'acc_1_0': 0.8131, 'acc_1_1': 0.7835, 'mean_acc': 0.9035}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.785, 'acc_0_0': 0.9472, 'acc_0_1': 0.9211, 'acc_1_0': 0.8084, 'acc_1_1': 0.785, 'mean_acc': 0.9037}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7741, 'acc_0_0': 0.9534, 'acc_0_1': 0.9313, 'acc_1_0': 0.7944, 'acc_1_1': 0.7741, 'mean_acc': 0.9073}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9914, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7741, 'acc_0_0': 0.9579, 'acc_0_1': 0.9317, 'acc_1_0': 0.7897, 'acc_1_1': 0.7741, 'mean_acc': 0.9087}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7632, 'acc_0_0': 0.961, 'acc_0_1': 0.9375, 'acc_1_0': 0.7788, 'acc_1_1': 0.7632, 'mean_acc': 0.9097}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7648, 'acc_0_0': 0.9619, 'acc_0_1': 0.9375, 'acc_1_0': 0.7757, 'acc_1_1': 0.7648, 'mean_acc': 0.9099}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7726, 'acc_0_0': 0.9579, 'acc_0_1': 0.9335, 'acc_1_0': 0.7866, 'acc_1_1': 0.7726, 'mean_acc': 0.9089}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.771, 'acc_0_0': 0.9588, 'acc_0_1': 0.933, 'acc_1_0': 0.7804, 'acc_1_1': 0.771, 'mean_acc': 0.9082}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7726, 'acc_0_0': 0.9565, 'acc_0_1': 0.9326, 'acc_1_0': 0.7866, 'acc_1_1': 0.7726, 'mean_acc': 0.908}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7679, 'acc_0_0': 0.9565, 'acc_0_1': 0.933, 'acc_1_0': 0.785, 'acc_1_1': 0.7679, 'mean_acc': 0.9075}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7695, 'acc_0_0': 0.9552, 'acc_0_1': 0.9322, 'acc_1_0': 0.7897, 'acc_1_1': 0.7695, 'mean_acc': 0.9073}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7695, 'acc_0_0': 0.9548, 'acc_0_1': 0.933, 'acc_1_0': 0.7882, 'acc_1_1': 0.7695, 'mean_acc': 0.9073}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7679, 'acc_0_0': 0.9561, 'acc_0_1': 0.9339, 'acc_1_0': 0.785, 'acc_1_1': 0.7679, 'mean_acc': 0.9077}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7695, 'acc_0_0': 0.9543, 'acc_0_1': 0.9322, 'acc_1_0': 0.7897, 'acc_1_1': 0.7695, 'mean_acc': 0.907}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7695, 'acc_0_0': 0.9561, 'acc_0_1': 0.9326, 'acc_1_0': 0.7866, 'acc_1_1': 0.7695, 'mean_acc': 0.9075}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9344, 'acc_1_0': 0.7866, 'acc_1_1': 0.7664, 'mean_acc': 0.9082}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7695, 'acc_0_0': 0.9548, 'acc_0_1': 0.9322, 'acc_1_0': 0.7882, 'acc_1_1': 0.7695, 'mean_acc': 0.907}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9111, 'worst_acc': 0.7664, 'acc_0_0': 0.9557, 'acc_0_1': 0.9344, 'acc_1_0': 0.785, 'acc_1_1': 0.7664, 'mean_acc': 0.9075}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7664, 'acc_0_0': 0.9543, 'acc_0_1': 0.9335, 'acc_1_0': 0.7866, 'acc_1_1': 0.7664, 'mean_acc': 0.9068}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7648, 'acc_0_0': 0.9543, 'acc_0_1': 0.9361, 'acc_1_0': 0.7866, 'acc_1_1': 0.7648, 'mean_acc': 0.9077}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7648, 'acc_0_0': 0.9557, 'acc_0_1': 0.9339, 'acc_1_0': 0.785, 'acc_1_1': 0.7648, 'mean_acc': 0.9071}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7648, 'acc_0_0': 0.9552, 'acc_0_1': 0.9366, 'acc_1_0': 0.785, 'acc_1_1': 0.7648, 'mean_acc': 0.908}
========================================================================
> end of training. 

best epoch : 41
best training accuracy on [class]: {'worst_acc': 0.5303, 'acc_0_0': 0.9828, 'acc_0_1': 0.8412, 'acc_1_0': 0.5303, 'acc_1_1': 0.7164, 'mean_acc': 0.8481}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}
best test accuracy on [class]: {'weighted_mean_acc': 0.9151, 'worst_acc': 0.81, 'acc_0_0': 0.9481, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.81, 'mean_acc': 0.9078}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.81, 'acc_0_0': 0.9481, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.81, 'mean_acc': 0.9078}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.867, 'worst_acc': 0.0918, 'acc_0_0': 0.9322, 'acc_0_1': 0.0918, 'acc_1_0': 0.1589, 'acc_1_1': 0.824, 'mean_acc': 0.5074}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 41': {'Train': {'worst_acc': 0.5303, 'acc_0_0': 0.9828, 'acc_0_1': 0.8412, 'acc_1_0': 0.5303, 'acc_1_1': 0.7164, 'mean_acc': 0.8481}, 'Val': {'weighted_mean_acc': 0.9187, 'worst_acc': 0.8657, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.9133}, 'Test': {'weighted_mean_acc': 0.9151, 'worst_acc': 0.81, 'acc_0_0': 0.9481, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.81, 'mean_acc': 0.9078}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9151, 'worst_acc': 0.81, 'acc_0_0': 0.9481, 'acc_0_1': 0.9175, 'acc_1_0': 0.8302, 'acc_1_1': 0.81, 'mean_acc': 0.9078}, 'spurious': {'weighted_mean_acc': 0.867, 'worst_acc': 0.0918, 'acc_0_0': 0.9322, 'acc_0_1': 0.0918, 'acc_1_0': 0.1589, 'acc_1_1': 0.824, 'mean_acc': 0.5074}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0893, 'acc_0_0': 0.9182, 'acc_0_1': 0.8098, 'acc_1_0': 0.0893, 'acc_1_1': 0.211, 'mean_acc': 0.7485}
Val(class): {'weighted_mean_acc': 0.932, 'worst_acc': 0.1545, 'acc_0_0': 0.9615, 'acc_0_1': 0.1545, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.615}
Test(class): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.1397, 'acc_0_0': 0.9659, 'acc_0_1': 0.1397, 'acc_1_0': 0.6573, 'acc_1_1': 0.9766, 'mean_acc': 0.6113}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9917, 'acc_0_1': 0.4185, 'acc_1_0': 0.3393, 'acc_1_1': 0.8694, 'mean_acc': 0.9351}
Val(class): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.103, 'acc_0_0': 0.9188, 'acc_0_1': 0.103, 'acc_1_0': 0.6418, 'acc_1_1': 1.0, 'mean_acc': 0.58}
Test(class): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.0847, 'acc_0_0': 0.9308, 'acc_0_1': 0.0847, 'acc_1_0': 0.7227, 'acc_1_1': 0.986, 'mean_acc': 0.5846}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.2143, 'acc_0_0': 0.998, 'acc_0_1': 0.6033, 'acc_1_0': 0.2143, 'acc_1_1': 0.8288, 'mean_acc': 0.9364}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.2017, 'acc_0_0': 0.9829, 'acc_0_1': 0.2017, 'acc_1_0': 0.6119, 'acc_1_1': 1.0, 'mean_acc': 0.64}
Test(class): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.1703, 'acc_0_0': 0.9783, 'acc_0_1': 0.1703, 'acc_1_0': 0.5935, 'acc_1_1': 0.9688, 'mean_acc': 0.6201}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9971, 'acc_0_1': 0.5272, 'acc_1_0': 0.3214, 'acc_1_1': 0.9167, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.3348, 'acc_0_0': 1.0, 'acc_0_1': 0.3348, 'acc_1_0': 0.5373, 'acc_1_1': 0.9848, 'mean_acc': 0.6883}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.2812, 'acc_0_0': 0.9863, 'acc_0_1': 0.2812, 'acc_1_0': 0.5234, 'acc_1_1': 0.9673, 'mean_acc': 0.6584}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9954, 'acc_0_1': 0.4728, 'acc_1_0': 0.3393, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4506, 'acc_0_0': 1.0, 'acc_0_1': 0.4506, 'acc_1_0': 0.4776, 'acc_1_1': 0.9848, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.3969, 'acc_0_0': 0.9885, 'acc_0_1': 0.3969, 'acc_1_0': 0.4984, 'acc_1_1': 0.9595, 'mean_acc': 0.7007}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9937, 'acc_0_1': 0.4728, 'acc_1_0': 0.4464, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.5322, 'acc_1_0': 0.4627, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.4807, 'acc_0_0': 0.9902, 'acc_0_1': 0.4807, 'acc_1_0': 0.4891, 'acc_1_1': 0.9502, 'mean_acc': 0.732}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.9937, 'acc_0_1': 0.5217, 'acc_1_0': 0.5179, 'acc_1_1': 0.9508, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.4478, 'acc_0_0': 1.0, 'acc_0_1': 0.6052, 'acc_1_0': 0.4478, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4688, 'acc_0_0': 0.9911, 'acc_0_1': 0.5579, 'acc_1_0': 0.4688, 'acc_1_1': 0.9455, 'mean_acc': 0.7596}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9943, 'acc_0_1': 0.5924, 'acc_1_0': 0.4821, 'acc_1_1': 0.948, 'mean_acc': 0.9627}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4179, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.4179, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.4579, 'acc_0_0': 0.9933, 'acc_0_1': 0.6257, 'acc_1_0': 0.4579, 'acc_1_1': 0.9346, 'mean_acc': 0.7844}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9946, 'acc_0_1': 0.6522, 'acc_1_0': 0.4464, 'acc_1_1': 0.9404, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4439, 'acc_0_0': 0.9947, 'acc_0_1': 0.6825, 'acc_1_0': 0.4439, 'acc_1_1': 0.9283, 'mean_acc': 0.8048}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9954, 'acc_0_1': 0.6957, 'acc_1_0': 0.5, 'acc_1_1': 0.9347, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.4424, 'acc_0_0': 0.9956, 'acc_0_1': 0.7055, 'acc_1_0': 0.4424, 'acc_1_1': 0.919, 'mean_acc': 0.8129}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.4821, 'acc_1_1': 0.9357, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9736, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.4595, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.4595, 'acc_1_1': 0.9221, 'mean_acc': 0.8139}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.994, 'acc_0_1': 0.712, 'acc_1_0': 0.5536, 'acc_1_1': 0.9442, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.4627, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.486, 'acc_0_0': 0.9933, 'acc_0_1': 0.6914, 'acc_1_0': 0.486, 'acc_1_1': 0.9252, 'mean_acc': 0.812}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.5893, 'acc_1_1': 0.948, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5031, 'acc_0_0': 0.9929, 'acc_0_1': 0.6803, 'acc_1_0': 0.5031, 'acc_1_1': 0.9283, 'mean_acc': 0.8098}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9499, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5093, 'acc_0_0': 0.9925, 'acc_0_1': 0.6785, 'acc_1_0': 0.5093, 'acc_1_1': 0.9315, 'mean_acc': 0.81}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9931, 'acc_0_1': 0.6848, 'acc_1_0': 0.5714, 'acc_1_1': 0.9518, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9743, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5156, 'acc_0_0': 0.9929, 'acc_0_1': 0.6807, 'acc_1_0': 0.5156, 'acc_1_1': 0.9315, 'mean_acc': 0.8117}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9923, 'acc_0_1': 0.7174, 'acc_1_0': 0.625, 'acc_1_1': 0.9451, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9748, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5031, 'acc_0_0': 0.9933, 'acc_0_1': 0.6949, 'acc_1_0': 0.5031, 'acc_1_1': 0.9237, 'mean_acc': 0.8152}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6607, 'acc_1_1': 0.9451, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5062, 'acc_0_0': 0.992, 'acc_0_1': 0.6971, 'acc_1_0': 0.5062, 'acc_1_1': 0.9252, 'mean_acc': 0.816}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9929, 'acc_0_1': 0.7391, 'acc_1_0': 0.6429, 'acc_1_1': 0.9451, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9753, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.4925, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.5109, 'acc_0_0': 0.9929, 'acc_0_1': 0.7073, 'acc_1_0': 0.5109, 'acc_1_1': 0.9206, 'mean_acc': 0.8203}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9461, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.702, 'acc_1_0': 0.5327, 'acc_1_1': 0.9221, 'mean_acc': 0.8203}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7446, 'acc_1_0': 0.6607, 'acc_1_1': 0.947, 'mean_acc': 0.9689}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5436, 'acc_0_0': 0.9907, 'acc_0_1': 0.7078, 'acc_1_0': 0.5436, 'acc_1_1': 0.9221, 'mean_acc': 0.8234}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.75, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.5514, 'acc_0_0': 0.9898, 'acc_0_1': 0.6891, 'acc_1_0': 0.5514, 'acc_1_1': 0.9268, 'mean_acc': 0.8172}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9536, 'mean_acc': 0.9718}
Val(class): {'weighted_mean_acc': 0.9754, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.6936, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.82}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.788, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5872, 'acc_0_0': 0.9889, 'acc_0_1': 0.6763, 'acc_1_0': 0.5872, 'acc_1_1': 0.933, 'mean_acc': 0.8165}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9751, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6687, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8152}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9931, 'acc_0_1': 0.8098, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6028, 'acc_0_0': 0.9871, 'acc_0_1': 0.6825, 'acc_1_0': 0.6028, 'acc_1_1': 0.9315, 'mean_acc': 0.8198}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.994, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6246, 'acc_0_0': 0.9863, 'acc_0_1': 0.6585, 'acc_1_0': 0.6246, 'acc_1_1': 0.9393, 'mean_acc': 0.8134}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.994, 'acc_0_1': 0.8043, 'acc_1_0': 0.7857, 'acc_1_1': 0.9688, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6153, 'acc_0_0': 0.9867, 'acc_0_1': 0.6785, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8196}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.6964, 'acc_1_1': 0.9593, 'mean_acc': 0.9783}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5919, 'acc_0_0': 0.9898, 'acc_0_1': 0.7273, 'acc_1_0': 0.5919, 'acc_1_1': 0.9237, 'mean_acc': 0.8362}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.975, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.6059, 'acc_1_1': 0.9361, 'mean_acc': 0.8169}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9949, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9811, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.6199, 'acc_0_0': 0.9863, 'acc_0_1': 0.6789, 'acc_1_0': 0.6199, 'acc_1_1': 0.9346, 'mean_acc': 0.8203}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9699, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6199, 'acc_0_0': 0.9867, 'acc_0_1': 0.7042, 'acc_1_0': 0.6199, 'acc_1_1': 0.9268, 'mean_acc': 0.8295}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.837, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6121, 'acc_0_0': 0.988, 'acc_0_1': 0.6931, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.8255}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9969, 'acc_0_1': 0.8641, 'acc_1_0': 0.8393, 'acc_1_1': 0.9801, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6153, 'acc_0_0': 0.9871, 'acc_0_1': 0.7251, 'acc_1_0': 0.6153, 'acc_1_1': 0.9268, 'mean_acc': 0.8372}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.998, 'acc_0_1': 0.913, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9864}
Val(class): {'weighted_mean_acc': 0.973, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6168, 'acc_0_0': 0.9871, 'acc_0_1': 0.7033, 'acc_1_0': 0.6168, 'acc_1_1': 0.9315, 'mean_acc': 0.8295}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.8214, 'acc_1_1': 0.9839, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.6695, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6271, 'acc_0_0': 0.9827, 'acc_0_1': 0.6271, 'acc_1_0': 0.6558, 'acc_1_1': 0.9455, 'mean_acc': 0.8039}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9969, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.983, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6309, 'acc_0_0': 0.9786, 'acc_0_1': 0.6309, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.6004, 'acc_0_0': 0.9796, 'acc_0_1': 0.6004, 'acc_1_0': 0.6822, 'acc_1_1': 0.9439, 'mean_acc': 0.7951}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.8913, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6402, 'acc_0_0': 0.9854, 'acc_0_1': 0.6576, 'acc_1_0': 0.6402, 'acc_1_1': 0.9377, 'mean_acc': 0.8143}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.998, 'acc_0_1': 0.9293, 'acc_1_0': 0.8929, 'acc_1_1': 0.9801, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6262, 'acc_0_0': 0.9863, 'acc_0_1': 0.6776, 'acc_1_0': 0.6262, 'acc_1_1': 0.9315, 'mean_acc': 0.8202}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9983, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9906}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.6558, 'acc_0_0': 0.9854, 'acc_0_1': 0.6887, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8269}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9989, 'acc_0_1': 0.9457, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.634, 'acc_0_0': 0.9849, 'acc_0_1': 0.6687, 'acc_1_0': 0.634, 'acc_1_1': 0.933, 'mean_acc': 0.8172}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9528, 'acc_0_1': 0.9056, 'acc_1_0': 0.6667, 'acc_1_1': 0.806, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.8197, 'acc_0_0': 0.8889, 'acc_0_1': 0.8197, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.8013, 'acc_0_0': 0.9095, 'acc_0_1': 0.8013, 'acc_1_0': 0.8692, 'acc_1_1': 0.9128, 'mean_acc': 0.8633}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3182, 'acc_0_0': 0.8584, 'acc_0_1': 0.7296, 'acc_1_0': 0.3182, 'acc_1_1': 0.806, 'mean_acc': 0.7429}
Val(class)(new adapter): {'weighted_mean_acc': 0.9313, 'worst_acc': 0.1717, 'acc_0_0': 0.953, 'acc_0_1': 0.1717, 'acc_1_0': 0.7761, 'acc_1_1': 1.0, 'mean_acc': 0.635}
Test(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.1889, 'acc_0_0': 0.9539, 'acc_0_1': 0.1889, 'acc_1_0': 0.7835, 'acc_1_1': 0.9875, 'mean_acc': 0.641}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9914, 'acc_0_1': 0.7468, 'acc_1_0': 0.4848, 'acc_1_1': 0.8358, 'mean_acc': 0.823}
Val(class)(new adapter): {'weighted_mean_acc': 0.7765, 'worst_acc': 0.5606, 'acc_0_0': 0.8333, 'acc_0_1': 0.9099, 'acc_1_0': 0.8657, 'acc_1_1': 0.5606, 'mean_acc': 0.8367}
Test(class)(new adapter): {'weighted_mean_acc': 0.7856, 'worst_acc': 0.4984, 'acc_0_0': 0.8634, 'acc_0_1': 0.9206, 'acc_1_0': 0.8972, 'acc_1_1': 0.4984, 'mean_acc': 0.849}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1343, 'acc_0_0': 0.7597, 'acc_0_1': 0.8884, 'acc_1_0': 0.9545, 'acc_1_1': 0.1343, 'mean_acc': 0.7613}
Val(class)(new adapter): {'weighted_mean_acc': 0.8458, 'worst_acc': 0.7725, 'acc_0_0': 0.8205, 'acc_0_1': 0.7725, 'acc_1_0': 0.8955, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class)(new adapter): {'weighted_mean_acc': 0.8549, 'worst_acc': 0.7876, 'acc_0_0': 0.8381, 'acc_0_1': 0.7876, 'acc_1_0': 0.9128, 'acc_1_1': 0.919, 'mean_acc': 0.8357}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9614, 'acc_0_1': 0.9485, 'acc_1_0': 0.803, 'acc_1_1': 0.8806, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8349, 'acc_0_0': 0.9494, 'acc_0_1': 0.9299, 'acc_1_0': 0.8349, 'acc_1_1': 0.8645, 'mean_acc': 0.9197}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4328, 'acc_0_0': 0.8584, 'acc_0_1': 0.9871, 'acc_1_0': 0.7424, 'acc_1_1': 0.4328, 'mean_acc': 0.8481}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.588, 'acc_0_0': 0.906, 'acc_0_1': 0.588, 'acc_1_0': 0.8806, 'acc_1_1': 0.9848, 'mean_acc': 0.7883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.5973, 'acc_0_0': 0.9091, 'acc_0_1': 0.5973, 'acc_1_0': 0.8769, 'acc_1_1': 0.9548, 'mean_acc': 0.7893}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.8712, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9484, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.8627, 'acc_1_0': 0.806, 'acc_1_1': 0.9697, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9365, 'worst_acc': 0.8287, 'acc_0_0': 0.9534, 'acc_0_1': 0.8647, 'acc_1_0': 0.8287, 'acc_1_1': 0.8988, 'mean_acc': 0.899}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.9785, 'acc_0_1': 0.9185, 'acc_1_0': 0.8788, 'acc_1_1': 0.6567, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.8781, 'worst_acc': 0.6667, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.6667, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8809, 'worst_acc': 0.6059, 'acc_0_0': 0.9605, 'acc_0_1': 0.9743, 'acc_1_0': 0.7866, 'acc_1_1': 0.6059, 'mean_acc': 0.9073}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.8788, 'acc_1_1': 0.8358, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.8756, 'worst_acc': 0.6667, 'acc_0_0': 0.9359, 'acc_0_1': 0.97, 'acc_1_0': 0.7463, 'acc_1_1': 0.6667, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8688, 'worst_acc': 0.6059, 'acc_0_0': 0.9437, 'acc_0_1': 0.9769, 'acc_1_0': 0.7944, 'acc_1_1': 0.6059, 'mean_acc': 0.9027}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.8498, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.8955, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.6269, 'acc_0_0': 0.9658, 'acc_0_1': 0.9356, 'acc_1_0': 0.6269, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.6745, 'acc_0_0': 0.9814, 'acc_0_1': 0.9534, 'acc_1_0': 0.6745, 'acc_1_1': 0.7679, 'mean_acc': 0.9128}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.803, 'acc_1_1': 1.0, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.941, 'worst_acc': 0.6119, 'acc_0_0': 0.9658, 'acc_0_1': 0.927, 'acc_1_0': 0.6119, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.938, 'worst_acc': 0.6324, 'acc_0_0': 0.9849, 'acc_0_1': 0.937, 'acc_1_0': 0.6324, 'acc_1_1': 0.7991, 'mean_acc': 0.9066}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9657, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.7695, 'acc_0_0': 0.9596, 'acc_0_1': 0.9295, 'acc_1_0': 0.7695, 'acc_1_1': 0.8037, 'mean_acc': 0.9096}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.7617, 'acc_0_0': 0.933, 'acc_0_1': 0.9317, 'acc_1_0': 0.8162, 'acc_1_1': 0.7617, 'mean_acc': 0.9006}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8868, 'worst_acc': 0.729, 'acc_0_0': 0.9335, 'acc_0_1': 0.9366, 'acc_1_0': 0.7897, 'acc_1_1': 0.729, 'mean_acc': 0.8961}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9034, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8912, 'worst_acc': 0.6947, 'acc_0_0': 0.9499, 'acc_0_1': 0.9499, 'acc_1_0': 0.743, 'acc_1_1': 0.6947, 'mean_acc': 0.8987}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.7274, 'acc_0_0': 0.9574, 'acc_0_1': 0.9437, 'acc_1_0': 0.7274, 'acc_1_1': 0.7414, 'mean_acc': 0.9027}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7508, 'acc_0_0': 0.9588, 'acc_0_1': 0.9361, 'acc_1_0': 0.7508, 'acc_1_1': 0.7679, 'mean_acc': 0.9058}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7648, 'acc_0_0': 0.9552, 'acc_0_1': 0.9419, 'acc_1_0': 0.7648, 'acc_1_1': 0.771, 'mean_acc': 0.9085}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7664, 'acc_0_0': 0.9565, 'acc_0_1': 0.9432, 'acc_1_0': 0.7679, 'acc_1_1': 0.7664, 'mean_acc': 0.9094}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7632, 'acc_0_0': 0.9601, 'acc_0_1': 0.945, 'acc_1_0': 0.7679, 'acc_1_1': 0.7632, 'mean_acc': 0.9111}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7539, 'acc_0_0': 0.9579, 'acc_0_1': 0.9459, 'acc_1_0': 0.7632, 'acc_1_1': 0.7539, 'mean_acc': 0.909}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7539, 'acc_0_0': 0.957, 'acc_0_1': 0.9432, 'acc_1_0': 0.7617, 'acc_1_1': 0.7539, 'mean_acc': 0.9075}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7539, 'acc_0_0': 0.9561, 'acc_0_1': 0.9432, 'acc_1_0': 0.7539, 'acc_1_1': 0.7555, 'mean_acc': 0.9065}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7445, 'acc_0_0': 0.9583, 'acc_0_1': 0.9432, 'acc_1_0': 0.7445, 'acc_1_1': 0.7523, 'mean_acc': 0.9059}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7492, 'acc_0_0': 0.9583, 'acc_0_1': 0.949, 'acc_1_0': 0.7492, 'acc_1_1': 0.7508, 'mean_acc': 0.9085}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7134, 'acc_0_0': 0.9721, 'acc_0_1': 0.9623, 'acc_1_0': 0.7181, 'acc_1_1': 0.7134, 'mean_acc': 0.9115}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.704, 'acc_0_0': 0.9729, 'acc_0_1': 0.9645, 'acc_1_0': 0.7134, 'acc_1_1': 0.704, 'mean_acc': 0.9111}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.715, 'acc_0_0': 0.9721, 'acc_0_1': 0.9632, 'acc_1_0': 0.7165, 'acc_1_1': 0.715, 'mean_acc': 0.9118}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9528, 'acc_1_0': 0.6567, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7103, 'acc_0_0': 0.9712, 'acc_0_1': 0.9619, 'acc_1_0': 0.7103, 'acc_1_1': 0.7134, 'mean_acc': 0.9101}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.6716, 'acc_0_0': 0.9487, 'acc_0_1': 0.9485, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7321, 'acc_0_0': 0.9659, 'acc_0_1': 0.953, 'acc_1_0': 0.7321, 'acc_1_1': 0.7477, 'mean_acc': 0.9108}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7445, 'acc_0_0': 0.9632, 'acc_0_1': 0.9477, 'acc_1_0': 0.7445, 'acc_1_1': 0.7601, 'mean_acc': 0.9104}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7477, 'acc_0_0': 0.9592, 'acc_0_1': 0.9437, 'acc_1_0': 0.7477, 'acc_1_1': 0.7632, 'mean_acc': 0.908}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7555, 'acc_0_0': 0.957, 'acc_0_1': 0.9428, 'acc_1_0': 0.7555, 'acc_1_1': 0.7679, 'mean_acc': 0.9082}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7601, 'acc_0_0': 0.9565, 'acc_0_1': 0.9397, 'acc_1_0': 0.7601, 'acc_1_1': 0.771, 'mean_acc': 0.9077}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7352, 'acc_0_0': 0.9619, 'acc_0_1': 0.9463, 'acc_1_0': 0.7352, 'acc_1_1': 0.7508, 'mean_acc': 0.9073}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7383, 'acc_0_0': 0.9596, 'acc_0_1': 0.9468, 'acc_1_0': 0.7383, 'acc_1_1': 0.7492, 'mean_acc': 0.9068}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7383, 'acc_0_0': 0.9588, 'acc_0_1': 0.9468, 'acc_1_0': 0.7383, 'acc_1_1': 0.7492, 'mean_acc': 0.9065}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7414, 'acc_0_0': 0.9583, 'acc_0_1': 0.9463, 'acc_1_0': 0.7414, 'acc_1_1': 0.7477, 'mean_acc': 0.9063}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7414, 'acc_0_0': 0.9579, 'acc_0_1': 0.9472, 'acc_1_0': 0.7414, 'acc_1_1': 0.7445, 'mean_acc': 0.9061}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7492, 'acc_0_0': 0.9561, 'acc_0_1': 0.9459, 'acc_1_0': 0.7523, 'acc_1_1': 0.7492, 'mean_acc': 0.9066}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7445, 'acc_0_0': 0.9561, 'acc_0_1': 0.9481, 'acc_1_0': 0.7508, 'acc_1_1': 0.7445, 'mean_acc': 0.9068}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7492, 'acc_0_0': 0.9543, 'acc_0_1': 0.9459, 'acc_1_0': 0.7523, 'acc_1_1': 0.7492, 'mean_acc': 0.9059}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7539, 'acc_0_0': 0.9517, 'acc_0_1': 0.9441, 'acc_1_0': 0.7617, 'acc_1_1': 0.7539, 'mean_acc': 0.9058}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.7555, 'acc_0_0': 0.9517, 'acc_0_1': 0.9428, 'acc_1_0': 0.7632, 'acc_1_1': 0.7555, 'mean_acc': 0.9056}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.7508, 'acc_0_0': 0.9512, 'acc_0_1': 0.9446, 'acc_1_0': 0.7601, 'acc_1_1': 0.7508, 'mean_acc': 0.9052}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7508, 'acc_0_0': 0.9512, 'acc_0_1': 0.9455, 'acc_1_0': 0.7586, 'acc_1_1': 0.7508, 'mean_acc': 0.9054}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7477, 'acc_0_0': 0.9512, 'acc_0_1': 0.9468, 'acc_1_0': 0.7539, 'acc_1_1': 0.7477, 'mean_acc': 0.9051}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9058, 'worst_acc': 0.7477, 'acc_0_0': 0.9539, 'acc_0_1': 0.9468, 'acc_1_0': 0.7508, 'acc_1_1': 0.7477, 'mean_acc': 0.9058}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9046, 'worst_acc': 0.7508, 'acc_0_0': 0.9512, 'acc_0_1': 0.9455, 'acc_1_0': 0.7586, 'acc_1_1': 0.7508, 'mean_acc': 0.9054}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7477, 'acc_0_0': 0.9512, 'acc_0_1': 0.9463, 'acc_1_0': 0.757, 'acc_1_1': 0.7477, 'mean_acc': 0.9052}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7477, 'acc_0_0': 0.9508, 'acc_0_1': 0.9463, 'acc_1_0': 0.757, 'acc_1_1': 0.7477, 'mean_acc': 0.9051}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.7523, 'acc_0_0': 0.9494, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7523, 'mean_acc': 0.9052}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7508, 'acc_0_0': 0.9499, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7508, 'mean_acc': 0.9052}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7477, 'acc_0_0': 0.9499, 'acc_0_1': 0.9446, 'acc_1_0': 0.7586, 'acc_1_1': 0.7477, 'mean_acc': 0.9042}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.7523, 'acc_0_0': 0.9494, 'acc_0_1': 0.9446, 'acc_1_0': 0.7632, 'acc_1_1': 0.7523, 'mean_acc': 0.9051}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9033, 'worst_acc': 0.7555, 'acc_0_0': 0.9481, 'acc_0_1': 0.9428, 'acc_1_0': 0.7679, 'acc_1_1': 0.7555, 'mean_acc': 0.9047}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7523, 'acc_0_0': 0.9481, 'acc_0_1': 0.9441, 'acc_1_0': 0.7695, 'acc_1_1': 0.7523, 'mean_acc': 0.9051}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9033, 'worst_acc': 0.7492, 'acc_0_0': 0.9499, 'acc_0_1': 0.9446, 'acc_1_0': 0.7648, 'acc_1_1': 0.7492, 'mean_acc': 0.9051}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7523, 'acc_0_0': 0.9499, 'acc_0_1': 0.9446, 'acc_1_0': 0.7617, 'acc_1_1': 0.7523, 'mean_acc': 0.9051}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9026, 'worst_acc': 0.7477, 'acc_0_0': 0.9494, 'acc_0_1': 0.9446, 'acc_1_0': 0.7601, 'acc_1_1': 0.7477, 'mean_acc': 0.9042}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.803, 'acc_0_0': 0.9614, 'acc_0_1': 0.9485, 'acc_1_0': 0.803, 'acc_1_1': 0.8806, 'mean_acc': 0.9299}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9156, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
best test accuracy on [class]: {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8349, 'acc_0_0': 0.9494, 'acc_0_1': 0.9299, 'acc_1_0': 0.8349, 'acc_1_1': 0.8645, 'mean_acc': 0.9197}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8349, 'acc_0_0': 0.9494, 'acc_0_1': 0.9299, 'acc_1_0': 0.8349, 'acc_1_1': 0.8645, 'mean_acc': 0.9197}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9361, 'worst_acc': 0.4019, 'acc_0_0': 0.9251, 'acc_0_1': 0.9508, 'acc_1_0': 0.4019, 'acc_1_1': 0.9984, 'mean_acc': 0.8852}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.803, 'acc_0_0': 0.9614, 'acc_0_1': 0.9485, 'acc_1_0': 0.803, 'acc_1_1': 0.8806, 'mean_acc': 0.9299}, 'Val': {'weighted_mean_acc': 0.9156, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8939, 'mean_acc': 0.91}, 'Test': {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8349, 'acc_0_0': 0.9494, 'acc_0_1': 0.9299, 'acc_1_0': 0.8349, 'acc_1_1': 0.8645, 'mean_acc': 0.9197}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9286, 'worst_acc': 0.8349, 'acc_0_0': 0.9494, 'acc_0_1': 0.9299, 'acc_1_0': 0.8349, 'acc_1_1': 0.8645, 'mean_acc': 0.9197}, 'spurious': {'weighted_mean_acc': 0.9361, 'worst_acc': 0.4019, 'acc_0_0': 0.9251, 'acc_0_1': 0.9508, 'acc_1_0': 0.4019, 'acc_1_1': 0.9984, 'mean_acc': 0.8852}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8795     0.8349   0.8940  ...   0.8676   0.8349    0.8730
2                       0.9151     0.8100   0.9481  ...   0.8302   0.8100    0.9078
3                       0.9286     0.8349   0.9494  ...   0.8349   0.8645    0.9197
test_mean               0.9077     0.8266   0.9305  ...   0.8442   0.8365    0.9002
test_std                0.0207     0.0117   0.0258  ...   0.0166   0.0223    0.0198
1                       0.9641     0.5498   0.9774  ...   0.5498   0.9673    0.8671
2                       0.8670     0.0918   0.9322  ...   0.1589   0.8240    0.5074
3                       0.9361     0.4019   0.9251  ...   0.4019   0.9984    0.8852
zs_spu_mean             0.9224     0.3478   0.9449  ...   0.3702   0.9299    0.7532
zs_spu_std              0.0408     0.1908   0.0232  ...   0.1612   0.0760    0.1740
1                          NaN     0.9545   0.9657  ...   0.9545   1.0000    0.9800
2                          NaN     0.5303   0.9828  ...   0.5303   0.7164    0.8481
3                          NaN     0.8030   0.9614  ...   0.8030   0.8806    0.9299
tr_mean                    NaN     0.7626   0.9700  ...   0.7626   0.8657    0.9193
tr_std                     NaN     0.1755   0.0092  ...   0.1755   0.1163    0.0544
1                       0.9006     0.8541   0.9145  ...   0.8806   0.8636    0.8817
2                       0.9187     0.8657   0.9316  ...   0.8657   0.8788    0.9133
3                       0.9156     0.8209   0.9231  ...   0.8209   0.8939    0.9100
val_mean                0.9116     0.8469   0.9231  ...   0.8557   0.8788    0.9017
val_std                 0.0079     0.0190   0.0070  ...   0.0254   0.0124    0.0142
1                       0.8795     0.8349   0.8940  ...   0.8676   0.8349    0.8730
2                       0.9151     0.8100   0.9481  ...   0.8302   0.8100    0.9078
3                       0.9286     0.8349   0.9494  ...   0.8349   0.8645    0.9197
zs_tg_mean              0.9077     0.8266   0.9305  ...   0.8442   0.8365    0.9002
zs_tg_std               0.0207     0.0117   0.0258  ...   0.0166   0.0223    0.0198

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_10.0_lrr10.0_bsr128_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.2857, 'acc_0_0': 0.9028, 'acc_0_1': 0.663, 'acc_1_0': 0.2857, 'acc_1_1': 0.4759, 'mean_acc': 0.7923}
Val(class): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.1588, 'acc_0_0': 0.9274, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6117}
Test(class): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.1251, 'acc_0_0': 0.9392, 'acc_0_1': 0.1251, 'acc_1_0': 0.7259, 'acc_1_1': 0.9844, 'mean_acc': 0.6037}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2174, 'acc_0_0': 0.9768, 'acc_0_1': 0.2174, 'acc_1_0': 0.6786, 'acc_1_1': 0.9745, 'mean_acc': 0.9437}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3648, 'acc_0_0': 1.0, 'acc_0_1': 0.3648, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.6933}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.322, 'acc_0_0': 0.9942, 'acc_0_1': 0.322, 'acc_1_0': 0.5249, 'acc_1_1': 0.9564, 'mean_acc': 0.6764}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.6359, 'acc_1_0': 0.5, 'acc_1_1': 0.878, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5064, 'acc_0_0': 0.9957, 'acc_0_1': 0.5064, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.4678, 'acc_0_0': 0.9933, 'acc_0_1': 0.4678, 'acc_1_0': 0.553, 'acc_1_1': 0.9361, 'mean_acc': 0.7337}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5217, 'acc_0_0': 0.9886, 'acc_0_1': 0.5217, 'acc_1_0': 0.6964, 'acc_1_1': 0.9631, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4292, 'acc_0_0': 0.9915, 'acc_0_1': 0.4292, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7367}
Test(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3889, 'acc_0_0': 0.9805, 'acc_0_1': 0.3889, 'acc_1_0': 0.6791, 'acc_1_1': 0.9579, 'mean_acc': 0.7144}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5543, 'acc_0_0': 0.9848, 'acc_0_1': 0.5543, 'acc_1_0': 0.8036, 'acc_1_1': 0.964, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6262, 'acc_0_0': 0.988, 'acc_0_1': 0.6421, 'acc_1_0': 0.6262, 'acc_1_1': 0.9283, 'mean_acc': 0.8067}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9946, 'acc_0_1': 0.7772, 'acc_1_0': 0.6786, 'acc_1_1': 0.9224, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9566, 'worst_acc': 0.634, 'acc_0_0': 0.9858, 'acc_0_1': 0.6528, 'acc_1_0': 0.634, 'acc_1_1': 0.9299, 'mean_acc': 0.811}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.992, 'acc_0_1': 0.663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9518, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7717}
Test(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.5002, 'acc_0_0': 0.9809, 'acc_0_1': 0.5002, 'acc_1_0': 0.6854, 'acc_1_1': 0.9502, 'mean_acc': 0.7577}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6196, 'acc_0_0': 0.9914, 'acc_0_1': 0.6196, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.6288, 'acc_0_0': 0.9885, 'acc_0_1': 0.6288, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8031}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.7143, 'acc_1_1': 0.9499, 'mean_acc': 0.9708}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.6075, 'acc_0_0': 0.9907, 'acc_0_1': 0.6359, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8029}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.996, 'acc_0_1': 0.7065, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5672, 'acc_0_0': 0.9889, 'acc_0_1': 0.5672, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.7798}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6304, 'acc_0_0': 0.9937, 'acc_0_1': 0.6304, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9712}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6438, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6121, 'acc_0_0': 0.9911, 'acc_0_1': 0.6133, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.7957}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9974, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5794, 'acc_0_0': 0.9933, 'acc_0_1': 0.667, 'acc_1_0': 0.5794, 'acc_1_1': 0.9221, 'mean_acc': 0.8126}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9966, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.9729}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6121, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.7991}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9949, 'acc_0_1': 0.6902, 'acc_1_0': 0.7679, 'acc_1_1': 0.9622, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6106, 'acc_0_0': 0.9925, 'acc_0_1': 0.6302, 'acc_1_0': 0.6106, 'acc_1_1': 0.933, 'mean_acc': 0.8026}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.75, 'acc_1_1': 0.9622, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6012, 'acc_0_0': 0.9929, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8219}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9974, 'acc_0_1': 0.7391, 'acc_1_0': 0.7857, 'acc_1_1': 0.9565, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6457, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8076}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9963, 'acc_0_1': 0.7337, 'acc_1_0': 0.8214, 'acc_1_1': 0.9612, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6537, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8107}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9977, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.6732, 'acc_1_0': 0.6012, 'acc_1_1': 0.9283, 'mean_acc': 0.8177}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9974, 'acc_0_1': 0.7554, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.6625, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8148}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9966, 'acc_0_1': 0.7446, 'acc_1_0': 0.8393, 'acc_1_1': 0.9697, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6293, 'acc_0_0': 0.9907, 'acc_0_1': 0.655, 'acc_1_0': 0.6293, 'acc_1_1': 0.9346, 'mean_acc': 0.8138}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9925, 'acc_0_1': 0.6838, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.8234}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.7857, 'acc_1_1': 0.9631, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6812, 'acc_1_0': 0.6184, 'acc_1_1': 0.9315, 'mean_acc': 0.8222}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7717, 'acc_0_0': 0.998, 'acc_0_1': 0.7717, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6137, 'acc_0_0': 0.9902, 'acc_0_1': 0.6874, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9983, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6749, 'acc_1_0': 0.6184, 'acc_1_1': 0.933, 'mean_acc': 0.82}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9986, 'acc_0_1': 0.7935, 'acc_1_0': 0.8571, 'acc_1_1': 0.9697, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6812, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8219}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9994, 'acc_0_1': 0.788, 'acc_1_0': 0.8571, 'acc_1_1': 0.9716, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.6887, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8245}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8571, 'acc_1_1': 0.9678, 'mean_acc': 0.9837}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5997, 'acc_0_0': 0.9916, 'acc_0_1': 0.7166, 'acc_1_0': 0.5997, 'acc_1_1': 0.9299, 'mean_acc': 0.8343}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9986, 'acc_0_1': 0.8152, 'acc_1_0': 0.8929, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9663, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6106, 'acc_0_0': 0.9902, 'acc_0_1': 0.6634, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8152}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7511, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5903, 'acc_0_0': 0.9925, 'acc_0_1': 0.722, 'acc_1_0': 0.5903, 'acc_1_1': 0.9283, 'mean_acc': 0.8355}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.8859, 'acc_1_0': 0.8393, 'acc_1_1': 0.9688, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.9714, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.5919, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.5919, 'acc_1_1': 0.9315, 'mean_acc': 0.8264}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9889, 'acc_0_1': 0.6732, 'acc_1_0': 0.6153, 'acc_1_1': 0.9377, 'mean_acc': 0.819}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9991, 'acc_0_1': 0.837, 'acc_1_0': 0.9107, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.6847, 'acc_1_0': 0.6308, 'acc_1_1': 0.9361, 'mean_acc': 0.8248}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9735, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.7002, 'acc_1_0': 0.6153, 'acc_1_1': 0.9346, 'mean_acc': 0.8293}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 1.0, 'acc_0_1': 0.8913, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.6882, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8243}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 1.0, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6269, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6308, 'acc_1_1': 0.9377, 'mean_acc': 0.8165}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6931, 'acc_1_0': 0.6168, 'acc_1_1': 0.9346, 'mean_acc': 0.8269}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9239, 'acc_0_0': 1.0, 'acc_0_1': 0.9239, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8298}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9185, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.9643, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6741, 'acc_1_0': 0.6168, 'acc_1_1': 0.9377, 'mean_acc': 0.8198}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9868, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.609, 'acc_0_0': 0.9911, 'acc_0_1': 0.7033, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8305}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9896, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6059, 'acc_0_0': 0.9916, 'acc_0_1': 0.722, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8376}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.7554, 'acc_1_0': 0.5, 'acc_1_1': 0.9104, 'mean_acc': 0.8381}
Val(class)(new adapter): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5373, 'acc_0_0': 0.9829, 'acc_0_1': 0.8369, 'acc_1_0': 0.5373, 'acc_1_1': 0.9091, 'mean_acc': 0.8683}
Test(class)(new adapter): {'weighted_mean_acc': 0.967, 'worst_acc': 0.5841, 'acc_0_0': 0.9947, 'acc_0_1': 0.8231, 'acc_1_0': 0.5841, 'acc_1_1': 0.9206, 'mean_acc': 0.8742}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1061, 'acc_0_0': 0.9742, 'acc_0_1': 0.2318, 'acc_1_0': 0.1061, 'acc_1_1': 0.4478, 'mean_acc': 0.5309}
Val(class)(new adapter): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.4721, 'acc_0_0': 0.9658, 'acc_0_1': 0.4721, 'acc_1_0': 0.7761, 'acc_1_1': 1.0, 'mean_acc': 0.7567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9421, 'worst_acc': 0.4856, 'acc_0_0': 0.9619, 'acc_0_1': 0.4856, 'acc_1_0': 0.7648, 'acc_1_1': 0.9657, 'mean_acc': 0.7551}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.721, 'acc_0_0': 0.9485, 'acc_0_1': 0.721, 'acc_1_0': 0.7727, 'acc_1_1': 0.9552, 'mean_acc': 0.8414}
Val(class)(new adapter): {'weighted_mean_acc': 0.893, 'worst_acc': 0.6364, 'acc_0_0': 0.9701, 'acc_0_1': 0.9657, 'acc_1_0': 0.6866, 'acc_1_1': 0.6364, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8895, 'worst_acc': 0.6059, 'acc_0_0': 0.9738, 'acc_0_1': 0.9619, 'acc_1_0': 0.7321, 'acc_1_1': 0.6059, 'mean_acc': 0.9016}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1045, 'acc_0_0': 0.5408, 'acc_0_1': 0.9871, 'acc_1_0': 0.4394, 'acc_1_1': 0.1045, 'mean_acc': 0.6544}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.9742, 'acc_1_0': 0.5821, 'acc_1_1': 0.6364, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8959, 'worst_acc': 0.5748, 'acc_0_0': 0.9929, 'acc_0_1': 0.9849, 'acc_1_0': 0.609, 'acc_1_1': 0.5748, 'mean_acc': 0.9009}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.6667, 'acc_1_1': 0.8507, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.9559, 'worst_acc': 0.7313, 'acc_0_0': 0.9829, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9317}
Test(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.7196, 'acc_0_0': 0.9845, 'acc_0_1': 0.9459, 'acc_1_0': 0.7196, 'acc_1_1': 0.8318, 'mean_acc': 0.9232}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5224, 'acc_0_0': 0.9657, 'acc_0_1': 0.8884, 'acc_1_0': 0.8333, 'acc_1_1': 0.5224, 'mean_acc': 0.8715}
Val(class)(new adapter): {'weighted_mean_acc': 0.9288, 'worst_acc': 0.8209, 'acc_0_0': 0.9359, 'acc_0_1': 0.8541, 'acc_1_0': 0.8209, 'acc_1_1': 0.9242, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8287, 'acc_0_0': 0.9317, 'acc_0_1': 0.8488, 'acc_1_0': 0.8287, 'acc_1_1': 0.9143, 'mean_acc': 0.8861}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9442, 'acc_0_1': 0.9528, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8907, 'worst_acc': 0.8738, 'acc_0_0': 0.89, 'acc_0_1': 0.8798, 'acc_1_0': 0.8738, 'acc_1_1': 0.8956, 'mean_acc': 0.8849}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9013, 'acc_0_1': 0.9571, 'acc_1_0': 0.9394, 'acc_1_1': 0.7612, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.871, 'worst_acc': 0.8485, 'acc_0_0': 0.8761, 'acc_0_1': 0.9099, 'acc_1_0': 0.8507, 'acc_1_1': 0.8485, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8524, 'worst_acc': 0.8396, 'acc_0_0': 0.8532, 'acc_0_1': 0.9016, 'acc_1_0': 0.8863, 'acc_1_1': 0.8396, 'mean_acc': 0.8742}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9104, 'acc_0_0': 0.9785, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9104, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.8831, 'worst_acc': 0.8358, 'acc_0_0': 0.8932, 'acc_0_1': 0.9056, 'acc_1_0': 0.8358, 'acc_1_1': 0.8485, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8668, 'worst_acc': 0.8411, 'acc_0_0': 0.8723, 'acc_0_1': 0.9086, 'acc_1_0': 0.8692, 'acc_1_1': 0.8411, 'mean_acc': 0.8826}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.9091, 'acc_1_1': 0.8806, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.8224, 'acc_0_0': 0.9313, 'acc_0_1': 0.9157, 'acc_1_0': 0.8224, 'acc_1_1': 0.8474, 'mean_acc': 0.9039}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9142, 'acc_1_0': 0.7761, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.8178, 'acc_0_0': 0.9441, 'acc_0_1': 0.9113, 'acc_1_0': 0.8178, 'acc_1_1': 0.8551, 'mean_acc': 0.9075}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.97, 'acc_0_1': 0.9828, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7761, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.7761, 'acc_1_1': 0.9242, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.8505, 'acc_0_0': 0.9122, 'acc_0_1': 0.89, 'acc_1_0': 0.8505, 'acc_1_1': 0.8754, 'mean_acc': 0.8926}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.893, 'worst_acc': 0.8318, 'acc_0_0': 0.9109, 'acc_0_1': 0.9215, 'acc_1_0': 0.8427, 'acc_1_1': 0.8318, 'mean_acc': 0.8987}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8839, 'worst_acc': 0.8131, 'acc_0_0': 0.9038, 'acc_0_1': 0.9273, 'acc_1_0': 0.8411, 'acc_1_1': 0.8131, 'mean_acc': 0.8959}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.886, 'worst_acc': 0.7761, 'acc_0_0': 0.8974, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8837, 'worst_acc': 0.81, 'acc_0_0': 0.9047, 'acc_0_1': 0.922, 'acc_1_0': 0.8364, 'acc_1_1': 0.81, 'mean_acc': 0.8933}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8795, 'worst_acc': 0.791, 'acc_0_0': 0.8889, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8812, 'worst_acc': 0.8193, 'acc_0_0': 0.8989, 'acc_0_1': 0.9144, 'acc_1_0': 0.838, 'acc_1_1': 0.8193, 'mean_acc': 0.8894}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8788, 'worst_acc': 0.791, 'acc_0_0': 0.8889, 'acc_0_1': 0.8884, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8829, 'worst_acc': 0.8271, 'acc_0_0': 0.8993, 'acc_0_1': 0.9064, 'acc_1_0': 0.8318, 'acc_1_1': 0.8271, 'mean_acc': 0.8866}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8886, 'worst_acc': 0.791, 'acc_0_0': 0.8932, 'acc_0_1': 0.8884, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8939, 'worst_acc': 0.8287, 'acc_0_0': 0.9064, 'acc_0_1': 0.8896, 'acc_1_0': 0.8287, 'acc_1_1': 0.8567, 'mean_acc': 0.8857}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.8798, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9055, 'worst_acc': 0.824, 'acc_0_0': 0.9211, 'acc_0_1': 0.8882, 'acc_1_0': 0.824, 'acc_1_1': 0.8614, 'mean_acc': 0.8909}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.901, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.897, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.8209, 'acc_0_0': 0.9259, 'acc_0_1': 0.8971, 'acc_1_0': 0.8209, 'acc_1_1': 0.852, 'mean_acc': 0.8949}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.81, 'acc_0_0': 0.9344, 'acc_0_1': 0.9095, 'acc_1_0': 0.81, 'acc_1_1': 0.8333, 'mean_acc': 0.8997}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7991, 'acc_0_0': 0.9375, 'acc_0_1': 0.9197, 'acc_1_0': 0.7991, 'acc_1_1': 0.81, 'mean_acc': 0.9011}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9043, 'worst_acc': 0.7882, 'acc_0_0': 0.9384, 'acc_0_1': 0.9317, 'acc_1_0': 0.7882, 'acc_1_1': 0.7928, 'mean_acc': 0.903}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.904, 'worst_acc': 0.7804, 'acc_0_0': 0.9415, 'acc_0_1': 0.9392, 'acc_1_0': 0.7819, 'acc_1_1': 0.7804, 'mean_acc': 0.9051}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.757, 'acc_0_0': 0.9397, 'acc_0_1': 0.9441, 'acc_1_0': 0.7819, 'acc_1_1': 0.757, 'mean_acc': 0.9037}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.7612, 'acc_0_0': 0.9188, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8921, 'worst_acc': 0.7648, 'acc_0_0': 0.9295, 'acc_0_1': 0.9428, 'acc_1_0': 0.7913, 'acc_1_1': 0.7648, 'mean_acc': 0.9011}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.7612, 'acc_0_0': 0.9188, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.7617, 'acc_0_0': 0.9286, 'acc_0_1': 0.9428, 'acc_1_0': 0.7944, 'acc_1_1': 0.7617, 'mean_acc': 0.9008}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.7586, 'acc_0_0': 0.9353, 'acc_0_1': 0.9446, 'acc_1_0': 0.7835, 'acc_1_1': 0.7586, 'mean_acc': 0.9025}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.7461, 'acc_0_0': 0.9534, 'acc_0_1': 0.9463, 'acc_1_0': 0.7539, 'acc_1_1': 0.7461, 'mean_acc': 0.9056}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9125, 'worst_acc': 0.7399, 'acc_0_0': 0.9619, 'acc_0_1': 0.9463, 'acc_1_0': 0.7399, 'acc_1_1': 0.7523, 'mean_acc': 0.908}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7612, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7414, 'acc_0_0': 0.9636, 'acc_0_1': 0.9459, 'acc_1_0': 0.7414, 'acc_1_1': 0.757, 'mean_acc': 0.9092}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7508, 'acc_0_0': 0.9619, 'acc_0_1': 0.9379, 'acc_1_0': 0.7508, 'acc_1_1': 0.7804, 'mean_acc': 0.909}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7586, 'acc_0_0': 0.9588, 'acc_0_1': 0.9357, 'acc_1_0': 0.7586, 'acc_1_1': 0.7819, 'mean_acc': 0.908}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7632, 'acc_0_0': 0.957, 'acc_0_1': 0.9344, 'acc_1_0': 0.7632, 'acc_1_1': 0.7866, 'mean_acc': 0.9078}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7695, 'acc_0_0': 0.9499, 'acc_0_1': 0.9326, 'acc_1_0': 0.7695, 'acc_1_1': 0.7882, 'mean_acc': 0.9052}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7632, 'acc_0_0': 0.9521, 'acc_0_1': 0.9353, 'acc_1_0': 0.7632, 'acc_1_1': 0.7804, 'mean_acc': 0.9056}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7648, 'acc_0_0': 0.9508, 'acc_0_1': 0.9353, 'acc_1_0': 0.7648, 'acc_1_1': 0.7804, 'mean_acc': 0.9052}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7664, 'acc_0_0': 0.9503, 'acc_0_1': 0.9353, 'acc_1_0': 0.7664, 'acc_1_1': 0.7819, 'mean_acc': 0.9054}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7664, 'acc_0_0': 0.9499, 'acc_0_1': 0.9366, 'acc_1_0': 0.7664, 'acc_1_1': 0.7788, 'mean_acc': 0.9054}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7664, 'acc_0_0': 0.9499, 'acc_0_1': 0.9375, 'acc_1_0': 0.7664, 'acc_1_1': 0.7773, 'mean_acc': 0.9056}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7632, 'acc_0_0': 0.9494, 'acc_0_1': 0.9379, 'acc_1_0': 0.7632, 'acc_1_1': 0.7788, 'mean_acc': 0.9054}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9098, 'worst_acc': 0.7601, 'acc_0_0': 0.9503, 'acc_0_1': 0.9384, 'acc_1_0': 0.7601, 'acc_1_1': 0.7788, 'mean_acc': 0.9056}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7632, 'acc_0_0': 0.9494, 'acc_0_1': 0.937, 'acc_1_0': 0.7632, 'acc_1_1': 0.7804, 'mean_acc': 0.9052}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7679, 'acc_0_0': 0.9486, 'acc_0_1': 0.9357, 'acc_1_0': 0.7679, 'acc_1_1': 0.7835, 'mean_acc': 0.9052}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9093, 'worst_acc': 0.7679, 'acc_0_0': 0.949, 'acc_0_1': 0.937, 'acc_1_0': 0.7679, 'acc_1_1': 0.7804, 'mean_acc': 0.9056}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.771, 'acc_0_0': 0.9468, 'acc_0_1': 0.9344, 'acc_1_0': 0.771, 'acc_1_1': 0.785, 'mean_acc': 0.9046}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.771, 'acc_0_0': 0.9468, 'acc_0_1': 0.9348, 'acc_1_0': 0.771, 'acc_1_1': 0.7835, 'mean_acc': 0.9046}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7695, 'acc_0_0': 0.9486, 'acc_0_1': 0.9344, 'acc_1_0': 0.7695, 'acc_1_1': 0.7866, 'mean_acc': 0.9052}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7741, 'acc_0_0': 0.9472, 'acc_0_1': 0.9335, 'acc_1_0': 0.7741, 'acc_1_1': 0.7882, 'mean_acc': 0.9051}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.771, 'acc_0_0': 0.9472, 'acc_0_1': 0.9339, 'acc_1_0': 0.771, 'acc_1_1': 0.7882, 'mean_acc': 0.9049}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7741, 'acc_0_0': 0.9441, 'acc_0_1': 0.9317, 'acc_1_0': 0.7741, 'acc_1_1': 0.7882, 'mean_acc': 0.9032}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7741, 'acc_0_0': 0.9441, 'acc_0_1': 0.9308, 'acc_1_0': 0.7741, 'acc_1_1': 0.796, 'mean_acc': 0.9037}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.908, 'worst_acc': 0.7726, 'acc_0_0': 0.9455, 'acc_0_1': 0.9357, 'acc_1_0': 0.7726, 'acc_1_1': 0.7866, 'mean_acc': 0.9049}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7726, 'acc_0_0': 0.9437, 'acc_0_1': 0.9344, 'acc_1_0': 0.7726, 'acc_1_1': 0.7866, 'mean_acc': 0.9037}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.771, 'acc_0_0': 0.9455, 'acc_0_1': 0.9353, 'acc_1_0': 0.771, 'acc_1_1': 0.785, 'mean_acc': 0.9044}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.771, 'acc_0_0': 0.9472, 'acc_0_1': 0.9344, 'acc_1_0': 0.771, 'acc_1_1': 0.7882, 'mean_acc': 0.9051}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.771, 'acc_0_0': 0.9472, 'acc_0_1': 0.9339, 'acc_1_0': 0.771, 'acc_1_1': 0.7882, 'mean_acc': 0.9049}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.771, 'acc_0_0': 0.9477, 'acc_0_1': 0.933, 'acc_1_0': 0.771, 'acc_1_1': 0.7897, 'mean_acc': 0.9049}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.771, 'acc_0_0': 0.949, 'acc_0_1': 0.9335, 'acc_1_0': 0.771, 'acc_1_1': 0.7882, 'mean_acc': 0.9054}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7726, 'acc_0_0': 0.949, 'acc_0_1': 0.9348, 'acc_1_0': 0.7726, 'acc_1_1': 0.7882, 'mean_acc': 0.9061}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8939, 'acc_0_0': 0.9442, 'acc_0_1': 0.9528, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9449}
best validation accuracy on [class]: {'weighted_mean_acc': 0.909, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9}
best test accuracy on [class]: {'weighted_mean_acc': 0.8907, 'worst_acc': 0.8738, 'acc_0_0': 0.89, 'acc_0_1': 0.8798, 'acc_1_0': 0.8738, 'acc_1_1': 0.8956, 'mean_acc': 0.8849}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8907, 'worst_acc': 0.8738, 'acc_0_0': 0.89, 'acc_0_1': 0.8798, 'acc_1_0': 0.8738, 'acc_1_1': 0.8956, 'mean_acc': 0.8849}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.8838, 'acc_0_0': 0.9823, 'acc_0_1': 0.8838, 'acc_1_0': 0.8972, 'acc_1_1': 0.9595, 'mean_acc': 0.932}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8939, 'acc_0_0': 0.9442, 'acc_0_1': 0.9528, 'acc_1_0': 0.8939, 'acc_1_1': 0.9701, 'mean_acc': 0.9449}, 'Val': {'weighted_mean_acc': 0.909, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.897, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.9}, 'Test': {'weighted_mean_acc': 0.8907, 'worst_acc': 0.8738, 'acc_0_0': 0.89, 'acc_0_1': 0.8798, 'acc_1_0': 0.8738, 'acc_1_1': 0.8956, 'mean_acc': 0.8849}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8907, 'worst_acc': 0.8738, 'acc_0_0': 0.89, 'acc_0_1': 0.8798, 'acc_1_0': 0.8738, 'acc_1_1': 0.8956, 'mean_acc': 0.8849}, 'spurious': {'weighted_mean_acc': 0.9725, 'worst_acc': 0.8838, 'acc_0_0': 0.9823, 'acc_0_1': 0.8838, 'acc_1_0': 0.8972, 'acc_1_1': 0.9595, 'mean_acc': 0.932}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.25, 'acc_0_0': 0.8957, 'acc_0_1': 0.7717, 'acc_1_0': 0.25, 'acc_1_1': 0.2819, 'mean_acc': 0.7481}
Val(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.3047, 'acc_0_0': 0.9829, 'acc_0_1': 0.3047, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6767}
Test(class): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.2381, 'acc_0_0': 0.9676, 'acc_0_1': 0.2381, 'acc_1_0': 0.6168, 'acc_1_1': 0.9735, 'mean_acc': 0.6455}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1902, 'acc_0_0': 0.9565, 'acc_0_1': 0.1902, 'acc_1_0': 0.6964, 'acc_1_1': 0.9858, 'mean_acc': 0.9306}
Val(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.2403, 'acc_0_0': 0.9872, 'acc_0_1': 0.2403, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6583}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2124, 'acc_0_0': 0.9792, 'acc_0_1': 0.2124, 'acc_1_0': 0.6433, 'acc_1_1': 0.972, 'mean_acc': 0.6427}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.996, 'acc_0_1': 0.587, 'acc_1_0': 0.4464, 'acc_1_1': 0.9007, 'mean_acc': 0.9529}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.2961, 'acc_0_0': 1.0, 'acc_0_1': 0.2961, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.685}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.2736, 'acc_0_0': 0.9827, 'acc_0_1': 0.2736, 'acc_1_0': 0.6449, 'acc_1_1': 0.9688, 'mean_acc': 0.6678}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9946, 'acc_0_1': 0.625, 'acc_1_0': 0.5714, 'acc_1_1': 0.9338, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3262, 'acc_0_0': 0.9915, 'acc_0_1': 0.3262, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.6983}
Test(class): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.29, 'acc_0_0': 0.9778, 'acc_0_1': 0.29, 'acc_1_0': 0.6729, 'acc_1_1': 0.9704, 'mean_acc': 0.6755}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4348, 'acc_0_0': 0.9903, 'acc_0_1': 0.4348, 'acc_1_0': 0.6786, 'acc_1_1': 0.9763, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.4163, 'acc_0_0': 0.9915, 'acc_0_1': 0.4163, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.3579, 'acc_0_0': 0.9792, 'acc_0_1': 0.3579, 'acc_1_0': 0.6822, 'acc_1_1': 0.9657, 'mean_acc': 0.703}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5761, 'acc_0_0': 0.99, 'acc_0_1': 0.5761, 'acc_1_0': 0.7143, 'acc_1_1': 0.9707, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.618, 'acc_0_0': 0.9872, 'acc_0_1': 0.618, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5685, 'acc_0_0': 0.9849, 'acc_0_1': 0.5685, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.7813}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.6429, 'acc_1_1': 0.9376, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6402, 'acc_0_0': 0.9867, 'acc_0_1': 0.6838, 'acc_1_0': 0.6402, 'acc_1_1': 0.9159, 'mean_acc': 0.8226}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7337, 'acc_1_0': 0.6964, 'acc_1_1': 0.947, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5716, 'acc_0_0': 0.9854, 'acc_0_1': 0.5716, 'acc_1_0': 0.6495, 'acc_1_1': 0.9424, 'mean_acc': 0.7824}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9909, 'acc_0_1': 0.6467, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5446, 'acc_0_0': 0.9863, 'acc_0_1': 0.5446, 'acc_1_0': 0.6464, 'acc_1_1': 0.947, 'mean_acc': 0.7724}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9687, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6133, 'acc_0_0': 0.9885, 'acc_0_1': 0.6133, 'acc_1_0': 0.6137, 'acc_1_1': 0.933, 'mean_acc': 0.7948}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9957, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6059, 'acc_0_0': 0.9894, 'acc_0_1': 0.651, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8088}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9954, 'acc_0_1': 0.7065, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6093, 'acc_0_0': 0.9889, 'acc_0_1': 0.6093, 'acc_1_0': 0.634, 'acc_1_1': 0.9424, 'mean_acc': 0.7967}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.608, 'acc_0_0': 0.9889, 'acc_0_1': 0.608, 'acc_1_0': 0.6417, 'acc_1_1': 0.9424, 'mean_acc': 0.797}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9943, 'acc_0_1': 0.7065, 'acc_1_0': 0.8214, 'acc_1_1': 0.9688, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6231, 'acc_1_1': 0.9346, 'mean_acc': 0.8098}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9949, 'acc_0_1': 0.7283, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6168, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.6168, 'acc_1_1': 0.9393, 'mean_acc': 0.8098}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.994, 'acc_0_1': 0.7011, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9722, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6284, 'acc_1_0': 0.6153, 'acc_1_1': 0.9424, 'mean_acc': 0.8024}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9946, 'acc_0_1': 0.712, 'acc_1_0': 0.7857, 'acc_1_1': 0.964, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5981, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9393, 'mean_acc': 0.8077}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9971, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9738, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5779, 'acc_0_0': 0.9929, 'acc_0_1': 0.6918, 'acc_1_0': 0.5779, 'acc_1_1': 0.933, 'mean_acc': 0.8231}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6213, 'acc_0_0': 0.9894, 'acc_0_1': 0.6213, 'acc_1_0': 0.6215, 'acc_1_1': 0.9439, 'mean_acc': 0.8003}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9931, 'acc_0_1': 0.7228, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6199, 'acc_0_0': 0.9898, 'acc_0_1': 0.6461, 'acc_1_0': 0.6199, 'acc_1_1': 0.9439, 'mean_acc': 0.81}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9974, 'acc_0_1': 0.7772, 'acc_1_0': 0.8036, 'acc_1_1': 0.9669, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6798, 'acc_1_0': 0.5966, 'acc_1_1': 0.9377, 'mean_acc': 0.8207}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.998, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9622, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6714, 'acc_1_0': 0.5966, 'acc_1_1': 0.9408, 'mean_acc': 0.8177}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6315, 'acc_0_0': 0.9889, 'acc_0_1': 0.6315, 'acc_1_0': 0.6324, 'acc_1_1': 0.9439, 'mean_acc': 0.8053}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9971, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.6763, 'acc_1_0': 0.6121, 'acc_1_1': 0.9393, 'mean_acc': 0.8207}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9986, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.6692, 'acc_1_0': 0.6121, 'acc_1_1': 0.9408, 'mean_acc': 0.8184}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9977, 'acc_0_1': 0.788, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6603, 'acc_1_0': 0.6137, 'acc_1_1': 0.9424, 'mean_acc': 0.8152}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9977, 'acc_0_1': 0.8098, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.663, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8171}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9994, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9745, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6231, 'acc_0_0': 0.9911, 'acc_0_1': 0.678, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8224}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.9994, 'acc_0_1': 0.8424, 'acc_1_0': 0.9107, 'acc_1_1': 0.982, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.671, 'acc_1_0': 0.6231, 'acc_1_1': 0.9393, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9849, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8164}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9994, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9801, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6355, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.6355, 'acc_1_1': 0.9393, 'mean_acc': 0.8183}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9849, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.686, 'acc_1_0': 0.6215, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9997, 'acc_0_1': 0.8641, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6794, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 1.0, 'acc_0_1': 0.9076, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7073, 'acc_1_0': 0.5981, 'acc_1_1': 0.9377, 'mean_acc': 0.831}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.994}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.694, 'acc_1_0': 0.6137, 'acc_1_1': 0.9393, 'mean_acc': 0.8267}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9905, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6803, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8217}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.6661, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8171}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7153, 'acc_1_0': 0.5981, 'acc_1_1': 0.9361, 'mean_acc': 0.834}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6028, 'acc_0_0': 0.9894, 'acc_0_1': 0.7091, 'acc_1_0': 0.6028, 'acc_1_1': 0.9346, 'mean_acc': 0.8314}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4091, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.4091, 'acc_1_1': 0.9254, 'mean_acc': 0.818}
Val(class)(new adapter): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.4627, 'acc_0_0': 0.9957, 'acc_0_1': 0.9313, 'acc_1_0': 0.4627, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.943, 'worst_acc': 0.486, 'acc_0_0': 0.9956, 'acc_0_1': 0.9286, 'acc_1_0': 0.486, 'acc_1_1': 0.796, 'mean_acc': 0.8909}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0758, 'acc_0_0': 0.9571, 'acc_0_1': 0.3133, 'acc_1_0': 0.0758, 'acc_1_1': 0.4776, 'mean_acc': 0.5559}
Val(class)(new adapter): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.6309, 'acc_0_0': 0.9658, 'acc_0_1': 0.6309, 'acc_1_0': 0.806, 'acc_1_1': 1.0, 'mean_acc': 0.8217}
Test(class)(new adapter): {'weighted_mean_acc': 0.954, 'worst_acc': 0.6146, 'acc_0_0': 0.9756, 'acc_0_1': 0.6146, 'acc_1_0': 0.729, 'acc_1_1': 0.9533, 'mean_acc': 0.8053}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7124, 'acc_0_0': 0.9399, 'acc_0_1': 0.7124, 'acc_1_0': 0.7576, 'acc_1_1': 0.9552, 'mean_acc': 0.8331}
Val(class)(new adapter): {'weighted_mean_acc': 0.8405, 'worst_acc': 0.4091, 'acc_0_0': 0.9658, 'acc_0_1': 0.9657, 'acc_1_0': 0.7463, 'acc_1_1': 0.4091, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.8551, 'worst_acc': 0.4346, 'acc_0_0': 0.9774, 'acc_0_1': 0.9769, 'acc_1_0': 0.7508, 'acc_1_1': 0.4346, 'mean_acc': 0.892}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1791, 'acc_0_0': 0.5193, 'acc_0_1': 0.9957, 'acc_1_0': 0.2121, 'acc_1_1': 0.1791, 'mean_acc': 0.6327}
Val(class)(new adapter): {'weighted_mean_acc': 0.8134, 'worst_acc': 0.1818, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.4627, 'acc_1_1': 0.1818, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.8128, 'worst_acc': 0.1854, 'acc_0_0': 0.9973, 'acc_0_1': 0.9996, 'acc_1_0': 0.5171, 'acc_1_1': 0.1854, 'mean_acc': 0.855}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6061, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.6061, 'acc_1_1': 0.7164, 'mean_acc': 0.9215}
Val(class)(new adapter): {'weighted_mean_acc': 0.9529, 'worst_acc': 0.7761, 'acc_0_0': 0.9701, 'acc_0_1': 0.9313, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.9267}
Test(class)(new adapter): {'weighted_mean_acc': 0.941, 'worst_acc': 0.7648, 'acc_0_0': 0.9712, 'acc_0_1': 0.9233, 'acc_1_0': 0.7648, 'acc_1_1': 0.8536, 'mean_acc': 0.9166}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.9185, 'acc_0_1': 0.824, 'acc_1_0': 0.8636, 'acc_1_1': 0.5522, 'mean_acc': 0.8347}
Val(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.8412, 'acc_0_0': 0.9231, 'acc_0_1': 0.8412, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.8399, 'acc_0_0': 0.9273, 'acc_0_1': 0.8399, 'acc_1_0': 0.8551, 'acc_1_1': 0.9128, 'mean_acc': 0.8837}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.8798, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8738, 'acc_0_0': 0.9082, 'acc_0_1': 0.8776, 'acc_1_0': 0.8738, 'acc_1_1': 0.8754, 'mean_acc': 0.8889}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7761, 'acc_0_0': 0.9442, 'acc_0_1': 0.9442, 'acc_1_0': 0.8485, 'acc_1_1': 0.7761, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.8803, 'worst_acc': 0.8333, 'acc_0_0': 0.8932, 'acc_0_1': 0.9013, 'acc_1_0': 0.8955, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.861, 'worst_acc': 0.8115, 'acc_0_0': 0.8732, 'acc_0_1': 0.9082, 'acc_1_0': 0.8816, 'acc_1_1': 0.8115, 'mean_acc': 0.8809}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.8182, 'acc_1_1': 0.8657, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.865, 'worst_acc': 0.8333, 'acc_0_0': 0.8718, 'acc_0_1': 0.927, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8403, 'worst_acc': 0.7819, 'acc_0_0': 0.8532, 'acc_0_1': 0.9188, 'acc_1_0': 0.8785, 'acc_1_1': 0.7819, 'mean_acc': 0.8737}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9056, 'acc_0_0': 0.9056, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9403, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.8302, 'acc_0_0': 0.9313, 'acc_0_1': 0.9144, 'acc_1_0': 0.8302, 'acc_1_1': 0.8349, 'mean_acc': 0.9028}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 0.9742, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.6866, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7617, 'acc_0_0': 0.9557, 'acc_0_1': 0.9202, 'acc_1_0': 0.7617, 'acc_1_1': 0.8318, 'mean_acc': 0.9066}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.771, 'acc_0_0': 0.949, 'acc_0_1': 0.9091, 'acc_1_0': 0.771, 'acc_1_1': 0.8333, 'mean_acc': 0.9009}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.8146, 'acc_0_0': 0.9375, 'acc_0_1': 0.9082, 'acc_1_0': 0.8146, 'acc_1_1': 0.8162, 'mean_acc': 0.899}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.7913, 'acc_0_0': 0.9295, 'acc_0_1': 0.9153, 'acc_1_0': 0.824, 'acc_1_1': 0.7913, 'mean_acc': 0.897}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8182, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.7835, 'acc_0_0': 0.9273, 'acc_0_1': 0.9193, 'acc_1_0': 0.8271, 'acc_1_1': 0.7835, 'mean_acc': 0.8971}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.791, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8965, 'worst_acc': 0.7819, 'acc_0_0': 0.9313, 'acc_0_1': 0.9171, 'acc_1_0': 0.8193, 'acc_1_1': 0.7819, 'mean_acc': 0.8968}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9075, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.7928, 'acc_0_0': 0.9428, 'acc_0_1': 0.9206, 'acc_1_0': 0.8084, 'acc_1_1': 0.7928, 'mean_acc': 0.9027}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9073, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.8084, 'acc_0_0': 0.9446, 'acc_0_1': 0.9126, 'acc_1_0': 0.81, 'acc_1_1': 0.8084, 'mean_acc': 0.9021}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.8022, 'acc_0_0': 0.9477, 'acc_0_1': 0.9109, 'acc_1_0': 0.8022, 'acc_1_1': 0.8131, 'mean_acc': 0.9023}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.8053, 'acc_0_0': 0.9437, 'acc_0_1': 0.9122, 'acc_1_0': 0.8053, 'acc_1_1': 0.8146, 'mean_acc': 0.9018}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.7761, 'acc_1_1': 0.8636, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.8037, 'acc_0_0': 0.941, 'acc_0_1': 0.9202, 'acc_1_0': 0.8053, 'acc_1_1': 0.8037, 'mean_acc': 0.9027}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7835, 'acc_0_0': 0.9432, 'acc_0_1': 0.9268, 'acc_1_0': 0.7928, 'acc_1_1': 0.7835, 'mean_acc': 0.9025}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9028, 'worst_acc': 0.7664, 'acc_0_0': 0.9441, 'acc_0_1': 0.9353, 'acc_1_0': 0.7897, 'acc_1_1': 0.7664, 'mean_acc': 0.9039}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.7523, 'acc_0_0': 0.9503, 'acc_0_1': 0.9432, 'acc_1_0': 0.7804, 'acc_1_1': 0.7523, 'mean_acc': 0.9068}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7368, 'acc_0_0': 0.9565, 'acc_0_1': 0.949, 'acc_1_0': 0.7648, 'acc_1_1': 0.7368, 'mean_acc': 0.908}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.729, 'acc_0_0': 0.9596, 'acc_0_1': 0.9543, 'acc_1_0': 0.743, 'acc_1_1': 0.729, 'mean_acc': 0.908}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.6716, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.715, 'acc_0_0': 0.9645, 'acc_0_1': 0.9605, 'acc_1_0': 0.7305, 'acc_1_1': 0.715, 'mean_acc': 0.9094}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.6866, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7196, 'acc_0_0': 0.9654, 'acc_0_1': 0.9592, 'acc_1_0': 0.729, 'acc_1_1': 0.7196, 'mean_acc': 0.9096}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.6866, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7274, 'acc_0_0': 0.9659, 'acc_0_1': 0.9601, 'acc_1_0': 0.7305, 'acc_1_1': 0.7274, 'mean_acc': 0.9111}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.6866, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7274, 'acc_0_0': 0.9663, 'acc_0_1': 0.9583, 'acc_1_0': 0.7274, 'acc_1_1': 0.729, 'mean_acc': 0.9104}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.6866, 'acc_0_0': 0.9444, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7243, 'acc_0_0': 0.9681, 'acc_0_1': 0.9552, 'acc_1_0': 0.7243, 'acc_1_1': 0.7368, 'mean_acc': 0.9104}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7352, 'acc_0_0': 0.9667, 'acc_0_1': 0.9481, 'acc_1_0': 0.7352, 'acc_1_1': 0.7539, 'mean_acc': 0.9103}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7399, 'acc_0_0': 0.9654, 'acc_0_1': 0.9401, 'acc_1_0': 0.7399, 'acc_1_1': 0.7632, 'mean_acc': 0.9082}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7445, 'acc_0_0': 0.965, 'acc_0_1': 0.937, 'acc_1_0': 0.7445, 'acc_1_1': 0.7632, 'mean_acc': 0.9073}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7508, 'acc_0_0': 0.9627, 'acc_0_1': 0.933, 'acc_1_0': 0.7508, 'acc_1_1': 0.7741, 'mean_acc': 0.9068}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7508, 'acc_0_0': 0.9614, 'acc_0_1': 0.933, 'acc_1_0': 0.7508, 'acc_1_1': 0.7757, 'mean_acc': 0.9065}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7492, 'acc_0_0': 0.9614, 'acc_0_1': 0.9326, 'acc_1_0': 0.7492, 'acc_1_1': 0.7757, 'mean_acc': 0.9061}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9167, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7523, 'acc_0_0': 0.9614, 'acc_0_1': 0.9326, 'acc_1_0': 0.7523, 'acc_1_1': 0.7788, 'mean_acc': 0.9068}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.757, 'acc_0_0': 0.9592, 'acc_0_1': 0.9322, 'acc_1_0': 0.757, 'acc_1_1': 0.7788, 'mean_acc': 0.9063}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7586, 'acc_0_0': 0.9579, 'acc_0_1': 0.9322, 'acc_1_0': 0.7586, 'acc_1_1': 0.7804, 'mean_acc': 0.9061}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.757, 'acc_0_0': 0.9592, 'acc_0_1': 0.933, 'acc_1_0': 0.757, 'acc_1_1': 0.7773, 'mean_acc': 0.9065}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7555, 'acc_0_0': 0.9601, 'acc_0_1': 0.9339, 'acc_1_0': 0.7555, 'acc_1_1': 0.7773, 'mean_acc': 0.907}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7461, 'acc_0_0': 0.9605, 'acc_0_1': 0.9353, 'acc_1_0': 0.7461, 'acc_1_1': 0.7664, 'mean_acc': 0.9054}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7523, 'acc_0_0': 0.9601, 'acc_0_1': 0.9353, 'acc_1_0': 0.7523, 'acc_1_1': 0.7695, 'mean_acc': 0.9063}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7555, 'acc_0_0': 0.9592, 'acc_0_1': 0.9348, 'acc_1_0': 0.7555, 'acc_1_1': 0.7664, 'mean_acc': 0.9058}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7523, 'acc_0_0': 0.9601, 'acc_0_1': 0.9366, 'acc_1_0': 0.7523, 'acc_1_1': 0.7617, 'mean_acc': 0.9059}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.757, 'acc_0_0': 0.9588, 'acc_0_1': 0.9353, 'acc_1_0': 0.757, 'acc_1_1': 0.7617, 'mean_acc': 0.9054}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7555, 'acc_0_0': 0.9592, 'acc_0_1': 0.9353, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9054}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7586, 'acc_0_0': 0.9574, 'acc_0_1': 0.9348, 'acc_1_0': 0.7586, 'acc_1_1': 0.7648, 'mean_acc': 0.9052}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9121, 'worst_acc': 0.7586, 'acc_0_0': 0.9574, 'acc_0_1': 0.9353, 'acc_1_0': 0.7586, 'acc_1_1': 0.7664, 'mean_acc': 0.9056}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9353, 'acc_1_0': 0.757, 'acc_1_1': 0.7648, 'mean_acc': 0.9051}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7586, 'acc_0_0': 0.9565, 'acc_0_1': 0.9344, 'acc_1_0': 0.7586, 'acc_1_1': 0.7679, 'mean_acc': 0.9051}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9131, 'worst_acc': 0.7555, 'acc_0_0': 0.9601, 'acc_0_1': 0.9366, 'acc_1_0': 0.7555, 'acc_1_1': 0.7617, 'mean_acc': 0.9063}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7508, 'acc_0_0': 0.961, 'acc_0_1': 0.9375, 'acc_1_0': 0.7508, 'acc_1_1': 0.7601, 'mean_acc': 0.9063}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7555, 'acc_0_0': 0.9601, 'acc_0_1': 0.9348, 'acc_1_0': 0.7555, 'acc_1_1': 0.7664, 'mean_acc': 0.9061}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7523, 'acc_0_0': 0.9605, 'acc_0_1': 0.9357, 'acc_1_0': 0.7523, 'acc_1_1': 0.7664, 'mean_acc': 0.9063}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.757, 'acc_0_0': 0.9579, 'acc_0_1': 0.9344, 'acc_1_0': 0.757, 'acc_1_1': 0.7664, 'mean_acc': 0.9052}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7601, 'acc_0_0': 0.9565, 'acc_0_1': 0.9366, 'acc_1_0': 0.7601, 'acc_1_1': 0.7632, 'mean_acc': 0.9056}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7586, 'acc_0_0': 0.957, 'acc_0_1': 0.9348, 'acc_1_0': 0.7586, 'acc_1_1': 0.7664, 'mean_acc': 0.9052}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9366, 'acc_1_0': 0.757, 'acc_1_1': 0.7648, 'mean_acc': 0.9056}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8182, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9499}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9083, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.8798, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.8933}
best test accuracy on [class]: {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8738, 'acc_0_0': 0.9082, 'acc_0_1': 0.8776, 'acc_1_0': 0.8738, 'acc_1_1': 0.8754, 'mean_acc': 0.8889}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8738, 'acc_0_0': 0.9082, 'acc_0_1': 0.8776, 'acc_1_0': 0.8738, 'acc_1_1': 0.8754, 'mean_acc': 0.8889}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.8754, 'acc_0_0': 0.9823, 'acc_0_1': 0.8887, 'acc_1_0': 0.8754, 'acc_1_1': 0.9642, 'mean_acc': 0.932}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8182, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9499}, 'Val': {'weighted_mean_acc': 0.9083, 'worst_acc': 0.8657, 'acc_0_0': 0.9103, 'acc_0_1': 0.8798, 'acc_1_0': 0.8657, 'acc_1_1': 0.9091, 'mean_acc': 0.8933}, 'Test': {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8738, 'acc_0_0': 0.9082, 'acc_0_1': 0.8776, 'acc_1_0': 0.8738, 'acc_1_1': 0.8754, 'mean_acc': 0.8889}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8994, 'worst_acc': 0.8738, 'acc_0_0': 0.9082, 'acc_0_1': 0.8776, 'acc_1_0': 0.8738, 'acc_1_1': 0.8754, 'mean_acc': 0.8889}, 'spurious': {'weighted_mean_acc': 0.9734, 'worst_acc': 0.8754, 'acc_0_0': 0.9823, 'acc_0_1': 0.8887, 'acc_1_0': 0.8754, 'acc_1_1': 0.9642, 'mean_acc': 0.932}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.4457, 'acc_0_0': 0.9168, 'acc_0_1': 0.4457, 'acc_1_0': 0.4821, 'acc_1_1': 0.6377, 'mean_acc': 0.8321}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.2618, 'acc_0_0': 0.9915, 'acc_0_1': 0.2618, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6633}
Test(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.2293, 'acc_0_0': 0.9836, 'acc_0_1': 0.2293, 'acc_1_0': 0.5748, 'acc_1_1': 0.9704, 'mean_acc': 0.6433}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4643, 'acc_0_0': 0.9943, 'acc_0_1': 0.6196, 'acc_1_0': 0.4643, 'acc_1_1': 0.8723, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.3176, 'acc_0_0': 0.9957, 'acc_0_1': 0.3176, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6917}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.3193, 'acc_0_0': 0.9809, 'acc_0_1': 0.3193, 'acc_1_0': 0.6417, 'acc_1_1': 0.9642, 'mean_acc': 0.684}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9871, 'acc_0_1': 0.4891, 'acc_1_0': 0.6607, 'acc_1_1': 0.9527, 'mean_acc': 0.9566}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2918, 'acc_0_0': 0.9829, 'acc_0_1': 0.2918, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.6833}
Test(class): {'weighted_mean_acc': 0.941, 'worst_acc': 0.2878, 'acc_0_0': 0.9685, 'acc_0_1': 0.2878, 'acc_1_0': 0.7274, 'acc_1_1': 0.9751, 'mean_acc': 0.6776}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5272, 'acc_0_0': 0.9728, 'acc_0_1': 0.5272, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9514}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.6244, 'acc_0_0': 0.9858, 'acc_0_1': 0.6244, 'acc_1_0': 0.6386, 'acc_1_1': 0.933, 'mean_acc': 0.8008}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9977, 'acc_0_1': 0.8641, 'acc_1_0': 0.5357, 'acc_1_1': 0.8846, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6438, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6302, 'acc_0_0': 0.9831, 'acc_0_1': 0.6302, 'acc_1_0': 0.6838, 'acc_1_1': 0.9346, 'mean_acc': 0.8072}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9808, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9518, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.4893, 'acc_0_0': 0.9786, 'acc_0_1': 0.4893, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.4315, 'acc_0_0': 0.9685, 'acc_0_1': 0.4315, 'acc_1_0': 0.729, 'acc_1_1': 0.9611, 'mean_acc': 0.7321}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9926, 'acc_0_1': 0.6793, 'acc_1_0': 0.6429, 'acc_1_1': 0.9508, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.6738, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5312, 'acc_0_0': 0.9929, 'acc_0_1': 0.6834, 'acc_1_0': 0.5312, 'acc_1_1': 0.9143, 'mean_acc': 0.8126}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9994, 'acc_0_1': 0.7826, 'acc_1_0': 0.5, 'acc_1_1': 0.9234, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.5536, 'acc_0_0': 0.9915, 'acc_0_1': 0.5536, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.775}
Test(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5583, 'acc_0_0': 0.9876, 'acc_0_1': 0.5583, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.7713}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.996, 'acc_0_1': 0.6141, 'acc_1_0': 0.6071, 'acc_1_1': 0.9659, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5365, 'acc_0_0': 0.9872, 'acc_0_1': 0.5365, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7733}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.5153, 'acc_0_0': 0.9863, 'acc_0_1': 0.5153, 'acc_1_0': 0.6246, 'acc_1_1': 0.9439, 'mean_acc': 0.7582}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9969, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.948, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.5498, 'acc_0_0': 0.9916, 'acc_0_1': 0.6816, 'acc_1_0': 0.5498, 'acc_1_1': 0.9112, 'mean_acc': 0.8131}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.6071, 'acc_1_1': 0.9423, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.5522, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5748, 'acc_0_0': 0.9898, 'acc_0_1': 0.6612, 'acc_1_0': 0.5748, 'acc_1_1': 0.9159, 'mean_acc': 0.8077}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.6957, 'acc_1_0': 0.6786, 'acc_1_1': 0.9565, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.581, 'acc_0_0': 0.9916, 'acc_0_1': 0.651, 'acc_1_0': 0.581, 'acc_1_1': 0.919, 'mean_acc': 0.8055}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9977, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.6931, 'acc_1_0': 0.567, 'acc_1_1': 0.9128, 'mean_acc': 0.8202}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9983, 'acc_0_1': 0.7663, 'acc_1_0': 0.6964, 'acc_1_1': 0.9518, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5779, 'acc_0_0': 0.9925, 'acc_0_1': 0.6905, 'acc_1_0': 0.5779, 'acc_1_1': 0.9174, 'mean_acc': 0.8207}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9546, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.6829, 'acc_1_0': 0.5841, 'acc_1_1': 0.9221, 'mean_acc': 0.819}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.998, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9574, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5888, 'acc_0_0': 0.992, 'acc_0_1': 0.6838, 'acc_1_0': 0.5888, 'acc_1_1': 0.9252, 'mean_acc': 0.82}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9977, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9929, 'acc_0_1': 0.7029, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8271}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9489, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7091, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8293}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.6656, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8152}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9986, 'acc_0_1': 0.7772, 'acc_1_0': 0.75, 'acc_1_1': 0.9603, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5732, 'acc_0_0': 0.9938, 'acc_0_1': 0.7299, 'acc_1_0': 0.5732, 'acc_1_1': 0.9237, 'mean_acc': 0.8367}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6652, 'acc_1_0': 0.6137, 'acc_1_1': 0.9361, 'mean_acc': 0.8164}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9986, 'acc_0_1': 0.7609, 'acc_1_0': 0.875, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.595, 'acc_0_0': 0.9925, 'acc_0_1': 0.7069, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.83}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8214, 'acc_1_1': 0.9631, 'mean_acc': 0.9823}
Val(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5981, 'acc_0_0': 0.992, 'acc_0_1': 0.7069, 'acc_1_0': 0.5981, 'acc_1_1': 0.9268, 'mean_acc': 0.8302}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9983, 'acc_0_1': 0.8098, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9916, 'acc_0_1': 0.6914, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9986, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9707, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.7118, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8326}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9991, 'acc_0_1': 0.8207, 'acc_1_0': 0.875, 'acc_1_1': 0.9773, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8295}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6028, 'acc_0_0': 0.9925, 'acc_0_1': 0.7171, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.8348}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9726, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6028, 'acc_0_0': 0.9938, 'acc_0_1': 0.729, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.702, 'acc_1_0': 0.6106, 'acc_1_1': 0.9361, 'mean_acc': 0.8303}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9991, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.7166, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8359}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9782, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.9658, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7277, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8402}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9991, 'acc_0_1': 0.8587, 'acc_1_0': 0.9464, 'acc_1_1': 0.982, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.7095, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8331}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9997, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.609, 'acc_0_0': 0.9925, 'acc_0_1': 0.7424, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9997, 'acc_0_1': 0.8967, 'acc_1_0': 0.9464, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6012, 'acc_0_0': 0.9933, 'acc_0_1': 0.7614, 'acc_1_0': 0.6012, 'acc_1_1': 0.9237, 'mean_acc': 0.8519}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.7419, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.846}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9994, 'acc_0_1': 0.8913, 'acc_1_0': 0.9821, 'acc_1_1': 0.9905, 'mean_acc': 0.9931}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.7211, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8371}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9923}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9902, 'acc_0_1': 0.7295, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8397}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9997, 'acc_0_1': 0.9022, 'acc_1_0': 0.9821, 'acc_1_1': 0.9849, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.7197, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8374}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7694, 'acc_1_0': 0.6075, 'acc_1_1': 0.9268, 'mean_acc': 0.8548}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9944}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6121, 'acc_0_0': 0.9902, 'acc_0_1': 0.7415, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8454}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3333, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.3333, 'acc_1_1': 0.9104, 'mean_acc': 0.808}
Val(class)(new adapter): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5373, 'acc_0_0': 1.0, 'acc_0_1': 0.8798, 'acc_1_0': 0.5373, 'acc_1_1': 0.8939, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.567, 'acc_0_0': 0.996, 'acc_0_1': 0.8856, 'acc_1_0': 0.567, 'acc_1_1': 0.8707, 'mean_acc': 0.8916}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.9657, 'acc_0_1': 0.2833, 'acc_1_0': 0.0, 'acc_1_1': 0.7164, 'mean_acc': 0.5659}
Val(class)(new adapter): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.7463, 'acc_0_0': 0.9872, 'acc_0_1': 0.7554, 'acc_1_0': 0.7463, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.7399, 'acc_0_0': 0.9783, 'acc_0_1': 0.7707, 'acc_1_0': 0.7399, 'acc_1_1': 0.9299, 'mean_acc': 0.8657}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.97, 'acc_0_1': 0.897, 'acc_1_0': 0.7576, 'acc_1_1': 0.9254, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.7424, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.8507, 'acc_1_1': 0.7424, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.898, 'worst_acc': 0.7477, 'acc_0_0': 0.9432, 'acc_0_1': 0.922, 'acc_1_0': 0.8271, 'acc_1_1': 0.7477, 'mean_acc': 0.9004}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1493, 'acc_0_0': 0.7082, 'acc_0_1': 0.9914, 'acc_1_0': 0.5758, 'acc_1_1': 0.1493, 'mean_acc': 0.7412}
Val(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.791, 'acc_0_0': 0.9615, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9355, 'worst_acc': 0.7788, 'acc_0_0': 0.9694, 'acc_0_1': 0.9157, 'acc_1_0': 0.7788, 'acc_1_1': 0.8349, 'mean_acc': 0.9125}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5606, 'acc_0_0': 0.9957, 'acc_0_1': 0.9742, 'acc_1_0': 0.5606, 'acc_1_1': 0.9254, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9263, 'worst_acc': 0.8455, 'acc_0_0': 0.9274, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8399, 'acc_0_0': 0.9202, 'acc_0_1': 0.8399, 'acc_1_0': 0.8567, 'acc_1_1': 0.8988, 'mean_acc': 0.8795}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9356, 'acc_0_1': 0.9056, 'acc_1_0': 0.8485, 'acc_1_1': 0.6866, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.8464, 'worst_acc': 0.7811, 'acc_0_0': 0.8205, 'acc_0_1': 0.7811, 'acc_1_0': 0.9254, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class)(new adapter): {'weighted_mean_acc': 0.8492, 'worst_acc': 0.7876, 'acc_0_0': 0.8288, 'acc_0_1': 0.7876, 'acc_1_0': 0.9206, 'acc_1_1': 0.9237, 'mean_acc': 0.8334}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9013, 'acc_0_0': 0.9185, 'acc_0_1': 0.9013, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9182}
Val(class)(new adapter): {'weighted_mean_acc': 0.8426, 'worst_acc': 0.7727, 'acc_0_0': 0.859, 'acc_0_1': 0.9313, 'acc_1_0': 0.8507, 'acc_1_1': 0.7727, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8335, 'worst_acc': 0.7165, 'acc_0_0': 0.8621, 'acc_0_1': 0.9419, 'acc_1_0': 0.9034, 'acc_1_1': 0.7165, 'mean_acc': 0.8816}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.9614, 'acc_0_1': 0.9657, 'acc_1_0': 0.9394, 'acc_1_1': 0.6269, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.81, 'worst_acc': 0.6515, 'acc_0_0': 0.8504, 'acc_0_1': 0.9485, 'acc_1_0': 0.8209, 'acc_1_1': 0.6515, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.7959, 'worst_acc': 0.6028, 'acc_0_0': 0.8439, 'acc_0_1': 0.9623, 'acc_1_0': 0.8925, 'acc_1_1': 0.6028, 'mean_acc': 0.8687}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7313, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 0.7313, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.8153, 'worst_acc': 0.7906, 'acc_0_0': 0.7906, 'acc_0_1': 0.9056, 'acc_1_0': 0.8657, 'acc_1_1': 0.8788, 'mean_acc': 0.8533}
Test(class)(new adapter): {'weighted_mean_acc': 0.7921, 'worst_acc': 0.7729, 'acc_0_0': 0.7729, 'acc_0_1': 0.9162, 'acc_1_0': 0.9206, 'acc_1_1': 0.8271, 'mean_acc': 0.8511}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9571, 'acc_0_1': 0.97, 'acc_1_0': 0.8333, 'acc_1_1': 0.9552, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.8642, 'worst_acc': 0.8376, 'acc_0_0': 0.8376, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.8365, 'worst_acc': 0.8142, 'acc_0_0': 0.8142, 'acc_0_1': 0.8497, 'acc_1_0': 0.9206, 'acc_1_1': 0.9034, 'mean_acc': 0.8497}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8831, 'worst_acc': 0.8358, 'acc_0_0': 0.8675, 'acc_0_1': 0.8712, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8729, 'worst_acc': 0.8652, 'acc_0_0': 0.8652, 'acc_0_1': 0.8674, 'acc_1_0': 0.8847, 'acc_1_1': 0.8988, 'mean_acc': 0.8719}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9742, 'acc_0_1': 0.9785, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.791, 'acc_0_0': 0.906, 'acc_0_1': 0.9485, 'acc_1_0': 0.791, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.8037, 'acc_0_0': 0.9335, 'acc_0_1': 0.9268, 'acc_1_0': 0.8115, 'acc_1_1': 0.8037, 'mean_acc': 0.903}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9742, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.901, 'worst_acc': 0.7056, 'acc_0_0': 0.9596, 'acc_0_1': 0.957, 'acc_1_0': 0.7461, 'acc_1_1': 0.7056, 'mean_acc': 0.9068}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.97, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.975}
Val(class)(new adapter): {'weighted_mean_acc': 0.887, 'worst_acc': 0.7761, 'acc_0_0': 0.9145, 'acc_0_1': 0.9657, 'acc_1_0': 0.7761, 'acc_1_1': 0.7879, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8916, 'worst_acc': 0.6869, 'acc_0_0': 0.9521, 'acc_0_1': 0.9561, 'acc_1_0': 0.7617, 'acc_1_1': 0.6869, 'mean_acc': 0.9032}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9552, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9552, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8748, 'worst_acc': 0.806, 'acc_0_0': 0.8889, 'acc_0_1': 0.9528, 'acc_1_0': 0.806, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8727, 'worst_acc': 0.715, 'acc_0_0': 0.9175, 'acc_0_1': 0.9432, 'acc_1_0': 0.8224, 'acc_1_1': 0.715, 'mean_acc': 0.8945}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9785, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.885, 'worst_acc': 0.8209, 'acc_0_0': 0.8889, 'acc_0_1': 0.9528, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8743, 'worst_acc': 0.7555, 'acc_0_0': 0.9078, 'acc_0_1': 0.9317, 'acc_1_0': 0.8396, 'acc_1_1': 0.7555, 'mean_acc': 0.8926}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9005, 'worst_acc': 0.806, 'acc_0_0': 0.906, 'acc_0_1': 0.9485, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.8976, 'worst_acc': 0.7866, 'acc_0_0': 0.9308, 'acc_0_1': 0.9259, 'acc_1_0': 0.8271, 'acc_1_1': 0.7866, 'mean_acc': 0.9014}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7866, 'acc_0_0': 0.9548, 'acc_0_1': 0.9259, 'acc_1_0': 0.8037, 'acc_1_1': 0.7866, 'mean_acc': 0.9082}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.7726, 'acc_0_0': 0.9645, 'acc_0_1': 0.9264, 'acc_1_0': 0.7726, 'acc_1_1': 0.785, 'mean_acc': 0.9085}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7617, 'acc_0_0': 0.9676, 'acc_0_1': 0.929, 'acc_1_0': 0.7617, 'acc_1_1': 0.7819, 'mean_acc': 0.9092}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7695, 'acc_0_0': 0.9659, 'acc_0_1': 0.9282, 'acc_1_0': 0.7695, 'acc_1_1': 0.7788, 'mean_acc': 0.9087}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7726, 'acc_0_0': 0.9641, 'acc_0_1': 0.9308, 'acc_1_0': 0.7757, 'acc_1_1': 0.7726, 'mean_acc': 0.909}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.9399, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7695, 'acc_0_0': 0.9627, 'acc_0_1': 0.9313, 'acc_1_0': 0.7788, 'acc_1_1': 0.7695, 'mean_acc': 0.9087}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7555, 'acc_0_0': 0.9605, 'acc_0_1': 0.9361, 'acc_1_0': 0.7835, 'acc_1_1': 0.7555, 'mean_acc': 0.9087}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.7445, 'acc_0_0': 0.9601, 'acc_0_1': 0.9392, 'acc_1_0': 0.7788, 'acc_1_1': 0.7445, 'mean_acc': 0.908}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7463, 'acc_0_0': 0.9573, 'acc_0_1': 0.9614, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.92}
Test(class)(new adapter): {'weighted_mean_acc': 0.9054, 'worst_acc': 0.7103, 'acc_0_0': 0.9645, 'acc_0_1': 0.9494, 'acc_1_0': 0.7492, 'acc_1_1': 0.7103, 'mean_acc': 0.9066}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7015, 'acc_0_0': 0.9615, 'acc_0_1': 0.9614, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9167}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.6963, 'acc_0_0': 0.9694, 'acc_0_1': 0.9534, 'acc_1_0': 0.7227, 'acc_1_1': 0.6963, 'mean_acc': 0.9056}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.6866, 'acc_0_0': 0.9615, 'acc_0_1': 0.97, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.6854, 'acc_0_0': 0.9716, 'acc_0_1': 0.9583, 'acc_1_0': 0.7134, 'acc_1_1': 0.6854, 'mean_acc': 0.9061}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.6716, 'acc_0_0': 0.9615, 'acc_0_1': 0.9742, 'acc_1_0': 0.6716, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9036, 'worst_acc': 0.676, 'acc_0_0': 0.9725, 'acc_0_1': 0.9619, 'acc_1_0': 0.704, 'acc_1_1': 0.676, 'mean_acc': 0.9058}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.927, 'worst_acc': 0.6866, 'acc_0_0': 0.9615, 'acc_0_1': 0.97, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9183}
Test(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.6947, 'acc_0_0': 0.9712, 'acc_0_1': 0.9574, 'acc_1_0': 0.7087, 'acc_1_1': 0.6947, 'mean_acc': 0.9061}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9657, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.7025, 'acc_0_0': 0.9681, 'acc_0_1': 0.9539, 'acc_1_0': 0.715, 'acc_1_1': 0.7025, 'mean_acc': 0.9051}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.6866, 'acc_0_0': 0.953, 'acc_0_1': 0.9614, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9052, 'worst_acc': 0.7056, 'acc_0_0': 0.9659, 'acc_0_1': 0.953, 'acc_1_0': 0.7243, 'acc_1_1': 0.7056, 'mean_acc': 0.9052}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.7196, 'acc_0_0': 0.9632, 'acc_0_1': 0.9512, 'acc_1_0': 0.743, 'acc_1_1': 0.7196, 'mean_acc': 0.9071}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.7336, 'acc_0_0': 0.9614, 'acc_0_1': 0.9481, 'acc_1_0': 0.7523, 'acc_1_1': 0.7336, 'mean_acc': 0.9078}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7305, 'acc_0_0': 0.9619, 'acc_0_1': 0.9486, 'acc_1_0': 0.7539, 'acc_1_1': 0.7305, 'mean_acc': 0.908}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.7196, 'acc_0_0': 0.9627, 'acc_0_1': 0.9494, 'acc_1_0': 0.7461, 'acc_1_1': 0.7196, 'mean_acc': 0.9066}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7227, 'acc_0_0': 0.9632, 'acc_0_1': 0.949, 'acc_1_0': 0.7461, 'acc_1_1': 0.7227, 'mean_acc': 0.907}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7243, 'acc_0_0': 0.9636, 'acc_0_1': 0.9499, 'acc_1_0': 0.743, 'acc_1_1': 0.7243, 'mean_acc': 0.9073}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7181, 'acc_0_0': 0.9636, 'acc_0_1': 0.9512, 'acc_1_0': 0.7414, 'acc_1_1': 0.7181, 'mean_acc': 0.907}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7243, 'acc_0_0': 0.9623, 'acc_0_1': 0.9477, 'acc_1_0': 0.7492, 'acc_1_1': 0.7243, 'mean_acc': 0.9066}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9064, 'worst_acc': 0.7212, 'acc_0_0': 0.9627, 'acc_0_1': 0.9481, 'acc_1_0': 0.7477, 'acc_1_1': 0.7212, 'mean_acc': 0.9065}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9074, 'worst_acc': 0.7274, 'acc_0_0': 0.9623, 'acc_0_1': 0.9463, 'acc_1_0': 0.7492, 'acc_1_1': 0.7274, 'mean_acc': 0.9065}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.7383, 'acc_0_0': 0.9619, 'acc_0_1': 0.9437, 'acc_1_0': 0.757, 'acc_1_1': 0.7383, 'mean_acc': 0.9073}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7445, 'acc_0_0': 0.9619, 'acc_0_1': 0.9437, 'acc_1_0': 0.7586, 'acc_1_1': 0.7445, 'mean_acc': 0.9082}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7368, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.757, 'acc_1_1': 0.7368, 'mean_acc': 0.9075}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7352, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.757, 'acc_1_1': 0.7352, 'mean_acc': 0.9071}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7305, 'acc_0_0': 0.9619, 'acc_0_1': 0.945, 'acc_1_0': 0.757, 'acc_1_1': 0.7305, 'mean_acc': 0.907}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7274, 'acc_0_0': 0.9627, 'acc_0_1': 0.9472, 'acc_1_0': 0.7492, 'acc_1_1': 0.7274, 'mean_acc': 0.907}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7352, 'acc_0_0': 0.9623, 'acc_0_1': 0.9446, 'acc_1_0': 0.757, 'acc_1_1': 0.7352, 'mean_acc': 0.9075}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.7336, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.757, 'acc_1_1': 0.7336, 'mean_acc': 0.9071}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.7321, 'acc_0_0': 0.9614, 'acc_0_1': 0.945, 'acc_1_0': 0.757, 'acc_1_1': 0.7321, 'mean_acc': 0.907}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9086, 'worst_acc': 0.743, 'acc_0_0': 0.9592, 'acc_0_1': 0.9432, 'acc_1_0': 0.7632, 'acc_1_1': 0.743, 'mean_acc': 0.9073}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7399, 'acc_0_0': 0.961, 'acc_0_1': 0.9441, 'acc_1_0': 0.7586, 'acc_1_1': 0.7399, 'mean_acc': 0.9075}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7414, 'acc_0_0': 0.9614, 'acc_0_1': 0.9446, 'acc_1_0': 0.757, 'acc_1_1': 0.7414, 'mean_acc': 0.9078}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9109, 'worst_acc': 0.7461, 'acc_0_0': 0.9614, 'acc_0_1': 0.9432, 'acc_1_0': 0.757, 'acc_1_1': 0.7461, 'mean_acc': 0.9078}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9105, 'worst_acc': 0.7523, 'acc_0_0': 0.9592, 'acc_0_1': 0.9392, 'acc_1_0': 0.7617, 'acc_1_1': 0.7523, 'mean_acc': 0.9066}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.909, 'worst_acc': 0.7461, 'acc_0_0': 0.9588, 'acc_0_1': 0.9424, 'acc_1_0': 0.7617, 'acc_1_1': 0.7461, 'mean_acc': 0.907}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7352, 'acc_0_0': 0.9619, 'acc_0_1': 0.9441, 'acc_1_0': 0.7555, 'acc_1_1': 0.7352, 'mean_acc': 0.907}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.8182, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7399, 'acc_0_0': 0.9623, 'acc_0_1': 0.945, 'acc_1_0': 0.7539, 'acc_1_1': 0.7399, 'mean_acc': 0.9078}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7368, 'acc_0_0': 0.9619, 'acc_0_1': 0.9446, 'acc_1_0': 0.7477, 'acc_1_1': 0.7368, 'mean_acc': 0.9065}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.5606, 'acc_0_0': 0.9957, 'acc_0_1': 0.9742, 'acc_1_0': 0.5606, 'acc_1_1': 0.9254, 'mean_acc': 0.9316}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9263, 'worst_acc': 0.8455, 'acc_0_0': 0.9274, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}
best test accuracy on [class]: {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8399, 'acc_0_0': 0.9202, 'acc_0_1': 0.8399, 'acc_1_0': 0.8567, 'acc_1_1': 0.8988, 'mean_acc': 0.8795}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8399, 'acc_0_0': 0.9202, 'acc_0_1': 0.8399, 'acc_1_0': 0.8567, 'acc_1_1': 0.8988, 'mean_acc': 0.8795}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.8621, 'acc_0_0': 0.984, 'acc_0_1': 0.8621, 'acc_1_0': 0.9455, 'acc_1_1': 0.9112, 'mean_acc': 0.9242}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.5606, 'acc_0_0': 0.9957, 'acc_0_1': 0.9742, 'acc_1_0': 0.5606, 'acc_1_1': 0.9254, 'mean_acc': 0.9316}, 'Val': {'weighted_mean_acc': 0.9263, 'worst_acc': 0.8455, 'acc_0_0': 0.9274, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8917}, 'Test': {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8399, 'acc_0_0': 0.9202, 'acc_0_1': 0.8399, 'acc_1_0': 0.8567, 'acc_1_1': 0.8988, 'mean_acc': 0.8795}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8399, 'acc_0_0': 0.9202, 'acc_0_1': 0.8399, 'acc_1_0': 0.8567, 'acc_1_1': 0.8988, 'mean_acc': 0.8795}, 'spurious': {'weighted_mean_acc': 0.9629, 'worst_acc': 0.8621, 'acc_0_0': 0.984, 'acc_0_1': 0.8621, 'acc_1_0': 0.9455, 'acc_1_1': 0.9112, 'mean_acc': 0.9242}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8907     0.8738   0.8900  ...   0.8738   0.8956    0.8849
2                       0.8994     0.8738   0.9082  ...   0.8738   0.8754    0.8889
3                       0.9116     0.8399   0.9202  ...   0.8567   0.8988    0.8795
test_mean               0.9006     0.8625   0.9061  ...   0.8681   0.8899    0.8844
test_std                0.0086     0.0160   0.0124  ...   0.0081   0.0104    0.0039
1                       0.9725     0.8838   0.9823  ...   0.8972   0.9595    0.9320
2                       0.9734     0.8754   0.9823  ...   0.8754   0.9642    0.9320
3                       0.9629     0.8621   0.9840  ...   0.9455   0.9112    0.9242
zs_spu_mean             0.9696     0.8738   0.9829  ...   0.9060   0.9450    0.9294
zs_spu_std              0.0048     0.0089   0.0008  ...   0.0293   0.0240    0.0037
1                          NaN     0.8939   0.9442  ...   0.8939   0.9701    0.9449
2                          NaN     0.8182   0.9614  ...   0.8182   0.9701    0.9499
3                          NaN     0.5606   0.9957  ...   0.5606   0.9254    0.9316
tr_mean                    NaN     0.7576   0.9671  ...   0.7576   0.9552    0.9421
tr_std                     NaN     0.1427   0.0214  ...   0.1427   0.0211    0.0077
1                       0.9090     0.8657   0.9103  ...   0.8657   0.9091    0.9000
2                       0.9083     0.8657   0.9103  ...   0.8657   0.9091    0.8933
3                       0.9263     0.8455   0.9274  ...   0.8806   0.9394    0.8917
val_mean                0.9145     0.8590   0.9160  ...   0.8707   0.9192    0.8950
val_std                 0.0083     0.0095   0.0081  ...   0.0070   0.0143    0.0036
1                       0.8907     0.8738   0.8900  ...   0.8738   0.8956    0.8849
2                       0.8994     0.8738   0.9082  ...   0.8738   0.8754    0.8889
3                       0.9116     0.8399   0.9202  ...   0.8567   0.8988    0.8795
zs_tg_mean              0.9006     0.8625   0.9061  ...   0.8681   0.8899    0.8844
zs_tg_std               0.0086     0.0160   0.0124  ...   0.0081   0.0104    0.0039

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_1.0_lrr1.0_bsr256_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.122, 'acc_0_0': 0.9265, 'acc_0_1': 0.9348, 'acc_1_0': 0.1607, 'acc_1_1': 0.122, 'mean_acc': 0.7406}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7677, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.7685, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9969, 'acc_1_0': 0.0, 'acc_1_1': 0.0031, 'mean_acc': 0.7775}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9771, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.7465, 'mean_acc': 0.8997}
Val(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.2961, 'acc_0_0': 0.9786, 'acc_0_1': 0.2961, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6717}
Test(class): {'weighted_mean_acc': 0.9409, 'worst_acc': 0.247, 'acc_0_0': 0.9734, 'acc_0_1': 0.247, 'acc_1_0': 0.5732, 'acc_1_1': 0.9735, 'mean_acc': 0.6464}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3036, 'acc_0_0': 0.994, 'acc_0_1': 0.462, 'acc_1_0': 0.3036, 'acc_1_1': 0.9234, 'mean_acc': 0.9499}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.209, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.209, 'acc_1_1': 0.9091, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2259, 'acc_0_0': 0.9996, 'acc_0_1': 0.6341, 'acc_1_0': 0.2259, 'acc_1_1': 0.8738, 'mean_acc': 0.7577}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.2321, 'acc_0_0': 0.9986, 'acc_0_1': 0.6359, 'acc_1_0': 0.2321, 'acc_1_1': 0.8581, 'mean_acc': 0.9447}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.2985, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.2985, 'acc_1_1': 0.9242, 'mean_acc': 0.8017}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.3598, 'acc_0_0': 0.9987, 'acc_0_1': 0.6328, 'acc_1_0': 0.3598, 'acc_1_1': 0.9065, 'mean_acc': 0.7753}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4674, 'acc_0_0': 0.99, 'acc_0_1': 0.4674, 'acc_1_0': 0.5893, 'acc_1_1': 0.9612, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.3881, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.3881, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.4688, 'acc_0_0': 0.9951, 'acc_0_1': 0.6488, 'acc_1_0': 0.4688, 'acc_1_1': 0.9159, 'mean_acc': 0.7932}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9857, 'acc_0_1': 0.5109, 'acc_1_0': 0.6607, 'acc_1_1': 0.964, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.3284, 'acc_1_1': 0.8939, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.4361, 'acc_0_0': 0.9969, 'acc_0_1': 0.8115, 'acc_1_0': 0.4361, 'acc_1_1': 0.8769, 'mean_acc': 0.8493}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.99, 'acc_0_1': 0.712, 'acc_1_0': 0.6071, 'acc_1_1': 0.9338, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8455, 'acc_1_0': 0.3731, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4486, 'acc_0_0': 0.996, 'acc_0_1': 0.855, 'acc_1_0': 0.4486, 'acc_1_1': 0.866, 'mean_acc': 0.8661}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7391, 'acc_1_0': 0.625, 'acc_1_1': 0.929, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9716, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.581, 'acc_0_0': 0.9902, 'acc_0_1': 0.7038, 'acc_1_0': 0.581, 'acc_1_1': 0.9299, 'mean_acc': 0.8267}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.9866, 'acc_0_1': 0.6359, 'acc_1_0': 0.6964, 'acc_1_1': 0.9574, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9744, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.955, 'worst_acc': 0.5508, 'acc_0_0': 0.984, 'acc_0_1': 0.5508, 'acc_1_0': 0.6511, 'acc_1_1': 0.9455, 'mean_acc': 0.7742}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9886, 'acc_0_1': 0.625, 'acc_1_0': 0.6607, 'acc_1_1': 0.9593, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5401, 'acc_0_0': 0.9858, 'acc_0_1': 0.5401, 'acc_1_0': 0.6417, 'acc_1_1': 0.9517, 'mean_acc': 0.7705}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9937, 'acc_0_1': 0.6957, 'acc_1_0': 0.625, 'acc_1_1': 0.9565, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9731, 'worst_acc': 0.5665, 'acc_0_0': 0.9915, 'acc_0_1': 0.5665, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5042, 'acc_0_0': 0.9845, 'acc_0_1': 0.5042, 'acc_1_0': 0.6511, 'acc_1_1': 0.9564, 'mean_acc': 0.7575}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.6739, 'acc_1_0': 0.6071, 'acc_1_1': 0.9603, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9705, 'worst_acc': 0.4893, 'acc_0_0': 0.9915, 'acc_0_1': 0.4893, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.4381, 'acc_0_0': 0.9814, 'acc_0_1': 0.4381, 'acc_1_0': 0.6807, 'acc_1_1': 0.9611, 'mean_acc': 0.7344}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6087, 'acc_0_0': 0.9911, 'acc_0_1': 0.6087, 'acc_1_0': 0.6607, 'acc_1_1': 0.9707, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5322, 'acc_0_0': 0.9915, 'acc_0_1': 0.5322, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.9547, 'worst_acc': 0.4878, 'acc_0_0': 0.9823, 'acc_0_1': 0.4878, 'acc_1_0': 0.6729, 'acc_1_1': 0.9595, 'mean_acc': 0.753}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.6902, 'acc_1_0': 0.6607, 'acc_1_1': 0.9688, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9742, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9559, 'worst_acc': 0.5627, 'acc_0_0': 0.9836, 'acc_0_1': 0.5627, 'acc_1_0': 0.6589, 'acc_1_1': 0.9486, 'mean_acc': 0.7799}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.992, 'acc_0_1': 0.6359, 'acc_1_0': 0.7321, 'acc_1_1': 0.9726, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.545, 'acc_0_0': 0.9818, 'acc_0_1': 0.545, 'acc_1_0': 0.6822, 'acc_1_1': 0.9564, 'mean_acc': 0.7758}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9926, 'acc_0_1': 0.6685, 'acc_1_0': 0.7679, 'acc_1_1': 0.9726, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6137, 'acc_0_0': 0.9915, 'acc_0_1': 0.6137, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5765, 'acc_0_0': 0.9827, 'acc_0_1': 0.5765, 'acc_1_0': 0.6822, 'acc_1_1': 0.947, 'mean_acc': 0.7874}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9688, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5583, 'acc_0_0': 0.9823, 'acc_0_1': 0.5583, 'acc_1_0': 0.6807, 'acc_1_1': 0.9533, 'mean_acc': 0.7806}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.9931, 'acc_0_1': 0.6793, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.588, 'acc_0_0': 0.9845, 'acc_0_1': 0.588, 'acc_1_0': 0.6729, 'acc_1_1': 0.9455, 'mean_acc': 0.7913}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.7857, 'acc_1_1': 0.9754, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6481, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6164, 'acc_0_0': 0.9863, 'acc_0_1': 0.6164, 'acc_1_0': 0.6667, 'acc_1_1': 0.9455, 'mean_acc': 0.8024}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6341, 'acc_0_0': 0.9876, 'acc_0_1': 0.6341, 'acc_1_0': 0.6667, 'acc_1_1': 0.9424, 'mean_acc': 0.8095}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9943, 'acc_0_1': 0.7337, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6511, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6511, 'acc_1_1': 0.9408, 'mean_acc': 0.816}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9957, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9785}
Val(class): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6381, 'acc_0_0': 0.9863, 'acc_0_1': 0.6381, 'acc_1_0': 0.6558, 'acc_1_1': 0.9486, 'mean_acc': 0.81}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.994, 'acc_0_1': 0.7283, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6438, 'acc_0_0': 0.9872, 'acc_0_1': 0.6438, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6266, 'acc_0_0': 0.9867, 'acc_0_1': 0.6266, 'acc_1_0': 0.6558, 'acc_1_1': 0.947, 'mean_acc': 0.8055}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9966, 'acc_0_1': 0.7826, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9707, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6741, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.8214}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9943, 'acc_0_1': 0.75, 'acc_1_0': 0.8571, 'acc_1_1': 0.9773, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9739, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6402, 'acc_0_0': 0.9876, 'acc_0_1': 0.6727, 'acc_1_0': 0.6402, 'acc_1_1': 0.9424, 'mean_acc': 0.8215}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9603, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6589, 'acc_0_0': 0.9871, 'acc_0_1': 0.6692, 'acc_1_0': 0.6589, 'acc_1_1': 0.9455, 'mean_acc': 0.8224}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9946, 'acc_0_1': 0.7283, 'acc_1_0': 0.8929, 'acc_1_1': 0.982, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6355, 'acc_0_0': 0.9867, 'acc_0_1': 0.6355, 'acc_1_0': 0.6495, 'acc_1_1': 0.9455, 'mean_acc': 0.8081}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.75, 'acc_1_1': 0.9716, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.7091, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8338}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5622, 'acc_0_0': 0.9786, 'acc_0_1': 0.5622, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5481, 'acc_0_0': 0.9823, 'acc_0_1': 0.5481, 'acc_1_0': 0.69, 'acc_1_1': 0.9533, 'mean_acc': 0.7777}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.996, 'acc_0_1': 0.788, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6542, 'acc_0_0': 0.9876, 'acc_0_1': 0.6621, 'acc_1_0': 0.6542, 'acc_1_1': 0.9393, 'mean_acc': 0.8186}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9951, 'acc_0_1': 0.7772, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.662, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8271}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.913, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.588, 'acc_0_0': 0.9872, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5969, 'acc_0_0': 0.9885, 'acc_0_1': 0.5969, 'acc_1_0': 0.6308, 'acc_1_1': 0.9486, 'mean_acc': 0.792}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.7857, 'acc_1_1': 0.9877, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6464, 'acc_0_0': 0.9871, 'acc_0_1': 0.7419, 'acc_1_0': 0.6464, 'acc_1_1': 0.9237, 'mean_acc': 0.8469}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9957, 'acc_0_1': 0.8641, 'acc_1_0': 0.9107, 'acc_1_1': 0.9858, 'mean_acc': 0.9875}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5701, 'acc_0_0': 0.9925, 'acc_0_1': 0.69, 'acc_1_0': 0.5701, 'acc_1_1': 0.9237, 'mean_acc': 0.8203}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.8913, 'acc_1_0': 0.875, 'acc_1_1': 0.9792, 'mean_acc': 0.9883}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7639, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.634, 'acc_0_0': 0.988, 'acc_0_1': 0.7698, 'acc_1_0': 0.634, 'acc_1_1': 0.9206, 'mean_acc': 0.8564}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9963, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.7317, 'acc_1_0': 0.5545, 'acc_1_1': 0.9252, 'mean_acc': 0.8353}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9974, 'acc_0_1': 0.8913, 'acc_1_0': 0.9286, 'acc_1_1': 0.983, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5997, 'acc_0_0': 0.9863, 'acc_0_1': 0.7375, 'acc_1_0': 0.5997, 'acc_1_1': 0.9252, 'mean_acc': 0.8398}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.7468, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.6558, 'acc_0_0': 0.9836, 'acc_0_1': 0.7353, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8443}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9991, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9801, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.588, 'acc_0_0': 0.9658, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5787, 'acc_0_0': 0.9792, 'acc_0_1': 0.5787, 'acc_1_0': 0.6963, 'acc_1_1': 0.9548, 'mean_acc': 0.7893}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.4848, 'acc_1_1': 0.8806, 'mean_acc': 0.8397}
Val(class)(new adapter): {'weighted_mean_acc': 0.8227, 'worst_acc': 0.3182, 'acc_0_0': 0.9701, 'acc_0_1': 0.97, 'acc_1_0': 0.6567, 'acc_1_1': 0.3182, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.8415, 'worst_acc': 0.352, 'acc_0_0': 0.9849, 'acc_0_1': 0.9765, 'acc_1_0': 0.6776, 'acc_1_1': 0.352, 'mean_acc': 0.8775}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1515, 'acc_0_0': 0.7854, 'acc_0_1': 0.2318, 'acc_1_0': 0.1515, 'acc_1_1': 0.5821, 'mean_acc': 0.4775}
Val(class)(new adapter): {'weighted_mean_acc': 0.9421, 'worst_acc': 0.2403, 'acc_0_0': 0.9658, 'acc_0_1': 0.2403, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.655}
Test(class)(new adapter): {'weighted_mean_acc': 0.9475, 'worst_acc': 0.2293, 'acc_0_0': 0.9774, 'acc_0_1': 0.2293, 'acc_1_0': 0.6885, 'acc_1_1': 0.9875, 'mean_acc': 0.6553}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5152, 'acc_0_0': 0.9871, 'acc_0_1': 0.5236, 'acc_1_0': 0.5152, 'acc_1_1': 0.8358, 'mean_acc': 0.7379}
Val(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.7463, 'acc_0_0': 0.9658, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9303, 'worst_acc': 0.7741, 'acc_0_0': 0.9743, 'acc_0_1': 0.9228, 'acc_1_0': 0.7741, 'acc_1_1': 0.7944, 'mean_acc': 0.9122}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.927, 'acc_0_1': 0.9227, 'acc_1_0': 0.7727, 'acc_1_1': 0.0, 'mean_acc': 0.8047}
Val(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.8369, 'acc_0_0': 0.8974, 'acc_0_1': 0.8369, 'acc_1_0': 0.8806, 'acc_1_1': 0.8788, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.8639, 'worst_acc': 0.8377, 'acc_0_0': 0.8652, 'acc_0_1': 0.8377, 'acc_1_0': 0.8894, 'acc_1_1': 0.8629, 'mean_acc': 0.8569}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.8884, 'acc_0_1': 0.9313, 'acc_1_0': 0.8333, 'acc_1_1': 0.9104, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.891, 'worst_acc': 0.8412, 'acc_0_0': 0.8974, 'acc_0_1': 0.8412, 'acc_1_0': 0.8806, 'acc_1_1': 0.8788, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8452, 'acc_0_0': 0.8714, 'acc_0_1': 0.8452, 'acc_1_0': 0.8847, 'acc_1_1': 0.8707, 'mean_acc': 0.8626}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0746, 'acc_0_0': 0.7854, 'acc_0_1': 0.9657, 'acc_1_0': 0.8333, 'acc_1_1': 0.0746, 'mean_acc': 0.7813}
Val(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8627, 'acc_0_0': 0.9231, 'acc_0_1': 0.8627, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8457, 'acc_0_0': 0.8967, 'acc_0_1': 0.8457, 'acc_1_0': 0.8676, 'acc_1_1': 0.8956, 'mean_acc': 0.8735}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.9185, 'acc_0_1': 0.9614, 'acc_1_0': 0.7879, 'acc_1_1': 0.9701, 'mean_acc': 0.9265}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.8455, 'acc_0_0': 0.9359, 'acc_0_1': 0.8455, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.8399, 'acc_0_0': 0.9264, 'acc_0_1': 0.8399, 'acc_1_0': 0.8536, 'acc_1_1': 0.9112, 'mean_acc': 0.883}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1791, 'acc_0_0': 0.9013, 'acc_0_1': 0.9485, 'acc_1_0': 0.8333, 'acc_1_1': 0.1791, 'mean_acc': 0.8314}
Val(class)(new adapter): {'weighted_mean_acc': 0.9308, 'worst_acc': 0.8026, 'acc_0_0': 0.9316, 'acc_0_1': 0.8026, 'acc_1_0': 0.8507, 'acc_1_1': 0.9545, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.8093, 'acc_0_0': 0.9424, 'acc_0_1': 0.8093, 'acc_1_0': 0.8442, 'acc_1_1': 0.9221, 'mean_acc': 0.8775}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9528, 'acc_0_1': 0.9356, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9332}
Val(class)(new adapter): {'weighted_mean_acc': 0.9334, 'worst_acc': 0.794, 'acc_0_0': 0.9359, 'acc_0_1': 0.794, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9372, 'worst_acc': 0.8213, 'acc_0_0': 0.9512, 'acc_0_1': 0.8213, 'acc_1_0': 0.8411, 'acc_1_1': 0.9159, 'mean_acc': 0.8845}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5075, 'acc_0_0': 0.897, 'acc_0_1': 0.9399, 'acc_1_0': 0.8333, 'acc_1_1': 0.5075, 'mean_acc': 0.8631}
Val(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7682, 'acc_0_0': 0.9316, 'acc_0_1': 0.7682, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.939, 'worst_acc': 0.7965, 'acc_0_0': 0.9521, 'acc_0_1': 0.7965, 'acc_1_0': 0.8458, 'acc_1_1': 0.9252, 'mean_acc': 0.8768}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.7879, 'acc_1_1': 0.9552, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.7897, 'acc_0_0': 0.9359, 'acc_0_1': 0.7897, 'acc_1_0': 0.806, 'acc_1_1': 0.9545, 'mean_acc': 0.8667}
Test(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.8226, 'acc_0_0': 0.949, 'acc_0_1': 0.8226, 'acc_1_0': 0.8442, 'acc_1_1': 0.9159, 'mean_acc': 0.8845}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9313, 'acc_0_1': 0.9785, 'acc_1_0': 0.8182, 'acc_1_1': 0.6716, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7725, 'acc_0_0': 0.9359, 'acc_0_1': 0.7725, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7973, 'acc_0_0': 0.9366, 'acc_0_1': 0.7973, 'acc_1_0': 0.8458, 'acc_1_1': 0.9377, 'mean_acc': 0.8725}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9785, 'acc_0_1': 0.9614, 'acc_1_0': 0.803, 'acc_1_1': 0.9701, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9372, 'worst_acc': 0.806, 'acc_0_0': 0.9402, 'acc_0_1': 0.8197, 'acc_1_0': 0.806, 'acc_1_1': 0.9545, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.933, 'worst_acc': 0.8302, 'acc_0_0': 0.945, 'acc_0_1': 0.8355, 'acc_1_0': 0.8302, 'acc_1_1': 0.9159, 'mean_acc': 0.8864}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7313, 'acc_0_0': 0.97, 'acc_0_1': 0.9571, 'acc_1_0': 0.8939, 'acc_1_1': 0.7313, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9356, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.8755, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.7991, 'acc_0_0': 0.9592, 'acc_0_1': 0.8803, 'acc_1_0': 0.7991, 'acc_1_1': 0.8879, 'mean_acc': 0.9028}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9914, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.9851, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.7913, 'acc_0_0': 0.9632, 'acc_0_1': 0.9184, 'acc_1_0': 0.7913, 'acc_1_1': 0.8364, 'mean_acc': 0.9127}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7015, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.8788, 'acc_1_1': 0.7015, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7897, 'acc_0_0': 0.9632, 'acc_0_1': 0.9149, 'acc_1_0': 0.7897, 'acc_1_1': 0.8302, 'mean_acc': 0.9104}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.867, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9318, 'worst_acc': 0.7944, 'acc_0_0': 0.9596, 'acc_0_1': 0.8931, 'acc_1_0': 0.7944, 'acc_1_1': 0.8536, 'mean_acc': 0.9037}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.8939, 'acc_1_1': 0.8507, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9412, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.8584, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.7991, 'acc_0_0': 0.957, 'acc_0_1': 0.8665, 'acc_1_0': 0.7991, 'acc_1_1': 0.8816, 'mean_acc': 0.8959}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9412, 'worst_acc': 0.7761, 'acc_0_0': 0.9487, 'acc_0_1': 0.8584, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9328, 'worst_acc': 0.796, 'acc_0_0': 0.9561, 'acc_0_1': 0.8701, 'acc_1_0': 0.796, 'acc_1_1': 0.8738, 'mean_acc': 0.8958}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9254, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.934, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.8498, 'acc_1_0': 0.7463, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.8069, 'acc_0_0': 0.9539, 'acc_0_1': 0.8741, 'acc_1_0': 0.8069, 'acc_1_1': 0.8692, 'mean_acc': 0.8971}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9376, 'worst_acc': 0.7463, 'acc_0_0': 0.953, 'acc_0_1': 0.867, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7928, 'acc_0_0': 0.9565, 'acc_0_1': 0.8922, 'acc_1_0': 0.7928, 'acc_1_1': 0.8458, 'mean_acc': 0.9011}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.8798, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7695, 'acc_0_0': 0.9539, 'acc_0_1': 0.8998, 'acc_1_0': 0.7695, 'acc_1_1': 0.8271, 'mean_acc': 0.8983}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9252, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9013, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.7741, 'acc_0_0': 0.9517, 'acc_0_1': 0.9078, 'acc_1_0': 0.7741, 'acc_1_1': 0.8209, 'mean_acc': 0.9004}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9254, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7679, 'acc_0_0': 0.9557, 'acc_0_1': 0.9078, 'acc_1_0': 0.7679, 'acc_1_1': 0.8178, 'mean_acc': 0.9009}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.757, 'acc_0_0': 0.9565, 'acc_0_1': 0.9273, 'acc_1_0': 0.757, 'acc_1_1': 0.8006, 'mean_acc': 0.9058}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9194, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.7601, 'acc_0_0': 0.9627, 'acc_0_1': 0.9326, 'acc_1_0': 0.7601, 'acc_1_1': 0.7882, 'mean_acc': 0.9092}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9147, 'worst_acc': 0.7601, 'acc_0_0': 0.9605, 'acc_0_1': 0.9326, 'acc_1_0': 0.7601, 'acc_1_1': 0.7679, 'mean_acc': 0.9061}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9399, 'acc_1_0': 0.7015, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7508, 'acc_0_0': 0.9623, 'acc_0_1': 0.9361, 'acc_1_0': 0.7508, 'acc_1_1': 0.7617, 'mean_acc': 0.9065}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.6866, 'acc_0_0': 0.9573, 'acc_0_1': 0.9442, 'acc_1_0': 0.6866, 'acc_1_1': 0.7879, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.7134, 'acc_0_0': 0.9672, 'acc_0_1': 0.945, 'acc_1_0': 0.7305, 'acc_1_1': 0.7134, 'mean_acc': 0.9042}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9104, 'acc_0_0': 1.0, 'acc_0_1': 0.9785, 'acc_1_0': 0.9545, 'acc_1_1': 0.9104, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.6866, 'acc_1_1': 0.803, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7461, 'acc_0_0': 0.9548, 'acc_0_1': 0.9379, 'acc_1_0': 0.7461, 'acc_1_1': 0.7508, 'mean_acc': 0.9025}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9042, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8923, 'worst_acc': 0.7555, 'acc_0_0': 0.933, 'acc_0_1': 0.9388, 'acc_1_0': 0.7757, 'acc_1_1': 0.7555, 'mean_acc': 0.8982}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7928, 'acc_0_0': 0.9375, 'acc_0_1': 0.9215, 'acc_1_0': 0.7928, 'acc_1_1': 0.8037, 'mean_acc': 0.9004}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9151, 'worst_acc': 0.8037, 'acc_0_0': 0.9419, 'acc_0_1': 0.9011, 'acc_1_0': 0.8037, 'acc_1_1': 0.8349, 'mean_acc': 0.8989}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7819, 'acc_0_0': 0.9486, 'acc_0_1': 0.8909, 'acc_1_0': 0.7819, 'acc_1_1': 0.8505, 'mean_acc': 0.8968}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.932, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7819, 'acc_0_0': 0.9512, 'acc_0_1': 0.8984, 'acc_1_0': 0.7819, 'acc_1_1': 0.8474, 'mean_acc': 0.9004}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7695, 'acc_0_0': 0.9534, 'acc_0_1': 0.9122, 'acc_1_0': 0.7695, 'acc_1_1': 0.824, 'mean_acc': 0.9027}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9242, 'worst_acc': 0.7695, 'acc_0_0': 0.9552, 'acc_0_1': 0.9126, 'acc_1_0': 0.7695, 'acc_1_1': 0.8318, 'mean_acc': 0.9044}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.771, 'acc_0_0': 0.9552, 'acc_0_1': 0.9109, 'acc_1_0': 0.771, 'acc_1_1': 0.8333, 'mean_acc': 0.904}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9324, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9056, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7695, 'acc_0_0': 0.9557, 'acc_0_1': 0.9113, 'acc_1_0': 0.7695, 'acc_1_1': 0.8333, 'mean_acc': 0.9042}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7648, 'acc_0_0': 0.9565, 'acc_0_1': 0.914, 'acc_1_0': 0.7648, 'acc_1_1': 0.8287, 'mean_acc': 0.9046}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9255, 'worst_acc': 0.7632, 'acc_0_0': 0.9583, 'acc_0_1': 0.9153, 'acc_1_0': 0.7632, 'acc_1_1': 0.8271, 'mean_acc': 0.9054}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9267, 'worst_acc': 0.7601, 'acc_0_0': 0.9601, 'acc_0_1': 0.9149, 'acc_1_0': 0.7601, 'acc_1_1': 0.8271, 'mean_acc': 0.9056}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.7617, 'acc_0_0': 0.9579, 'acc_0_1': 0.9149, 'acc_1_0': 0.7617, 'acc_1_1': 0.8287, 'mean_acc': 0.9051}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9265, 'worst_acc': 0.7648, 'acc_0_0': 0.9574, 'acc_0_1': 0.9131, 'acc_1_0': 0.7648, 'acc_1_1': 0.8349, 'mean_acc': 0.9052}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9249, 'worst_acc': 0.7648, 'acc_0_0': 0.957, 'acc_0_1': 0.9153, 'acc_1_0': 0.7648, 'acc_1_1': 0.8287, 'mean_acc': 0.9052}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9323, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7757, 'acc_0_0': 0.9543, 'acc_0_1': 0.9118, 'acc_1_0': 0.7757, 'acc_1_1': 0.8349, 'mean_acc': 0.9047}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7741, 'acc_0_0': 0.957, 'acc_0_1': 0.9135, 'acc_1_0': 0.7741, 'acc_1_1': 0.8333, 'mean_acc': 0.9061}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7617, 'acc_0_0': 0.9574, 'acc_0_1': 0.9162, 'acc_1_0': 0.7617, 'acc_1_1': 0.8318, 'mean_acc': 0.9058}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9957, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7726, 'acc_0_0': 0.9574, 'acc_0_1': 0.9135, 'acc_1_0': 0.7726, 'acc_1_1': 0.8318, 'mean_acc': 0.9059}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7664, 'acc_0_0': 0.957, 'acc_0_1': 0.9193, 'acc_1_0': 0.7664, 'acc_1_1': 0.824, 'mean_acc': 0.9065}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7741, 'acc_0_0': 0.9565, 'acc_0_1': 0.9175, 'acc_1_0': 0.7741, 'acc_1_1': 0.8287, 'mean_acc': 0.907}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7741, 'acc_0_0': 0.957, 'acc_0_1': 0.9131, 'acc_1_0': 0.7741, 'acc_1_1': 0.8318, 'mean_acc': 0.9058}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7741, 'acc_0_0': 0.9561, 'acc_0_1': 0.9202, 'acc_1_0': 0.7741, 'acc_1_1': 0.8255, 'mean_acc': 0.9075}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7773, 'acc_0_0': 0.9543, 'acc_0_1': 0.9184, 'acc_1_0': 0.7773, 'acc_1_1': 0.8271, 'mean_acc': 0.9066}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7726, 'acc_0_0': 0.9565, 'acc_0_1': 0.9202, 'acc_1_0': 0.7726, 'acc_1_1': 0.824, 'mean_acc': 0.9073}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7695, 'acc_0_0': 0.9574, 'acc_0_1': 0.9202, 'acc_1_0': 0.7695, 'acc_1_1': 0.8255, 'mean_acc': 0.9075}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7695, 'acc_0_0': 0.9574, 'acc_0_1': 0.9188, 'acc_1_0': 0.7695, 'acc_1_1': 0.8255, 'mean_acc': 0.907}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.7695, 'acc_0_0': 0.9574, 'acc_0_1': 0.918, 'acc_1_0': 0.7695, 'acc_1_1': 0.8287, 'mean_acc': 0.907}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9253, 'worst_acc': 0.7679, 'acc_0_0': 0.9574, 'acc_0_1': 0.918, 'acc_1_0': 0.7679, 'acc_1_1': 0.8287, 'mean_acc': 0.9068}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9298, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7664, 'acc_0_0': 0.9574, 'acc_0_1': 0.9202, 'acc_1_0': 0.7664, 'acc_1_1': 0.8271, 'mean_acc': 0.9073}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.0746, 'acc_0_0': 0.7854, 'acc_0_1': 0.9657, 'acc_1_0': 0.8333, 'acc_1_1': 0.0746, 'mean_acc': 0.7813}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8627, 'acc_0_0': 0.9231, 'acc_0_1': 0.8627, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8967}
best test accuracy on [class]: {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8457, 'acc_0_0': 0.8967, 'acc_0_1': 0.8457, 'acc_1_0': 0.8676, 'acc_1_1': 0.8956, 'mean_acc': 0.8735}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8457, 'acc_0_0': 0.8967, 'acc_0_1': 0.8457, 'acc_1_0': 0.8676, 'acc_1_1': 0.8956, 'mean_acc': 0.8735}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.3879, 'acc_0_0': 0.9654, 'acc_0_1': 0.8998, 'acc_1_0': 0.3879, 'acc_1_1': 0.9907, 'mean_acc': 0.8787}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.0746, 'acc_0_0': 0.7854, 'acc_0_1': 0.9657, 'acc_1_0': 0.8333, 'acc_1_1': 0.0746, 'mean_acc': 0.7813}, 'Val': {'weighted_mean_acc': 0.9239, 'worst_acc': 0.8627, 'acc_0_0': 0.9231, 'acc_0_1': 0.8627, 'acc_1_0': 0.8806, 'acc_1_1': 0.9394, 'mean_acc': 0.8967}, 'Test': {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8457, 'acc_0_0': 0.8967, 'acc_0_1': 0.8457, 'acc_1_0': 0.8676, 'acc_1_1': 0.8956, 'mean_acc': 0.8735}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8941, 'worst_acc': 0.8457, 'acc_0_0': 0.8967, 'acc_0_1': 0.8457, 'acc_1_0': 0.8676, 'acc_1_1': 0.8956, 'mean_acc': 0.8735}, 'spurious': {'weighted_mean_acc': 0.9617, 'worst_acc': 0.3879, 'acc_0_0': 0.9654, 'acc_0_1': 0.8998, 'acc_1_0': 0.3879, 'acc_1_1': 0.9907, 'mean_acc': 0.8787}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9048, 'acc_0_1': 0.8967, 'acc_1_0': 0.0714, 'acc_1_1': 0.1485, 'mean_acc': 0.7281}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9983, 'acc_0_1': 0.8424, 'acc_1_0': 0.0714, 'acc_1_1': 0.3226, 'mean_acc': 0.8325}
Val(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7017}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3481, 'acc_0_0': 0.9845, 'acc_0_1': 0.3481, 'acc_1_0': 0.4408, 'acc_1_1': 0.9595, 'mean_acc': 0.6738}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3315, 'acc_0_0': 0.9826, 'acc_0_1': 0.3315, 'acc_1_0': 0.4643, 'acc_1_1': 0.9612, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.515, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7517}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.4745, 'acc_0_0': 0.9902, 'acc_0_1': 0.4745, 'acc_1_0': 0.4875, 'acc_1_1': 0.947, 'mean_acc': 0.729}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9977, 'acc_0_1': 0.7283, 'acc_1_0': 0.3214, 'acc_1_1': 0.9026, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5202, 'acc_0_0': 0.9849, 'acc_0_1': 0.5202, 'acc_1_0': 0.6449, 'acc_1_1': 0.9486, 'mean_acc': 0.7623}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5435, 'acc_0_0': 0.9746, 'acc_0_1': 0.5435, 'acc_1_0': 0.6964, 'acc_1_1': 0.965, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.4776, 'acc_0_0': 0.9915, 'acc_0_1': 0.824, 'acc_1_0': 0.4776, 'acc_1_1': 0.8636, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.5421, 'acc_0_0': 0.9929, 'acc_0_1': 0.8381, 'acc_1_0': 0.5421, 'acc_1_1': 0.8567, 'mean_acc': 0.8676}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7554, 'acc_1_0': 0.625, 'acc_1_1': 0.9319, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5389, 'acc_0_0': 0.9925, 'acc_0_1': 0.6457, 'acc_1_0': 0.5389, 'acc_1_1': 0.9377, 'mean_acc': 0.8012}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9903, 'acc_0_1': 0.5109, 'acc_1_0': 0.7143, 'acc_1_1': 0.9763, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.77}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4851, 'acc_0_0': 0.9898, 'acc_0_1': 0.4851, 'acc_1_0': 0.5748, 'acc_1_1': 0.9595, 'mean_acc': 0.744}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.996, 'acc_0_1': 0.6304, 'acc_1_0': 0.5179, 'acc_1_1': 0.965, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.4989, 'acc_0_0': 0.988, 'acc_0_1': 0.4989, 'acc_1_0': 0.5857, 'acc_1_1': 0.9564, 'mean_acc': 0.7496}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5815, 'acc_0_0': 0.99, 'acc_0_1': 0.5815, 'acc_1_0': 0.625, 'acc_1_1': 0.9782, 'mean_acc': 0.9675}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5408, 'acc_0_0': 0.9915, 'acc_0_1': 0.5408, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.4989, 'acc_0_0': 0.9836, 'acc_0_1': 0.4989, 'acc_1_0': 0.6776, 'acc_1_1': 0.9611, 'mean_acc': 0.7585}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.994, 'acc_0_1': 0.6848, 'acc_1_0': 0.75, 'acc_1_1': 0.964, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6922, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8255}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9723}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6609, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6173, 'acc_0_0': 0.9863, 'acc_0_1': 0.6173, 'acc_1_0': 0.6558, 'acc_1_1': 0.9502, 'mean_acc': 0.802}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9909, 'acc_0_1': 0.6902, 'acc_1_0': 0.75, 'acc_1_1': 0.9735, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5607, 'acc_0_0': 0.9916, 'acc_0_1': 0.7144, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8291}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.7143, 'acc_1_1': 0.964, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.567, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.567, 'acc_1_1': 0.9346, 'mean_acc': 0.824}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9946, 'acc_0_1': 0.7065, 'acc_1_0': 0.7857, 'acc_1_1': 0.9801, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5576, 'acc_0_0': 0.9925, 'acc_0_1': 0.7561, 'acc_1_0': 0.5576, 'acc_1_1': 0.9268, 'mean_acc': 0.845}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9966, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.7557, 'acc_1_0': 0.5794, 'acc_1_1': 0.9315, 'mean_acc': 0.8479}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8043, 'acc_0_0': 0.9954, 'acc_0_1': 0.8043, 'acc_1_0': 0.8393, 'acc_1_1': 0.9716, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7525, 'acc_1_0': 0.5841, 'acc_1_1': 0.9299, 'mean_acc': 0.8469}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9971, 'acc_0_1': 0.8967, 'acc_1_0': 0.7143, 'acc_1_1': 0.9565, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.9808, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.6581, 'acc_1_0': 0.5545, 'acc_1_1': 0.9455, 'mean_acc': 0.8089}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6739, 'acc_0_0': 0.9954, 'acc_0_1': 0.6739, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6184, 'acc_0_0': 0.9885, 'acc_0_1': 0.7348, 'acc_1_0': 0.6184, 'acc_1_1': 0.9237, 'mean_acc': 0.8416}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.7419, 'acc_1_0': 0.5312, 'acc_1_1': 0.9252, 'mean_acc': 0.8369}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9977, 'acc_0_1': 0.837, 'acc_1_0': 0.8929, 'acc_1_1': 0.9905, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.6953, 'acc_0_0': 0.9829, 'acc_0_1': 0.6953, 'acc_1_0': 0.7015, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6604, 'acc_0_0': 0.9885, 'acc_0_1': 0.6931, 'acc_1_0': 0.6604, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5903, 'acc_0_0': 0.9916, 'acc_0_1': 0.6807, 'acc_1_0': 0.5903, 'acc_1_1': 0.9424, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8859, 'acc_0_0': 0.9989, 'acc_0_1': 0.8859, 'acc_1_0': 0.9107, 'acc_1_1': 0.9905, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8297, 'acc_1_0': 0.5779, 'acc_1_1': 0.9065, 'mean_acc': 0.8735}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8929, 'acc_1_1': 0.9839, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.6309, 'acc_0_0': 0.9829, 'acc_0_1': 0.6309, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5997, 'acc_0_0': 0.9911, 'acc_0_1': 0.6106, 'acc_1_0': 0.5997, 'acc_1_1': 0.9564, 'mean_acc': 0.7958}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.8283, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.8355, 'acc_1_0': 0.6168, 'acc_1_1': 0.8972, 'mean_acc': 0.8781}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4564, 'acc_0_0': 0.9973, 'acc_0_1': 0.7246, 'acc_1_0': 0.4564, 'acc_1_1': 0.9252, 'mean_acc': 0.8233}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.5672, 'acc_0_0': 0.9829, 'acc_0_1': 0.8369, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5343, 'acc_0_0': 0.9929, 'acc_0_1': 0.8373, 'acc_1_0': 0.5343, 'acc_1_1': 0.8988, 'mean_acc': 0.8711}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9986, 'acc_0_1': 0.9728, 'acc_1_0': 1.0, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.618, 'acc_0_0': 0.9744, 'acc_0_1': 0.618, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.596, 'acc_0_0': 0.9854, 'acc_0_1': 0.596, 'acc_1_0': 0.6293, 'acc_1_1': 0.9533, 'mean_acc': 0.7908}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9107, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7768, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5545, 'acc_0_0': 0.9929, 'acc_0_1': 0.7694, 'acc_1_0': 0.5545, 'acc_1_1': 0.9268, 'mean_acc': 0.85}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5821, 'acc_0_0': 0.9658, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6106, 'acc_0_0': 0.984, 'acc_0_1': 0.6945, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9953, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.9876, 'acc_0_1': 0.6732, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8198}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.609, 'acc_1_1': 0.9455, 'mean_acc': 0.8202}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.6266, 'acc_0_0': 0.9274, 'acc_0_1': 0.6266, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.6093, 'acc_0_0': 0.9392, 'acc_0_1': 0.6093, 'acc_1_0': 0.7928, 'acc_1_1': 0.9595, 'mean_acc': 0.7969}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9991, 'acc_0_1': 0.8804, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6119, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6231, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6231, 'acc_1_1': 0.9299, 'mean_acc': 0.8371}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9837, 'acc_1_0': 0.9464, 'acc_1_1': 0.983, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.472, 'acc_0_0': 0.9938, 'acc_0_1': 0.745, 'acc_1_0': 0.472, 'acc_1_1': 0.9174, 'mean_acc': 0.8307}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9989, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9962, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.8026, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.6293, 'acc_0_0': 0.9805, 'acc_0_1': 0.8009, 'acc_1_0': 0.6293, 'acc_1_1': 0.8925, 'mean_acc': 0.8619}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9293, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6567, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6231, 'acc_0_0': 0.9889, 'acc_0_1': 0.714, 'acc_1_0': 0.6231, 'acc_1_1': 0.933, 'mean_acc': 0.8352}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5075, 'acc_1_1': 0.8939, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5016, 'acc_0_0': 0.9956, 'acc_0_1': 0.8483, 'acc_1_0': 0.5016, 'acc_1_1': 0.8785, 'mean_acc': 0.8706}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9713, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8197, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5421, 'acc_0_0': 0.9894, 'acc_0_1': 0.8084, 'acc_1_0': 0.5421, 'acc_1_1': 0.9003, 'mean_acc': 0.8595}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 0.9997, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.5522, 'acc_0_0': 0.9786, 'acc_0_1': 0.6695, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.553, 'acc_0_0': 0.988, 'acc_0_1': 0.639, 'acc_1_0': 0.553, 'acc_1_1': 0.9424, 'mean_acc': 0.7989}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4697, 'acc_0_0': 0.9914, 'acc_0_1': 0.7554, 'acc_1_0': 0.4697, 'acc_1_1': 0.8507, 'mean_acc': 0.8264}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.5224, 'acc_0_0': 0.9786, 'acc_0_1': 0.9871, 'acc_1_0': 0.5224, 'acc_1_1': 0.7273, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.5218, 'acc_0_0': 0.9965, 'acc_0_1': 0.9654, 'acc_1_0': 0.5218, 'acc_1_1': 0.6153, 'mean_acc': 0.8895}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1212, 'acc_0_0': 0.8712, 'acc_0_1': 0.3133, 'acc_1_0': 0.1212, 'acc_1_1': 0.8806, 'mean_acc': 0.5726}
Val(class)(new adapter): {'weighted_mean_acc': 0.935, 'worst_acc': 0.2189, 'acc_0_0': 0.9573, 'acc_0_1': 0.2189, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.6433}
Test(class)(new adapter): {'weighted_mean_acc': 0.9379, 'worst_acc': 0.2022, 'acc_0_0': 0.9667, 'acc_0_1': 0.2022, 'acc_1_0': 0.648, 'acc_1_1': 0.986, 'mean_acc': 0.636}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4592, 'acc_0_0': 0.9871, 'acc_0_1': 0.4592, 'acc_1_0': 0.6061, 'acc_1_1': 0.9552, 'mean_acc': 0.7362}
Val(class)(new adapter): {'weighted_mean_acc': 0.9294, 'worst_acc': 0.7612, 'acc_0_0': 0.9615, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8333, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.729, 'acc_0_0': 0.9769, 'acc_0_1': 0.9206, 'acc_1_0': 0.729, 'acc_1_1': 0.8084, 'mean_acc': 0.9089}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.9142, 'acc_0_1': 0.9185, 'acc_1_0': 0.8182, 'acc_1_1': 0.0, 'mean_acc': 0.803}
Val(class)(new adapter): {'weighted_mean_acc': 0.8615, 'worst_acc': 0.8485, 'acc_0_0': 0.8632, 'acc_0_1': 0.8884, 'acc_1_0': 0.9104, 'acc_1_1': 0.8485, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8478, 'worst_acc': 0.7632, 'acc_0_0': 0.871, 'acc_0_1': 0.8816, 'acc_1_0': 0.8832, 'acc_1_1': 0.7632, 'mean_acc': 0.8645}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9099, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.8507, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.8742, 'worst_acc': 0.8632, 'acc_0_0': 0.8632, 'acc_0_1': 0.8712, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8694, 'worst_acc': 0.8461, 'acc_0_0': 0.871, 'acc_0_1': 0.8461, 'acc_1_0': 0.8832, 'acc_1_1': 0.8676, 'mean_acc': 0.8623}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2985, 'acc_0_0': 0.7296, 'acc_0_1': 0.9914, 'acc_1_0': 0.8333, 'acc_1_1': 0.2985, 'mean_acc': 0.7947}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7425, 'acc_0_0': 0.906, 'acc_0_1': 0.7425, 'acc_1_0': 0.8955, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7525, 'acc_0_0': 0.9095, 'acc_0_1': 0.7525, 'acc_1_0': 0.8598, 'acc_1_1': 0.9377, 'mean_acc': 0.846}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9742, 'acc_0_1': 0.9313, 'acc_1_0': 0.8182, 'acc_1_1': 0.9403, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9406, 'worst_acc': 0.7124, 'acc_0_0': 0.9402, 'acc_0_1': 0.7124, 'acc_1_0': 0.8806, 'acc_1_1': 0.9848, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.9367, 'worst_acc': 0.7135, 'acc_0_0': 0.9481, 'acc_0_1': 0.7135, 'acc_1_0': 0.8209, 'acc_1_1': 0.9439, 'mean_acc': 0.8423}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1045, 'acc_0_0': 0.9871, 'acc_0_1': 0.8412, 'acc_1_0': 0.7424, 'acc_1_1': 0.1045, 'mean_acc': 0.8047}
Val(class)(new adapter): {'weighted_mean_acc': 0.9325, 'worst_acc': 0.6738, 'acc_0_0': 0.9359, 'acc_0_1': 0.6738, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.6652, 'acc_0_0': 0.945, 'acc_0_1': 0.6652, 'acc_1_0': 0.824, 'acc_1_1': 0.9533, 'mean_acc': 0.8236}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9828, 'acc_0_1': 0.9185, 'acc_1_0': 0.803, 'acc_1_1': 0.9701, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.691, 'acc_0_0': 0.9402, 'acc_0_1': 0.691, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.6993, 'acc_0_0': 0.9375, 'acc_0_1': 0.6993, 'acc_1_0': 0.8364, 'acc_1_1': 0.9455, 'mean_acc': 0.8345}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6418, 'acc_0_0': 0.9442, 'acc_0_1': 0.9871, 'acc_1_0': 0.8333, 'acc_1_1': 0.6418, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.9335, 'worst_acc': 0.6953, 'acc_0_0': 0.9359, 'acc_0_1': 0.6953, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7051, 'acc_0_0': 0.9299, 'acc_0_1': 0.7051, 'acc_1_0': 0.838, 'acc_1_1': 0.9455, 'mean_acc': 0.834}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9742, 'acc_0_1': 0.9013, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7382, 'acc_0_0': 0.9145, 'acc_0_1': 0.7382, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7512, 'acc_0_0': 0.922, 'acc_0_1': 0.7512, 'acc_1_0': 0.8551, 'acc_1_1': 0.9346, 'mean_acc': 0.8495}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7164, 'acc_0_0': 0.8541, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.7164, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7639, 'acc_0_0': 0.9103, 'acc_0_1': 0.7639, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.855}
Test(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7774, 'acc_0_0': 0.9122, 'acc_0_1': 0.7774, 'acc_1_0': 0.8598, 'acc_1_1': 0.9268, 'mean_acc': 0.8555}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9785, 'acc_0_1': 0.9657, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.921, 'worst_acc': 0.794, 'acc_0_0': 0.9145, 'acc_0_1': 0.794, 'acc_1_0': 0.8209, 'acc_1_1': 0.9697, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.8213, 'acc_0_0': 0.9197, 'acc_0_1': 0.8213, 'acc_1_0': 0.8458, 'acc_1_1': 0.9097, 'mean_acc': 0.8721}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9356, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.6866, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9277, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8197, 'acc_1_0': 0.7761, 'acc_1_1': 0.9697, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8162, 'acc_0_0': 0.9339, 'acc_0_1': 0.8364, 'acc_1_0': 0.8162, 'acc_1_1': 0.9003, 'mean_acc': 0.8792}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 1.0, 'acc_0_1': 0.9785, 'acc_1_0': 0.8333, 'acc_1_1': 0.9851, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.7761, 'acc_0_0': 0.9402, 'acc_0_1': 0.8455, 'acc_1_0': 0.7761, 'acc_1_1': 0.9242, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.7866, 'acc_0_0': 0.9512, 'acc_0_1': 0.8532, 'acc_1_0': 0.7866, 'acc_1_1': 0.8863, 'mean_acc': 0.8876}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9828, 'acc_0_1': 0.97, 'acc_1_0': 0.9394, 'acc_1_1': 0.8507, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9275, 'worst_acc': 0.7761, 'acc_0_0': 0.9359, 'acc_0_1': 0.8326, 'acc_1_0': 0.7761, 'acc_1_1': 0.9242, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9371, 'worst_acc': 0.7726, 'acc_0_0': 0.9588, 'acc_0_1': 0.8572, 'acc_1_0': 0.7726, 'acc_1_1': 0.8879, 'mean_acc': 0.8907}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.8412, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9386, 'worst_acc': 0.7539, 'acc_0_0': 0.9654, 'acc_0_1': 0.8674, 'acc_1_0': 0.7539, 'acc_1_1': 0.8723, 'mean_acc': 0.8935}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8955, 'acc_0_0': 0.9957, 'acc_0_1': 0.9528, 'acc_1_0': 0.9697, 'acc_1_1': 0.8955, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9243, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.8498, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.7508, 'acc_0_0': 0.9627, 'acc_0_1': 0.8736, 'acc_1_0': 0.7508, 'acc_1_1': 0.8692, 'mean_acc': 0.8942}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.8541, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9312, 'worst_acc': 0.743, 'acc_0_0': 0.9645, 'acc_0_1': 0.8914, 'acc_1_0': 0.743, 'acc_1_1': 0.838, 'mean_acc': 0.8975}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9871, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.8755, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9288, 'worst_acc': 0.7118, 'acc_0_0': 0.9698, 'acc_0_1': 0.9157, 'acc_1_0': 0.7118, 'acc_1_1': 0.8069, 'mean_acc': 0.9021}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.6963, 'acc_0_0': 0.9707, 'acc_0_1': 0.9348, 'acc_1_0': 0.6963, 'acc_1_1': 0.7648, 'mean_acc': 0.9035}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.6567, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.6567, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.6807, 'acc_0_0': 0.9729, 'acc_0_1': 0.9432, 'acc_1_0': 0.6807, 'acc_1_1': 0.7523, 'mean_acc': 0.9046}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.6418, 'acc_0_0': 0.9402, 'acc_0_1': 0.9485, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9191, 'worst_acc': 0.6791, 'acc_0_0': 0.9716, 'acc_0_1': 0.9415, 'acc_1_0': 0.6791, 'acc_1_1': 0.7539, 'mean_acc': 0.9033}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9095, 'worst_acc': 0.6418, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.6418, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.6791, 'acc_0_0': 0.9721, 'acc_0_1': 0.9322, 'acc_1_0': 0.6791, 'acc_1_1': 0.7664, 'mean_acc': 0.9013}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9085, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.8927, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.6994, 'acc_0_0': 0.9694, 'acc_0_1': 0.9233, 'acc_1_0': 0.6994, 'acc_1_1': 0.7726, 'mean_acc': 0.8997}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9084, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.8841, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7196, 'acc_0_0': 0.9636, 'acc_0_1': 0.9149, 'acc_1_0': 0.7196, 'acc_1_1': 0.7897, 'mean_acc': 0.8983}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.905, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.8841, 'acc_1_0': 0.6866, 'acc_1_1': 0.8182, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7336, 'acc_0_0': 0.9601, 'acc_0_1': 0.9166, 'acc_1_0': 0.7336, 'acc_1_1': 0.7819, 'mean_acc': 0.8983}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.8755, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7383, 'acc_0_0': 0.9588, 'acc_0_1': 0.9153, 'acc_1_0': 0.7383, 'acc_1_1': 0.7913, 'mean_acc': 0.8989}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9152, 'worst_acc': 0.7336, 'acc_0_0': 0.9596, 'acc_0_1': 0.918, 'acc_1_0': 0.7336, 'acc_1_1': 0.7773, 'mean_acc': 0.8982}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7259, 'acc_0_0': 0.9623, 'acc_0_1': 0.9215, 'acc_1_0': 0.7259, 'acc_1_1': 0.7788, 'mean_acc': 0.8999}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.6866, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.6866, 'acc_1_1': 0.8333, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7212, 'acc_0_0': 0.9623, 'acc_0_1': 0.9237, 'acc_1_0': 0.7212, 'acc_1_1': 0.771, 'mean_acc': 0.8994}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7336, 'acc_0_0': 0.9601, 'acc_0_1': 0.9224, 'acc_1_0': 0.7336, 'acc_1_1': 0.7757, 'mean_acc': 0.8999}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9091, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7383, 'acc_0_0': 0.9592, 'acc_0_1': 0.9233, 'acc_1_0': 0.7383, 'acc_1_1': 0.7804, 'mean_acc': 0.9009}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9094, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.7321, 'acc_0_0': 0.9601, 'acc_0_1': 0.9273, 'acc_1_0': 0.7321, 'acc_1_1': 0.7757, 'mean_acc': 0.9016}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7321, 'acc_0_0': 0.9614, 'acc_0_1': 0.9251, 'acc_1_0': 0.7321, 'acc_1_1': 0.7788, 'mean_acc': 0.9016}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9124, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.897, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7336, 'acc_0_0': 0.961, 'acc_0_1': 0.9202, 'acc_1_0': 0.7336, 'acc_1_1': 0.7897, 'mean_acc': 0.9009}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9119, 'worst_acc': 0.7015, 'acc_0_0': 0.9359, 'acc_0_1': 0.8841, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7383, 'acc_0_0': 0.9605, 'acc_0_1': 0.9153, 'acc_1_0': 0.7383, 'acc_1_1': 0.7928, 'mean_acc': 0.8997}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.8798, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.7414, 'acc_0_0': 0.9588, 'acc_0_1': 0.9104, 'acc_1_0': 0.7414, 'acc_1_1': 0.8022, 'mean_acc': 0.8985}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.8712, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7492, 'acc_0_0': 0.9543, 'acc_0_1': 0.9064, 'acc_1_0': 0.7492, 'acc_1_1': 0.8069, 'mean_acc': 0.8966}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.867, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7523, 'acc_0_0': 0.9521, 'acc_0_1': 0.9024, 'acc_1_0': 0.7523, 'acc_1_1': 0.8131, 'mean_acc': 0.8952}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.8712, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7492, 'acc_0_0': 0.953, 'acc_0_1': 0.9064, 'acc_1_0': 0.7492, 'acc_1_1': 0.8069, 'mean_acc': 0.8961}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.8712, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7477, 'acc_0_0': 0.953, 'acc_0_1': 0.9051, 'acc_1_0': 0.7477, 'acc_1_1': 0.81, 'mean_acc': 0.8958}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.8755, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7445, 'acc_0_0': 0.9543, 'acc_0_1': 0.9073, 'acc_1_0': 0.7445, 'acc_1_1': 0.8053, 'mean_acc': 0.8963}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9089, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.8755, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7477, 'acc_0_0': 0.9534, 'acc_0_1': 0.9073, 'acc_1_0': 0.7477, 'acc_1_1': 0.8053, 'mean_acc': 0.8963}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8755, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.7477, 'acc_0_0': 0.9517, 'acc_0_1': 0.9055, 'acc_1_0': 0.7477, 'acc_1_1': 0.8069, 'mean_acc': 0.8951}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.8798, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.7461, 'acc_0_0': 0.953, 'acc_0_1': 0.9086, 'acc_1_0': 0.7461, 'acc_1_1': 0.8053, 'mean_acc': 0.8964}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7523, 'acc_0_0': 0.9508, 'acc_0_1': 0.906, 'acc_1_0': 0.7523, 'acc_1_1': 0.8069, 'mean_acc': 0.8954}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7492, 'acc_0_0': 0.9508, 'acc_0_1': 0.9055, 'acc_1_0': 0.7492, 'acc_1_1': 0.8037, 'mean_acc': 0.8945}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7555, 'acc_0_0': 0.9494, 'acc_0_1': 0.9051, 'acc_1_0': 0.7555, 'acc_1_1': 0.8053, 'mean_acc': 0.8947}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7523, 'acc_0_0': 0.949, 'acc_0_1': 0.9055, 'acc_1_0': 0.7523, 'acc_1_1': 0.8037, 'mean_acc': 0.8942}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7477, 'acc_0_0': 0.9499, 'acc_0_1': 0.9055, 'acc_1_0': 0.7477, 'acc_1_1': 0.8037, 'mean_acc': 0.894}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7539, 'acc_0_0': 0.9486, 'acc_0_1': 0.9051, 'acc_1_0': 0.7539, 'acc_1_1': 0.8069, 'mean_acc': 0.8944}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7477, 'acc_0_0': 0.9503, 'acc_0_1': 0.906, 'acc_1_0': 0.7477, 'acc_1_1': 0.8037, 'mean_acc': 0.8944}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.7477, 'acc_0_0': 0.9508, 'acc_0_1': 0.906, 'acc_1_0': 0.7477, 'acc_1_1': 0.8022, 'mean_acc': 0.8944}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7492, 'acc_0_0': 0.9503, 'acc_0_1': 0.9055, 'acc_1_0': 0.7492, 'acc_1_1': 0.8037, 'mean_acc': 0.8944}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7477, 'acc_0_0': 0.9503, 'acc_0_1': 0.9069, 'acc_1_0': 0.7477, 'acc_1_1': 0.8022, 'mean_acc': 0.8945}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7539, 'acc_0_0': 0.9499, 'acc_0_1': 0.9055, 'acc_1_0': 0.7539, 'acc_1_1': 0.8037, 'mean_acc': 0.8947}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9127, 'worst_acc': 0.7539, 'acc_0_0': 0.949, 'acc_0_1': 0.9069, 'acc_1_0': 0.7539, 'acc_1_1': 0.8022, 'mean_acc': 0.8947}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7539, 'acc_0_0': 0.9494, 'acc_0_1': 0.9055, 'acc_1_0': 0.7539, 'acc_1_1': 0.8037, 'mean_acc': 0.8945}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.7539, 'acc_0_0': 0.9499, 'acc_0_1': 0.9073, 'acc_1_0': 0.7539, 'acc_1_1': 0.8022, 'mean_acc': 0.8952}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.8485, 'acc_0_0': 0.9099, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.8507, 'mean_acc': 0.9165}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8742, 'worst_acc': 0.8632, 'acc_0_0': 0.8632, 'acc_0_1': 0.8712, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.8767}
best test accuracy on [class]: {'weighted_mean_acc': 0.8694, 'worst_acc': 0.8461, 'acc_0_0': 0.871, 'acc_0_1': 0.8461, 'acc_1_0': 0.8832, 'acc_1_1': 0.8676, 'mean_acc': 0.8623}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8694, 'worst_acc': 0.8461, 'acc_0_0': 0.871, 'acc_0_1': 0.8461, 'acc_1_0': 0.8832, 'acc_1_1': 0.8676, 'mean_acc': 0.8623}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.8902, 'worst_acc': 0.1636, 'acc_0_0': 0.8661, 'acc_0_1': 0.9401, 'acc_1_0': 0.1636, 'acc_1_1': 1.0, 'mean_acc': 0.8319}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.8485, 'acc_0_0': 0.9099, 'acc_0_1': 0.9614, 'acc_1_0': 0.8485, 'acc_1_1': 0.8507, 'mean_acc': 0.9165}, 'Val': {'weighted_mean_acc': 0.8742, 'worst_acc': 0.8632, 'acc_0_0': 0.8632, 'acc_0_1': 0.8712, 'acc_1_0': 0.9104, 'acc_1_1': 0.9091, 'mean_acc': 0.8767}, 'Test': {'weighted_mean_acc': 0.8694, 'worst_acc': 0.8461, 'acc_0_0': 0.871, 'acc_0_1': 0.8461, 'acc_1_0': 0.8832, 'acc_1_1': 0.8676, 'mean_acc': 0.8623}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8694, 'worst_acc': 0.8461, 'acc_0_0': 0.871, 'acc_0_1': 0.8461, 'acc_1_0': 0.8832, 'acc_1_1': 0.8676, 'mean_acc': 0.8623}, 'spurious': {'weighted_mean_acc': 0.8902, 'worst_acc': 0.1636, 'acc_0_0': 0.8661, 'acc_0_1': 0.9401, 'acc_1_0': 0.1636, 'acc_1_1': 1.0, 'mean_acc': 0.8319}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0893, 'acc_0_0': 0.9182, 'acc_0_1': 0.8098, 'acc_1_0': 0.0893, 'acc_1_1': 0.211, 'mean_acc': 0.7485}
Val(class): {'weighted_mean_acc': 0.932, 'worst_acc': 0.1545, 'acc_0_0': 0.9615, 'acc_0_1': 0.1545, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.615}
Test(class): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.1397, 'acc_0_0': 0.9659, 'acc_0_1': 0.1397, 'acc_1_0': 0.6573, 'acc_1_1': 0.9766, 'mean_acc': 0.6113}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9917, 'acc_0_1': 0.4185, 'acc_1_0': 0.3393, 'acc_1_1': 0.8694, 'mean_acc': 0.9351}
Val(class): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.103, 'acc_0_0': 0.9188, 'acc_0_1': 0.103, 'acc_1_0': 0.6418, 'acc_1_1': 1.0, 'mean_acc': 0.58}
Test(class): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.0847, 'acc_0_0': 0.9308, 'acc_0_1': 0.0847, 'acc_1_0': 0.7227, 'acc_1_1': 0.986, 'mean_acc': 0.5846}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.2143, 'acc_0_0': 0.998, 'acc_0_1': 0.6033, 'acc_1_0': 0.2143, 'acc_1_1': 0.8288, 'mean_acc': 0.9364}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.2017, 'acc_0_0': 0.9829, 'acc_0_1': 0.2017, 'acc_1_0': 0.6119, 'acc_1_1': 1.0, 'mean_acc': 0.64}
Test(class): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.1703, 'acc_0_0': 0.9783, 'acc_0_1': 0.1703, 'acc_1_0': 0.5935, 'acc_1_1': 0.9688, 'mean_acc': 0.6201}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9971, 'acc_0_1': 0.5272, 'acc_1_0': 0.3214, 'acc_1_1': 0.9167, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.3348, 'acc_0_0': 1.0, 'acc_0_1': 0.3348, 'acc_1_0': 0.5373, 'acc_1_1': 0.9848, 'mean_acc': 0.6883}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.2812, 'acc_0_0': 0.9863, 'acc_0_1': 0.2812, 'acc_1_0': 0.5234, 'acc_1_1': 0.9673, 'mean_acc': 0.6584}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9954, 'acc_0_1': 0.4728, 'acc_1_0': 0.3393, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4506, 'acc_0_0': 1.0, 'acc_0_1': 0.4506, 'acc_1_0': 0.4776, 'acc_1_1': 0.9848, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.3969, 'acc_0_0': 0.9885, 'acc_0_1': 0.3969, 'acc_1_0': 0.4984, 'acc_1_1': 0.9595, 'mean_acc': 0.7007}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9937, 'acc_0_1': 0.4728, 'acc_1_0': 0.4464, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.5322, 'acc_1_0': 0.4627, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.4807, 'acc_0_0': 0.9902, 'acc_0_1': 0.4807, 'acc_1_0': 0.4891, 'acc_1_1': 0.9502, 'mean_acc': 0.732}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.9937, 'acc_0_1': 0.5217, 'acc_1_0': 0.5179, 'acc_1_1': 0.9508, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.4478, 'acc_0_0': 1.0, 'acc_0_1': 0.6052, 'acc_1_0': 0.4478, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4688, 'acc_0_0': 0.9911, 'acc_0_1': 0.5579, 'acc_1_0': 0.4688, 'acc_1_1': 0.9455, 'mean_acc': 0.7596}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9943, 'acc_0_1': 0.5924, 'acc_1_0': 0.4821, 'acc_1_1': 0.948, 'mean_acc': 0.9627}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4179, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.4179, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.4579, 'acc_0_0': 0.9933, 'acc_0_1': 0.6257, 'acc_1_0': 0.4579, 'acc_1_1': 0.9346, 'mean_acc': 0.7844}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9946, 'acc_0_1': 0.6522, 'acc_1_0': 0.4464, 'acc_1_1': 0.9404, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4439, 'acc_0_0': 0.9947, 'acc_0_1': 0.6825, 'acc_1_0': 0.4439, 'acc_1_1': 0.9283, 'mean_acc': 0.8048}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9954, 'acc_0_1': 0.6957, 'acc_1_0': 0.5, 'acc_1_1': 0.9347, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.4424, 'acc_0_0': 0.9956, 'acc_0_1': 0.7055, 'acc_1_0': 0.4424, 'acc_1_1': 0.919, 'mean_acc': 0.8129}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.4821, 'acc_1_1': 0.9357, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9736, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.4595, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.4595, 'acc_1_1': 0.9221, 'mean_acc': 0.8139}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.994, 'acc_0_1': 0.712, 'acc_1_0': 0.5536, 'acc_1_1': 0.9442, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.4627, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.486, 'acc_0_0': 0.9933, 'acc_0_1': 0.6914, 'acc_1_0': 0.486, 'acc_1_1': 0.9252, 'mean_acc': 0.812}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.5893, 'acc_1_1': 0.948, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5031, 'acc_0_0': 0.9929, 'acc_0_1': 0.6803, 'acc_1_0': 0.5031, 'acc_1_1': 0.9283, 'mean_acc': 0.8098}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9499, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5093, 'acc_0_0': 0.9925, 'acc_0_1': 0.6785, 'acc_1_0': 0.5093, 'acc_1_1': 0.9315, 'mean_acc': 0.81}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9931, 'acc_0_1': 0.6848, 'acc_1_0': 0.5714, 'acc_1_1': 0.9518, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9743, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5156, 'acc_0_0': 0.9929, 'acc_0_1': 0.6807, 'acc_1_0': 0.5156, 'acc_1_1': 0.9315, 'mean_acc': 0.8117}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9923, 'acc_0_1': 0.7174, 'acc_1_0': 0.625, 'acc_1_1': 0.9451, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9748, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5031, 'acc_0_0': 0.9933, 'acc_0_1': 0.6949, 'acc_1_0': 0.5031, 'acc_1_1': 0.9237, 'mean_acc': 0.8152}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6607, 'acc_1_1': 0.9451, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5062, 'acc_0_0': 0.992, 'acc_0_1': 0.6971, 'acc_1_0': 0.5062, 'acc_1_1': 0.9252, 'mean_acc': 0.816}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9929, 'acc_0_1': 0.7391, 'acc_1_0': 0.6429, 'acc_1_1': 0.9451, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9753, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.4925, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.5109, 'acc_0_0': 0.9929, 'acc_0_1': 0.7073, 'acc_1_0': 0.5109, 'acc_1_1': 0.9206, 'mean_acc': 0.8203}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9461, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.702, 'acc_1_0': 0.5327, 'acc_1_1': 0.9221, 'mean_acc': 0.8203}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7446, 'acc_1_0': 0.6607, 'acc_1_1': 0.947, 'mean_acc': 0.9689}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5436, 'acc_0_0': 0.9907, 'acc_0_1': 0.7078, 'acc_1_0': 0.5436, 'acc_1_1': 0.9221, 'mean_acc': 0.8234}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.75, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.5514, 'acc_0_0': 0.9898, 'acc_0_1': 0.6891, 'acc_1_0': 0.5514, 'acc_1_1': 0.9268, 'mean_acc': 0.8172}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9536, 'mean_acc': 0.9718}
Val(class): {'weighted_mean_acc': 0.9754, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.6936, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.82}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.788, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5872, 'acc_0_0': 0.9889, 'acc_0_1': 0.6763, 'acc_1_0': 0.5872, 'acc_1_1': 0.933, 'mean_acc': 0.8165}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9751, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6687, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8152}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9931, 'acc_0_1': 0.8098, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6028, 'acc_0_0': 0.9871, 'acc_0_1': 0.6825, 'acc_1_0': 0.6028, 'acc_1_1': 0.9315, 'mean_acc': 0.8198}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.994, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6246, 'acc_0_0': 0.9863, 'acc_0_1': 0.6585, 'acc_1_0': 0.6246, 'acc_1_1': 0.9393, 'mean_acc': 0.8134}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.994, 'acc_0_1': 0.8043, 'acc_1_0': 0.7857, 'acc_1_1': 0.9688, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6153, 'acc_0_0': 0.9867, 'acc_0_1': 0.6785, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8196}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.6964, 'acc_1_1': 0.9593, 'mean_acc': 0.9783}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5919, 'acc_0_0': 0.9898, 'acc_0_1': 0.7273, 'acc_1_0': 0.5919, 'acc_1_1': 0.9237, 'mean_acc': 0.8362}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.975, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.6059, 'acc_1_1': 0.9361, 'mean_acc': 0.8169}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9949, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9811, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.6199, 'acc_0_0': 0.9863, 'acc_0_1': 0.6789, 'acc_1_0': 0.6199, 'acc_1_1': 0.9346, 'mean_acc': 0.8203}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9699, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6199, 'acc_0_0': 0.9867, 'acc_0_1': 0.7042, 'acc_1_0': 0.6199, 'acc_1_1': 0.9268, 'mean_acc': 0.8295}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.837, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6121, 'acc_0_0': 0.988, 'acc_0_1': 0.6931, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.8255}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9969, 'acc_0_1': 0.8641, 'acc_1_0': 0.8393, 'acc_1_1': 0.9801, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6153, 'acc_0_0': 0.9871, 'acc_0_1': 0.7251, 'acc_1_0': 0.6153, 'acc_1_1': 0.9268, 'mean_acc': 0.8372}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.998, 'acc_0_1': 0.913, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9864}
Val(class): {'weighted_mean_acc': 0.973, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6168, 'acc_0_0': 0.9871, 'acc_0_1': 0.7033, 'acc_1_0': 0.6168, 'acc_1_1': 0.9315, 'mean_acc': 0.8295}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.8214, 'acc_1_1': 0.9839, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.6695, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6271, 'acc_0_0': 0.9827, 'acc_0_1': 0.6271, 'acc_1_0': 0.6558, 'acc_1_1': 0.9455, 'mean_acc': 0.8039}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9969, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.983, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6309, 'acc_0_0': 0.9786, 'acc_0_1': 0.6309, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.6004, 'acc_0_0': 0.9796, 'acc_0_1': 0.6004, 'acc_1_0': 0.6822, 'acc_1_1': 0.9439, 'mean_acc': 0.7951}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.8913, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6402, 'acc_0_0': 0.9854, 'acc_0_1': 0.6576, 'acc_1_0': 0.6402, 'acc_1_1': 0.9377, 'mean_acc': 0.8143}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.998, 'acc_0_1': 0.9293, 'acc_1_0': 0.8929, 'acc_1_1': 0.9801, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6262, 'acc_0_0': 0.9863, 'acc_0_1': 0.6776, 'acc_1_0': 0.6262, 'acc_1_1': 0.9315, 'mean_acc': 0.8202}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9983, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9906}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.6558, 'acc_0_0': 0.9854, 'acc_0_1': 0.6887, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8269}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9989, 'acc_0_1': 0.9457, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.634, 'acc_0_0': 0.9849, 'acc_0_1': 0.6687, 'acc_1_0': 0.634, 'acc_1_1': 0.933, 'mean_acc': 0.8172}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9914, 'acc_0_1': 0.8755, 'acc_1_0': 0.5455, 'acc_1_1': 0.8507, 'mean_acc': 0.8815}
Val(class)(new adapter): {'weighted_mean_acc': 0.9444, 'worst_acc': 0.7425, 'acc_0_0': 0.9402, 'acc_0_1': 0.7425, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9313, 'worst_acc': 0.741, 'acc_0_0': 0.9437, 'acc_0_1': 0.741, 'acc_1_0': 0.8131, 'acc_1_1': 0.9299, 'mean_acc': 0.8488}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1667, 'acc_0_0': 0.867, 'acc_0_1': 0.5021, 'acc_1_0': 0.1667, 'acc_1_1': 0.8209, 'mean_acc': 0.6427}
Val(class)(new adapter): {'weighted_mean_acc': 0.8975, 'worst_acc': 0.0901, 'acc_0_0': 0.9103, 'acc_0_1': 0.0901, 'acc_1_0': 0.8209, 'acc_1_1': 1.0, 'mean_acc': 0.5917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8997, 'worst_acc': 0.118, 'acc_0_0': 0.9135, 'acc_0_1': 0.118, 'acc_1_0': 0.8271, 'acc_1_1': 0.9938, 'mean_acc': 0.6032}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5455, 'acc_0_0': 0.9828, 'acc_0_1': 0.6309, 'acc_1_0': 0.5455, 'acc_1_1': 0.8955, 'mean_acc': 0.788}
Val(class)(new adapter): {'weighted_mean_acc': 0.6562, 'worst_acc': 0.3182, 'acc_0_0': 0.7393, 'acc_0_1': 0.9399, 'acc_1_0': 0.9104, 'acc_1_1': 0.3182, 'mean_acc': 0.79}
Test(class)(new adapter): {'weighted_mean_acc': 0.6562, 'worst_acc': 0.3302, 'acc_0_0': 0.7348, 'acc_0_1': 0.9517, 'acc_1_0': 0.9268, 'acc_1_1': 0.3302, 'mean_acc': 0.7957}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8155, 'acc_0_1': 0.9399, 'acc_1_0': 0.9394, 'acc_1_1': 0.0, 'mean_acc': 0.7863}
Val(class)(new adapter): {'weighted_mean_acc': 0.7892, 'worst_acc': 0.6364, 'acc_0_0': 0.8248, 'acc_0_1': 0.9571, 'acc_1_0': 0.8955, 'acc_1_1': 0.6364, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.7628, 'worst_acc': 0.5109, 'acc_0_0': 0.8262, 'acc_0_1': 0.9583, 'acc_1_0': 0.9143, 'acc_1_1': 0.5109, 'mean_acc': 0.8524}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6716, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.8636, 'acc_1_1': 0.6716, 'mean_acc': 0.9232}
Val(class)(new adapter): {'weighted_mean_acc': 0.8678, 'worst_acc': 0.8636, 'acc_0_0': 0.8675, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8636, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8598, 'worst_acc': 0.8271, 'acc_0_0': 0.867, 'acc_0_1': 0.8971, 'acc_1_0': 0.9097, 'acc_1_1': 0.8271, 'mean_acc': 0.879}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3433, 'acc_0_0': 0.9185, 'acc_0_1': 0.9957, 'acc_1_0': 0.8182, 'acc_1_1': 0.3433, 'mean_acc': 0.8731}
Val(class)(new adapter): {'weighted_mean_acc': 0.8493, 'worst_acc': 0.6009, 'acc_0_0': 0.8248, 'acc_0_1': 0.6009, 'acc_1_0': 0.9254, 'acc_1_1': 0.9697, 'mean_acc': 0.765}
Test(class)(new adapter): {'weighted_mean_acc': 0.839, 'worst_acc': 0.5676, 'acc_0_0': 0.8164, 'acc_0_1': 0.5676, 'acc_1_0': 0.9237, 'acc_1_1': 0.9564, 'mean_acc': 0.747}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8326, 'acc_0_0': 0.9571, 'acc_0_1': 0.8326, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.7167, 'acc_0_0': 0.8803, 'acc_0_1': 0.7167, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class)(new adapter): {'weighted_mean_acc': 0.8863, 'worst_acc': 0.7353, 'acc_0_0': 0.8776, 'acc_0_1': 0.7353, 'acc_1_0': 0.8941, 'acc_1_1': 0.9408, 'mean_acc': 0.831}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6269, 'acc_0_0': 0.9356, 'acc_0_1': 0.9957, 'acc_1_0': 0.7273, 'acc_1_1': 0.6269, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.8112, 'acc_0_0': 0.8846, 'acc_0_1': 0.8112, 'acc_1_0': 0.8358, 'acc_1_1': 0.9697, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8684, 'worst_acc': 0.8217, 'acc_0_0': 0.8572, 'acc_0_1': 0.8217, 'acc_1_0': 0.8847, 'acc_1_1': 0.9128, 'mean_acc': 0.8526}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.9403, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.867, 'worst_acc': 0.8283, 'acc_0_0': 0.8376, 'acc_0_1': 0.8283, 'acc_1_0': 0.8955, 'acc_1_1': 0.9697, 'mean_acc': 0.855}
Test(class)(new adapter): {'weighted_mean_acc': 0.8378, 'worst_acc': 0.8213, 'acc_0_0': 0.8213, 'acc_0_1': 0.8306, 'acc_1_0': 0.9159, 'acc_1_1': 0.8894, 'mean_acc': 0.8429}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7612, 'acc_0_0': 0.9485, 'acc_0_1': 0.9614, 'acc_1_0': 0.9242, 'acc_1_1': 0.7612, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.8449, 'worst_acc': 0.8077, 'acc_0_0': 0.8077, 'acc_0_1': 0.8197, 'acc_1_0': 0.8955, 'acc_1_1': 0.9697, 'mean_acc': 0.84}
Test(class)(new adapter): {'weighted_mean_acc': 0.8284, 'worst_acc': 0.8071, 'acc_0_0': 0.8071, 'acc_0_1': 0.8186, 'acc_1_0': 0.9252, 'acc_1_1': 0.8956, 'mean_acc': 0.8345}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9099, 'acc_0_0': 0.9099, 'acc_0_1': 0.9614, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.8762, 'worst_acc': 0.8507, 'acc_0_0': 0.8632, 'acc_0_1': 0.8541, 'acc_1_0': 0.8507, 'acc_1_1': 0.9242, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.865, 'worst_acc': 0.8608, 'acc_0_0': 0.8625, 'acc_0_1': 0.8608, 'acc_1_0': 0.8941, 'acc_1_1': 0.8723, 'mean_acc': 0.8664}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9785, 'acc_0_1': 0.9785, 'acc_1_0': 0.9242, 'acc_1_1': 0.8657, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.8712, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9059, 'worst_acc': 0.8302, 'acc_0_0': 0.9264, 'acc_0_1': 0.886, 'acc_1_0': 0.8302, 'acc_1_1': 0.8458, 'mean_acc': 0.8911}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9088, 'worst_acc': 0.7164, 'acc_0_0': 0.9188, 'acc_0_1': 0.8627, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7882, 'acc_0_0': 0.9548, 'acc_0_1': 0.8984, 'acc_1_0': 0.7882, 'acc_1_1': 0.8318, 'mean_acc': 0.9008}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.8806, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9186, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.8627, 'acc_1_0': 0.7313, 'acc_1_1': 0.9091, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.925, 'worst_acc': 0.7944, 'acc_0_0': 0.9517, 'acc_0_1': 0.8851, 'acc_1_0': 0.7944, 'acc_1_1': 0.8505, 'mean_acc': 0.8971}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.8584, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.824, 'acc_0_0': 0.9339, 'acc_0_1': 0.8847, 'acc_1_0': 0.824, 'acc_1_1': 0.8489, 'mean_acc': 0.8932}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9657, 'acc_0_0': 0.9657, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9063, 'worst_acc': 0.7761, 'acc_0_0': 0.9103, 'acc_0_1': 0.8541, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8733}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.8255, 'acc_0_0': 0.933, 'acc_0_1': 0.8829, 'acc_1_0': 0.8255, 'acc_1_1': 0.8536, 'mean_acc': 0.8928}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9785, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.916, 'worst_acc': 0.7612, 'acc_0_0': 0.9316, 'acc_0_1': 0.8798, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.7928, 'acc_0_0': 0.9539, 'acc_0_1': 0.9073, 'acc_1_0': 0.7928, 'acc_1_1': 0.8131, 'mean_acc': 0.9023}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7664, 'acc_0_0': 0.9619, 'acc_0_1': 0.9317, 'acc_1_0': 0.7664, 'acc_1_1': 0.7804, 'mean_acc': 0.9084}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.6866, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.743, 'acc_0_0': 0.969, 'acc_0_1': 0.9397, 'acc_1_0': 0.7445, 'acc_1_1': 0.743, 'mean_acc': 0.9077}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9198, 'worst_acc': 0.6866, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.6866, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7461, 'acc_0_0': 0.9667, 'acc_0_1': 0.937, 'acc_1_0': 0.7523, 'acc_1_1': 0.7461, 'mean_acc': 0.907}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7015, 'acc_0_0': 0.9402, 'acc_0_1': 0.9142, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7555, 'acc_0_0': 0.9627, 'acc_0_1': 0.9322, 'acc_1_0': 0.7586, 'acc_1_1': 0.7555, 'mean_acc': 0.9052}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7664, 'acc_0_0': 0.9574, 'acc_0_1': 0.9206, 'acc_1_0': 0.771, 'acc_1_1': 0.7664, 'mean_acc': 0.9013}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.8927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.7788, 'acc_0_0': 0.9534, 'acc_0_1': 0.906, 'acc_1_0': 0.785, 'acc_1_1': 0.7788, 'mean_acc': 0.897}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9189, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.8884, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7648, 'acc_0_0': 0.9565, 'acc_0_1': 0.9016, 'acc_1_0': 0.7648, 'acc_1_1': 0.7897, 'mean_acc': 0.8954}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9914, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.6716, 'acc_0_0': 0.9402, 'acc_0_1': 0.9056, 'acc_1_0': 0.6716, 'acc_1_1': 0.8485, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7399, 'acc_0_0': 0.9663, 'acc_0_1': 0.9215, 'acc_1_0': 0.7399, 'acc_1_1': 0.7632, 'mean_acc': 0.9013}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9163, 'worst_acc': 0.6418, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.6418, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.676, 'acc_0_0': 0.9774, 'acc_0_1': 0.9641, 'acc_1_0': 0.6822, 'acc_1_1': 0.676, 'mean_acc': 0.9061}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.6269, 'acc_0_0': 0.9573, 'acc_0_1': 0.9657, 'acc_1_0': 0.6269, 'acc_1_1': 0.7576, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.6246, 'acc_0_0': 0.9818, 'acc_0_1': 0.9716, 'acc_1_0': 0.6604, 'acc_1_1': 0.6246, 'mean_acc': 0.9027}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.6269, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.6269, 'acc_1_1': 0.7576, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8992, 'worst_acc': 0.6355, 'acc_0_0': 0.9787, 'acc_0_1': 0.9721, 'acc_1_0': 0.6698, 'acc_1_1': 0.6355, 'mean_acc': 0.9039}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.6418, 'acc_0_0': 0.953, 'acc_0_1': 0.9657, 'acc_1_0': 0.6418, 'acc_1_1': 0.803, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.6636, 'acc_0_0': 0.9761, 'acc_0_1': 0.9694, 'acc_1_0': 0.6854, 'acc_1_1': 0.6636, 'mean_acc': 0.9066}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.6567, 'acc_0_0': 0.9487, 'acc_0_1': 0.9614, 'acc_1_0': 0.6567, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9122, 'worst_acc': 0.7134, 'acc_0_0': 0.9721, 'acc_0_1': 0.9601, 'acc_1_0': 0.7134, 'acc_1_1': 0.7165, 'mean_acc': 0.9104}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7015, 'acc_0_0': 0.9444, 'acc_0_1': 0.9485, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7461, 'acc_0_0': 0.9672, 'acc_0_1': 0.9494, 'acc_1_0': 0.7461, 'acc_1_1': 0.7523, 'mean_acc': 0.912}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7555, 'acc_0_0': 0.9619, 'acc_0_1': 0.9361, 'acc_1_0': 0.7555, 'acc_1_1': 0.7648, 'mean_acc': 0.9071}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9181, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9442, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7726, 'acc_0_0': 0.9565, 'acc_0_1': 0.9251, 'acc_1_0': 0.7726, 'acc_1_1': 0.7804, 'mean_acc': 0.9044}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7773, 'acc_0_0': 0.953, 'acc_0_1': 0.9166, 'acc_1_0': 0.7773, 'acc_1_1': 0.7944, 'mean_acc': 0.9018}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9195, 'worst_acc': 0.7539, 'acc_0_0': 0.9605, 'acc_0_1': 0.9184, 'acc_1_0': 0.7539, 'acc_1_1': 0.7928, 'mean_acc': 0.9027}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9145, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.7492, 'acc_0_0': 0.9627, 'acc_0_1': 0.9202, 'acc_1_0': 0.7492, 'acc_1_1': 0.7913, 'mean_acc': 0.9035}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7414, 'acc_0_0': 0.9636, 'acc_0_1': 0.9202, 'acc_1_0': 0.7414, 'acc_1_1': 0.7928, 'mean_acc': 0.9032}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9176, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7399, 'acc_0_0': 0.9654, 'acc_0_1': 0.9206, 'acc_1_0': 0.7399, 'acc_1_1': 0.7913, 'mean_acc': 0.9037}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7399, 'acc_0_0': 0.9654, 'acc_0_1': 0.9237, 'acc_1_0': 0.7399, 'acc_1_1': 0.785, 'mean_acc': 0.9042}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7508, 'acc_0_0': 0.9619, 'acc_0_1': 0.9202, 'acc_1_0': 0.7508, 'acc_1_1': 0.7897, 'mean_acc': 0.9032}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7523, 'acc_0_0': 0.961, 'acc_0_1': 0.9228, 'acc_1_0': 0.7523, 'acc_1_1': 0.7882, 'mean_acc': 0.9039}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.7523, 'acc_0_0': 0.961, 'acc_0_1': 0.922, 'acc_1_0': 0.7523, 'acc_1_1': 0.7897, 'mean_acc': 0.9037}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7601, 'acc_0_0': 0.9592, 'acc_0_1': 0.9193, 'acc_1_0': 0.7601, 'acc_1_1': 0.7928, 'mean_acc': 0.9032}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7601, 'acc_0_0': 0.9579, 'acc_0_1': 0.9188, 'acc_1_0': 0.7601, 'acc_1_1': 0.7928, 'mean_acc': 0.9025}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9177, 'worst_acc': 0.7601, 'acc_0_0': 0.9583, 'acc_0_1': 0.9202, 'acc_1_0': 0.7601, 'acc_1_1': 0.7913, 'mean_acc': 0.903}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7601, 'acc_0_0': 0.9579, 'acc_0_1': 0.9202, 'acc_1_0': 0.7601, 'acc_1_1': 0.7913, 'mean_acc': 0.9028}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7601, 'acc_0_0': 0.9579, 'acc_0_1': 0.9211, 'acc_1_0': 0.7601, 'acc_1_1': 0.7897, 'mean_acc': 0.903}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9187, 'worst_acc': 0.7555, 'acc_0_0': 0.9605, 'acc_0_1': 0.9242, 'acc_1_0': 0.7555, 'acc_1_1': 0.7882, 'mean_acc': 0.9046}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7601, 'acc_0_0': 0.9579, 'acc_0_1': 0.9206, 'acc_1_0': 0.7601, 'acc_1_1': 0.7913, 'mean_acc': 0.903}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7601, 'acc_0_0': 0.9574, 'acc_0_1': 0.9215, 'acc_1_0': 0.7601, 'acc_1_1': 0.7897, 'mean_acc': 0.903}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7632, 'acc_0_0': 0.9561, 'acc_0_1': 0.9215, 'acc_1_0': 0.7632, 'acc_1_1': 0.7897, 'mean_acc': 0.9028}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.7726, 'acc_0_0': 0.953, 'acc_0_1': 0.9202, 'acc_1_0': 0.7726, 'acc_1_1': 0.7913, 'mean_acc': 0.9023}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7695, 'acc_0_0': 0.9539, 'acc_0_1': 0.9206, 'acc_1_0': 0.7695, 'acc_1_1': 0.7913, 'mean_acc': 0.9025}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.771, 'acc_0_0': 0.9557, 'acc_0_1': 0.9202, 'acc_1_0': 0.771, 'acc_1_1': 0.7944, 'mean_acc': 0.9035}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7726, 'acc_0_0': 0.9557, 'acc_0_1': 0.9202, 'acc_1_0': 0.7726, 'acc_1_1': 0.7944, 'mean_acc': 0.9037}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9313, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7788, 'acc_0_0': 0.9508, 'acc_0_1': 0.918, 'acc_1_0': 0.7788, 'acc_1_1': 0.7975, 'mean_acc': 0.902}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9082, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7773, 'acc_0_0': 0.9508, 'acc_0_1': 0.9184, 'acc_1_0': 0.7773, 'acc_1_1': 0.7975, 'mean_acc': 0.902}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9159, 'worst_acc': 0.7679, 'acc_0_0': 0.9561, 'acc_0_1': 0.9211, 'acc_1_0': 0.7679, 'acc_1_1': 0.7897, 'mean_acc': 0.9032}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7648, 'acc_0_0': 0.9561, 'acc_0_1': 0.9197, 'acc_1_0': 0.7648, 'acc_1_1': 0.7928, 'mean_acc': 0.9027}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9113, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7632, 'acc_0_0': 0.9565, 'acc_0_1': 0.9197, 'acc_1_0': 0.7632, 'acc_1_1': 0.7913, 'mean_acc': 0.9025}
========================================================================
> end of training. 

best epoch : 45
best training accuracy on [class]: {'worst_acc': 0.6716, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.8636, 'acc_1_1': 0.6716, 'mean_acc': 0.9232}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8678, 'worst_acc': 0.8636, 'acc_0_0': 0.8675, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8636, 'mean_acc': 0.8783}
best test accuracy on [class]: {'weighted_mean_acc': 0.8598, 'worst_acc': 0.8271, 'acc_0_0': 0.867, 'acc_0_1': 0.8971, 'acc_1_0': 0.9097, 'acc_1_1': 0.8271, 'mean_acc': 0.879}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8598, 'worst_acc': 0.8271, 'acc_0_0': 0.867, 'acc_0_1': 0.8971, 'acc_1_0': 0.9097, 'acc_1_1': 0.8271, 'mean_acc': 0.879}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9451, 'worst_acc': 0.3863, 'acc_0_0': 0.9401, 'acc_0_1': 0.9401, 'acc_1_0': 0.3863, 'acc_1_1': 0.9922, 'mean_acc': 0.8845}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 45': {'Train': {'worst_acc': 0.6716, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.8636, 'acc_1_1': 0.6716, 'mean_acc': 0.9232}, 'Val': {'weighted_mean_acc': 0.8678, 'worst_acc': 0.8636, 'acc_0_0': 0.8675, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8636, 'mean_acc': 0.8783}, 'Test': {'weighted_mean_acc': 0.8598, 'worst_acc': 0.8271, 'acc_0_0': 0.867, 'acc_0_1': 0.8971, 'acc_1_0': 0.9097, 'acc_1_1': 0.8271, 'mean_acc': 0.879}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8598, 'worst_acc': 0.8271, 'acc_0_0': 0.867, 'acc_0_1': 0.8971, 'acc_1_0': 0.9097, 'acc_1_1': 0.8271, 'mean_acc': 0.879}, 'spurious': {'weighted_mean_acc': 0.9451, 'worst_acc': 0.3863, 'acc_0_0': 0.9401, 'acc_0_1': 0.9401, 'acc_1_0': 0.3863, 'acc_1_1': 0.9922, 'mean_acc': 0.8845}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8941     0.8457   0.8967  ...   0.8676   0.8956    0.8735
2                       0.8694     0.8461   0.8710  ...   0.8832   0.8676    0.8623
3                       0.8598     0.8271   0.8670  ...   0.9097   0.8271    0.8790
test_mean               0.8744     0.8396   0.8782  ...   0.8868   0.8634    0.8716
test_std                0.0144     0.0089   0.0132  ...   0.0174   0.0281    0.0069
1                       0.9617     0.3879   0.9654  ...   0.3879   0.9907    0.8787
2                       0.8902     0.1636   0.8661  ...   0.1636   1.0000    0.8319
3                       0.9451     0.3863   0.9401  ...   0.3863   0.9922    0.8845
zs_spu_mean             0.9323     0.3126   0.9239  ...   0.3126   0.9943    0.8650
zs_spu_std              0.0306     0.1054   0.0421  ...   0.1054   0.0041    0.0235
1                          NaN     0.0746   0.7854  ...   0.8333   0.0746    0.7813
2                          NaN     0.8485   0.9099  ...   0.8485   0.8507    0.9165
3                          NaN     0.6716   0.9485  ...   0.8636   0.6716    0.9232
tr_mean                    NaN     0.5316   0.8813  ...   0.8485   0.5323    0.8737
tr_std                     NaN     0.3311   0.0696  ...   0.0124   0.3318    0.0654
1                       0.9239     0.8627   0.9231  ...   0.8806   0.9394    0.8967
2                       0.8742     0.8632   0.8632  ...   0.9104   0.9091    0.8767
3                       0.8678     0.8636   0.8675  ...   0.8955   0.8636    0.8783
val_mean                0.8886     0.8632   0.8846  ...   0.8955   0.9040    0.8839
val_std                 0.0251     0.0004   0.0273  ...   0.0122   0.0312    0.0091
1                       0.8941     0.8457   0.8967  ...   0.8676   0.8956    0.8735
2                       0.8694     0.8461   0.8710  ...   0.8832   0.8676    0.8623
3                       0.8598     0.8271   0.8670  ...   0.9097   0.8271    0.8790
zs_tg_mean              0.8744     0.8396   0.8782  ...   0.8868   0.8634    0.8716
zs_tg_std               0.0144     0.0089   0.0132  ...   0.0174   0.0281    0.0069

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_10.0_lrr10.0_bsr256_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.2857, 'acc_0_0': 0.9028, 'acc_0_1': 0.663, 'acc_1_0': 0.2857, 'acc_1_1': 0.4759, 'mean_acc': 0.7923}
Val(class): {'weighted_mean_acc': 0.9112, 'worst_acc': 0.1588, 'acc_0_0': 0.9274, 'acc_0_1': 0.1588, 'acc_1_0': 0.7015, 'acc_1_1': 1.0, 'mean_acc': 0.6117}
Test(class): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.1251, 'acc_0_0': 0.9392, 'acc_0_1': 0.1251, 'acc_1_0': 0.7259, 'acc_1_1': 0.9844, 'mean_acc': 0.6037}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.2174, 'acc_0_0': 0.9768, 'acc_0_1': 0.2174, 'acc_1_0': 0.6786, 'acc_1_1': 0.9745, 'mean_acc': 0.9437}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.3648, 'acc_0_0': 1.0, 'acc_0_1': 0.3648, 'acc_1_0': 0.4925, 'acc_1_1': 0.9697, 'mean_acc': 0.6933}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.322, 'acc_0_0': 0.9942, 'acc_0_1': 0.322, 'acc_1_0': 0.5249, 'acc_1_1': 0.9564, 'mean_acc': 0.6764}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.6359, 'acc_1_0': 0.5, 'acc_1_1': 0.878, 'mean_acc': 0.9502}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5064, 'acc_0_0': 0.9957, 'acc_0_1': 0.5064, 'acc_1_0': 0.5672, 'acc_1_1': 0.9848, 'mean_acc': 0.7567}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.4678, 'acc_0_0': 0.9933, 'acc_0_1': 0.4678, 'acc_1_0': 0.553, 'acc_1_1': 0.9361, 'mean_acc': 0.7337}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5217, 'acc_0_0': 0.9886, 'acc_0_1': 0.5217, 'acc_1_0': 0.6964, 'acc_1_1': 0.9631, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4292, 'acc_0_0': 0.9915, 'acc_0_1': 0.4292, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.7367}
Test(class): {'weighted_mean_acc': 0.9493, 'worst_acc': 0.3889, 'acc_0_0': 0.9805, 'acc_0_1': 0.3889, 'acc_1_0': 0.6791, 'acc_1_1': 0.9579, 'mean_acc': 0.7144}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5543, 'acc_0_0': 0.9848, 'acc_0_1': 0.5543, 'acc_1_0': 0.8036, 'acc_1_1': 0.964, 'mean_acc': 0.9616}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.6262, 'acc_0_0': 0.988, 'acc_0_1': 0.6421, 'acc_1_0': 0.6262, 'acc_1_1': 0.9283, 'mean_acc': 0.8067}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9946, 'acc_0_1': 0.7772, 'acc_1_0': 0.6786, 'acc_1_1': 0.9224, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9566, 'worst_acc': 0.634, 'acc_0_0': 0.9858, 'acc_0_1': 0.6528, 'acc_1_0': 0.634, 'acc_1_1': 0.9299, 'mean_acc': 0.811}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.663, 'acc_0_0': 0.992, 'acc_0_1': 0.663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9518, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9711, 'worst_acc': 0.5193, 'acc_0_0': 0.9957, 'acc_0_1': 0.5193, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7717}
Test(class): {'weighted_mean_acc': 0.9522, 'worst_acc': 0.5002, 'acc_0_0': 0.9809, 'acc_0_1': 0.5002, 'acc_1_0': 0.6854, 'acc_1_1': 0.9502, 'mean_acc': 0.7577}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6196, 'acc_0_0': 0.9914, 'acc_0_1': 0.6196, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.958, 'worst_acc': 0.6288, 'acc_0_0': 0.9885, 'acc_0_1': 0.6288, 'acc_1_0': 0.6355, 'acc_1_1': 0.9315, 'mean_acc': 0.8031}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9954, 'acc_0_1': 0.7011, 'acc_1_0': 0.7143, 'acc_1_1': 0.9499, 'mean_acc': 0.9708}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.6075, 'acc_0_0': 0.9907, 'acc_0_1': 0.6359, 'acc_1_0': 0.6075, 'acc_1_1': 0.9252, 'mean_acc': 0.8029}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.996, 'acc_0_1': 0.7065, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.7983}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5672, 'acc_0_0': 0.9889, 'acc_0_1': 0.5672, 'acc_1_0': 0.6324, 'acc_1_1': 0.9393, 'mean_acc': 0.7798}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6304, 'acc_0_0': 0.9937, 'acc_0_1': 0.6304, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9712}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6438, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6121, 'acc_0_0': 0.9911, 'acc_0_1': 0.6133, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.7957}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9974, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9555, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5373, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5794, 'acc_0_0': 0.9933, 'acc_0_1': 0.667, 'acc_1_0': 0.5794, 'acc_1_1': 0.9221, 'mean_acc': 0.8126}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9966, 'acc_0_1': 0.7283, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.9729}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6695, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6121, 'acc_0_0': 0.9925, 'acc_0_1': 0.6204, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.7991}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9949, 'acc_0_1': 0.6902, 'acc_1_0': 0.7679, 'acc_1_1': 0.9622, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6106, 'acc_0_0': 0.9925, 'acc_0_1': 0.6302, 'acc_1_0': 0.6106, 'acc_1_1': 0.933, 'mean_acc': 0.8026}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.75, 'acc_1_1': 0.9622, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6012, 'acc_0_0': 0.9929, 'acc_0_1': 0.6838, 'acc_1_0': 0.6012, 'acc_1_1': 0.9268, 'mean_acc': 0.8219}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9974, 'acc_0_1': 0.7391, 'acc_1_0': 0.7857, 'acc_1_1': 0.9565, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9596, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6457, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8076}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9963, 'acc_0_1': 0.7337, 'acc_1_0': 0.8214, 'acc_1_1': 0.9612, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6106, 'acc_0_0': 0.9907, 'acc_0_1': 0.6537, 'acc_1_0': 0.6106, 'acc_1_1': 0.9299, 'mean_acc': 0.8107}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9977, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6012, 'acc_0_0': 0.9925, 'acc_0_1': 0.6732, 'acc_1_0': 0.6012, 'acc_1_1': 0.9283, 'mean_acc': 0.8177}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9974, 'acc_0_1': 0.7554, 'acc_1_0': 0.7679, 'acc_1_1': 0.9612, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.6625, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8148}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.9966, 'acc_0_1': 0.7446, 'acc_1_0': 0.8393, 'acc_1_1': 0.9697, 'mean_acc': 0.9791}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6293, 'acc_0_0': 0.9907, 'acc_0_1': 0.655, 'acc_1_0': 0.6293, 'acc_1_1': 0.9346, 'mean_acc': 0.8138}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9969, 'acc_0_1': 0.7663, 'acc_1_0': 0.8036, 'acc_1_1': 0.9612, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9925, 'acc_0_1': 0.6838, 'acc_1_0': 0.6137, 'acc_1_1': 0.9299, 'mean_acc': 0.8234}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.7857, 'acc_1_1': 0.9631, 'mean_acc': 0.9794}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6812, 'acc_1_0': 0.6184, 'acc_1_1': 0.9315, 'mean_acc': 0.8222}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7717, 'acc_0_0': 0.998, 'acc_0_1': 0.7717, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6137, 'acc_0_0': 0.9902, 'acc_0_1': 0.6874, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9983, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.6184, 'acc_0_0': 0.9902, 'acc_0_1': 0.6749, 'acc_1_0': 0.6184, 'acc_1_1': 0.933, 'mean_acc': 0.82}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9986, 'acc_0_1': 0.7935, 'acc_1_0': 0.8571, 'acc_1_1': 0.9697, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6812, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8219}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9994, 'acc_0_1': 0.788, 'acc_1_0': 0.8571, 'acc_1_1': 0.9716, 'mean_acc': 0.9835}
Val(class): {'weighted_mean_acc': 0.9677, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.609, 'acc_0_0': 0.9907, 'acc_0_1': 0.6887, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8245}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8571, 'acc_1_1': 0.9678, 'mean_acc': 0.9837}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5997, 'acc_0_0': 0.9916, 'acc_0_1': 0.7166, 'acc_1_0': 0.5997, 'acc_1_1': 0.9299, 'mean_acc': 0.8343}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9986, 'acc_0_1': 0.8152, 'acc_1_0': 0.8929, 'acc_1_1': 0.9745, 'mean_acc': 0.985}
Val(class): {'weighted_mean_acc': 0.9663, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.6106, 'acc_0_0': 0.9902, 'acc_0_1': 0.6634, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8152}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9763, 'mean_acc': 0.9858}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.7511, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5903, 'acc_0_0': 0.9925, 'acc_0_1': 0.722, 'acc_1_0': 0.5903, 'acc_1_1': 0.9283, 'mean_acc': 0.8355}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 1.0, 'acc_0_1': 0.8859, 'acc_1_0': 0.8393, 'acc_1_1': 0.9688, 'mean_acc': 0.9869}
Val(class): {'weighted_mean_acc': 0.9714, 'worst_acc': 0.5373, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5373, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.5919, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.5919, 'acc_1_1': 0.9315, 'mean_acc': 0.8264}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7989, 'acc_0_0': 0.9983, 'acc_0_1': 0.7989, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9675, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9889, 'acc_0_1': 0.6732, 'acc_1_0': 0.6153, 'acc_1_1': 0.9377, 'mean_acc': 0.819}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9991, 'acc_0_1': 0.837, 'acc_1_0': 0.9107, 'acc_1_1': 0.9839, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.6847, 'acc_1_0': 0.6308, 'acc_1_1': 0.9361, 'mean_acc': 0.8248}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9735, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9894, 'acc_0_1': 0.7002, 'acc_1_0': 0.6153, 'acc_1_1': 0.9346, 'mean_acc': 0.8293}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 1.0, 'acc_0_1': 0.8913, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.6882, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8243}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 1.0, 'acc_0_1': 0.8696, 'acc_1_0': 0.9107, 'acc_1_1': 0.983, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6269, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.6308, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6308, 'acc_1_1': 0.9377, 'mean_acc': 0.8165}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9286, 'acc_1_1': 0.9858, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6931, 'acc_1_0': 0.6168, 'acc_1_1': 0.9346, 'mean_acc': 0.8269}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9239, 'acc_0_0': 1.0, 'acc_0_1': 0.9239, 'acc_1_0': 0.9643, 'acc_1_1': 0.9886, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.5821, 'acc_0_0': 0.9829, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9907, 'acc_0_1': 0.7029, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8298}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9185, 'acc_0_0': 1.0, 'acc_0_1': 0.9185, 'acc_1_0': 0.9643, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.6741, 'acc_1_0': 0.6168, 'acc_1_1': 0.9377, 'mean_acc': 0.8198}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.913, 'acc_0_0': 1.0, 'acc_0_1': 0.913, 'acc_1_0': 0.9643, 'acc_1_1': 0.9868, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.609, 'acc_0_0': 0.9911, 'acc_0_1': 0.7033, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8305}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9896, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.7382, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9642, 'worst_acc': 0.6059, 'acc_0_0': 0.9916, 'acc_0_1': 0.722, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8376}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5, 'acc_0_0': 0.9957, 'acc_0_1': 0.7382, 'acc_1_0': 0.5, 'acc_1_1': 0.9104, 'mean_acc': 0.8314}
Val(class)(new adapter): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.5672, 'acc_0_0': 0.9829, 'acc_0_1': 0.7897, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class)(new adapter): {'weighted_mean_acc': 0.9659, 'worst_acc': 0.5981, 'acc_0_0': 0.9929, 'acc_0_1': 0.7543, 'acc_1_0': 0.5981, 'acc_1_1': 0.933, 'mean_acc': 0.8497}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.073, 'acc_0_0': 0.9957, 'acc_0_1': 0.073, 'acc_1_0': 0.1364, 'acc_1_1': 0.5821, 'mean_acc': 0.4958}
Val(class)(new adapter): {'weighted_mean_acc': 0.9548, 'worst_acc': 0.6716, 'acc_0_0': 0.9701, 'acc_0_1': 0.7511, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6542, 'acc_0_0': 0.9831, 'acc_0_1': 0.7308, 'acc_1_0': 0.6542, 'acc_1_1': 0.9408, 'mean_acc': 0.8438}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9785, 'acc_0_1': 0.8927, 'acc_1_0': 0.6667, 'acc_1_1': 0.9552, 'mean_acc': 0.9082}
Val(class)(new adapter): {'weighted_mean_acc': 0.9445, 'worst_acc': 0.7639, 'acc_0_0': 0.953, 'acc_0_1': 0.7639, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.9415, 'worst_acc': 0.753, 'acc_0_0': 0.9548, 'acc_0_1': 0.753, 'acc_1_0': 0.7788, 'acc_1_1': 0.9393, 'mean_acc': 0.855}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.4893, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.3134, 'mean_acc': 0.6127}
Val(class)(new adapter): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.7164, 'acc_0_0': 0.9615, 'acc_0_1': 0.7725, 'acc_1_0': 0.7164, 'acc_1_1': 0.9242, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9534, 'worst_acc': 0.7555, 'acc_0_0': 0.9747, 'acc_0_1': 0.7619, 'acc_1_0': 0.7555, 'acc_1_1': 0.9268, 'mean_acc': 0.8623}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9785, 'acc_0_1': 0.8455, 'acc_1_0': 0.7727, 'acc_1_1': 0.9552, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.9061, 'worst_acc': 0.4179, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.4179, 'acc_1_1': 0.6212, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8849, 'worst_acc': 0.4891, 'acc_0_0': 0.9956, 'acc_0_1': 0.9876, 'acc_1_0': 0.4891, 'acc_1_1': 0.5218, 'mean_acc': 0.8838}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0597, 'acc_0_0': 0.9871, 'acc_0_1': 0.8841, 'acc_1_0': 0.6515, 'acc_1_1': 0.0597, 'mean_acc': 0.8063}
Val(class)(new adapter): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.9614, 'acc_1_0': 0.6418, 'acc_1_1': 0.8333, 'mean_acc': 0.9217}
Test(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.6791, 'acc_0_0': 0.9858, 'acc_0_1': 0.9579, 'acc_1_0': 0.6791, 'acc_1_1': 0.7835, 'mean_acc': 0.9185}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9914, 'acc_0_1': 0.9871, 'acc_1_0': 0.7576, 'acc_1_1': 0.9552, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9351, 'worst_acc': 0.791, 'acc_0_0': 0.9444, 'acc_0_1': 0.8627, 'acc_1_0': 0.791, 'acc_1_1': 0.9242, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.934, 'worst_acc': 0.8115, 'acc_0_0': 0.9468, 'acc_0_1': 0.8687, 'acc_1_0': 0.8115, 'acc_1_1': 0.9097, 'mean_acc': 0.8973}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9099, 'acc_0_1': 0.9185, 'acc_1_0': 0.9091, 'acc_1_1': 0.6866, 'mean_acc': 0.8881}
Val(class)(new adapter): {'weighted_mean_acc': 0.9087, 'worst_acc': 0.7897, 'acc_0_0': 0.8974, 'acc_0_1': 0.7897, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.8929, 'worst_acc': 0.8093, 'acc_0_0': 0.8865, 'acc_0_1': 0.8093, 'acc_1_0': 0.8738, 'acc_1_1': 0.9299, 'mean_acc': 0.8599}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9185, 'acc_0_0': 0.9185, 'acc_0_1': 0.9399, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9332}
Val(class)(new adapter): {'weighted_mean_acc': 0.8796, 'worst_acc': 0.8358, 'acc_0_0': 0.8675, 'acc_0_1': 0.867, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.8677, 'worst_acc': 0.8612, 'acc_0_0': 0.8612, 'acc_0_1': 0.8687, 'acc_1_0': 0.8879, 'acc_1_1': 0.8879, 'mean_acc': 0.87}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8627, 'acc_0_0': 0.8627, 'acc_0_1': 0.9571, 'acc_1_0': 0.9394, 'acc_1_1': 0.9104, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.791, 'acc_0_0': 0.9145, 'acc_0_1': 0.9313, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8911, 'worst_acc': 0.8115, 'acc_0_0': 0.9135, 'acc_0_1': 0.9357, 'acc_1_0': 0.8458, 'acc_1_1': 0.8115, 'mean_acc': 0.9033}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.97, 'acc_0_1': 0.9914, 'acc_1_0': 0.8636, 'acc_1_1': 0.8657, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9302, 'worst_acc': 0.7612, 'acc_0_0': 0.9573, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9157, 'worst_acc': 0.7991, 'acc_0_0': 0.9512, 'acc_0_1': 0.9437, 'acc_1_0': 0.8037, 'acc_1_1': 0.7991, 'mean_acc': 0.9151}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9571, 'acc_0_1': 0.9828, 'acc_1_0': 0.803, 'acc_1_1': 0.8806, 'mean_acc': 0.9416}
Val(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.7612, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9296, 'worst_acc': 0.7975, 'acc_0_0': 0.9557, 'acc_0_1': 0.9197, 'acc_1_0': 0.7975, 'acc_1_1': 0.852, 'mean_acc': 0.9127}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.9403, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9325, 'worst_acc': 0.7612, 'acc_0_0': 0.9487, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9319, 'worst_acc': 0.8022, 'acc_0_0': 0.9543, 'acc_0_1': 0.8971, 'acc_1_0': 0.8022, 'acc_1_1': 0.8707, 'mean_acc': 0.9059}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9657, 'acc_0_1': 0.9785, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.8884, 'acc_1_0': 0.7313, 'acc_1_1': 0.8939, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7913, 'acc_0_0': 0.9561, 'acc_0_1': 0.8931, 'acc_1_0': 0.7913, 'acc_1_1': 0.8692, 'mean_acc': 0.9037}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9206, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7788, 'acc_0_0': 0.9543, 'acc_0_1': 0.9078, 'acc_1_0': 0.7788, 'acc_1_1': 0.8598, 'mean_acc': 0.9063}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9785, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9552, 'mean_acc': 0.9716}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9225, 'worst_acc': 0.7788, 'acc_0_0': 0.953, 'acc_0_1': 0.9246, 'acc_1_0': 0.7788, 'acc_1_1': 0.8287, 'mean_acc': 0.9089}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7601, 'acc_0_0': 0.9534, 'acc_0_1': 0.9353, 'acc_1_0': 0.7601, 'acc_1_1': 0.8037, 'mean_acc': 0.9084}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7601, 'acc_0_0': 0.9548, 'acc_0_1': 0.9357, 'acc_1_0': 0.7601, 'acc_1_1': 0.8037, 'mean_acc': 0.909}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9193, 'worst_acc': 0.7555, 'acc_0_0': 0.9539, 'acc_0_1': 0.9313, 'acc_1_0': 0.7555, 'acc_1_1': 0.8115, 'mean_acc': 0.9073}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9394, 'acc_1_1': 0.9552, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9056, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7617, 'acc_0_0': 0.9512, 'acc_0_1': 0.9175, 'acc_1_0': 0.7617, 'acc_1_1': 0.824, 'mean_acc': 0.903}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7664, 'acc_0_0': 0.9494, 'acc_0_1': 0.9109, 'acc_1_0': 0.7664, 'acc_1_1': 0.8318, 'mean_acc': 0.9011}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7695, 'acc_0_0': 0.945, 'acc_0_1': 0.902, 'acc_1_0': 0.7695, 'acc_1_1': 0.8489, 'mean_acc': 0.8982}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9128, 'worst_acc': 0.7313, 'acc_0_0': 0.9316, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7804, 'acc_0_0': 0.9419, 'acc_0_1': 0.898, 'acc_1_0': 0.7804, 'acc_1_1': 0.852, 'mean_acc': 0.897}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9066, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7819, 'acc_0_0': 0.9397, 'acc_0_1': 0.8962, 'acc_1_0': 0.7819, 'acc_1_1': 0.852, 'mean_acc': 0.8956}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9107, 'worst_acc': 0.785, 'acc_0_0': 0.9353, 'acc_0_1': 0.9007, 'acc_1_0': 0.785, 'acc_1_1': 0.838, 'mean_acc': 0.8944}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8913, 'worst_acc': 0.7463, 'acc_0_0': 0.9017, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8006, 'acc_0_0': 0.9171, 'acc_0_1': 0.9024, 'acc_1_0': 0.8006, 'acc_1_1': 0.8287, 'mean_acc': 0.8887}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8885, 'worst_acc': 0.7463, 'acc_0_0': 0.9017, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8884, 'worst_acc': 0.8084, 'acc_0_0': 0.9118, 'acc_0_1': 0.9188, 'acc_1_0': 0.8084, 'acc_1_1': 0.81, 'mean_acc': 0.8918}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.901, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.7897, 'acc_0_0': 0.9273, 'acc_0_1': 0.9317, 'acc_1_0': 0.7928, 'acc_1_1': 0.7897, 'mean_acc': 0.8989}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8991, 'worst_acc': 0.7477, 'acc_0_0': 0.9446, 'acc_0_1': 0.9481, 'acc_1_0': 0.757, 'acc_1_1': 0.7477, 'mean_acc': 0.9033}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7259, 'acc_0_0': 0.9561, 'acc_0_1': 0.9521, 'acc_1_0': 0.7399, 'acc_1_1': 0.7259, 'mean_acc': 0.9051}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7313, 'acc_0_0': 0.9573, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9057, 'worst_acc': 0.7243, 'acc_0_0': 0.9605, 'acc_0_1': 0.9548, 'acc_1_0': 0.743, 'acc_1_1': 0.7243, 'mean_acc': 0.908}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7539, 'acc_0_0': 0.9565, 'acc_0_1': 0.9486, 'acc_1_0': 0.7539, 'acc_1_1': 0.7601, 'mean_acc': 0.9092}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.7679, 'acc_0_0': 0.9534, 'acc_0_1': 0.9392, 'acc_1_0': 0.7679, 'acc_1_1': 0.7819, 'mean_acc': 0.9084}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9115, 'worst_acc': 0.7773, 'acc_0_0': 0.9486, 'acc_0_1': 0.9295, 'acc_1_0': 0.7773, 'acc_1_1': 0.7928, 'mean_acc': 0.9049}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9117, 'worst_acc': 0.7882, 'acc_0_0': 0.945, 'acc_0_1': 0.9193, 'acc_1_0': 0.7882, 'acc_1_1': 0.8069, 'mean_acc': 0.9023}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9154, 'worst_acc': 0.7788, 'acc_0_0': 0.9512, 'acc_0_1': 0.9264, 'acc_1_0': 0.7788, 'acc_1_1': 0.8022, 'mean_acc': 0.9059}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7788, 'acc_0_0': 0.953, 'acc_0_1': 0.9246, 'acc_1_0': 0.7788, 'acc_1_1': 0.8022, 'mean_acc': 0.9059}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.7819, 'acc_0_0': 0.9517, 'acc_0_1': 0.9224, 'acc_1_0': 0.7819, 'acc_1_1': 0.8022, 'mean_acc': 0.9049}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.915, 'worst_acc': 0.7773, 'acc_0_0': 0.9512, 'acc_0_1': 0.9255, 'acc_1_0': 0.7773, 'acc_1_1': 0.8006, 'mean_acc': 0.9052}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.7773, 'acc_0_0': 0.953, 'acc_0_1': 0.9308, 'acc_1_0': 0.7773, 'acc_1_1': 0.7975, 'mean_acc': 0.9077}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7741, 'acc_0_0': 0.9539, 'acc_0_1': 0.9308, 'acc_1_0': 0.7741, 'acc_1_1': 0.796, 'mean_acc': 0.9075}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9183, 'worst_acc': 0.771, 'acc_0_0': 0.9579, 'acc_0_1': 0.9326, 'acc_1_0': 0.771, 'acc_1_1': 0.7928, 'mean_acc': 0.909}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9203, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7726, 'acc_0_0': 0.9579, 'acc_0_1': 0.9313, 'acc_1_0': 0.7726, 'acc_1_1': 0.796, 'mean_acc': 0.909}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.919, 'worst_acc': 0.7757, 'acc_0_0': 0.9574, 'acc_0_1': 0.9308, 'acc_1_0': 0.7757, 'acc_1_1': 0.7975, 'mean_acc': 0.9092}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9172, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9184, 'worst_acc': 0.7695, 'acc_0_0': 0.9579, 'acc_0_1': 0.9335, 'acc_1_0': 0.7695, 'acc_1_1': 0.7928, 'mean_acc': 0.9092}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7804, 'acc_0_0': 0.9539, 'acc_0_1': 0.9295, 'acc_1_0': 0.7804, 'acc_1_1': 0.7975, 'mean_acc': 0.9078}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9155, 'worst_acc': 0.7804, 'acc_0_0': 0.9534, 'acc_0_1': 0.9317, 'acc_1_0': 0.7804, 'acc_1_1': 0.7944, 'mean_acc': 0.9082}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7773, 'acc_0_0': 0.9561, 'acc_0_1': 0.933, 'acc_1_0': 0.7773, 'acc_1_1': 0.7913, 'mean_acc': 0.909}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7819, 'acc_0_0': 0.9543, 'acc_0_1': 0.929, 'acc_1_0': 0.7819, 'acc_1_1': 0.796, 'mean_acc': 0.9078}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7819, 'acc_0_0': 0.9557, 'acc_0_1': 0.9326, 'acc_1_0': 0.7819, 'acc_1_1': 0.7928, 'mean_acc': 0.9094}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9141, 'worst_acc': 0.7819, 'acc_0_0': 0.9517, 'acc_0_1': 0.9282, 'acc_1_0': 0.7819, 'acc_1_1': 0.7944, 'mean_acc': 0.9063}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7835, 'acc_0_0': 0.9508, 'acc_0_1': 0.9259, 'acc_1_0': 0.7835, 'acc_1_1': 0.7991, 'mean_acc': 0.9058}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9148, 'worst_acc': 0.7804, 'acc_0_0': 0.9539, 'acc_0_1': 0.9326, 'acc_1_0': 0.7804, 'acc_1_1': 0.7897, 'mean_acc': 0.9082}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7835, 'acc_0_0': 0.9517, 'acc_0_1': 0.9313, 'acc_1_0': 0.7835, 'acc_1_1': 0.7944, 'mean_acc': 0.9077}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9356, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7773, 'acc_0_0': 0.9561, 'acc_0_1': 0.9344, 'acc_1_0': 0.7773, 'acc_1_1': 0.7882, 'mean_acc': 0.9092}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7741, 'acc_0_0': 0.957, 'acc_0_1': 0.9322, 'acc_1_0': 0.7741, 'acc_1_1': 0.7913, 'mean_acc': 0.9087}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.917, 'worst_acc': 0.7773, 'acc_0_0': 0.9565, 'acc_0_1': 0.9295, 'acc_1_0': 0.7773, 'acc_1_1': 0.7913, 'mean_acc': 0.9078}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7773, 'acc_0_0': 0.9561, 'acc_0_1': 0.9264, 'acc_1_0': 0.7773, 'acc_1_1': 0.7928, 'mean_acc': 0.9066}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9174, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.7757, 'acc_0_0': 0.9574, 'acc_0_1': 0.9273, 'acc_1_0': 0.7757, 'acc_1_1': 0.7944, 'mean_acc': 0.9075}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9175, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.9313, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9186, 'worst_acc': 0.7741, 'acc_0_0': 0.9588, 'acc_0_1': 0.9299, 'acc_1_0': 0.7741, 'acc_1_1': 0.7913, 'mean_acc': 0.9085}
========================================================================
> end of training. 

best epoch : 49
best training accuracy on [class]: {'worst_acc': 0.9185, 'acc_0_0': 0.9185, 'acc_0_1': 0.9399, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9332}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8796, 'worst_acc': 0.8358, 'acc_0_0': 0.8675, 'acc_0_1': 0.867, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.87}
best test accuracy on [class]: {'weighted_mean_acc': 0.8677, 'worst_acc': 0.8612, 'acc_0_0': 0.8612, 'acc_0_1': 0.8687, 'acc_1_0': 0.8879, 'acc_1_1': 0.8879, 'mean_acc': 0.87}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8677, 'worst_acc': 0.8612, 'acc_0_0': 0.8612, 'acc_0_1': 0.8687, 'acc_1_0': 0.8879, 'acc_1_1': 0.8879, 'mean_acc': 0.87}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6449, 'acc_0_0': 0.9592, 'acc_0_1': 0.9175, 'acc_1_0': 0.6449, 'acc_1_1': 0.986, 'mean_acc': 0.9111}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 49': {'Train': {'worst_acc': 0.9185, 'acc_0_0': 0.9185, 'acc_0_1': 0.9399, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9332}, 'Val': {'weighted_mean_acc': 0.8796, 'worst_acc': 0.8358, 'acc_0_0': 0.8675, 'acc_0_1': 0.867, 'acc_1_0': 0.8358, 'acc_1_1': 0.9242, 'mean_acc': 0.87}, 'Test': {'weighted_mean_acc': 0.8677, 'worst_acc': 0.8612, 'acc_0_0': 0.8612, 'acc_0_1': 0.8687, 'acc_1_0': 0.8879, 'acc_1_1': 0.8879, 'mean_acc': 0.87}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8677, 'worst_acc': 0.8612, 'acc_0_0': 0.8612, 'acc_0_1': 0.8687, 'acc_1_0': 0.8879, 'acc_1_1': 0.8879, 'mean_acc': 0.87}, 'spurious': {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6449, 'acc_0_0': 0.9592, 'acc_0_1': 0.9175, 'acc_1_0': 0.6449, 'acc_1_1': 0.986, 'mean_acc': 0.9111}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.25, 'acc_0_0': 0.8957, 'acc_0_1': 0.7717, 'acc_1_0': 0.25, 'acc_1_1': 0.2819, 'mean_acc': 0.7481}
Val(class): {'weighted_mean_acc': 0.9528, 'worst_acc': 0.3047, 'acc_0_0': 0.9829, 'acc_0_1': 0.3047, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6767}
Test(class): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.2381, 'acc_0_0': 0.9676, 'acc_0_1': 0.2381, 'acc_1_0': 0.6168, 'acc_1_1': 0.9735, 'mean_acc': 0.6455}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.1902, 'acc_0_0': 0.9565, 'acc_0_1': 0.1902, 'acc_1_0': 0.6964, 'acc_1_1': 0.9858, 'mean_acc': 0.9306}
Val(class): {'weighted_mean_acc': 0.954, 'worst_acc': 0.2403, 'acc_0_0': 0.9872, 'acc_0_1': 0.2403, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6583}
Test(class): {'weighted_mean_acc': 0.9442, 'worst_acc': 0.2124, 'acc_0_0': 0.9792, 'acc_0_1': 0.2124, 'acc_1_0': 0.6433, 'acc_1_1': 0.972, 'mean_acc': 0.6427}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.996, 'acc_0_1': 0.587, 'acc_1_0': 0.4464, 'acc_1_1': 0.9007, 'mean_acc': 0.9529}
Val(class): {'weighted_mean_acc': 0.9655, 'worst_acc': 0.2961, 'acc_0_0': 1.0, 'acc_0_1': 0.2961, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.685}
Test(class): {'weighted_mean_acc': 0.9485, 'worst_acc': 0.2736, 'acc_0_0': 0.9827, 'acc_0_1': 0.2736, 'acc_1_0': 0.6449, 'acc_1_1': 0.9688, 'mean_acc': 0.6678}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9946, 'acc_0_1': 0.625, 'acc_1_0': 0.5714, 'acc_1_1': 0.9338, 'mean_acc': 0.962}
Val(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.3262, 'acc_0_0': 0.9915, 'acc_0_1': 0.3262, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.6983}
Test(class): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.29, 'acc_0_0': 0.9778, 'acc_0_1': 0.29, 'acc_1_0': 0.6729, 'acc_1_1': 0.9704, 'mean_acc': 0.6755}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.4348, 'acc_0_0': 0.9903, 'acc_0_1': 0.4348, 'acc_1_0': 0.6786, 'acc_1_1': 0.9763, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.4163, 'acc_0_0': 0.9915, 'acc_0_1': 0.4163, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7333}
Test(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.3579, 'acc_0_0': 0.9792, 'acc_0_1': 0.3579, 'acc_1_0': 0.6822, 'acc_1_1': 0.9657, 'mean_acc': 0.703}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5761, 'acc_0_0': 0.99, 'acc_0_1': 0.5761, 'acc_1_0': 0.7143, 'acc_1_1': 0.9707, 'mean_acc': 0.9666}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.618, 'acc_0_0': 0.9872, 'acc_0_1': 0.618, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5685, 'acc_0_0': 0.9849, 'acc_0_1': 0.5685, 'acc_1_0': 0.6526, 'acc_1_1': 0.9424, 'mean_acc': 0.7813}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9931, 'acc_0_1': 0.7554, 'acc_1_0': 0.6429, 'acc_1_1': 0.9376, 'mean_acc': 0.9677}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6402, 'acc_0_0': 0.9867, 'acc_0_1': 0.6838, 'acc_1_0': 0.6402, 'acc_1_1': 0.9159, 'mean_acc': 0.8226}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9929, 'acc_0_1': 0.7337, 'acc_1_0': 0.6964, 'acc_1_1': 0.947, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.8067}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5716, 'acc_0_0': 0.9854, 'acc_0_1': 0.5716, 'acc_1_0': 0.6495, 'acc_1_1': 0.9424, 'mean_acc': 0.7824}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6467, 'acc_0_0': 0.9909, 'acc_0_1': 0.6467, 'acc_1_0': 0.75, 'acc_1_1': 0.9697, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9672, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.9567, 'worst_acc': 0.5446, 'acc_0_0': 0.9863, 'acc_0_1': 0.5446, 'acc_1_0': 0.6464, 'acc_1_1': 0.947, 'mean_acc': 0.7724}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9929, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9706}
Val(class): {'weighted_mean_acc': 0.9687, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6133, 'acc_0_0': 0.9885, 'acc_0_1': 0.6133, 'acc_1_0': 0.6137, 'acc_1_1': 0.933, 'mean_acc': 0.7948}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9957, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9574, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6652, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6059, 'acc_0_0': 0.9894, 'acc_0_1': 0.651, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8088}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9954, 'acc_0_1': 0.7065, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9733}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.6093, 'acc_0_0': 0.9889, 'acc_0_1': 0.6093, 'acc_1_0': 0.634, 'acc_1_1': 0.9424, 'mean_acc': 0.7967}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6352, 'acc_0_0': 0.9957, 'acc_0_1': 0.6352, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.608, 'acc_0_0': 0.9889, 'acc_0_1': 0.608, 'acc_1_0': 0.6417, 'acc_1_1': 0.9424, 'mean_acc': 0.797}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9943, 'acc_0_1': 0.7065, 'acc_1_0': 0.8214, 'acc_1_1': 0.9688, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.6475, 'acc_1_0': 0.6231, 'acc_1_1': 0.9346, 'mean_acc': 0.8098}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9949, 'acc_0_1': 0.7283, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6567, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6168, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.6168, 'acc_1_1': 0.9393, 'mean_acc': 0.8098}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.994, 'acc_0_1': 0.7011, 'acc_1_0': 0.8214, 'acc_1_1': 0.9669, 'mean_acc': 0.9748}
Val(class): {'weighted_mean_acc': 0.9722, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.815}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6153, 'acc_0_0': 0.9898, 'acc_0_1': 0.6284, 'acc_1_0': 0.6153, 'acc_1_1': 0.9424, 'mean_acc': 0.8024}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.712, 'acc_0_0': 0.9946, 'acc_0_1': 0.712, 'acc_1_0': 0.7857, 'acc_1_1': 0.964, 'mean_acc': 0.9746}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5981, 'acc_0_0': 0.9902, 'acc_0_1': 0.6475, 'acc_1_0': 0.5981, 'acc_1_1': 0.9393, 'mean_acc': 0.8077}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9971, 'acc_0_1': 0.7609, 'acc_1_0': 0.75, 'acc_1_1': 0.9593, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9738, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5779, 'acc_0_0': 0.9929, 'acc_0_1': 0.6918, 'acc_1_0': 0.5779, 'acc_1_1': 0.933, 'mean_acc': 0.8231}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7391, 'acc_0_0': 0.9966, 'acc_0_1': 0.7391, 'acc_1_0': 0.8393, 'acc_1_1': 0.9659, 'mean_acc': 0.9781}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6309, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6213, 'acc_0_0': 0.9894, 'acc_0_1': 0.6213, 'acc_1_0': 0.6215, 'acc_1_1': 0.9439, 'mean_acc': 0.8003}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.7228, 'acc_0_0': 0.9931, 'acc_0_1': 0.7228, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9727, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6609, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9622, 'worst_acc': 0.6199, 'acc_0_0': 0.9898, 'acc_0_1': 0.6461, 'acc_1_0': 0.6199, 'acc_1_1': 0.9439, 'mean_acc': 0.81}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9974, 'acc_0_1': 0.7772, 'acc_1_0': 0.8036, 'acc_1_1': 0.9669, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6798, 'acc_1_0': 0.5966, 'acc_1_1': 0.9377, 'mean_acc': 0.8207}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.998, 'acc_0_1': 0.788, 'acc_1_0': 0.8214, 'acc_1_1': 0.9622, 'mean_acc': 0.98}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6269, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5966, 'acc_0_0': 0.992, 'acc_0_1': 0.6714, 'acc_1_0': 0.5966, 'acc_1_1': 0.9408, 'mean_acc': 0.8177}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6481, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.6315, 'acc_0_0': 0.9889, 'acc_0_1': 0.6315, 'acc_1_0': 0.6324, 'acc_1_1': 0.9439, 'mean_acc': 0.8053}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9971, 'acc_0_1': 0.7772, 'acc_1_0': 0.8214, 'acc_1_1': 0.9763, 'mean_acc': 0.9821}
Val(class): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.6763, 'acc_1_0': 0.6121, 'acc_1_1': 0.9393, 'mean_acc': 0.8207}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9986, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9716, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9671, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.6121, 'acc_0_0': 0.9916, 'acc_0_1': 0.6692, 'acc_1_0': 0.6121, 'acc_1_1': 0.9408, 'mean_acc': 0.8184}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.9977, 'acc_0_1': 0.788, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9666, 'worst_acc': 0.6119, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6603, 'acc_1_0': 0.6137, 'acc_1_1': 0.9424, 'mean_acc': 0.8152}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9977, 'acc_0_1': 0.8098, 'acc_1_0': 0.8929, 'acc_1_1': 0.9792, 'mean_acc': 0.9852}
Val(class): {'weighted_mean_acc': 0.9673, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6246, 'acc_0_0': 0.9907, 'acc_0_1': 0.663, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8171}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8315, 'acc_0_0': 0.9994, 'acc_0_1': 0.8315, 'acc_1_0': 0.875, 'acc_1_1': 0.9745, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6231, 'acc_0_0': 0.9911, 'acc_0_1': 0.678, 'acc_1_0': 0.6231, 'acc_1_1': 0.9361, 'mean_acc': 0.8224}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8424, 'acc_0_0': 0.9994, 'acc_0_1': 0.8424, 'acc_1_0': 0.9107, 'acc_1_1': 0.982, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6567, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6231, 'acc_0_0': 0.9898, 'acc_0_1': 0.671, 'acc_1_0': 0.6231, 'acc_1_1': 0.9393, 'mean_acc': 0.8195}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.9107, 'acc_1_1': 0.9849, 'mean_acc': 0.9885}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6277, 'acc_0_0': 0.9885, 'acc_0_1': 0.663, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8164}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9994, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9801, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.691, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.6355, 'acc_0_0': 0.988, 'acc_0_1': 0.6661, 'acc_1_0': 0.6355, 'acc_1_1': 0.9393, 'mean_acc': 0.8183}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9849, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9627, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.686, 'acc_1_0': 0.6215, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9997, 'acc_0_1': 0.8641, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.6716, 'acc_0_0': 0.9957, 'acc_0_1': 0.6953, 'acc_1_0': 0.6716, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6794, 'acc_1_0': 0.6293, 'acc_1_1': 0.9393, 'mean_acc': 0.8231}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9464, 'acc_1_1': 0.9839, 'mean_acc': 0.9921}
Val(class): {'weighted_mean_acc': 0.9625, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6891, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8252}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 1.0, 'acc_0_1': 0.9076, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.9927}
Val(class): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7073, 'acc_1_0': 0.5981, 'acc_1_1': 0.9377, 'mean_acc': 0.831}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 1.0, 'acc_0_1': 0.9022, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.994}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9242, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6137, 'acc_0_0': 0.988, 'acc_0_1': 0.694, 'acc_1_0': 0.6137, 'acc_1_1': 0.9393, 'mean_acc': 0.8267}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9643, 'acc_1_1': 0.9905, 'mean_acc': 0.9952}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.6153, 'acc_0_0': 0.9885, 'acc_0_1': 0.6803, 'acc_1_0': 0.6153, 'acc_1_1': 0.9393, 'mean_acc': 0.8217}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9348, 'acc_0_0': 1.0, 'acc_0_1': 0.9348, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6996, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6277, 'acc_0_0': 0.9871, 'acc_0_1': 0.6661, 'acc_1_0': 0.6277, 'acc_1_1': 0.9393, 'mean_acc': 0.8171}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9924, 'mean_acc': 0.996}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.5981, 'acc_0_0': 0.9907, 'acc_0_1': 0.7153, 'acc_1_0': 0.5981, 'acc_1_1': 0.9361, 'mean_acc': 0.834}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9511, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9683, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6028, 'acc_0_0': 0.9894, 'acc_0_1': 0.7091, 'acc_1_0': 0.6028, 'acc_1_1': 0.9346, 'mean_acc': 0.8314}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4091, 'acc_0_0': 0.9957, 'acc_0_1': 0.7124, 'acc_1_0': 0.4091, 'acc_1_1': 0.9254, 'mean_acc': 0.813}
Val(class)(new adapter): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.4627, 'acc_0_0': 0.9957, 'acc_0_1': 0.8841, 'acc_1_0': 0.4627, 'acc_1_1': 0.8636, 'mean_acc': 0.8783}
Test(class)(new adapter): {'weighted_mean_acc': 0.9544, 'worst_acc': 0.4938, 'acc_0_0': 0.9951, 'acc_0_1': 0.882, 'acc_1_0': 0.4938, 'acc_1_1': 0.8567, 'mean_acc': 0.8802}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0606, 'acc_0_0': 0.9871, 'acc_0_1': 0.2403, 'acc_1_0': 0.0606, 'acc_1_1': 0.6418, 'mean_acc': 0.5559}
Val(class)(new adapter): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.8455, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5966, 'acc_0_0': 0.9902, 'acc_0_1': 0.8386, 'acc_1_0': 0.5966, 'acc_1_1': 0.8941, 'mean_acc': 0.8769}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9785, 'acc_0_1': 0.8627, 'acc_1_0': 0.7273, 'acc_1_1': 0.9552, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.9399, 'worst_acc': 0.7164, 'acc_0_0': 0.9701, 'acc_0_1': 0.8712, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.7165, 'acc_0_0': 0.9814, 'acc_0_1': 0.8896, 'acc_1_0': 0.7165, 'acc_1_1': 0.8396, 'mean_acc': 0.9006}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.5107, 'acc_0_1': 0.9871, 'acc_1_0': 0.0, 'acc_1_1': 0.3433, 'mean_acc': 0.621}
Val(class)(new adapter): {'weighted_mean_acc': 0.9387, 'worst_acc': 0.6716, 'acc_0_0': 0.9744, 'acc_0_1': 0.9485, 'acc_1_0': 0.6716, 'acc_1_1': 0.8333, 'mean_acc': 0.915}
Test(class)(new adapter): {'weighted_mean_acc': 0.9452, 'worst_acc': 0.6807, 'acc_0_0': 0.9876, 'acc_0_1': 0.9441, 'acc_1_0': 0.6807, 'acc_1_1': 0.8193, 'mean_acc': 0.918}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9571, 'acc_0_1': 0.9528, 'acc_1_0': 0.7273, 'acc_1_1': 0.9701, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.8928, 'worst_acc': 0.5909, 'acc_0_0': 0.9829, 'acc_0_1': 0.9914, 'acc_1_0': 0.6418, 'acc_1_1': 0.5909, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8879, 'worst_acc': 0.5436, 'acc_0_0': 0.9907, 'acc_0_1': 0.9885, 'acc_1_0': 0.6355, 'acc_1_1': 0.5436, 'mean_acc': 0.9009}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2836, 'acc_0_0': 0.9313, 'acc_0_1': 0.9313, 'acc_1_0': 0.7576, 'acc_1_1': 0.2836, 'mean_acc': 0.8397}
Val(class)(new adapter): {'weighted_mean_acc': 0.9373, 'worst_acc': 0.806, 'acc_0_0': 0.9658, 'acc_0_1': 0.9442, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.9267}
Test(class)(new adapter): {'weighted_mean_acc': 0.9362, 'worst_acc': 0.7991, 'acc_0_0': 0.9676, 'acc_0_1': 0.9366, 'acc_1_0': 0.7991, 'acc_1_1': 0.8396, 'mean_acc': 0.9227}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7273, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.7273, 'acc_1_1': 0.9403, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9164, 'worst_acc': 0.7468, 'acc_0_0': 0.9103, 'acc_0_1': 0.7468, 'acc_1_0': 0.8507, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7521, 'acc_0_0': 0.9122, 'acc_0_1': 0.7521, 'acc_1_0': 0.8723, 'acc_1_1': 0.933, 'mean_acc': 0.8478}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.9657, 'acc_0_1': 0.897, 'acc_1_0': 0.8939, 'acc_1_1': 0.6567, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.8563, 'worst_acc': 0.6094, 'acc_0_0': 0.8291, 'acc_0_1': 0.6094, 'acc_1_0': 0.9403, 'acc_1_1': 0.9848, 'mean_acc': 0.7733}
Test(class)(new adapter): {'weighted_mean_acc': 0.8457, 'worst_acc': 0.5933, 'acc_0_0': 0.8244, 'acc_0_1': 0.5933, 'acc_1_0': 0.919, 'acc_1_1': 0.9564, 'mean_acc': 0.7596}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9742, 'acc_0_1': 0.9399, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9499}
Val(class)(new adapter): {'weighted_mean_acc': 0.8125, 'worst_acc': 0.6867, 'acc_0_0': 0.765, 'acc_0_1': 0.6867, 'acc_1_0': 0.9403, 'acc_1_1': 0.9848, 'mean_acc': 0.7783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8033, 'worst_acc': 0.6718, 'acc_0_0': 0.7681, 'acc_0_1': 0.6718, 'acc_1_0': 0.9299, 'acc_1_1': 0.9361, 'mean_acc': 0.7672}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.8884, 'acc_0_1': 0.9399, 'acc_1_0': 0.9697, 'acc_1_1': 0.8806, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.8721, 'worst_acc': 0.8455, 'acc_0_0': 0.8718, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8788, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.8564, 'worst_acc': 0.8492, 'acc_0_0': 0.8492, 'acc_0_1': 0.855, 'acc_1_0': 0.8941, 'acc_1_1': 0.8785, 'mean_acc': 0.8597}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9785, 'acc_0_1': 0.9957, 'acc_1_0': 0.8636, 'acc_1_1': 0.9104, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.9185, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.89, 'worst_acc': 0.7695, 'acc_0_0': 0.9246, 'acc_0_1': 0.9366, 'acc_1_0': 0.8474, 'acc_1_1': 0.7695, 'mean_acc': 0.9035}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9485, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.8917, 'worst_acc': 0.7164, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7025, 'acc_0_0': 0.9517, 'acc_0_1': 0.9636, 'acc_1_0': 0.7882, 'acc_1_1': 0.7025, 'mean_acc': 0.9106}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.8915, 'worst_acc': 0.7164, 'acc_0_0': 0.9231, 'acc_0_1': 0.9399, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7336, 'acc_0_0': 0.9543, 'acc_0_1': 0.9601, 'acc_1_0': 0.7773, 'acc_1_1': 0.7336, 'mean_acc': 0.9125}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.8878, 'worst_acc': 0.7015, 'acc_0_0': 0.9231, 'acc_0_1': 0.9356, 'acc_1_0': 0.7015, 'acc_1_1': 0.7727, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9079, 'worst_acc': 0.7352, 'acc_0_0': 0.9596, 'acc_0_1': 0.9579, 'acc_1_0': 0.7679, 'acc_1_1': 0.7352, 'mean_acc': 0.9128}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.8879, 'worst_acc': 0.7015, 'acc_0_0': 0.9145, 'acc_0_1': 0.927, 'acc_1_0': 0.7015, 'acc_1_1': 0.803, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.7477, 'acc_0_0': 0.9499, 'acc_0_1': 0.9463, 'acc_1_0': 0.785, 'acc_1_1': 0.7477, 'mean_acc': 0.9078}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.885, 'worst_acc': 0.7313, 'acc_0_0': 0.9103, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.7601, 'acc_0_0': 0.9424, 'acc_0_1': 0.9384, 'acc_1_0': 0.7944, 'acc_1_1': 0.7601, 'mean_acc': 0.9042}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8817, 'worst_acc': 0.7463, 'acc_0_0': 0.906, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.88}
Test(class)(new adapter): {'weighted_mean_acc': 0.897, 'worst_acc': 0.7695, 'acc_0_0': 0.9353, 'acc_0_1': 0.9264, 'acc_1_0': 0.8193, 'acc_1_1': 0.7695, 'mean_acc': 0.9006}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.8851, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8902, 'worst_acc': 0.7897, 'acc_0_0': 0.9197, 'acc_0_1': 0.9171, 'acc_1_0': 0.8567, 'acc_1_1': 0.7897, 'mean_acc': 0.8973}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8636, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8899, 'worst_acc': 0.8022, 'acc_0_0': 0.9157, 'acc_0_1': 0.9104, 'acc_1_0': 0.866, 'acc_1_1': 0.8022, 'mean_acc': 0.8956}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.9185, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8903, 'worst_acc': 0.7975, 'acc_0_0': 0.9175, 'acc_0_1': 0.9162, 'acc_1_0': 0.8551, 'acc_1_1': 0.7975, 'mean_acc': 0.8968}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8919, 'worst_acc': 0.7741, 'acc_0_0': 0.9259, 'acc_0_1': 0.9357, 'acc_1_0': 0.8442, 'acc_1_1': 0.7741, 'mean_acc': 0.9039}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8899, 'worst_acc': 0.7761, 'acc_0_0': 0.9103, 'acc_0_1': 0.9485, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8909, 'worst_acc': 0.7492, 'acc_0_0': 0.9317, 'acc_0_1': 0.9481, 'acc_1_0': 0.8255, 'acc_1_1': 0.7492, 'mean_acc': 0.9061}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8863, 'worst_acc': 0.7463, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.803, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8887, 'worst_acc': 0.7414, 'acc_0_0': 0.9308, 'acc_0_1': 0.9534, 'acc_1_0': 0.824, 'acc_1_1': 0.7414, 'mean_acc': 0.9068}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.883, 'worst_acc': 0.7463, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.7879, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8866, 'worst_acc': 0.7321, 'acc_0_0': 0.9308, 'acc_0_1': 0.9557, 'acc_1_0': 0.8131, 'acc_1_1': 0.7321, 'mean_acc': 0.9054}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.883, 'worst_acc': 0.7463, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.7463, 'acc_1_1': 0.7879, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8876, 'worst_acc': 0.7383, 'acc_0_0': 0.9304, 'acc_0_1': 0.9548, 'acc_1_0': 0.8146, 'acc_1_1': 0.7383, 'mean_acc': 0.9058}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8865, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9528, 'acc_1_0': 0.7612, 'acc_1_1': 0.803, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8878, 'worst_acc': 0.7445, 'acc_0_0': 0.9286, 'acc_0_1': 0.9552, 'acc_1_0': 0.8178, 'acc_1_1': 0.7445, 'mean_acc': 0.9063}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8843, 'worst_acc': 0.803, 'acc_0_0': 0.906, 'acc_0_1': 0.9571, 'acc_1_0': 0.8209, 'acc_1_1': 0.803, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.8826, 'worst_acc': 0.7555, 'acc_0_0': 0.9184, 'acc_0_1': 0.949, 'acc_1_0': 0.824, 'acc_1_1': 0.7555, 'mean_acc': 0.9018}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.875, 'worst_acc': 0.8333, 'acc_0_0': 0.8846, 'acc_0_1': 0.9442, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8745, 'worst_acc': 0.7835, 'acc_0_0': 0.8993, 'acc_0_1': 0.9317, 'acc_1_0': 0.8567, 'acc_1_1': 0.7835, 'mean_acc': 0.8944}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8717, 'worst_acc': 0.8182, 'acc_0_0': 0.8846, 'acc_0_1': 0.9442, 'acc_1_0': 0.8358, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8723, 'worst_acc': 0.8037, 'acc_0_0': 0.8905, 'acc_0_1': 0.9242, 'acc_1_0': 0.8598, 'acc_1_1': 0.8037, 'mean_acc': 0.8906}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8709, 'worst_acc': 0.8182, 'acc_0_0': 0.8846, 'acc_0_1': 0.9227, 'acc_1_0': 0.8358, 'acc_1_1': 0.8182, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8742, 'worst_acc': 0.8022, 'acc_0_0': 0.894, 'acc_0_1': 0.9157, 'acc_1_0': 0.8614, 'acc_1_1': 0.8022, 'mean_acc': 0.8887}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8801, 'worst_acc': 0.8182, 'acc_0_0': 0.8974, 'acc_0_1': 0.9142, 'acc_1_0': 0.8507, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8833, 'worst_acc': 0.8084, 'acc_0_0': 0.9047, 'acc_0_1': 0.9166, 'acc_1_0': 0.852, 'acc_1_1': 0.8084, 'mean_acc': 0.8928}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8893, 'worst_acc': 0.8333, 'acc_0_0': 0.906, 'acc_0_1': 0.9056, 'acc_1_0': 0.8507, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.8115, 'acc_0_0': 0.9144, 'acc_0_1': 0.9135, 'acc_1_0': 0.8364, 'acc_1_1': 0.8115, 'mean_acc': 0.894}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.8333, 'acc_0_0': 0.9145, 'acc_0_1': 0.9056, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.81, 'acc_0_0': 0.9259, 'acc_0_1': 0.9171, 'acc_1_0': 0.824, 'acc_1_1': 0.81, 'mean_acc': 0.8983}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9008, 'worst_acc': 0.8084, 'acc_0_0': 0.929, 'acc_0_1': 0.9193, 'acc_1_0': 0.8193, 'acc_1_1': 0.8084, 'mean_acc': 0.8997}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.8209, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.902, 'worst_acc': 0.8069, 'acc_0_0': 0.9313, 'acc_0_1': 0.9175, 'acc_1_0': 0.8178, 'acc_1_1': 0.8069, 'mean_acc': 0.8996}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9023, 'worst_acc': 0.8069, 'acc_0_0': 0.9317, 'acc_0_1': 0.9184, 'acc_1_0': 0.8178, 'acc_1_1': 0.8069, 'mean_acc': 0.9001}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.8069, 'acc_0_0': 0.9326, 'acc_0_1': 0.9184, 'acc_1_0': 0.8178, 'acc_1_1': 0.8069, 'mean_acc': 0.9004}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.8084, 'acc_0_0': 0.9357, 'acc_0_1': 0.918, 'acc_1_0': 0.8178, 'acc_1_1': 0.8084, 'mean_acc': 0.9016}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.8069, 'acc_0_0': 0.9357, 'acc_0_1': 0.9206, 'acc_1_0': 0.8162, 'acc_1_1': 0.8069, 'mean_acc': 0.9023}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.903, 'worst_acc': 0.8084, 'acc_0_0': 0.9322, 'acc_0_1': 0.9166, 'acc_1_0': 0.8209, 'acc_1_1': 0.8084, 'mean_acc': 0.9001}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9044, 'worst_acc': 0.806, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9051, 'worst_acc': 0.8084, 'acc_0_0': 0.9348, 'acc_0_1': 0.9211, 'acc_1_0': 0.8178, 'acc_1_1': 0.8084, 'mean_acc': 0.9025}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.806, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.906, 'worst_acc': 0.8069, 'acc_0_0': 0.9366, 'acc_0_1': 0.9215, 'acc_1_0': 0.8178, 'acc_1_1': 0.8069, 'mean_acc': 0.9032}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9053, 'worst_acc': 0.7975, 'acc_0_0': 0.9384, 'acc_0_1': 0.9246, 'acc_1_0': 0.8131, 'acc_1_1': 0.7975, 'mean_acc': 0.9035}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9045, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.796, 'acc_0_0': 0.9366, 'acc_0_1': 0.9246, 'acc_1_0': 0.8146, 'acc_1_1': 0.796, 'mean_acc': 0.9028}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.791, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9024, 'worst_acc': 0.7975, 'acc_0_0': 0.9344, 'acc_0_1': 0.9237, 'acc_1_0': 0.8178, 'acc_1_1': 0.7975, 'mean_acc': 0.9021}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9076, 'worst_acc': 0.791, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.791, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9031, 'worst_acc': 0.7944, 'acc_0_0': 0.9361, 'acc_0_1': 0.9273, 'acc_1_0': 0.8146, 'acc_1_1': 0.7944, 'mean_acc': 0.9035}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9009, 'worst_acc': 0.7928, 'acc_0_0': 0.9335, 'acc_0_1': 0.9264, 'acc_1_0': 0.8224, 'acc_1_1': 0.7928, 'mean_acc': 0.9028}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9016, 'worst_acc': 0.806, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.806, 'acc_1_1': 0.8333, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7928, 'acc_0_0': 0.9339, 'acc_0_1': 0.9277, 'acc_1_0': 0.8193, 'acc_1_1': 0.7928, 'mean_acc': 0.9032}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9, 'worst_acc': 0.7913, 'acc_0_0': 0.9326, 'acc_0_1': 0.9268, 'acc_1_0': 0.824, 'acc_1_1': 0.7913, 'mean_acc': 0.9027}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.7913, 'acc_0_0': 0.9304, 'acc_0_1': 0.9268, 'acc_1_0': 0.824, 'acc_1_1': 0.7913, 'mean_acc': 0.9018}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.7913, 'acc_0_0': 0.9313, 'acc_0_1': 0.9268, 'acc_1_0': 0.824, 'acc_1_1': 0.7913, 'mean_acc': 0.9021}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8983, 'worst_acc': 0.7944, 'acc_0_0': 0.9295, 'acc_0_1': 0.9237, 'acc_1_0': 0.8287, 'acc_1_1': 0.7944, 'mean_acc': 0.9011}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.8182, 'acc_0_0': 0.9188, 'acc_0_1': 0.9185, 'acc_1_0': 0.8209, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7882, 'acc_0_0': 0.9344, 'acc_0_1': 0.9286, 'acc_1_0': 0.8224, 'acc_1_1': 0.7882, 'mean_acc': 0.9035}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.8182, 'acc_0_0': 0.9274, 'acc_0_1': 0.9185, 'acc_1_0': 0.8209, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7882, 'acc_0_0': 0.9344, 'acc_0_1': 0.9268, 'acc_1_0': 0.8255, 'acc_1_1': 0.7882, 'mean_acc': 0.9032}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.8209, 'acc_0_0': 0.9231, 'acc_0_1': 0.9142, 'acc_1_0': 0.8209, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7913, 'acc_0_0': 0.9335, 'acc_0_1': 0.9251, 'acc_1_0': 0.8255, 'acc_1_1': 0.7913, 'mean_acc': 0.9025}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.8182, 'acc_0_0': 0.9231, 'acc_0_1': 0.9185, 'acc_1_0': 0.8209, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9002, 'worst_acc': 0.7882, 'acc_0_0': 0.9339, 'acc_0_1': 0.9268, 'acc_1_0': 0.8224, 'acc_1_1': 0.7882, 'mean_acc': 0.9027}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8996, 'worst_acc': 0.7913, 'acc_0_0': 0.9322, 'acc_0_1': 0.9255, 'acc_1_0': 0.8255, 'acc_1_1': 0.7913, 'mean_acc': 0.9021}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.8182, 'acc_0_0': 0.9188, 'acc_0_1': 0.9185, 'acc_1_0': 0.8358, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.897, 'worst_acc': 0.7882, 'acc_0_0': 0.9295, 'acc_0_1': 0.9264, 'acc_1_0': 0.824, 'acc_1_1': 0.7882, 'mean_acc': 0.9009}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.8333, 'acc_0_0': 0.9188, 'acc_0_1': 0.9142, 'acc_1_0': 0.8358, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.7913, 'acc_0_0': 0.9313, 'acc_0_1': 0.9251, 'acc_1_0': 0.8255, 'acc_1_1': 0.7913, 'mean_acc': 0.9016}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.8182, 'acc_0_0': 0.9188, 'acc_0_1': 0.9185, 'acc_1_0': 0.8209, 'acc_1_1': 0.8182, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.7882, 'acc_0_0': 0.9304, 'acc_0_1': 0.9282, 'acc_1_0': 0.8224, 'acc_1_1': 0.7882, 'mean_acc': 0.9018}
========================================================================
> end of training. 

best epoch : 50
best training accuracy on [class]: {'worst_acc': 0.8806, 'acc_0_0': 0.8884, 'acc_0_1': 0.9399, 'acc_1_0': 0.9697, 'acc_1_1': 0.8806, 'mean_acc': 0.9165}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8721, 'worst_acc': 0.8455, 'acc_0_0': 0.8718, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8788, 'mean_acc': 0.86}
best test accuracy on [class]: {'weighted_mean_acc': 0.8564, 'worst_acc': 0.8492, 'acc_0_0': 0.8492, 'acc_0_1': 0.855, 'acc_1_0': 0.8941, 'acc_1_1': 0.8785, 'mean_acc': 0.8597}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8564, 'worst_acc': 0.8492, 'acc_0_0': 0.8492, 'acc_0_1': 0.855, 'acc_1_0': 0.8941, 'acc_1_1': 0.8785, 'mean_acc': 0.8597}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9651, 'worst_acc': 0.7352, 'acc_0_0': 0.9641, 'acc_0_1': 0.9437, 'acc_1_0': 0.7352, 'acc_1_1': 0.9844, 'mean_acc': 0.933}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 50': {'Train': {'worst_acc': 0.8806, 'acc_0_0': 0.8884, 'acc_0_1': 0.9399, 'acc_1_0': 0.9697, 'acc_1_1': 0.8806, 'mean_acc': 0.9165}, 'Val': {'weighted_mean_acc': 0.8721, 'worst_acc': 0.8455, 'acc_0_0': 0.8718, 'acc_0_1': 0.8455, 'acc_1_0': 0.8507, 'acc_1_1': 0.8788, 'mean_acc': 0.86}, 'Test': {'weighted_mean_acc': 0.8564, 'worst_acc': 0.8492, 'acc_0_0': 0.8492, 'acc_0_1': 0.855, 'acc_1_0': 0.8941, 'acc_1_1': 0.8785, 'mean_acc': 0.8597}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8564, 'worst_acc': 0.8492, 'acc_0_0': 0.8492, 'acc_0_1': 0.855, 'acc_1_0': 0.8941, 'acc_1_1': 0.8785, 'mean_acc': 0.8597}, 'spurious': {'weighted_mean_acc': 0.9651, 'worst_acc': 0.7352, 'acc_0_0': 0.9641, 'acc_0_1': 0.9437, 'acc_1_0': 0.7352, 'acc_1_1': 0.9844, 'mean_acc': 0.933}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.4457, 'acc_0_0': 0.9168, 'acc_0_1': 0.4457, 'acc_1_0': 0.4821, 'acc_1_1': 0.6377, 'mean_acc': 0.8321}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.2618, 'acc_0_0': 0.9915, 'acc_0_1': 0.2618, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6633}
Test(class): {'weighted_mean_acc': 0.947, 'worst_acc': 0.2293, 'acc_0_0': 0.9836, 'acc_0_1': 0.2293, 'acc_1_0': 0.5748, 'acc_1_1': 0.9704, 'mean_acc': 0.6433}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.4643, 'acc_0_0': 0.9943, 'acc_0_1': 0.6196, 'acc_1_0': 0.4643, 'acc_1_1': 0.8723, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.3176, 'acc_0_0': 0.9957, 'acc_0_1': 0.3176, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.6917}
Test(class): {'weighted_mean_acc': 0.9479, 'worst_acc': 0.3193, 'acc_0_0': 0.9809, 'acc_0_1': 0.3193, 'acc_1_0': 0.6417, 'acc_1_1': 0.9642, 'mean_acc': 0.684}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.4891, 'acc_0_0': 0.9871, 'acc_0_1': 0.4891, 'acc_1_0': 0.6607, 'acc_1_1': 0.9527, 'mean_acc': 0.9566}
Val(class): {'weighted_mean_acc': 0.9535, 'worst_acc': 0.2918, 'acc_0_0': 0.9829, 'acc_0_1': 0.2918, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.6833}
Test(class): {'weighted_mean_acc': 0.941, 'worst_acc': 0.2878, 'acc_0_0': 0.9685, 'acc_0_1': 0.2878, 'acc_1_0': 0.7274, 'acc_1_1': 0.9751, 'mean_acc': 0.6776}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.5272, 'acc_0_0': 0.9728, 'acc_0_1': 0.5272, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9514}
Val(class): {'weighted_mean_acc': 0.9656, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.6395, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.6244, 'acc_0_0': 0.9858, 'acc_0_1': 0.6244, 'acc_1_0': 0.6386, 'acc_1_1': 0.933, 'mean_acc': 0.8008}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.5357, 'acc_0_0': 0.9977, 'acc_0_1': 0.8641, 'acc_1_0': 0.5357, 'acc_1_1': 0.8846, 'mean_acc': 0.9623}
Val(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.6418, 'acc_0_0': 0.9829, 'acc_0_1': 0.6438, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9554, 'worst_acc': 0.6302, 'acc_0_0': 0.9831, 'acc_0_1': 0.6302, 'acc_1_0': 0.6838, 'acc_1_1': 0.9346, 'mean_acc': 0.8072}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.6576, 'acc_0_0': 0.9808, 'acc_0_1': 0.6576, 'acc_1_0': 0.75, 'acc_1_1': 0.9518, 'mean_acc': 0.9593}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.4893, 'acc_0_0': 0.9786, 'acc_0_1': 0.4893, 'acc_1_0': 0.7164, 'acc_1_1': 1.0, 'mean_acc': 0.7617}
Test(class): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.4315, 'acc_0_0': 0.9685, 'acc_0_1': 0.4315, 'acc_1_0': 0.729, 'acc_1_1': 0.9611, 'mean_acc': 0.7321}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9926, 'acc_0_1': 0.6793, 'acc_1_0': 0.6429, 'acc_1_1': 0.9508, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.6738, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8117}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5312, 'acc_0_0': 0.9929, 'acc_0_1': 0.6834, 'acc_1_0': 0.5312, 'acc_1_1': 0.9143, 'mean_acc': 0.8126}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9994, 'acc_0_1': 0.7826, 'acc_1_0': 0.5, 'acc_1_1': 0.9234, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9684, 'worst_acc': 0.5536, 'acc_0_0': 0.9915, 'acc_0_1': 0.5536, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.775}
Test(class): {'weighted_mean_acc': 0.9552, 'worst_acc': 0.5583, 'acc_0_0': 0.9876, 'acc_0_1': 0.5583, 'acc_1_0': 0.595, 'acc_1_1': 0.9361, 'mean_acc': 0.7713}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.996, 'acc_0_1': 0.6141, 'acc_1_0': 0.6071, 'acc_1_1': 0.9659, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.5365, 'acc_0_0': 0.9872, 'acc_0_1': 0.5365, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.7733}
Test(class): {'weighted_mean_acc': 0.9546, 'worst_acc': 0.5153, 'acc_0_0': 0.9863, 'acc_0_1': 0.5153, 'acc_1_0': 0.6246, 'acc_1_1': 0.9439, 'mean_acc': 0.7582}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9969, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.948, 'mean_acc': 0.9702}
Val(class): {'weighted_mean_acc': 0.9626, 'worst_acc': 0.5224, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.5224, 'acc_1_1': 0.9394, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.5498, 'acc_0_0': 0.9916, 'acc_0_1': 0.6816, 'acc_1_0': 0.5498, 'acc_1_1': 0.9112, 'mean_acc': 0.8131}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.998, 'acc_0_1': 0.7772, 'acc_1_0': 0.6071, 'acc_1_1': 0.9423, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5522, 'acc_0_0': 0.9915, 'acc_0_1': 0.6524, 'acc_1_0': 0.5522, 'acc_1_1': 0.9394, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5748, 'acc_0_0': 0.9898, 'acc_0_1': 0.6612, 'acc_1_0': 0.5748, 'acc_1_1': 0.9159, 'mean_acc': 0.8077}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9969, 'acc_0_1': 0.6957, 'acc_1_0': 0.6786, 'acc_1_1': 0.9565, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.5672, 'acc_1_1': 0.9697, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.581, 'acc_0_0': 0.9916, 'acc_0_1': 0.651, 'acc_1_0': 0.581, 'acc_1_1': 0.919, 'mean_acc': 0.8055}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9977, 'acc_0_1': 0.7174, 'acc_1_0': 0.7321, 'acc_1_1': 0.9593, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.567, 'acc_0_0': 0.9929, 'acc_0_1': 0.6931, 'acc_1_0': 0.567, 'acc_1_1': 0.9128, 'mean_acc': 0.8202}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9983, 'acc_0_1': 0.7663, 'acc_1_0': 0.6964, 'acc_1_1': 0.9518, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5779, 'acc_0_0': 0.9925, 'acc_0_1': 0.6905, 'acc_1_0': 0.5779, 'acc_1_1': 0.9174, 'mean_acc': 0.8207}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9546, 'mean_acc': 0.976}
Val(class): {'weighted_mean_acc': 0.9637, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.6829, 'acc_1_0': 0.5841, 'acc_1_1': 0.9221, 'mean_acc': 0.819}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7446, 'acc_0_0': 0.998, 'acc_0_1': 0.7446, 'acc_1_0': 0.7679, 'acc_1_1': 0.9574, 'mean_acc': 0.9766}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5888, 'acc_0_0': 0.992, 'acc_0_1': 0.6838, 'acc_1_0': 0.5888, 'acc_1_1': 0.9252, 'mean_acc': 0.82}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.9977, 'acc_0_1': 0.75, 'acc_1_0': 0.7321, 'acc_1_1': 0.9584, 'mean_acc': 0.9764}
Val(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9929, 'acc_0_1': 0.7029, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8271}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.7143, 'acc_1_1': 0.9489, 'mean_acc': 0.9769}
Val(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7091, 'acc_1_0': 0.5841, 'acc_1_1': 0.9237, 'mean_acc': 0.8293}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.7554, 'acc_0_0': 0.9983, 'acc_0_1': 0.7554, 'acc_1_0': 0.7857, 'acc_1_1': 0.9584, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.9669, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9545, 'mean_acc': 0.8233}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.6656, 'acc_1_0': 0.6044, 'acc_1_1': 0.9315, 'mean_acc': 0.8152}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9986, 'acc_0_1': 0.7772, 'acc_1_0': 0.75, 'acc_1_1': 0.9603, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9586, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7339, 'acc_1_0': 0.5821, 'acc_1_1': 0.9091, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.5732, 'acc_0_0': 0.9938, 'acc_0_1': 0.7299, 'acc_1_0': 0.5732, 'acc_1_1': 0.9237, 'mean_acc': 0.8367}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9991, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9593, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6137, 'acc_0_0': 0.9911, 'acc_0_1': 0.6652, 'acc_1_0': 0.6137, 'acc_1_1': 0.9361, 'mean_acc': 0.8164}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7609, 'acc_0_0': 0.9986, 'acc_0_1': 0.7609, 'acc_1_0': 0.875, 'acc_1_1': 0.9678, 'mean_acc': 0.9812}
Val(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.595, 'acc_0_0': 0.9925, 'acc_0_1': 0.7069, 'acc_1_0': 0.595, 'acc_1_1': 0.9268, 'mean_acc': 0.83}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9989, 'acc_0_1': 0.8261, 'acc_1_0': 0.8214, 'acc_1_1': 0.9631, 'mean_acc': 0.9823}
Val(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.721, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5981, 'acc_0_0': 0.992, 'acc_0_1': 0.7069, 'acc_1_0': 0.5981, 'acc_1_1': 0.9268, 'mean_acc': 0.8302}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8098, 'acc_0_0': 0.9983, 'acc_0_1': 0.8098, 'acc_1_0': 0.8571, 'acc_1_1': 0.9754, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6137, 'acc_0_0': 0.9916, 'acc_0_1': 0.6914, 'acc_1_0': 0.6137, 'acc_1_1': 0.9315, 'mean_acc': 0.8262}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9986, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9707, 'mean_acc': 0.9844}
Val(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.6044, 'acc_0_0': 0.9916, 'acc_0_1': 0.7118, 'acc_1_0': 0.6044, 'acc_1_1': 0.9268, 'mean_acc': 0.8326}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9991, 'acc_0_1': 0.8207, 'acc_1_0': 0.875, 'acc_1_1': 0.9773, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.963, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7007, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8295}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8261, 'acc_0_0': 0.9994, 'acc_0_1': 0.8261, 'acc_1_0': 0.875, 'acc_1_1': 0.9754, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6028, 'acc_0_0': 0.9925, 'acc_0_1': 0.7171, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.8348}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9997, 'acc_0_1': 0.875, 'acc_1_0': 0.8571, 'acc_1_1': 0.9726, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6028, 'acc_0_0': 0.9938, 'acc_0_1': 0.729, 'acc_1_0': 0.6028, 'acc_1_1': 0.9268, 'mean_acc': 0.84}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.8478, 'acc_0_0': 0.9994, 'acc_0_1': 0.8478, 'acc_1_0': 0.8929, 'acc_1_1': 0.9782, 'mean_acc': 0.9877}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9635, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.702, 'acc_1_0': 0.6106, 'acc_1_1': 0.9361, 'mean_acc': 0.8303}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8533, 'acc_0_0': 0.9991, 'acc_0_1': 0.8533, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.966, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.7166, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.8359}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9286, 'acc_1_1': 0.9782, 'mean_acc': 0.9892}
Val(class): {'weighted_mean_acc': 0.9658, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9644, 'worst_acc': 0.609, 'acc_0_0': 0.9916, 'acc_0_1': 0.7277, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8402}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8587, 'acc_0_0': 0.9991, 'acc_0_1': 0.8587, 'acc_1_0': 0.9464, 'acc_1_1': 0.982, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9631, 'worst_acc': 0.6121, 'acc_0_0': 0.9907, 'acc_0_1': 0.7095, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8331}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9997, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.609, 'acc_0_0': 0.9925, 'acc_0_1': 0.7424, 'acc_1_0': 0.609, 'acc_1_1': 0.933, 'mean_acc': 0.846}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9997, 'acc_0_1': 0.8967, 'acc_1_0': 0.9464, 'acc_1_1': 0.9782, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7597, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6012, 'acc_0_0': 0.9933, 'acc_0_1': 0.7614, 'acc_1_0': 0.6012, 'acc_1_1': 0.9237, 'mean_acc': 0.8519}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9994, 'acc_0_1': 0.875, 'acc_1_0': 0.9643, 'acc_1_1': 0.9849, 'mean_acc': 0.991}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.597, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9653, 'worst_acc': 0.6106, 'acc_0_0': 0.992, 'acc_0_1': 0.7419, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.846}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9994, 'acc_0_1': 0.8913, 'acc_1_0': 0.9821, 'acc_1_1': 0.9905, 'mean_acc': 0.9931}
Val(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6106, 'acc_0_0': 0.9898, 'acc_0_1': 0.7211, 'acc_1_0': 0.6106, 'acc_1_1': 0.9346, 'mean_acc': 0.8371}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9923}
Val(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9628, 'worst_acc': 0.6059, 'acc_0_0': 0.9902, 'acc_0_1': 0.7295, 'acc_1_0': 0.6059, 'acc_1_1': 0.9315, 'mean_acc': 0.8397}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9022, 'acc_0_0': 0.9997, 'acc_0_1': 0.9022, 'acc_1_0': 0.9821, 'acc_1_1': 0.9849, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9685, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.721, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9645, 'worst_acc': 0.6106, 'acc_0_0': 0.9911, 'acc_0_1': 0.7197, 'acc_1_0': 0.6106, 'acc_1_1': 0.9377, 'mean_acc': 0.8374}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.9994, 'acc_0_1': 0.8967, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9935}
Val(class): {'weighted_mean_acc': 0.9693, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9633, 'worst_acc': 0.6075, 'acc_0_0': 0.9902, 'acc_0_1': 0.7694, 'acc_1_0': 0.6075, 'acc_1_1': 0.9268, 'mean_acc': 0.8548}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 1.0, 'acc_0_1': 0.9402, 'acc_1_0': 0.9821, 'acc_1_1': 0.9858, 'mean_acc': 0.9944}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9957, 'acc_0_1': 0.7339, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.6121, 'acc_0_0': 0.9902, 'acc_0_1': 0.7415, 'acc_1_0': 0.6121, 'acc_1_1': 0.9346, 'mean_acc': 0.8454}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.3182, 'acc_0_0': 0.9957, 'acc_0_1': 0.6867, 'acc_1_0': 0.3182, 'acc_1_1': 0.9104, 'mean_acc': 0.7913}
Val(class)(new adapter): {'weighted_mean_acc': 0.9758, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.8541, 'acc_1_0': 0.5522, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.567, 'acc_0_0': 0.9956, 'acc_0_1': 0.843, 'acc_1_0': 0.567, 'acc_1_1': 0.9019, 'mean_acc': 0.8783}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0909, 'acc_0_0': 0.9914, 'acc_0_1': 0.0944, 'acc_1_0': 0.0909, 'acc_1_1': 0.8358, 'mean_acc': 0.5259}
Val(class)(new adapter): {'weighted_mean_acc': 0.9676, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.867, 'acc_1_0': 0.6269, 'acc_1_1': 0.9242, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6231, 'acc_0_0': 0.9916, 'acc_0_1': 0.863, 'acc_1_0': 0.6231, 'acc_1_1': 0.8894, 'mean_acc': 0.8894}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5909, 'acc_0_0': 0.9957, 'acc_0_1': 0.9399, 'acc_1_0': 0.5909, 'acc_1_1': 0.8209, 'mean_acc': 0.9098}
Val(class)(new adapter): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.8209, 'acc_0_0': 0.9658, 'acc_0_1': 0.8326, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9411, 'worst_acc': 0.7944, 'acc_0_0': 0.9636, 'acc_0_1': 0.8195, 'acc_1_0': 0.7944, 'acc_1_1': 0.8956, 'mean_acc': 0.8813}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0303, 'acc_0_0': 0.5751, 'acc_0_1': 0.9871, 'acc_1_0': 0.0303, 'acc_1_1': 0.209, 'mean_acc': 0.6344}
Val(class)(new adapter): {'weighted_mean_acc': 0.9353, 'worst_acc': 0.6567, 'acc_0_0': 0.9359, 'acc_0_1': 0.6567, 'acc_1_0': 0.8806, 'acc_1_1': 0.9848, 'mean_acc': 0.8267}
Test(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.6576, 'acc_0_0': 0.937, 'acc_0_1': 0.6576, 'acc_1_0': 0.8178, 'acc_1_1': 0.9579, 'mean_acc': 0.8174}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.6667, 'acc_0_0': 0.9742, 'acc_0_1': 0.8326, 'acc_1_0': 0.6667, 'acc_1_1': 0.9552, 'mean_acc': 0.8831}
Val(class)(new adapter): {'weighted_mean_acc': 0.9204, 'worst_acc': 0.8358, 'acc_0_0': 0.9402, 'acc_0_1': 0.897, 'acc_1_0': 0.8358, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9158, 'worst_acc': 0.8146, 'acc_0_0': 0.9441, 'acc_0_1': 0.8812, 'acc_1_0': 0.8146, 'acc_1_1': 0.8333, 'mean_acc': 0.893}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1493, 'acc_0_0': 0.9571, 'acc_0_1': 0.9185, 'acc_1_0': 0.7727, 'acc_1_1': 0.1493, 'mean_acc': 0.8314}
Val(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.8283, 'acc_0_0': 0.8932, 'acc_0_1': 0.8283, 'acc_1_0': 0.9104, 'acc_1_1': 0.9394, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8887, 'worst_acc': 0.8235, 'acc_0_0': 0.8882, 'acc_0_1': 0.8235, 'acc_1_0': 0.8801, 'acc_1_1': 0.9019, 'mean_acc': 0.8637}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9657, 'acc_0_1': 0.9056, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.8651, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8939, 'mean_acc': 0.8767}
Test(class)(new adapter): {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8458, 'acc_0_0': 0.8758, 'acc_0_1': 0.9002, 'acc_1_0': 0.9003, 'acc_1_1': 0.8458, 'mean_acc': 0.8847}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5821, 'acc_0_0': 0.9442, 'acc_0_1': 0.9356, 'acc_1_0': 0.8788, 'acc_1_1': 0.5821, 'mean_acc': 0.8932}
Val(class)(new adapter): {'weighted_mean_acc': 0.8409, 'worst_acc': 0.8291, 'acc_0_0': 0.8291, 'acc_0_1': 0.9099, 'acc_1_0': 0.9254, 'acc_1_1': 0.8636, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.8301, 'worst_acc': 0.8248, 'acc_0_0': 0.8248, 'acc_0_1': 0.9135, 'acc_1_0': 0.9128, 'acc_1_1': 0.8287, 'mean_acc': 0.8695}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9254, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.7962, 'worst_acc': 0.7521, 'acc_0_0': 0.7521, 'acc_0_1': 0.8498, 'acc_1_0': 0.9552, 'acc_1_1': 0.9242, 'mean_acc': 0.8317}
Test(class)(new adapter): {'weighted_mean_acc': 0.7507, 'worst_acc': 0.7086, 'acc_0_0': 0.7086, 'acc_0_1': 0.8838, 'acc_1_0': 0.9393, 'acc_1_1': 0.8567, 'mean_acc': 0.8188}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9442, 'acc_0_1': 0.9742, 'acc_1_0': 0.8788, 'acc_1_1': 0.8657, 'mean_acc': 0.9399}
Val(class)(new adapter): {'weighted_mean_acc': 0.7198, 'worst_acc': 0.6453, 'acc_0_0': 0.6453, 'acc_0_1': 0.7983, 'acc_1_0': 0.9701, 'acc_1_1': 0.9394, 'mean_acc': 0.7733}
Test(class)(new adapter): {'weighted_mean_acc': 0.6945, 'worst_acc': 0.6293, 'acc_0_0': 0.6293, 'acc_0_1': 0.8439, 'acc_1_0': 0.9533, 'acc_1_1': 0.8707, 'mean_acc': 0.7755}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.6987, 'worst_acc': 0.6068, 'acc_0_0': 0.6068, 'acc_0_1': 0.8112, 'acc_1_0': 0.9552, 'acc_1_1': 0.9697, 'mean_acc': 0.765}
Test(class)(new adapter): {'weighted_mean_acc': 0.6748, 'worst_acc': 0.6013, 'acc_0_0': 0.6013, 'acc_0_1': 0.843, 'acc_1_0': 0.9548, 'acc_1_1': 0.8738, 'mean_acc': 0.7648}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.927, 'acc_0_1': 0.9742, 'acc_1_0': 0.8788, 'acc_1_1': 0.9552, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.8333, 'worst_acc': 0.8077, 'acc_0_0': 0.8077, 'acc_0_1': 0.867, 'acc_1_0': 0.8955, 'acc_1_1': 0.9091, 'mean_acc': 0.8517}
Test(class)(new adapter): {'weighted_mean_acc': 0.7919, 'worst_acc': 0.7738, 'acc_0_0': 0.7738, 'acc_0_1': 0.8958, 'acc_1_0': 0.9112, 'acc_1_1': 0.8271, 'mean_acc': 0.8424}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8738, 'worst_acc': 0.7879, 'acc_0_0': 0.8974, 'acc_0_1': 0.9442, 'acc_1_0': 0.791, 'acc_1_1': 0.7879, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8743, 'worst_acc': 0.7368, 'acc_0_0': 0.9131, 'acc_0_1': 0.9379, 'acc_1_0': 0.8364, 'acc_1_1': 0.7368, 'mean_acc': 0.8947}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7727, 'acc_0_0': 0.9957, 'acc_0_1': 0.9442, 'acc_1_0': 0.7727, 'acc_1_1': 0.9403, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.8705, 'worst_acc': 0.7424, 'acc_0_0': 0.906, 'acc_0_1': 0.9571, 'acc_1_0': 0.791, 'acc_1_1': 0.7424, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8845, 'worst_acc': 0.6807, 'acc_0_0': 0.9437, 'acc_0_1': 0.9539, 'acc_1_0': 0.8053, 'acc_1_1': 0.6807, 'mean_acc': 0.9032}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8788, 'acc_1_1': 0.9403, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8677, 'worst_acc': 0.7576, 'acc_0_0': 0.8974, 'acc_0_1': 0.9571, 'acc_1_0': 0.791, 'acc_1_1': 0.7576, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.8746, 'worst_acc': 0.6885, 'acc_0_0': 0.9273, 'acc_0_1': 0.9565, 'acc_1_0': 0.8287, 'acc_1_1': 0.6885, 'mean_acc': 0.9013}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9871, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.8619, 'worst_acc': 0.7576, 'acc_0_0': 0.8889, 'acc_0_1': 0.9571, 'acc_1_0': 0.8358, 'acc_1_1': 0.7576, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8584, 'worst_acc': 0.6947, 'acc_0_0': 0.9029, 'acc_0_1': 0.9543, 'acc_1_0': 0.8505, 'acc_1_1': 0.6947, 'mean_acc': 0.894}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.8618, 'worst_acc': 0.7727, 'acc_0_0': 0.8846, 'acc_0_1': 0.9442, 'acc_1_0': 0.8507, 'acc_1_1': 0.7727, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8477, 'worst_acc': 0.7072, 'acc_0_0': 0.8847, 'acc_0_1': 0.9468, 'acc_1_0': 0.8598, 'acc_1_1': 0.7072, 'mean_acc': 0.8864}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9528, 'acc_0_0': 0.9528, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.8685, 'worst_acc': 0.7879, 'acc_0_0': 0.8889, 'acc_0_1': 0.9528, 'acc_1_0': 0.8358, 'acc_1_1': 0.7879, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8528, 'worst_acc': 0.704, 'acc_0_0': 0.8931, 'acc_0_1': 0.9459, 'acc_1_0': 0.838, 'acc_1_1': 0.704, 'mean_acc': 0.8866}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.8709, 'worst_acc': 0.7761, 'acc_0_0': 0.8932, 'acc_0_1': 0.9528, 'acc_1_0': 0.7761, 'acc_1_1': 0.7879, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8707, 'worst_acc': 0.704, 'acc_0_0': 0.918, 'acc_0_1': 0.949, 'acc_1_0': 0.8069, 'acc_1_1': 0.704, 'mean_acc': 0.894}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9828, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9701, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.8835, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8837, 'worst_acc': 0.704, 'acc_0_0': 0.9361, 'acc_0_1': 0.9494, 'acc_1_0': 0.7804, 'acc_1_1': 0.704, 'mean_acc': 0.8983}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8868, 'worst_acc': 0.7612, 'acc_0_0': 0.9103, 'acc_0_1': 0.9614, 'acc_1_0': 0.7612, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8908, 'worst_acc': 0.7274, 'acc_0_0': 0.9392, 'acc_0_1': 0.9446, 'acc_1_0': 0.771, 'acc_1_1': 0.7274, 'mean_acc': 0.8992}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8837, 'worst_acc': 0.7761, 'acc_0_0': 0.906, 'acc_0_1': 0.9571, 'acc_1_0': 0.7761, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8905, 'worst_acc': 0.7383, 'acc_0_0': 0.9357, 'acc_0_1': 0.9397, 'acc_1_0': 0.7788, 'acc_1_1': 0.7383, 'mean_acc': 0.898}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.8831, 'worst_acc': 0.7761, 'acc_0_0': 0.9017, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8883, 'worst_acc': 0.7648, 'acc_0_0': 0.9251, 'acc_0_1': 0.9277, 'acc_1_0': 0.7975, 'acc_1_1': 0.7648, 'mean_acc': 0.8942}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8766, 'worst_acc': 0.7761, 'acc_0_0': 0.8932, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8182, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.7773, 'acc_0_0': 0.9224, 'acc_0_1': 0.9211, 'acc_1_0': 0.8115, 'acc_1_1': 0.7773, 'mean_acc': 0.8935}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.8832, 'worst_acc': 0.7761, 'acc_0_0': 0.8932, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8884, 'worst_acc': 0.7835, 'acc_0_0': 0.9197, 'acc_0_1': 0.9157, 'acc_1_0': 0.8193, 'acc_1_1': 0.7835, 'mean_acc': 0.892}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8799, 'worst_acc': 0.7761, 'acc_0_0': 0.8932, 'acc_0_1': 0.927, 'acc_1_0': 0.7761, 'acc_1_1': 0.8333, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8926, 'worst_acc': 0.7773, 'acc_0_0': 0.9273, 'acc_0_1': 0.9202, 'acc_1_0': 0.8131, 'acc_1_1': 0.7773, 'mean_acc': 0.8952}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.7612, 'acc_0_0': 0.9017, 'acc_0_1': 0.9227, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.7741, 'acc_0_0': 0.9313, 'acc_0_1': 0.9157, 'acc_1_0': 0.8084, 'acc_1_1': 0.7741, 'mean_acc': 0.8942}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8827, 'worst_acc': 0.7463, 'acc_0_0': 0.8974, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.771, 'acc_0_0': 0.9326, 'acc_0_1': 0.9184, 'acc_1_0': 0.8006, 'acc_1_1': 0.771, 'mean_acc': 0.8945}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.7463, 'acc_0_0': 0.906, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8988, 'worst_acc': 0.771, 'acc_0_0': 0.9379, 'acc_0_1': 0.9224, 'acc_1_0': 0.7928, 'acc_1_1': 0.771, 'mean_acc': 0.8973}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8981, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9025, 'worst_acc': 0.7741, 'acc_0_0': 0.9424, 'acc_0_1': 0.9197, 'acc_1_0': 0.7804, 'acc_1_1': 0.7741, 'mean_acc': 0.897}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9013, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9041, 'worst_acc': 0.7773, 'acc_0_0': 0.9437, 'acc_0_1': 0.9162, 'acc_1_0': 0.785, 'acc_1_1': 0.7773, 'mean_acc': 0.897}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9227, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9027, 'worst_acc': 0.7664, 'acc_0_0': 0.945, 'acc_0_1': 0.9193, 'acc_1_0': 0.7773, 'acc_1_1': 0.7664, 'mean_acc': 0.8966}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8947, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8984, 'worst_acc': 0.7508, 'acc_0_0': 0.9437, 'acc_0_1': 0.9246, 'acc_1_0': 0.7726, 'acc_1_1': 0.7508, 'mean_acc': 0.8959}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8923, 'worst_acc': 0.7313, 'acc_0_0': 0.9145, 'acc_0_1': 0.9442, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.743, 'acc_0_0': 0.9437, 'acc_0_1': 0.9286, 'acc_1_0': 0.7726, 'acc_1_1': 0.743, 'mean_acc': 0.8966}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8942, 'worst_acc': 0.715, 'acc_0_0': 0.9481, 'acc_0_1': 0.9388, 'acc_1_0': 0.7617, 'acc_1_1': 0.715, 'mean_acc': 0.898}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8935, 'worst_acc': 0.704, 'acc_0_0': 0.9503, 'acc_0_1': 0.9424, 'acc_1_0': 0.7555, 'acc_1_1': 0.704, 'mean_acc': 0.8983}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.7072, 'acc_0_0': 0.9525, 'acc_0_1': 0.9424, 'acc_1_0': 0.7523, 'acc_1_1': 0.7072, 'mean_acc': 0.8992}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8919, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8966, 'worst_acc': 0.7025, 'acc_0_0': 0.9552, 'acc_0_1': 0.9432, 'acc_1_0': 0.743, 'acc_1_1': 0.7025, 'mean_acc': 0.899}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8921, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9614, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.897, 'worst_acc': 0.7025, 'acc_0_0': 0.9557, 'acc_0_1': 0.945, 'acc_1_0': 0.743, 'acc_1_1': 0.7025, 'mean_acc': 0.8999}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.7056, 'acc_0_0': 0.953, 'acc_0_1': 0.9419, 'acc_1_0': 0.7539, 'acc_1_1': 0.7056, 'mean_acc': 0.8992}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.704, 'acc_0_0': 0.9534, 'acc_0_1': 0.945, 'acc_1_0': 0.7523, 'acc_1_1': 0.704, 'mean_acc': 0.9002}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8918, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.7087, 'acc_0_0': 0.9521, 'acc_0_1': 0.9419, 'acc_1_0': 0.7539, 'acc_1_1': 0.7087, 'mean_acc': 0.8992}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.7165, 'acc_0_0': 0.9481, 'acc_0_1': 0.9388, 'acc_1_0': 0.7632, 'acc_1_1': 0.7165, 'mean_acc': 0.8983}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.7212, 'acc_0_0': 0.9481, 'acc_0_1': 0.9388, 'acc_1_0': 0.7664, 'acc_1_1': 0.7212, 'mean_acc': 0.8992}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8959, 'worst_acc': 0.7181, 'acc_0_0': 0.9494, 'acc_0_1': 0.9392, 'acc_1_0': 0.7617, 'acc_1_1': 0.7181, 'mean_acc': 0.899}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8955, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8949, 'worst_acc': 0.7181, 'acc_0_0': 0.9481, 'acc_0_1': 0.9397, 'acc_1_0': 0.7648, 'acc_1_1': 0.7181, 'mean_acc': 0.899}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8946, 'worst_acc': 0.7134, 'acc_0_0': 0.949, 'acc_0_1': 0.9406, 'acc_1_0': 0.7632, 'acc_1_1': 0.7134, 'mean_acc': 0.899}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9614, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.7087, 'acc_0_0': 0.9521, 'acc_0_1': 0.9415, 'acc_1_0': 0.7555, 'acc_1_1': 0.7087, 'mean_acc': 0.8992}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9614, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.7196, 'acc_0_0': 0.9508, 'acc_0_1': 0.9397, 'acc_1_0': 0.7632, 'acc_1_1': 0.7196, 'mean_acc': 0.9001}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8979, 'worst_acc': 0.7227, 'acc_0_0': 0.9508, 'acc_0_1': 0.9392, 'acc_1_0': 0.7632, 'acc_1_1': 0.7227, 'mean_acc': 0.9002}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9571, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8962, 'worst_acc': 0.7196, 'acc_0_0': 0.9494, 'acc_0_1': 0.9388, 'acc_1_0': 0.7632, 'acc_1_1': 0.7196, 'mean_acc': 0.8992}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9957, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.8891, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.8954, 'worst_acc': 0.7259, 'acc_0_0': 0.9463, 'acc_0_1': 0.9384, 'acc_1_0': 0.7695, 'acc_1_1': 0.7259, 'mean_acc': 0.8992}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8922, 'worst_acc': 0.7313, 'acc_0_0': 0.9231, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8967, 'worst_acc': 0.729, 'acc_0_0': 0.9472, 'acc_0_1': 0.9388, 'acc_1_0': 0.7695, 'acc_1_1': 0.729, 'mean_acc': 0.9001}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8953, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.7879, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.899, 'worst_acc': 0.7352, 'acc_0_0': 0.9486, 'acc_0_1': 0.937, 'acc_1_0': 0.7695, 'acc_1_1': 0.7352, 'mean_acc': 0.9006}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9018, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8987, 'worst_acc': 0.7368, 'acc_0_0': 0.9477, 'acc_0_1': 0.937, 'acc_1_0': 0.771, 'acc_1_1': 0.7368, 'mean_acc': 0.9006}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8956, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9485, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.8989, 'worst_acc': 0.743, 'acc_0_0': 0.9463, 'acc_0_1': 0.9299, 'acc_1_0': 0.7741, 'acc_1_1': 0.743, 'mean_acc': 0.8983}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.7313, 'acc_0_0': 0.9188, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.898, 'worst_acc': 0.7414, 'acc_0_0': 0.9455, 'acc_0_1': 0.9339, 'acc_1_0': 0.7741, 'acc_1_1': 0.7414, 'mean_acc': 0.8994}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8986, 'worst_acc': 0.7313, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7313, 'acc_1_1': 0.803, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8977, 'worst_acc': 0.7336, 'acc_0_0': 0.9472, 'acc_0_1': 0.937, 'acc_1_0': 0.7695, 'acc_1_1': 0.7336, 'mean_acc': 0.8999}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8985, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.7321, 'acc_0_0': 0.9503, 'acc_0_1': 0.9361, 'acc_1_0': 0.7632, 'acc_1_1': 0.7321, 'mean_acc': 0.8999}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.8951, 'worst_acc': 0.7164, 'acc_0_0': 0.9274, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7879, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9011, 'worst_acc': 0.7368, 'acc_0_0': 0.9512, 'acc_0_1': 0.9348, 'acc_1_0': 0.7601, 'acc_1_1': 0.7368, 'mean_acc': 0.8999}
========================================================================
> end of training. 

best epoch : 47
best training accuracy on [class]: {'worst_acc': 0.8485, 'acc_0_0': 0.9657, 'acc_0_1': 0.9056, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9299}
best validation accuracy on [class]: {'weighted_mean_acc': 0.8651, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8939, 'mean_acc': 0.8767}
best test accuracy on [class]: {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8458, 'acc_0_0': 0.8758, 'acc_0_1': 0.9002, 'acc_1_0': 0.9003, 'acc_1_1': 0.8458, 'mean_acc': 0.8847}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8458, 'acc_0_0': 0.8758, 'acc_0_1': 0.9002, 'acc_1_0': 0.9003, 'acc_1_1': 0.8458, 'mean_acc': 0.8847}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.8287, 'acc_0_0': 0.9796, 'acc_0_1': 0.8807, 'acc_1_0': 0.8287, 'acc_1_1': 0.9564, 'mean_acc': 0.9218}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 47': {'Train': {'worst_acc': 0.8485, 'acc_0_0': 0.9657, 'acc_0_1': 0.9056, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.9299}, 'Val': {'weighted_mean_acc': 0.8651, 'worst_acc': 0.8547, 'acc_0_0': 0.8547, 'acc_0_1': 0.8884, 'acc_1_0': 0.8955, 'acc_1_1': 0.8939, 'mean_acc': 0.8767}, 'Test': {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8458, 'acc_0_0': 0.8758, 'acc_0_1': 0.9002, 'acc_1_0': 0.9003, 'acc_1_1': 0.8458, 'mean_acc': 0.8847}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8704, 'worst_acc': 0.8458, 'acc_0_0': 0.8758, 'acc_0_1': 0.9002, 'acc_1_0': 0.9003, 'acc_1_1': 0.8458, 'mean_acc': 0.8847}, 'spurious': {'weighted_mean_acc': 0.9689, 'worst_acc': 0.8287, 'acc_0_0': 0.9796, 'acc_0_1': 0.8807, 'acc_1_0': 0.8287, 'acc_1_1': 0.9564, 'mean_acc': 0.9218}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.8677     0.8612   0.8612  ...   0.8879   0.8879    0.8700
2                       0.8564     0.8492   0.8492  ...   0.8941   0.8785    0.8597
3                       0.8704     0.8458   0.8758  ...   0.9003   0.8458    0.8847
test_mean               0.8648     0.8521   0.8621  ...   0.8941   0.8707    0.8715
test_std                0.0061     0.0066   0.0109  ...   0.0051   0.0180    0.0103
1                       0.9598     0.6449   0.9592  ...   0.6449   0.9860    0.9111
2                       0.9651     0.7352   0.9641  ...   0.7352   0.9844    0.9330
3                       0.9689     0.8287   0.9796  ...   0.8287   0.9564    0.9218
zs_spu_mean             0.9646     0.7363   0.9676  ...   0.7363   0.9756    0.9220
zs_spu_std              0.0037     0.0750   0.0087  ...   0.0750   0.0136    0.0089
1                          NaN     0.9185   0.9185  ...   0.9242   0.9701    0.9332
2                          NaN     0.8806   0.8884  ...   0.9697   0.8806    0.9165
3                          NaN     0.8485   0.9657  ...   0.8485   0.9701    0.9299
tr_mean                    NaN     0.8825   0.9242  ...   0.9141   0.9403    0.9265
tr_std                     NaN     0.0286   0.0318  ...   0.0500   0.0422    0.0072
1                       0.8796     0.8358   0.8675  ...   0.8358   0.9242    0.8700
2                       0.8721     0.8455   0.8718  ...   0.8507   0.8788    0.8600
3                       0.8651     0.8547   0.8547  ...   0.8955   0.8939    0.8767
val_mean                0.8723     0.8453   0.8647  ...   0.8607   0.8990    0.8689
val_std                 0.0059     0.0077   0.0073  ...   0.0254   0.0189    0.0069
1                       0.8677     0.8612   0.8612  ...   0.8879   0.8879    0.8700
2                       0.8564     0.8492   0.8492  ...   0.8941   0.8785    0.8597
3                       0.8704     0.8458   0.8758  ...   0.9003   0.8458    0.8847
zs_tg_mean              0.8648     0.8521   0.8621  ...   0.8941   0.8707    0.8715
zs_tg_std               0.0061     0.0066   0.0109  ...   0.0051   0.0180    0.0103

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_1.0_lrr1.0_bsr512_MA+rn.csv
random seeds :  [42, 32, 22]
f=============Iteration : 1/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.122, 'acc_0_0': 0.9265, 'acc_0_1': 0.9348, 'acc_1_0': 0.1607, 'acc_1_1': 0.122, 'mean_acc': 0.7406}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7677, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7767}
Test(class): {'weighted_mean_acc': 0.7685, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 0.9969, 'acc_1_0': 0.0, 'acc_1_1': 0.0031, 'mean_acc': 0.7775}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9771, 'acc_0_1': 0.4783, 'acc_1_0': 0.3393, 'acc_1_1': 0.7465, 'mean_acc': 0.8997}
Val(class): {'weighted_mean_acc': 0.9494, 'worst_acc': 0.2961, 'acc_0_0': 0.9786, 'acc_0_1': 0.2961, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.6717}
Test(class): {'weighted_mean_acc': 0.9409, 'worst_acc': 0.247, 'acc_0_0': 0.9734, 'acc_0_1': 0.247, 'acc_1_0': 0.5732, 'acc_1_1': 0.9735, 'mean_acc': 0.6464}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3036, 'acc_0_0': 0.994, 'acc_0_1': 0.462, 'acc_1_0': 0.3036, 'acc_1_1': 0.9234, 'mean_acc': 0.9499}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.209, 'acc_0_0': 1.0, 'acc_0_1': 0.6996, 'acc_1_0': 0.209, 'acc_1_1': 0.9091, 'mean_acc': 0.785}
Test(class): {'weighted_mean_acc': 0.9488, 'worst_acc': 0.2259, 'acc_0_0': 0.9996, 'acc_0_1': 0.6341, 'acc_1_0': 0.2259, 'acc_1_1': 0.8738, 'mean_acc': 0.7577}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.2321, 'acc_0_0': 0.9986, 'acc_0_1': 0.6359, 'acc_1_0': 0.2321, 'acc_1_1': 0.8581, 'mean_acc': 0.9447}
Val(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.2985, 'acc_0_0': 1.0, 'acc_0_1': 0.7124, 'acc_1_0': 0.2985, 'acc_1_1': 0.9242, 'mean_acc': 0.8017}
Test(class): {'weighted_mean_acc': 0.9569, 'worst_acc': 0.3598, 'acc_0_0': 0.9987, 'acc_0_1': 0.6328, 'acc_1_0': 0.3598, 'acc_1_1': 0.9065, 'mean_acc': 0.7753}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4674, 'acc_0_0': 0.99, 'acc_0_1': 0.4674, 'acc_1_0': 0.5893, 'acc_1_1': 0.9612, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.3881, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.3881, 'acc_1_1': 0.9545, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9582, 'worst_acc': 0.4688, 'acc_0_0': 0.9951, 'acc_0_1': 0.6488, 'acc_1_0': 0.4688, 'acc_1_1': 0.9159, 'mean_acc': 0.7932}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9857, 'acc_0_1': 0.5109, 'acc_1_0': 0.6607, 'acc_1_1': 0.964, 'mean_acc': 0.9589}
Val(class): {'weighted_mean_acc': 0.962, 'worst_acc': 0.3284, 'acc_0_0': 1.0, 'acc_0_1': 0.824, 'acc_1_0': 0.3284, 'acc_1_1': 0.8939, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9568, 'worst_acc': 0.4361, 'acc_0_0': 0.9969, 'acc_0_1': 0.8115, 'acc_1_0': 0.4361, 'acc_1_1': 0.8769, 'mean_acc': 0.8493}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.99, 'acc_0_1': 0.712, 'acc_1_0': 0.6071, 'acc_1_1': 0.9338, 'mean_acc': 0.9625}
Val(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.3731, 'acc_0_0': 1.0, 'acc_0_1': 0.8455, 'acc_1_0': 0.3731, 'acc_1_1': 0.8788, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.4486, 'acc_0_0': 0.996, 'acc_0_1': 0.855, 'acc_1_0': 0.4486, 'acc_1_1': 0.866, 'mean_acc': 0.8661}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7391, 'acc_1_0': 0.625, 'acc_1_1': 0.929, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9716, 'worst_acc': 0.5224, 'acc_0_0': 0.9957, 'acc_0_1': 0.7468, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.581, 'acc_0_0': 0.9902, 'acc_0_1': 0.7038, 'acc_1_0': 0.581, 'acc_1_1': 0.9299, 'mean_acc': 0.8267}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.9866, 'acc_0_1': 0.6359, 'acc_1_0': 0.6964, 'acc_1_1': 0.9574, 'mean_acc': 0.9633}
Val(class): {'weighted_mean_acc': 0.9744, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6269, 'acc_1_1': 1.0, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.955, 'worst_acc': 0.5508, 'acc_0_0': 0.984, 'acc_0_1': 0.5508, 'acc_1_0': 0.6511, 'acc_1_1': 0.9455, 'mean_acc': 0.7742}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9886, 'acc_0_1': 0.625, 'acc_1_0': 0.6607, 'acc_1_1': 0.9593, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.9741, 'worst_acc': 0.5923, 'acc_0_0': 0.9915, 'acc_0_1': 0.5923, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.8}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.5401, 'acc_0_0': 0.9858, 'acc_0_1': 0.5401, 'acc_1_0': 0.6417, 'acc_1_1': 0.9517, 'mean_acc': 0.7705}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9937, 'acc_0_1': 0.6957, 'acc_1_0': 0.625, 'acc_1_1': 0.9565, 'mean_acc': 0.9698}
Val(class): {'weighted_mean_acc': 0.9731, 'worst_acc': 0.5665, 'acc_0_0': 0.9915, 'acc_0_1': 0.5665, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.79}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.5042, 'acc_0_0': 0.9845, 'acc_0_1': 0.5042, 'acc_1_0': 0.6511, 'acc_1_1': 0.9564, 'mean_acc': 0.7575}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.6739, 'acc_1_0': 0.6071, 'acc_1_1': 0.9603, 'mean_acc': 0.9693}
Val(class): {'weighted_mean_acc': 0.9705, 'worst_acc': 0.4893, 'acc_0_0': 0.9915, 'acc_0_1': 0.4893, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7633}
Test(class): {'weighted_mean_acc': 0.9525, 'worst_acc': 0.4381, 'acc_0_0': 0.9814, 'acc_0_1': 0.4381, 'acc_1_0': 0.6807, 'acc_1_1': 0.9611, 'mean_acc': 0.7344}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6087, 'acc_0_0': 0.9911, 'acc_0_1': 0.6087, 'acc_1_0': 0.6607, 'acc_1_1': 0.9707, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5322, 'acc_0_0': 0.9915, 'acc_0_1': 0.5322, 'acc_1_0': 0.6716, 'acc_1_1': 1.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.9547, 'worst_acc': 0.4878, 'acc_0_0': 0.9823, 'acc_0_1': 0.4878, 'acc_1_0': 0.6729, 'acc_1_1': 0.9595, 'mean_acc': 0.753}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9929, 'acc_0_1': 0.6902, 'acc_1_0': 0.6607, 'acc_1_1': 0.9688, 'mean_acc': 0.9721}
Val(class): {'weighted_mean_acc': 0.9742, 'worst_acc': 0.5966, 'acc_0_0': 0.9957, 'acc_0_1': 0.5966, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9559, 'worst_acc': 0.5627, 'acc_0_0': 0.9836, 'acc_0_1': 0.5627, 'acc_1_0': 0.6589, 'acc_1_1': 0.9486, 'mean_acc': 0.7799}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.6359, 'acc_0_0': 0.992, 'acc_0_1': 0.6359, 'acc_1_0': 0.7321, 'acc_1_1': 0.9726, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.5794, 'acc_0_0': 0.9915, 'acc_0_1': 0.5794, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.545, 'acc_0_0': 0.9818, 'acc_0_1': 0.545, 'acc_1_0': 0.6822, 'acc_1_1': 0.9564, 'mean_acc': 0.7758}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6685, 'acc_0_0': 0.9926, 'acc_0_1': 0.6685, 'acc_1_0': 0.7679, 'acc_1_1': 0.9726, 'mean_acc': 0.9731}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6137, 'acc_0_0': 0.9915, 'acc_0_1': 0.6137, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.81}
Test(class): {'weighted_mean_acc': 0.9557, 'worst_acc': 0.5765, 'acc_0_0': 0.9827, 'acc_0_1': 0.5765, 'acc_1_0': 0.6822, 'acc_1_1': 0.947, 'mean_acc': 0.7874}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7011, 'acc_0_0': 0.9929, 'acc_0_1': 0.7011, 'acc_1_0': 0.75, 'acc_1_1': 0.9688, 'mean_acc': 0.9735}
Val(class): {'weighted_mean_acc': 0.9718, 'worst_acc': 0.6094, 'acc_0_0': 0.9915, 'acc_0_1': 0.6094, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9561, 'worst_acc': 0.5583, 'acc_0_0': 0.9823, 'acc_0_1': 0.5583, 'acc_1_0': 0.6807, 'acc_1_1': 0.9533, 'mean_acc': 0.7806}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6793, 'acc_0_0': 0.9931, 'acc_0_1': 0.6793, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9743}
Val(class): {'weighted_mean_acc': 0.9686, 'worst_acc': 0.6223, 'acc_0_0': 0.9915, 'acc_0_1': 0.6223, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.588, 'acc_0_0': 0.9845, 'acc_0_1': 0.588, 'acc_1_0': 0.6729, 'acc_1_1': 0.9455, 'mean_acc': 0.7913}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.7857, 'acc_1_1': 0.9754, 'mean_acc': 0.9754}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6481, 'acc_0_0': 0.9915, 'acc_0_1': 0.6481, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6164, 'acc_0_0': 0.9863, 'acc_0_1': 0.6164, 'acc_1_0': 0.6667, 'acc_1_1': 0.9455, 'mean_acc': 0.8024}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7174, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.7679, 'acc_1_1': 0.9669, 'mean_acc': 0.9758}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6652, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6341, 'acc_0_0': 0.9876, 'acc_0_1': 0.6341, 'acc_1_0': 0.6667, 'acc_1_1': 0.9424, 'mean_acc': 0.8095}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7337, 'acc_0_0': 0.9943, 'acc_0_1': 0.7337, 'acc_1_0': 0.7679, 'acc_1_1': 0.9745, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9706, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.6511, 'acc_0_0': 0.988, 'acc_0_1': 0.6554, 'acc_1_0': 0.6511, 'acc_1_1': 0.9408, 'mean_acc': 0.816}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7663, 'acc_0_0': 0.9957, 'acc_0_1': 0.7663, 'acc_1_0': 0.7679, 'acc_1_1': 0.9697, 'mean_acc': 0.9785}
Val(class): {'weighted_mean_acc': 0.9734, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6381, 'acc_0_0': 0.9863, 'acc_0_1': 0.6381, 'acc_1_0': 0.6558, 'acc_1_1': 0.9486, 'mean_acc': 0.81}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.994, 'acc_0_1': 0.7283, 'acc_1_0': 0.7857, 'acc_1_1': 0.9763, 'mean_acc': 0.9775}
Val(class): {'weighted_mean_acc': 0.9696, 'worst_acc': 0.6438, 'acc_0_0': 0.9872, 'acc_0_1': 0.6438, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6266, 'acc_0_0': 0.9867, 'acc_0_1': 0.6266, 'acc_1_0': 0.6558, 'acc_1_1': 0.947, 'mean_acc': 0.8055}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9966, 'acc_0_1': 0.7826, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9707, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6824, 'acc_1_0': 0.6418, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9624, 'worst_acc': 0.6293, 'acc_0_0': 0.9889, 'acc_0_1': 0.6741, 'acc_1_0': 0.6293, 'acc_1_1': 0.9424, 'mean_acc': 0.8214}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9943, 'acc_0_1': 0.75, 'acc_1_0': 0.8571, 'acc_1_1': 0.9773, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9739, 'worst_acc': 0.6418, 'acc_0_0': 0.9915, 'acc_0_1': 0.6781, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9615, 'worst_acc': 0.6402, 'acc_0_0': 0.9876, 'acc_0_1': 0.6727, 'acc_1_0': 0.6402, 'acc_1_1': 0.9424, 'mean_acc': 0.8215}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.8207, 'acc_0_0': 0.9963, 'acc_0_1': 0.8207, 'acc_1_0': 0.8214, 'acc_1_1': 0.9603, 'mean_acc': 0.9796}
Val(class): {'weighted_mean_acc': 0.9678, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6781, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.9619, 'worst_acc': 0.6589, 'acc_0_0': 0.9871, 'acc_0_1': 0.6692, 'acc_1_0': 0.6589, 'acc_1_1': 0.9455, 'mean_acc': 0.8224}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.7283, 'acc_0_0': 0.9946, 'acc_0_1': 0.7283, 'acc_1_0': 0.8929, 'acc_1_1': 0.982, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.967, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.6567, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6355, 'acc_0_0': 0.9867, 'acc_0_1': 0.6355, 'acc_1_0': 0.6495, 'acc_1_1': 0.9455, 'mean_acc': 0.8081}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.75, 'acc_1_1': 0.9716, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.7253, 'acc_1_0': 0.6418, 'acc_1_1': 0.9394, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9629, 'worst_acc': 0.6215, 'acc_0_0': 0.9898, 'acc_0_1': 0.7091, 'acc_1_0': 0.6215, 'acc_1_1': 0.9361, 'mean_acc': 0.8338}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8152, 'acc_0_0': 0.9966, 'acc_0_1': 0.8152, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9848}
Val(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5622, 'acc_0_0': 0.9786, 'acc_0_1': 0.5622, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9558, 'worst_acc': 0.5481, 'acc_0_0': 0.9823, 'acc_0_1': 0.5481, 'acc_1_0': 0.69, 'acc_1_1': 0.9533, 'mean_acc': 0.7777}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.788, 'acc_0_0': 0.996, 'acc_0_1': 0.788, 'acc_1_0': 0.8036, 'acc_1_1': 0.9773, 'mean_acc': 0.9816}
Val(class): {'weighted_mean_acc': 0.9674, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.6542, 'acc_0_0': 0.9876, 'acc_0_1': 0.6621, 'acc_1_0': 0.6542, 'acc_1_1': 0.9393, 'mean_acc': 0.8186}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.7772, 'acc_0_0': 0.9951, 'acc_0_1': 0.7772, 'acc_1_0': 0.8929, 'acc_1_1': 0.983, 'mean_acc': 0.9829}
Val(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.6738, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.9617, 'worst_acc': 0.662, 'acc_0_0': 0.988, 'acc_0_1': 0.6812, 'acc_1_0': 0.662, 'acc_1_1': 0.9393, 'mean_acc': 0.8271}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.913, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.9612, 'worst_acc': 0.588, 'acc_0_0': 0.9872, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 0.9545, 'mean_acc': 0.795}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5969, 'acc_0_0': 0.9885, 'acc_0_1': 0.5969, 'acc_1_0': 0.6308, 'acc_1_1': 0.9486, 'mean_acc': 0.792}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.998, 'acc_0_1': 0.8424, 'acc_1_0': 0.7857, 'acc_1_1': 0.9877, 'mean_acc': 0.9873}
Val(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.6464, 'acc_0_0': 0.9871, 'acc_0_1': 0.7419, 'acc_1_0': 0.6464, 'acc_1_1': 0.9237, 'mean_acc': 0.8469}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8641, 'acc_0_0': 0.9957, 'acc_0_1': 0.8641, 'acc_1_0': 0.9107, 'acc_1_1': 0.9858, 'mean_acc': 0.9875}
Val(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7082, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5701, 'acc_0_0': 0.9925, 'acc_0_1': 0.69, 'acc_1_0': 0.5701, 'acc_1_1': 0.9237, 'mean_acc': 0.8203}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.998, 'acc_0_1': 0.8913, 'acc_1_0': 0.875, 'acc_1_1': 0.9792, 'mean_acc': 0.9883}
Val(class): {'weighted_mean_acc': 0.9607, 'worst_acc': 0.6418, 'acc_0_0': 0.9872, 'acc_0_1': 0.7639, 'acc_1_0': 0.6418, 'acc_1_1': 0.9242, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9606, 'worst_acc': 0.634, 'acc_0_0': 0.988, 'acc_0_1': 0.7698, 'acc_1_0': 0.634, 'acc_1_1': 0.9206, 'mean_acc': 0.8564}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9963, 'acc_0_1': 0.9239, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6269, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9632, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.7317, 'acc_1_0': 0.5545, 'acc_1_1': 0.9252, 'mean_acc': 0.8353}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8913, 'acc_0_0': 0.9974, 'acc_0_1': 0.8913, 'acc_1_0': 0.9286, 'acc_1_1': 0.983, 'mean_acc': 0.9894}
Val(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6567, 'acc_1_1': 0.9242, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.5997, 'acc_0_0': 0.9863, 'acc_0_1': 0.7375, 'acc_1_0': 0.5997, 'acc_1_1': 0.9252, 'mean_acc': 0.8398}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9575, 'worst_acc': 0.6716, 'acc_0_0': 0.9786, 'acc_0_1': 0.7468, 'acc_1_0': 0.6716, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9577, 'worst_acc': 0.6558, 'acc_0_0': 0.9836, 'acc_0_1': 0.7353, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8443}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9991, 'acc_0_1': 0.9728, 'acc_1_0': 0.9464, 'acc_1_1': 0.9801, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.588, 'acc_0_0': 0.9658, 'acc_0_1': 0.588, 'acc_1_0': 0.6866, 'acc_1_1': 1.0, 'mean_acc': 0.7917}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5787, 'acc_0_0': 0.9792, 'acc_0_1': 0.5787, 'acc_1_0': 0.6963, 'acc_1_1': 0.9548, 'mean_acc': 0.7893}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4848, 'acc_0_0': 0.9957, 'acc_0_1': 0.6824, 'acc_1_0': 0.4848, 'acc_1_1': 0.9403, 'mean_acc': 0.8114}
Val(class)(new adapter): {'weighted_mean_acc': 0.7918, 'worst_acc': 0.1061, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.3731, 'acc_1_1': 0.1061, 'mean_acc': 0.8233}
Test(class)(new adapter): {'weighted_mean_acc': 0.7999, 'worst_acc': 0.1308, 'acc_0_0': 0.9982, 'acc_0_1': 0.9925, 'acc_1_0': 0.4081, 'acc_1_1': 0.1308, 'mean_acc': 0.8345}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0746, 'acc_0_0': 0.9614, 'acc_0_1': 0.1116, 'acc_1_0': 0.1818, 'acc_1_1': 0.0746, 'mean_acc': 0.4457}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.1588, 'acc_0_0': 0.9145, 'acc_0_1': 0.1588, 'acc_1_0': 0.8657, 'acc_1_1': 1.0, 'mean_acc': 0.625}
Test(class)(new adapter): {'weighted_mean_acc': 0.8925, 'worst_acc': 0.1459, 'acc_0_0': 0.9011, 'acc_0_1': 0.1459, 'acc_1_0': 0.8676, 'acc_1_1': 0.9953, 'mean_acc': 0.6139}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.382, 'acc_0_0': 0.9442, 'acc_0_1': 0.382, 'acc_1_0': 0.6667, 'acc_1_1': 0.9701, 'mean_acc': 0.6978}
Val(class)(new adapter): {'weighted_mean_acc': 0.9287, 'worst_acc': 0.7597, 'acc_0_0': 0.9359, 'acc_0_1': 0.7597, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.8567}
Test(class)(new adapter): {'weighted_mean_acc': 0.9318, 'worst_acc': 0.7308, 'acc_0_0': 0.9419, 'acc_0_1': 0.7308, 'acc_1_0': 0.8458, 'acc_1_1': 0.9377, 'mean_acc': 0.8486}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0746, 'acc_0_0': 0.7897, 'acc_0_1': 0.9442, 'acc_1_0': 0.7424, 'acc_1_1': 0.0746, 'mean_acc': 0.7646}
Val(class)(new adapter): {'weighted_mean_acc': 0.9012, 'worst_acc': 0.7727, 'acc_0_0': 0.9402, 'acc_0_1': 0.9356, 'acc_1_0': 0.7761, 'acc_1_1': 0.7727, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7679, 'acc_0_0': 0.9481, 'acc_0_1': 0.9512, 'acc_1_0': 0.8318, 'acc_1_1': 0.7679, 'mean_acc': 0.9165}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7015, 'acc_0_0': 0.97, 'acc_0_1': 0.9914, 'acc_1_0': 0.7879, 'acc_1_1': 0.7015, 'mean_acc': 0.9282}
Val(class)(new adapter): {'weighted_mean_acc': 0.8852, 'worst_acc': 0.6818, 'acc_0_0': 0.9444, 'acc_0_1': 0.9571, 'acc_1_0': 0.791, 'acc_1_1': 0.6818, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8945, 'worst_acc': 0.6698, 'acc_0_0': 0.9596, 'acc_0_1': 0.9721, 'acc_1_0': 0.8115, 'acc_1_1': 0.6698, 'mean_acc': 0.9159}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0299, 'acc_0_0': 0.9185, 'acc_0_1': 0.9185, 'acc_1_0': 0.7879, 'acc_1_1': 0.0299, 'mean_acc': 0.8047}
Val(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8442, 'acc_0_0': 0.949, 'acc_0_1': 0.9171, 'acc_1_0': 0.8442, 'acc_1_1': 0.8442, 'mean_acc': 0.9134}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.7576, 'acc_1_1': 0.8507, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7639, 'acc_0_0': 0.9274, 'acc_0_1': 0.7639, 'acc_1_0': 0.8657, 'acc_1_1': 0.9394, 'mean_acc': 0.8583}
Test(class)(new adapter): {'weighted_mean_acc': 0.918, 'worst_acc': 0.7743, 'acc_0_0': 0.922, 'acc_0_1': 0.7743, 'acc_1_0': 0.8583, 'acc_1_1': 0.933, 'mean_acc': 0.8586}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.897, 'acc_0_1': 0.927, 'acc_1_0': 0.8636, 'acc_1_1': 0.403, 'mean_acc': 0.8497}
Val(class)(new adapter): {'weighted_mean_acc': 0.8978, 'worst_acc': 0.5794, 'acc_0_0': 0.8932, 'acc_0_1': 0.5794, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.7783}
Test(class)(new adapter): {'weighted_mean_acc': 0.8864, 'worst_acc': 0.5765, 'acc_0_0': 0.8798, 'acc_0_1': 0.5765, 'acc_1_0': 0.8769, 'acc_1_1': 0.9626, 'mean_acc': 0.7706}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.803, 'acc_0_0': 0.9571, 'acc_0_1': 0.8798, 'acc_1_0': 0.803, 'acc_1_1': 0.9701, 'mean_acc': 0.9115}
Val(class)(new adapter): {'weighted_mean_acc': 0.8847, 'worst_acc': 0.5579, 'acc_0_0': 0.8761, 'acc_0_1': 0.5579, 'acc_1_0': 0.8955, 'acc_1_1': 0.9697, 'mean_acc': 0.765}
Test(class)(new adapter): {'weighted_mean_acc': 0.8691, 'worst_acc': 0.5517, 'acc_0_0': 0.8554, 'acc_0_1': 0.5517, 'acc_1_0': 0.8863, 'acc_1_1': 0.9688, 'mean_acc': 0.7532}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7597, 'acc_0_0': 0.7597, 'acc_0_1': 0.9914, 'acc_1_0': 0.8333, 'acc_1_1': 0.8209, 'mean_acc': 0.8648}
Val(class)(new adapter): {'weighted_mean_acc': 0.8927, 'worst_acc': 0.5322, 'acc_0_0': 0.8889, 'acc_0_1': 0.5322, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7567}
Test(class)(new adapter): {'weighted_mean_acc': 0.8863, 'worst_acc': 0.5636, 'acc_0_0': 0.8789, 'acc_0_1': 0.5636, 'acc_1_0': 0.8801, 'acc_1_1': 0.9673, 'mean_acc': 0.7661}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9914, 'acc_0_1': 0.97, 'acc_1_0': 0.7424, 'acc_1_1': 0.9254, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.8995, 'worst_acc': 0.5451, 'acc_0_0': 0.8974, 'acc_0_1': 0.5451, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.765}
Test(class)(new adapter): {'weighted_mean_acc': 0.8899, 'worst_acc': 0.5725, 'acc_0_0': 0.8834, 'acc_0_1': 0.5725, 'acc_1_0': 0.8801, 'acc_1_1': 0.9673, 'mean_acc': 0.7713}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.9356, 'acc_0_1': 0.9657, 'acc_1_0': 0.803, 'acc_1_1': 0.791, 'mean_acc': 0.9165}
Val(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.5408, 'acc_0_0': 0.9103, 'acc_0_1': 0.5408, 'acc_1_0': 0.8657, 'acc_1_1': 0.9848, 'mean_acc': 0.77}
Test(class)(new adapter): {'weighted_mean_acc': 0.8899, 'worst_acc': 0.5379, 'acc_0_0': 0.8851, 'acc_0_1': 0.5379, 'acc_1_0': 0.8801, 'acc_1_1': 0.9673, 'mean_acc': 0.7585}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7424, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.7424, 'acc_1_1': 0.9254, 'mean_acc': 0.9533}
Val(class)(new adapter): {'weighted_mean_acc': 0.9092, 'worst_acc': 0.5536, 'acc_0_0': 0.9103, 'acc_0_1': 0.5536, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7733}
Test(class)(new adapter): {'weighted_mean_acc': 0.891, 'worst_acc': 0.5783, 'acc_0_0': 0.8847, 'acc_0_1': 0.5783, 'acc_1_0': 0.8754, 'acc_1_1': 0.9673, 'mean_acc': 0.7736}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8209, 'acc_0_0': 0.9571, 'acc_0_1': 0.9442, 'acc_1_0': 0.8485, 'acc_1_1': 0.8209, 'mean_acc': 0.9249}
Val(class)(new adapter): {'weighted_mean_acc': 0.9179, 'worst_acc': 0.618, 'acc_0_0': 0.9188, 'acc_0_1': 0.618, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.8017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8969, 'worst_acc': 0.6435, 'acc_0_0': 0.8927, 'acc_0_1': 0.6435, 'acc_1_0': 0.8692, 'acc_1_1': 0.9564, 'mean_acc': 0.8001}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9914, 'acc_0_1': 0.9657, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7082, 'acc_0_0': 0.9274, 'acc_0_1': 0.7082, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.7424, 'acc_0_0': 0.9038, 'acc_0_1': 0.7424, 'acc_1_0': 0.8583, 'acc_1_1': 0.9424, 'mean_acc': 0.8402}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9356, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.8358, 'mean_acc': 0.9316}
Val(class)(new adapter): {'weighted_mean_acc': 0.9199, 'worst_acc': 0.7897, 'acc_0_0': 0.9316, 'acc_0_1': 0.7897, 'acc_1_0': 0.8209, 'acc_1_1': 0.9091, 'mean_acc': 0.8617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.812, 'acc_0_0': 0.9162, 'acc_0_1': 0.812, 'acc_1_0': 0.8396, 'acc_1_1': 0.9003, 'mean_acc': 0.8654}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.8636, 'acc_1_1': 0.9403, 'mean_acc': 0.9699}
Val(class)(new adapter): {'weighted_mean_acc': 0.9178, 'worst_acc': 0.806, 'acc_0_0': 0.9359, 'acc_0_1': 0.8326, 'acc_1_0': 0.806, 'acc_1_1': 0.8788, 'mean_acc': 0.875}
Test(class)(new adapter): {'weighted_mean_acc': 0.9118, 'worst_acc': 0.8287, 'acc_0_0': 0.9282, 'acc_0_1': 0.863, 'acc_1_0': 0.8287, 'acc_1_1': 0.8707, 'mean_acc': 0.8854}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9313, 'acc_0_1': 0.9785, 'acc_1_0': 0.8788, 'acc_1_1': 0.806, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.791, 'acc_0_0': 0.9359, 'acc_0_1': 0.8584, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9192, 'worst_acc': 0.8053, 'acc_0_0': 0.941, 'acc_0_1': 0.8803, 'acc_1_0': 0.8053, 'acc_1_1': 0.8598, 'mean_acc': 0.8933}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.867, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7944, 'acc_0_0': 0.9481, 'acc_0_1': 0.8834, 'acc_1_0': 0.7944, 'acc_1_1': 0.8567, 'mean_acc': 0.8958}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9571, 'acc_0_1': 0.9785, 'acc_1_0': 0.9091, 'acc_1_1': 0.8358, 'mean_acc': 0.9466}
Val(class)(new adapter): {'weighted_mean_acc': 0.9282, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.8712, 'acc_1_0': 0.7463, 'acc_1_1': 0.8939, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.931, 'worst_acc': 0.785, 'acc_0_0': 0.9561, 'acc_0_1': 0.8714, 'acc_1_0': 0.785, 'acc_1_1': 0.866, 'mean_acc': 0.8942}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 0.9828, 'acc_1_0': 0.8485, 'acc_1_1': 1.0, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9278, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.8712, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9355, 'worst_acc': 0.7741, 'acc_0_0': 0.961, 'acc_0_1': 0.8727, 'acc_1_0': 0.7741, 'acc_1_1': 0.8707, 'mean_acc': 0.8959}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9828, 'acc_0_1': 0.97, 'acc_1_0': 0.8939, 'acc_1_1': 0.8955, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9311, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.8755, 'acc_1_0': 0.7164, 'acc_1_1': 0.8939, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9363, 'worst_acc': 0.7601, 'acc_0_0': 0.9636, 'acc_0_1': 0.8816, 'acc_1_0': 0.7601, 'acc_1_1': 0.8645, 'mean_acc': 0.8982}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.8485, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9284, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.8927, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9347, 'worst_acc': 0.7601, 'acc_0_0': 0.9654, 'acc_0_1': 0.8976, 'acc_1_0': 0.7601, 'acc_1_1': 0.8489, 'mean_acc': 0.9033}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9828, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9683}
Val(class)(new adapter): {'weighted_mean_acc': 0.9288, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9013, 'acc_1_0': 0.7164, 'acc_1_1': 0.8788, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9301, 'worst_acc': 0.7632, 'acc_0_0': 0.9623, 'acc_0_1': 0.9149, 'acc_1_0': 0.7632, 'acc_1_1': 0.8349, 'mean_acc': 0.9077}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8485, 'acc_1_1': 0.9851, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7164, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9185, 'worst_acc': 0.7757, 'acc_0_0': 0.9583, 'acc_0_1': 0.9264, 'acc_1_0': 0.7757, 'acc_1_1': 0.7928, 'mean_acc': 0.9073}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.8939, 'acc_1_1': 0.9552, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.7773, 'acc_0_0': 0.9525, 'acc_0_1': 0.9277, 'acc_1_0': 0.785, 'acc_1_1': 0.7773, 'mean_acc': 0.9049}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9001, 'worst_acc': 0.7164, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.803, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9006, 'worst_acc': 0.7508, 'acc_0_0': 0.9459, 'acc_0_1': 0.9326, 'acc_1_0': 0.7897, 'acc_1_1': 0.7508, 'mean_acc': 0.9018}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9099, 'acc_0_1': 0.9957, 'acc_1_0': 0.8182, 'acc_1_1': 0.9403, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.8972, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9313, 'acc_1_0': 0.7164, 'acc_1_1': 0.7727, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9029, 'worst_acc': 0.7243, 'acc_0_0': 0.957, 'acc_0_1': 0.9419, 'acc_1_0': 0.7664, 'acc_1_1': 0.7243, 'mean_acc': 0.9042}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9035, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.7424, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.8964, 'worst_acc': 0.6589, 'acc_0_0': 0.9676, 'acc_0_1': 0.9565, 'acc_1_0': 0.7321, 'acc_1_1': 0.6589, 'mean_acc': 0.903}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9871, 'acc_0_1': 0.9657, 'acc_1_0': 0.9394, 'acc_1_1': 0.8358, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9003, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.7273, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9019, 'worst_acc': 0.6589, 'acc_0_0': 0.9752, 'acc_0_1': 0.9614, 'acc_1_0': 0.7134, 'acc_1_1': 0.6589, 'mean_acc': 0.9058}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.8485, 'acc_1_1': 0.9701, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9071, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9528, 'acc_1_0': 0.7164, 'acc_1_1': 0.7576, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9056, 'worst_acc': 0.6776, 'acc_0_0': 0.9747, 'acc_0_1': 0.961, 'acc_1_0': 0.7072, 'acc_1_1': 0.6776, 'mean_acc': 0.9068}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9657, 'acc_1_0': 0.9091, 'acc_1_1': 0.9104, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9485, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.729, 'acc_0_0': 0.9716, 'acc_0_1': 0.9525, 'acc_1_0': 0.7321, 'acc_1_1': 0.729, 'mean_acc': 0.9108}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.8636, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9271, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9117}
Test(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7555, 'acc_0_0': 0.9676, 'acc_0_1': 0.9428, 'acc_1_0': 0.7555, 'acc_1_1': 0.7773, 'mean_acc': 0.9134}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9273, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9399, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7632, 'acc_0_0': 0.9614, 'acc_0_1': 0.9339, 'acc_1_0': 0.7632, 'acc_1_1': 0.8022, 'mean_acc': 0.9111}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9197, 'worst_acc': 0.7679, 'acc_0_0': 0.9565, 'acc_0_1': 0.9317, 'acc_1_0': 0.7679, 'acc_1_1': 0.8037, 'mean_acc': 0.909}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.97, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 0.9552, 'mean_acc': 0.9733}
Val(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9356, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7648, 'acc_0_0': 0.957, 'acc_0_1': 0.933, 'acc_1_0': 0.7648, 'acc_1_1': 0.8037, 'mean_acc': 0.9094}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9238, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.9313, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9211, 'worst_acc': 0.771, 'acc_0_0': 0.9565, 'acc_0_1': 0.9313, 'acc_1_0': 0.771, 'acc_1_1': 0.81, 'mean_acc': 0.9099}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9742, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9214, 'worst_acc': 0.7804, 'acc_0_0': 0.9561, 'acc_0_1': 0.9273, 'acc_1_0': 0.7804, 'acc_1_1': 0.8131, 'mean_acc': 0.9096}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7788, 'acc_0_0': 0.9565, 'acc_0_1': 0.9246, 'acc_1_0': 0.7788, 'acc_1_1': 0.8146, 'mean_acc': 0.9087}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9742, 'acc_0_1': 0.9957, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7788, 'acc_0_0': 0.957, 'acc_0_1': 0.9268, 'acc_1_0': 0.7788, 'acc_1_1': 0.8115, 'mean_acc': 0.9094}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9217, 'worst_acc': 0.7773, 'acc_0_0': 0.9574, 'acc_0_1': 0.9282, 'acc_1_0': 0.7773, 'acc_1_1': 0.81, 'mean_acc': 0.9097}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9785, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7741, 'acc_0_0': 0.9583, 'acc_0_1': 0.929, 'acc_1_0': 0.7741, 'acc_1_1': 0.81, 'mean_acc': 0.9101}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9268, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7773, 'acc_0_0': 0.9592, 'acc_0_1': 0.9282, 'acc_1_0': 0.7773, 'acc_1_1': 0.81, 'mean_acc': 0.9104}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.8939, 'acc_1_1': 1.0, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7788, 'acc_0_0': 0.9583, 'acc_0_1': 0.9264, 'acc_1_0': 0.7788, 'acc_1_1': 0.8131, 'mean_acc': 0.9099}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7741, 'acc_0_0': 0.9596, 'acc_0_1': 0.9282, 'acc_1_0': 0.7741, 'acc_1_1': 0.8131, 'mean_acc': 0.9106}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7819, 'acc_0_0': 0.9574, 'acc_0_1': 0.9233, 'acc_1_0': 0.7819, 'acc_1_1': 0.8162, 'mean_acc': 0.909}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7835, 'acc_0_0': 0.9574, 'acc_0_1': 0.9224, 'acc_1_0': 0.7835, 'acc_1_1': 0.8162, 'mean_acc': 0.9089}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9236, 'worst_acc': 0.7788, 'acc_0_0': 0.9588, 'acc_0_1': 0.9242, 'acc_1_0': 0.7788, 'acc_1_1': 0.8146, 'mean_acc': 0.9094}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.785, 'acc_0_0': 0.9565, 'acc_0_1': 0.922, 'acc_1_0': 0.785, 'acc_1_1': 0.8193, 'mean_acc': 0.9089}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9229, 'worst_acc': 0.7788, 'acc_0_0': 0.9565, 'acc_0_1': 0.9233, 'acc_1_0': 0.7788, 'acc_1_1': 0.8193, 'mean_acc': 0.9087}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7866, 'acc_0_0': 0.9565, 'acc_0_1': 0.922, 'acc_1_0': 0.7866, 'acc_1_1': 0.8193, 'mean_acc': 0.909}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9233, 'worst_acc': 0.7882, 'acc_0_0': 0.9561, 'acc_0_1': 0.9197, 'acc_1_0': 0.7882, 'acc_1_1': 0.8224, 'mean_acc': 0.9085}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7819, 'acc_0_0': 0.9557, 'acc_0_1': 0.9237, 'acc_1_0': 0.7819, 'acc_1_1': 0.8178, 'mean_acc': 0.9087}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7897, 'acc_0_0': 0.9552, 'acc_0_1': 0.9215, 'acc_1_0': 0.7897, 'acc_1_1': 0.8193, 'mean_acc': 0.9087}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9242, 'acc_1_1': 1.0, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9223, 'worst_acc': 0.7804, 'acc_0_0': 0.9561, 'acc_0_1': 0.9242, 'acc_1_0': 0.7804, 'acc_1_1': 0.8178, 'mean_acc': 0.9089}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.923, 'worst_acc': 0.7804, 'acc_0_0': 0.957, 'acc_0_1': 0.9237, 'acc_1_0': 0.7804, 'acc_1_1': 0.8178, 'mean_acc': 0.909}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7819, 'acc_0_0': 0.957, 'acc_0_1': 0.9215, 'acc_1_0': 0.7819, 'acc_1_1': 0.8193, 'mean_acc': 0.9085}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7819, 'acc_0_0': 0.957, 'acc_0_1': 0.9197, 'acc_1_0': 0.7819, 'acc_1_1': 0.8193, 'mean_acc': 0.9078}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9264, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7835, 'acc_0_0': 0.9574, 'acc_0_1': 0.9193, 'acc_1_0': 0.7835, 'acc_1_1': 0.8193, 'mean_acc': 0.908}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 1.0, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9266, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.9227, 'acc_1_0': 0.7463, 'acc_1_1': 0.8636, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7741, 'acc_0_0': 0.9574, 'acc_0_1': 0.9224, 'acc_1_0': 0.7741, 'acc_1_1': 0.8193, 'mean_acc': 0.9082}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.0299, 'acc_0_0': 0.9185, 'acc_0_1': 0.9185, 'acc_1_0': 0.7879, 'acc_1_1': 0.0299, 'mean_acc': 0.8047}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}
best test accuracy on [class]: {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8442, 'acc_0_0': 0.949, 'acc_0_1': 0.9171, 'acc_1_0': 0.8442, 'acc_1_1': 0.8442, 'mean_acc': 0.9134}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8442, 'acc_0_0': 0.949, 'acc_0_1': 0.9171, 'acc_1_0': 0.8442, 'acc_1_1': 0.8442, 'mean_acc': 0.9134}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6589, 'acc_0_0': 0.9783, 'acc_0_1': 0.8794, 'acc_1_0': 0.6589, 'acc_1_1': 0.9735, 'mean_acc': 0.9039}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.0299, 'acc_0_0': 0.9185, 'acc_0_1': 0.9185, 'acc_1_0': 0.7879, 'acc_1_1': 0.0299, 'mean_acc': 0.8047}, 'Val': {'weighted_mean_acc': 0.9214, 'worst_acc': 0.8209, 'acc_0_0': 0.9402, 'acc_0_1': 0.927, 'acc_1_0': 0.8209, 'acc_1_1': 0.8636, 'mean_acc': 0.9133}, 'Test': {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8442, 'acc_0_0': 0.949, 'acc_0_1': 0.9171, 'acc_1_0': 0.8442, 'acc_1_1': 0.8442, 'mean_acc': 0.9134}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9235, 'worst_acc': 0.8442, 'acc_0_0': 0.949, 'acc_0_1': 0.9171, 'acc_1_0': 0.8442, 'acc_1_1': 0.8442, 'mean_acc': 0.9134}, 'spurious': {'weighted_mean_acc': 0.9697, 'worst_acc': 0.6589, 'acc_0_0': 0.9783, 'acc_0_1': 0.8794, 'acc_1_0': 0.6589, 'acc_1_1': 0.9735, 'mean_acc': 0.9039}}}
========================================================================
> end
f=============Iteration : 2/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9048, 'acc_0_1': 0.8967, 'acc_1_0': 0.0714, 'acc_1_1': 0.1485, 'mean_acc': 0.7281}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7679}
Val(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7783}
Test(class): {'weighted_mean_acc': 0.7679, 'worst_acc': 0.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.0, 'acc_1_1': 0.0, 'mean_acc': 0.7784}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.0714, 'acc_0_0': 0.9983, 'acc_0_1': 0.8424, 'acc_1_0': 0.0714, 'acc_1_1': 0.3226, 'mean_acc': 0.8325}
Val(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.3906, 'acc_0_0': 0.9915, 'acc_0_1': 0.3906, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7017}
Test(class): {'weighted_mean_acc': 0.9482, 'worst_acc': 0.3481, 'acc_0_0': 0.9845, 'acc_0_1': 0.3481, 'acc_1_0': 0.4408, 'acc_1_1': 0.9595, 'mean_acc': 0.6738}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3315, 'acc_0_0': 0.9826, 'acc_0_1': 0.3315, 'acc_1_0': 0.4643, 'acc_1_1': 0.9612, 'mean_acc': 0.9468}
Val(class): {'weighted_mean_acc': 0.969, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.515, 'acc_1_0': 0.4925, 'acc_1_1': 0.9848, 'mean_acc': 0.7517}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.4745, 'acc_0_0': 0.9902, 'acc_0_1': 0.4745, 'acc_1_0': 0.4875, 'acc_1_1': 0.947, 'mean_acc': 0.729}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9977, 'acc_0_1': 0.7283, 'acc_1_0': 0.3214, 'acc_1_1': 0.9026, 'mean_acc': 0.9585}
Val(class): {'weighted_mean_acc': 0.9726, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.7867}
Test(class): {'weighted_mean_acc': 0.9551, 'worst_acc': 0.5202, 'acc_0_0': 0.9849, 'acc_0_1': 0.5202, 'acc_1_0': 0.6449, 'acc_1_1': 0.9486, 'mean_acc': 0.7623}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.5435, 'acc_0_0': 0.9746, 'acc_0_1': 0.5435, 'acc_1_0': 0.6964, 'acc_1_1': 0.965, 'mean_acc': 0.9527}
Val(class): {'weighted_mean_acc': 0.9509, 'worst_acc': 0.4776, 'acc_0_0': 0.9915, 'acc_0_1': 0.824, 'acc_1_0': 0.4776, 'acc_1_1': 0.8636, 'mean_acc': 0.855}
Test(class): {'weighted_mean_acc': 0.9517, 'worst_acc': 0.5421, 'acc_0_0': 0.9929, 'acc_0_1': 0.8381, 'acc_1_0': 0.5421, 'acc_1_1': 0.8567, 'mean_acc': 0.8676}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9906, 'acc_0_1': 0.7554, 'acc_1_0': 0.625, 'acc_1_1': 0.9319, 'mean_acc': 0.9643}
Val(class): {'weighted_mean_acc': 0.976, 'worst_acc': 0.5522, 'acc_0_0': 0.9957, 'acc_0_1': 0.6781, 'acc_1_0': 0.5522, 'acc_1_1': 0.9848, 'mean_acc': 0.8217}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5389, 'acc_0_0': 0.9925, 'acc_0_1': 0.6457, 'acc_1_0': 0.5389, 'acc_1_1': 0.9377, 'mean_acc': 0.8012}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.5109, 'acc_0_0': 0.9903, 'acc_0_1': 0.5109, 'acc_1_0': 0.7143, 'acc_1_1': 0.9763, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9709, 'worst_acc': 0.5365, 'acc_0_0': 0.9957, 'acc_0_1': 0.5365, 'acc_1_0': 0.5821, 'acc_1_1': 0.9848, 'mean_acc': 0.77}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.4851, 'acc_0_0': 0.9898, 'acc_0_1': 0.4851, 'acc_1_0': 0.5748, 'acc_1_1': 0.9595, 'mean_acc': 0.744}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.996, 'acc_0_1': 0.6304, 'acc_1_0': 0.5179, 'acc_1_1': 0.965, 'mean_acc': 0.9696}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.5579, 'acc_0_0': 0.9957, 'acc_0_1': 0.5579, 'acc_1_0': 0.6119, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.4989, 'acc_0_0': 0.988, 'acc_0_1': 0.4989, 'acc_1_0': 0.5857, 'acc_1_1': 0.9564, 'mean_acc': 0.7496}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5815, 'acc_0_0': 0.99, 'acc_0_1': 0.5815, 'acc_1_0': 0.625, 'acc_1_1': 0.9782, 'mean_acc': 0.9675}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.5408, 'acc_0_0': 0.9915, 'acc_0_1': 0.5408, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.4989, 'acc_0_0': 0.9836, 'acc_0_1': 0.4989, 'acc_1_0': 0.6776, 'acc_1_1': 0.9611, 'mean_acc': 0.7585}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.6848, 'acc_0_0': 0.994, 'acc_0_1': 0.6848, 'acc_1_0': 0.75, 'acc_1_1': 0.964, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9688, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9614, 'worst_acc': 0.609, 'acc_0_0': 0.9894, 'acc_0_1': 0.6922, 'acc_1_0': 0.609, 'acc_1_1': 0.9346, 'mean_acc': 0.8255}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.6957, 'acc_0_0': 0.9931, 'acc_0_1': 0.6957, 'acc_1_0': 0.75, 'acc_1_1': 0.9631, 'mean_acc': 0.9723}
Val(class): {'weighted_mean_acc': 0.9702, 'worst_acc': 0.6609, 'acc_0_0': 0.9915, 'acc_0_1': 0.6609, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.825}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.6173, 'acc_0_0': 0.9863, 'acc_0_1': 0.6173, 'acc_1_0': 0.6558, 'acc_1_1': 0.9502, 'mean_acc': 0.802}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.6902, 'acc_0_0': 0.9909, 'acc_0_1': 0.6902, 'acc_1_0': 0.75, 'acc_1_1': 0.9735, 'mean_acc': 0.9727}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9623, 'worst_acc': 0.5607, 'acc_0_0': 0.9916, 'acc_0_1': 0.7144, 'acc_1_0': 0.5607, 'acc_1_1': 0.9299, 'mean_acc': 0.8291}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9969, 'acc_0_1': 0.7609, 'acc_1_0': 0.7143, 'acc_1_1': 0.964, 'mean_acc': 0.9773}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.567, 'acc_0_0': 0.9925, 'acc_0_1': 0.6971, 'acc_1_0': 0.567, 'acc_1_1': 0.9346, 'mean_acc': 0.824}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.7065, 'acc_0_0': 0.9946, 'acc_0_1': 0.7065, 'acc_1_0': 0.7857, 'acc_1_1': 0.9801, 'mean_acc': 0.9779}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5672, 'acc_0_0': 0.9915, 'acc_0_1': 0.794, 'acc_1_0': 0.5672, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.5576, 'acc_0_0': 0.9925, 'acc_0_1': 0.7561, 'acc_1_0': 0.5576, 'acc_1_1': 0.9268, 'mean_acc': 0.845}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.7935, 'acc_0_0': 0.9966, 'acc_0_1': 0.7935, 'acc_1_0': 0.8036, 'acc_1_1': 0.9659, 'mean_acc': 0.9798}
Val(class): {'weighted_mean_acc': 0.9708, 'worst_acc': 0.5821, 'acc_0_0': 0.9915, 'acc_0_1': 0.7897, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8633}
Test(class): {'weighted_mean_acc': 0.9654, 'worst_acc': 0.5794, 'acc_0_0': 0.9929, 'acc_0_1': 0.7557, 'acc_1_0': 0.5794, 'acc_1_1': 0.9315, 'mean_acc': 0.8479}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.8043, 'acc_0_0': 0.9954, 'acc_0_1': 0.8043, 'acc_1_0': 0.8393, 'acc_1_1': 0.9716, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.964, 'worst_acc': 0.597, 'acc_0_0': 0.9915, 'acc_0_1': 0.7811, 'acc_1_0': 0.597, 'acc_1_1': 0.9242, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.5841, 'acc_0_0': 0.9925, 'acc_0_1': 0.7525, 'acc_1_0': 0.5841, 'acc_1_1': 0.9299, 'mean_acc': 0.8469}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9971, 'acc_0_1': 0.8967, 'acc_1_0': 0.7143, 'acc_1_1': 0.9565, 'mean_acc': 0.981}
Val(class): {'weighted_mean_acc': 0.9808, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.7082, 'acc_1_0': 0.597, 'acc_1_1': 0.9848, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9648, 'worst_acc': 0.5545, 'acc_0_0': 0.9933, 'acc_0_1': 0.6581, 'acc_1_0': 0.5545, 'acc_1_1': 0.9455, 'mean_acc': 0.8089}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6739, 'acc_0_0': 0.9954, 'acc_0_1': 0.6739, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9804}
Val(class): {'weighted_mean_acc': 0.9681, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7725, 'acc_1_0': 0.6716, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9601, 'worst_acc': 0.6184, 'acc_0_0': 0.9885, 'acc_0_1': 0.7348, 'acc_1_0': 0.6184, 'acc_1_1': 0.9237, 'mean_acc': 0.8416}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.8571, 'acc_1_1': 0.964, 'mean_acc': 0.9867}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7725, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8583}
Test(class): {'weighted_mean_acc': 0.9636, 'worst_acc': 0.5312, 'acc_0_0': 0.9938, 'acc_0_1': 0.7419, 'acc_1_0': 0.5312, 'acc_1_1': 0.9252, 'mean_acc': 0.8369}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.837, 'acc_0_0': 0.9977, 'acc_0_1': 0.837, 'acc_1_0': 0.8929, 'acc_1_1': 0.9905, 'mean_acc': 0.9887}
Val(class): {'weighted_mean_acc': 0.959, 'worst_acc': 0.6953, 'acc_0_0': 0.9829, 'acc_0_1': 0.6953, 'acc_1_0': 0.7015, 'acc_1_1': 0.9394, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9638, 'worst_acc': 0.6604, 'acc_0_0': 0.9885, 'acc_0_1': 0.6931, 'acc_1_0': 0.6604, 'acc_1_1': 0.9455, 'mean_acc': 0.8324}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9986, 'acc_0_1': 0.9348, 'acc_1_0': 0.875, 'acc_1_1': 0.9811, 'mean_acc': 0.9908}
Val(class): {'weighted_mean_acc': 0.9712, 'worst_acc': 0.6418, 'acc_0_0': 0.9957, 'acc_0_1': 0.6996, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9641, 'worst_acc': 0.5903, 'acc_0_0': 0.9916, 'acc_0_1': 0.6807, 'acc_1_0': 0.5903, 'acc_1_1': 0.9424, 'mean_acc': 0.8207}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.8859, 'acc_0_0': 0.9989, 'acc_0_1': 0.8859, 'acc_1_0': 0.9107, 'acc_1_1': 0.9905, 'mean_acc': 0.9917}
Val(class): {'weighted_mean_acc': 0.9692, 'worst_acc': 0.597, 'acc_0_0': 1.0, 'acc_0_1': 0.8412, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8833}
Test(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.5779, 'acc_0_0': 0.992, 'acc_0_1': 0.8297, 'acc_1_0': 0.5779, 'acc_1_1': 0.9065, 'mean_acc': 0.8735}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 1.0, 'acc_0_1': 0.962, 'acc_1_0': 0.8929, 'acc_1_1': 0.9839, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.6309, 'acc_0_0': 0.9829, 'acc_0_1': 0.6309, 'acc_1_0': 0.6418, 'acc_1_1': 0.9545, 'mean_acc': 0.805}
Test(class): {'weighted_mean_acc': 0.9643, 'worst_acc': 0.5997, 'acc_0_0': 0.9911, 'acc_0_1': 0.6106, 'acc_1_0': 0.5997, 'acc_1_1': 0.9564, 'mean_acc': 0.7958}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.8967, 'acc_0_0': 0.998, 'acc_0_1': 0.8967, 'acc_1_0': 0.9286, 'acc_1_1': 0.9915, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.597, 'acc_0_0': 0.9829, 'acc_0_1': 0.8283, 'acc_1_0': 0.597, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6168, 'acc_0_0': 0.9898, 'acc_0_1': 0.8355, 'acc_1_0': 0.6168, 'acc_1_1': 0.8972, 'mean_acc': 0.8781}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.9402, 'acc_0_0': 0.9991, 'acc_0_1': 0.9402, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9942}
Val(class): {'weighted_mean_acc': 0.9639, 'worst_acc': 0.4925, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.4925, 'acc_1_1': 0.9242, 'mean_acc': 0.8283}
Test(class): {'weighted_mean_acc': 0.9647, 'worst_acc': 0.4564, 'acc_0_0': 0.9973, 'acc_0_1': 0.7246, 'acc_1_0': 0.4564, 'acc_1_1': 0.9252, 'mean_acc': 0.8233}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.875, 'acc_0_0': 0.9991, 'acc_0_1': 0.9511, 'acc_1_0': 0.875, 'acc_1_1': 0.9896, 'mean_acc': 0.9937}
Val(class): {'weighted_mean_acc': 0.9562, 'worst_acc': 0.5672, 'acc_0_0': 0.9829, 'acc_0_1': 0.8369, 'acc_1_0': 0.5672, 'acc_1_1': 0.9091, 'mean_acc': 0.8717}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5343, 'acc_0_0': 0.9929, 'acc_0_1': 0.8373, 'acc_1_0': 0.5343, 'acc_1_1': 0.8988, 'mean_acc': 0.8711}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.9728, 'acc_0_0': 0.9986, 'acc_0_1': 0.9728, 'acc_1_0': 1.0, 'acc_1_1': 0.9962, 'mean_acc': 0.9971}
Val(class): {'weighted_mean_acc': 0.9489, 'worst_acc': 0.618, 'acc_0_0': 0.9744, 'acc_0_1': 0.618, 'acc_1_0': 0.6269, 'acc_1_1': 0.9394, 'mean_acc': 0.7933}
Test(class): {'weighted_mean_acc': 0.9592, 'worst_acc': 0.596, 'acc_0_0': 0.9854, 'acc_0_1': 0.596, 'acc_1_0': 0.6293, 'acc_1_1': 0.9533, 'mean_acc': 0.7908}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9107, 'acc_1_1': 0.9943, 'mean_acc': 0.9967}
Val(class): {'weighted_mean_acc': 0.9574, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.7768, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5545, 'acc_0_0': 0.9929, 'acc_0_1': 0.7694, 'acc_1_0': 0.5545, 'acc_1_1': 0.9268, 'mean_acc': 0.85}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.9457, 'acc_0_0': 0.9983, 'acc_0_1': 0.9457, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9954}
Val(class): {'weighted_mean_acc': 0.9463, 'worst_acc': 0.5821, 'acc_0_0': 0.9658, 'acc_0_1': 0.7253, 'acc_1_0': 0.5821, 'acc_1_1': 0.9394, 'mean_acc': 0.8267}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6106, 'acc_0_0': 0.984, 'acc_0_1': 0.6945, 'acc_1_0': 0.6106, 'acc_1_1': 0.9315, 'mean_acc': 0.8241}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 1.0, 'acc_0_1': 0.9511, 'acc_1_0': 0.9464, 'acc_1_1': 0.9953, 'mean_acc': 0.9965}
Val(class): {'weighted_mean_acc': 0.9545, 'worst_acc': 0.5672, 'acc_0_0': 0.9786, 'acc_0_1': 0.6996, 'acc_1_0': 0.5672, 'acc_1_1': 0.9394, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.6246, 'acc_0_0': 0.9876, 'acc_0_1': 0.6732, 'acc_1_0': 0.6246, 'acc_1_1': 0.9408, 'mean_acc': 0.8198}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.9783, 'acc_0_0': 0.9997, 'acc_0_1': 0.9783, 'acc_1_0': 0.9821, 'acc_1_1': 0.9915, 'mean_acc': 0.9969}
Val(class): {'weighted_mean_acc': 0.951, 'worst_acc': 0.5821, 'acc_0_0': 0.9786, 'acc_0_1': 0.691, 'acc_1_0': 0.5821, 'acc_1_1': 0.9242, 'mean_acc': 0.8167}
Test(class): {'weighted_mean_acc': 0.965, 'worst_acc': 0.609, 'acc_0_0': 0.992, 'acc_0_1': 0.6727, 'acc_1_0': 0.609, 'acc_1_1': 0.9455, 'mean_acc': 0.8202}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.9076, 'acc_0_0': 0.9991, 'acc_0_1': 0.9076, 'acc_1_0': 0.9821, 'acc_1_1': 0.9953, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9207, 'worst_acc': 0.6266, 'acc_0_0': 0.9274, 'acc_0_1': 0.6266, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8033}
Test(class): {'weighted_mean_acc': 0.9293, 'worst_acc': 0.6093, 'acc_0_0': 0.9392, 'acc_0_1': 0.6093, 'acc_1_0': 0.7928, 'acc_1_1': 0.9595, 'mean_acc': 0.7969}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8804, 'acc_0_0': 0.9991, 'acc_0_1': 0.8804, 'acc_1_0': 0.9286, 'acc_1_1': 0.9839, 'mean_acc': 0.9904}
Val(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.6119, 'acc_0_0': 0.9829, 'acc_0_1': 0.7296, 'acc_1_0': 0.6119, 'acc_1_1': 0.9394, 'mean_acc': 0.8383}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.6231, 'acc_0_0': 0.9894, 'acc_0_1': 0.7193, 'acc_1_0': 0.6231, 'acc_1_1': 0.9299, 'mean_acc': 0.8371}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.9464, 'acc_0_0': 0.9994, 'acc_0_1': 0.9837, 'acc_1_0': 0.9464, 'acc_1_1': 0.983, 'mean_acc': 0.9946}
Val(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5075, 'acc_0_0': 0.9915, 'acc_0_1': 0.7511, 'acc_1_0': 0.5075, 'acc_1_1': 0.9242, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.472, 'acc_0_0': 0.9938, 'acc_0_1': 0.745, 'acc_1_0': 0.472, 'acc_1_1': 0.9174, 'mean_acc': 0.8307}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8696, 'acc_0_0': 0.9989, 'acc_0_1': 0.8696, 'acc_1_0': 0.9286, 'acc_1_1': 0.9962, 'mean_acc': 0.9925}
Val(class): {'weighted_mean_acc': 0.9556, 'worst_acc': 0.6269, 'acc_0_0': 0.9829, 'acc_0_1': 0.8026, 'acc_1_0': 0.6269, 'acc_1_1': 0.9091, 'mean_acc': 0.865}
Test(class): {'weighted_mean_acc': 0.9501, 'worst_acc': 0.6293, 'acc_0_0': 0.9805, 'acc_0_1': 0.8009, 'acc_1_0': 0.6293, 'acc_1_1': 0.8925, 'mean_acc': 0.8619}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.9293, 'acc_0_0': 0.9986, 'acc_0_1': 0.9293, 'acc_1_0': 0.9464, 'acc_1_1': 0.9896, 'mean_acc': 0.9933}
Val(class): {'weighted_mean_acc': 0.9621, 'worst_acc': 0.6567, 'acc_0_0': 0.9829, 'acc_0_1': 0.7039, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.6231, 'acc_0_0': 0.9889, 'acc_0_1': 0.714, 'acc_1_0': 0.6231, 'acc_1_1': 0.933, 'mean_acc': 0.8352}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.9107, 'acc_0_0': 0.9997, 'acc_0_1': 0.962, 'acc_1_0': 0.9107, 'acc_1_1': 0.9934, 'mean_acc': 0.9958}
Val(class): {'weighted_mean_acc': 0.9646, 'worst_acc': 0.5075, 'acc_0_0': 1.0, 'acc_0_1': 0.8369, 'acc_1_0': 0.5075, 'acc_1_1': 0.8939, 'mean_acc': 0.87}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.5016, 'acc_0_0': 0.9956, 'acc_0_1': 0.8483, 'acc_1_0': 0.5016, 'acc_1_1': 0.8785, 'mean_acc': 0.8706}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.962, 'acc_0_0': 0.9994, 'acc_0_1': 0.962, 'acc_1_0': 1.0, 'acc_1_1': 0.9972, 'mean_acc': 0.9975}
Val(class): {'weighted_mean_acc': 0.9713, 'worst_acc': 0.5672, 'acc_0_0': 1.0, 'acc_0_1': 0.8197, 'acc_1_0': 0.5672, 'acc_1_1': 0.9242, 'mean_acc': 0.8733}
Test(class): {'weighted_mean_acc': 0.9576, 'worst_acc': 0.5421, 'acc_0_0': 0.9894, 'acc_0_1': 0.8084, 'acc_1_0': 0.5421, 'acc_1_1': 0.9003, 'mean_acc': 0.8595}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.9643, 'acc_0_0': 0.9997, 'acc_0_1': 0.9946, 'acc_1_0': 0.9643, 'acc_1_1': 0.9915, 'mean_acc': 0.9973}
Val(class): {'weighted_mean_acc': 0.9565, 'worst_acc': 0.5522, 'acc_0_0': 0.9786, 'acc_0_1': 0.6695, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8083}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.553, 'acc_0_0': 0.988, 'acc_0_1': 0.639, 'acc_1_0': 0.553, 'acc_1_1': 0.9424, 'mean_acc': 0.7989}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4394, 'acc_0_0': 0.9914, 'acc_0_1': 0.6609, 'acc_1_0': 0.4394, 'acc_1_1': 0.9552, 'mean_acc': 0.798}
Val(class)(new adapter): {'weighted_mean_acc': 0.783, 'worst_acc': 0.0606, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.1493, 'acc_1_1': 0.0606, 'mean_acc': 0.8017}
Test(class)(new adapter): {'weighted_mean_acc': 0.8014, 'worst_acc': 0.1402, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.2227, 'acc_1_1': 0.1402, 'mean_acc': 0.8186}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0152, 'acc_0_0': 0.9485, 'acc_0_1': 0.133, 'acc_1_0': 0.0152, 'acc_1_1': 0.1343, 'mean_acc': 0.4374}
Val(class)(new adapter): {'weighted_mean_acc': 0.9457, 'worst_acc': 0.2575, 'acc_0_0': 0.9701, 'acc_0_1': 0.2575, 'acc_1_0': 0.6567, 'acc_1_1': 1.0, 'mean_acc': 0.6617}
Test(class)(new adapter): {'weighted_mean_acc': 0.9478, 'worst_acc': 0.2749, 'acc_0_0': 0.9778, 'acc_0_1': 0.2749, 'acc_1_0': 0.6464, 'acc_1_1': 0.9813, 'mean_acc': 0.6679}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4163, 'acc_0_0': 0.9571, 'acc_0_1': 0.4163, 'acc_1_0': 0.7273, 'acc_1_1': 0.9851, 'mean_acc': 0.7245}
Val(class)(new adapter): {'weighted_mean_acc': 0.9453, 'worst_acc': 0.5522, 'acc_0_0': 0.9872, 'acc_0_1': 0.824, 'acc_1_0': 0.5522, 'acc_1_1': 0.8485, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9462, 'worst_acc': 0.5358, 'acc_0_0': 0.9916, 'acc_0_1': 0.839, 'acc_1_0': 0.5358, 'acc_1_1': 0.8364, 'mean_acc': 0.8645}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1194, 'acc_0_0': 0.8712, 'acc_0_1': 0.927, 'acc_1_0': 0.6212, 'acc_1_1': 0.1194, 'mean_acc': 0.7813}
Val(class)(new adapter): {'weighted_mean_acc': 0.866, 'worst_acc': 0.5152, 'acc_0_0': 0.9701, 'acc_0_1': 0.9657, 'acc_1_0': 0.6567, 'acc_1_1': 0.5152, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8739, 'worst_acc': 0.5062, 'acc_0_0': 0.9827, 'acc_0_1': 0.9738, 'acc_1_0': 0.6854, 'acc_1_1': 0.5062, 'mean_acc': 0.8935}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5373, 'acc_0_0': 0.9871, 'acc_0_1': 0.9871, 'acc_1_0': 0.7727, 'acc_1_1': 0.5373, 'mean_acc': 0.9132}
Val(class)(new adapter): {'weighted_mean_acc': 0.8799, 'worst_acc': 0.7273, 'acc_0_0': 0.9231, 'acc_0_1': 0.9442, 'acc_1_0': 0.8507, 'acc_1_1': 0.7273, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.885, 'worst_acc': 0.6916, 'acc_0_0': 0.9406, 'acc_0_1': 0.9534, 'acc_1_0': 0.8364, 'acc_1_1': 0.6916, 'mean_acc': 0.9065}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.2836, 'acc_0_0': 0.8155, 'acc_0_1': 0.9571, 'acc_1_0': 0.8636, 'acc_1_1': 0.2836, 'mean_acc': 0.8164}
Val(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.8507, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8458, 'acc_0_0': 0.9353, 'acc_0_1': 0.9047, 'acc_1_0': 0.8458, 'acc_1_1': 0.8505, 'mean_acc': 0.904}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8333, 'acc_0_0': 0.9657, 'acc_0_1': 0.9828, 'acc_1_0': 0.8333, 'acc_1_1': 0.9104, 'mean_acc': 0.9516}
Val(class)(new adapter): {'weighted_mean_acc': 0.9424, 'worst_acc': 0.806, 'acc_0_0': 0.9487, 'acc_0_1': 0.8798, 'acc_1_0': 0.806, 'acc_1_1': 0.9394, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9368, 'worst_acc': 0.8271, 'acc_0_0': 0.9521, 'acc_0_1': 0.8435, 'acc_1_0': 0.8271, 'acc_1_1': 0.9081, 'mean_acc': 0.8911}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.403, 'acc_0_0': 0.9485, 'acc_0_1': 0.8712, 'acc_1_0': 0.8182, 'acc_1_1': 0.403, 'mean_acc': 0.8431}
Val(class)(new adapter): {'weighted_mean_acc': 0.9322, 'worst_acc': 0.7639, 'acc_0_0': 0.9359, 'acc_0_1': 0.7639, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.86}
Test(class)(new adapter): {'weighted_mean_acc': 0.9358, 'worst_acc': 0.7774, 'acc_0_0': 0.9481, 'acc_0_1': 0.7774, 'acc_1_0': 0.8318, 'acc_1_1': 0.9283, 'mean_acc': 0.8666}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9828, 'acc_0_1': 0.9485, 'acc_1_0': 0.7576, 'acc_1_1': 0.9701, 'mean_acc': 0.9432}
Val(class)(new adapter): {'weighted_mean_acc': 0.9231, 'worst_acc': 0.7511, 'acc_0_0': 0.9188, 'acc_0_1': 0.7511, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.855}
Test(class)(new adapter): {'weighted_mean_acc': 0.9256, 'worst_acc': 0.7486, 'acc_0_0': 0.9313, 'acc_0_1': 0.7486, 'acc_1_0': 0.8411, 'acc_1_1': 0.9424, 'mean_acc': 0.8514}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6866, 'acc_0_0': 0.9227, 'acc_0_1': 0.9056, 'acc_1_0': 0.8788, 'acc_1_1': 0.6866, 'mean_acc': 0.8848}
Val(class)(new adapter): {'weighted_mean_acc': 0.9161, 'worst_acc': 0.7296, 'acc_0_0': 0.9103, 'acc_0_1': 0.7296, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7366, 'acc_0_0': 0.9193, 'acc_0_1': 0.7366, 'acc_1_0': 0.8489, 'acc_1_1': 0.9439, 'mean_acc': 0.8431}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8182, 'acc_0_0': 0.9742, 'acc_0_1': 0.9442, 'acc_1_0': 0.8182, 'acc_1_1': 0.9701, 'mean_acc': 0.9449}
Val(class)(new adapter): {'weighted_mean_acc': 0.9014, 'worst_acc': 0.7639, 'acc_0_0': 0.8932, 'acc_0_1': 0.7639, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class)(new adapter): {'weighted_mean_acc': 0.9017, 'worst_acc': 0.7672, 'acc_0_0': 0.8976, 'acc_0_1': 0.7672, 'acc_1_0': 0.8676, 'acc_1_1': 0.9408, 'mean_acc': 0.8483}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.791, 'acc_0_0': 0.8326, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.791, 'mean_acc': 0.8865}
Val(class)(new adapter): {'weighted_mean_acc': 0.8958, 'worst_acc': 0.7811, 'acc_0_0': 0.8846, 'acc_0_1': 0.7811, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class)(new adapter): {'weighted_mean_acc': 0.8974, 'worst_acc': 0.7933, 'acc_0_0': 0.894, 'acc_0_1': 0.7933, 'acc_1_0': 0.8707, 'acc_1_1': 0.9283, 'mean_acc': 0.8561}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.97, 'acc_0_1': 0.97, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.8283, 'acc_0_0': 0.8932, 'acc_0_1': 0.8283, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.8717}
Test(class)(new adapter): {'weighted_mean_acc': 0.9021, 'worst_acc': 0.8284, 'acc_0_0': 0.9024, 'acc_0_1': 0.8284, 'acc_1_0': 0.866, 'acc_1_1': 0.9159, 'mean_acc': 0.8711}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.6567, 'acc_0_0': 0.8326, 'acc_0_1': 0.9957, 'acc_1_0': 0.7424, 'acc_1_1': 0.6567, 'mean_acc': 0.8664}
Val(class)(new adapter): {'weighted_mean_acc': 0.9077, 'worst_acc': 0.8358, 'acc_0_0': 0.9017, 'acc_0_1': 0.8627, 'acc_1_0': 0.8358, 'acc_1_1': 0.9394, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9219, 'worst_acc': 0.8364, 'acc_0_0': 0.9322, 'acc_0_1': 0.8594, 'acc_1_0': 0.8364, 'acc_1_1': 0.9034, 'mean_acc': 0.8901}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.7576, 'acc_1_1': 0.9104, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.791, 'acc_0_0': 0.9103, 'acc_0_1': 0.8755, 'acc_1_0': 0.791, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9314, 'worst_acc': 0.8178, 'acc_0_0': 0.9455, 'acc_0_1': 0.8776, 'acc_1_0': 0.8178, 'acc_1_1': 0.9003, 'mean_acc': 0.8999}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.7015, 'acc_0_0': 0.9185, 'acc_0_1': 0.9828, 'acc_1_0': 0.8788, 'acc_1_1': 0.7015, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.9295, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.8798, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9357, 'worst_acc': 0.7975, 'acc_0_0': 0.953, 'acc_0_1': 0.8789, 'acc_1_0': 0.7975, 'acc_1_1': 0.8956, 'mean_acc': 0.9006}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7576, 'acc_0_0': 0.9957, 'acc_0_1': 0.9828, 'acc_1_0': 0.7576, 'acc_1_1': 0.9254, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9382, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.8627, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9406, 'worst_acc': 0.7804, 'acc_0_0': 0.9592, 'acc_0_1': 0.8767, 'acc_1_0': 0.7804, 'acc_1_1': 0.8988, 'mean_acc': 0.9006}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9614, 'acc_0_1': 0.9657, 'acc_1_0': 0.9394, 'acc_1_1': 0.8507, 'mean_acc': 0.9482}
Val(class)(new adapter): {'weighted_mean_acc': 0.9377, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.8498, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9417, 'worst_acc': 0.7991, 'acc_0_0': 0.9579, 'acc_0_1': 0.8612, 'acc_1_0': 0.7991, 'acc_1_1': 0.9097, 'mean_acc': 0.8973}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9957, 'acc_0_1': 0.9442, 'acc_1_0': 0.8788, 'acc_1_1': 0.9701, 'mean_acc': 0.9599}
Val(class)(new adapter): {'weighted_mean_acc': 0.9376, 'worst_acc': 0.7761, 'acc_0_0': 0.9444, 'acc_0_1': 0.8455, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9408, 'worst_acc': 0.8115, 'acc_0_0': 0.9561, 'acc_0_1': 0.851, 'acc_1_0': 0.8115, 'acc_1_1': 0.9128, 'mean_acc': 0.8944}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8806, 'acc_0_0': 0.9571, 'acc_0_1': 0.927, 'acc_1_0': 0.9545, 'acc_1_1': 0.8806, 'mean_acc': 0.9366}
Val(class)(new adapter): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.8455, 'acc_1_0': 0.7761, 'acc_1_1': 0.9545, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9392, 'worst_acc': 0.81, 'acc_0_0': 0.9552, 'acc_0_1': 0.8519, 'acc_1_0': 0.81, 'acc_1_1': 0.9081, 'mean_acc': 0.8937}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8788, 'acc_0_0': 0.9871, 'acc_0_1': 0.9399, 'acc_1_0': 0.8788, 'acc_1_1': 0.9851, 'mean_acc': 0.9566}
Val(class)(new adapter): {'weighted_mean_acc': 0.9254, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.8541, 'acc_1_0': 0.7761, 'acc_1_1': 0.9394, 'mean_acc': 0.8833}
Test(class)(new adapter): {'weighted_mean_acc': 0.9364, 'worst_acc': 0.8053, 'acc_0_0': 0.953, 'acc_0_1': 0.8772, 'acc_1_0': 0.8053, 'acc_1_1': 0.8988, 'mean_acc': 0.9011}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9254, 'acc_0_0': 0.9614, 'acc_0_1': 0.97, 'acc_1_0': 0.9697, 'acc_1_1': 0.9254, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9232, 'worst_acc': 0.7761, 'acc_0_0': 0.9274, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.9242, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.934, 'worst_acc': 0.7944, 'acc_0_0': 0.9552, 'acc_0_1': 0.8914, 'acc_1_0': 0.7944, 'acc_1_1': 0.8785, 'mean_acc': 0.904}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.911, 'worst_acc': 0.791, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.791, 'acc_1_1': 0.8636, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.928, 'worst_acc': 0.7913, 'acc_0_0': 0.9548, 'acc_0_1': 0.906, 'acc_1_0': 0.7913, 'acc_1_1': 0.8505, 'mean_acc': 0.9061}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.97, 'acc_0_1': 0.9828, 'acc_1_0': 0.9697, 'acc_1_1': 0.8657, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9108, 'worst_acc': 0.7761, 'acc_0_0': 0.9316, 'acc_0_1': 0.9142, 'acc_1_0': 0.7761, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7741, 'acc_0_0': 0.9588, 'acc_0_1': 0.9211, 'acc_1_0': 0.7741, 'acc_1_1': 0.8271, 'mean_acc': 0.909}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.8636, 'acc_1_1': 0.9552, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9138, 'worst_acc': 0.7612, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9245, 'worst_acc': 0.7601, 'acc_0_0': 0.9601, 'acc_0_1': 0.9282, 'acc_1_0': 0.7601, 'acc_1_1': 0.8146, 'mean_acc': 0.9094}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9614, 'acc_0_1': 0.9957, 'acc_1_0': 0.9394, 'acc_1_1': 0.8358, 'mean_acc': 0.9583}
Val(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9142, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9247, 'worst_acc': 0.7555, 'acc_0_0': 0.9632, 'acc_0_1': 0.9304, 'acc_1_0': 0.7555, 'acc_1_1': 0.8053, 'mean_acc': 0.9099}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.9701, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7463, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9279, 'worst_acc': 0.7383, 'acc_0_0': 0.9676, 'acc_0_1': 0.9335, 'acc_1_0': 0.7383, 'acc_1_1': 0.8053, 'mean_acc': 0.9109}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9828, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9403, 'mean_acc': 0.9783}
Val(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7313, 'acc_0_0': 0.9444, 'acc_0_1': 0.927, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9316, 'worst_acc': 0.7305, 'acc_0_0': 0.9716, 'acc_0_1': 0.9299, 'acc_1_0': 0.7305, 'acc_1_1': 0.81, 'mean_acc': 0.9108}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9226, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9338, 'worst_acc': 0.7259, 'acc_0_0': 0.9734, 'acc_0_1': 0.929, 'acc_1_0': 0.7259, 'acc_1_1': 0.8146, 'mean_acc': 0.9111}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9403, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.9697, 'acc_1_1': 0.9403, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9222, 'worst_acc': 0.7015, 'acc_0_0': 0.9487, 'acc_0_1': 0.9099, 'acc_1_0': 0.7015, 'acc_1_1': 0.8485, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9371, 'worst_acc': 0.7196, 'acc_0_0': 0.9747, 'acc_0_1': 0.9197, 'acc_1_0': 0.7196, 'acc_1_1': 0.8271, 'mean_acc': 0.9087}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 0.9785, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9249, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.8884, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9366, 'worst_acc': 0.7227, 'acc_0_0': 0.9721, 'acc_0_1': 0.9109, 'acc_1_0': 0.7227, 'acc_1_1': 0.8349, 'mean_acc': 0.9054}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9545, 'acc_1_1': 0.9552, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9348, 'worst_acc': 0.7463, 'acc_0_0': 0.9487, 'acc_0_1': 0.8755, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9381, 'worst_acc': 0.7461, 'acc_0_0': 0.9681, 'acc_0_1': 0.8936, 'acc_1_0': 0.7461, 'acc_1_1': 0.8567, 'mean_acc': 0.9021}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9957, 'acc_0_1': 0.9657, 'acc_1_0': 0.9545, 'acc_1_1': 1.0, 'mean_acc': 0.98}
Val(class)(new adapter): {'weighted_mean_acc': 0.9315, 'worst_acc': 0.7463, 'acc_0_0': 0.9444, 'acc_0_1': 0.8712, 'acc_1_0': 0.7463, 'acc_1_1': 0.9091, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.936, 'worst_acc': 0.7804, 'acc_0_0': 0.9627, 'acc_0_1': 0.8856, 'acc_1_0': 0.7804, 'acc_1_1': 0.8645, 'mean_acc': 0.9016}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9871, 'acc_0_1': 0.9957, 'acc_1_0': 0.9242, 'acc_1_1': 0.9701, 'mean_acc': 0.9816}
Val(class)(new adapter): {'weighted_mean_acc': 0.9286, 'worst_acc': 0.7612, 'acc_0_0': 0.9402, 'acc_0_1': 0.8712, 'acc_1_0': 0.7612, 'acc_1_1': 0.9091, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9326, 'worst_acc': 0.7913, 'acc_0_0': 0.9596, 'acc_0_1': 0.8874, 'acc_1_0': 0.7913, 'acc_1_1': 0.8583, 'mean_acc': 0.9016}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9871, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8755, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.7991, 'acc_0_0': 0.9525, 'acc_0_1': 0.8869, 'acc_1_0': 0.7991, 'acc_1_1': 0.852, 'mean_acc': 0.8989}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9866}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8755, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.7975, 'acc_0_0': 0.9525, 'acc_0_1': 0.8874, 'acc_1_0': 0.7975, 'acc_1_1': 0.8505, 'mean_acc': 0.8987}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9169, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8884, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9261, 'worst_acc': 0.796, 'acc_0_0': 0.9534, 'acc_0_1': 0.89, 'acc_1_0': 0.796, 'acc_1_1': 0.8489, 'mean_acc': 0.8997}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9166, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9257, 'worst_acc': 0.796, 'acc_0_0': 0.953, 'acc_0_1': 0.8887, 'acc_1_0': 0.796, 'acc_1_1': 0.8489, 'mean_acc': 0.899}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9168, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9248, 'worst_acc': 0.7975, 'acc_0_0': 0.9517, 'acc_0_1': 0.8891, 'acc_1_0': 0.7975, 'acc_1_1': 0.8489, 'mean_acc': 0.8989}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9165, 'worst_acc': 0.7761, 'acc_0_0': 0.9231, 'acc_0_1': 0.8755, 'acc_1_0': 0.7761, 'acc_1_1': 0.9091, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9244, 'worst_acc': 0.796, 'acc_0_0': 0.9499, 'acc_0_1': 0.886, 'acc_1_0': 0.796, 'acc_1_1': 0.8536, 'mean_acc': 0.8973}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.8841, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7928, 'acc_0_0': 0.9521, 'acc_0_1': 0.8927, 'acc_1_0': 0.7928, 'acc_1_1': 0.838, 'mean_acc': 0.8987}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9096, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8798, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7897, 'acc_0_0': 0.953, 'acc_0_1': 0.8927, 'acc_1_0': 0.7897, 'acc_1_1': 0.8349, 'mean_acc': 0.8983}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9099, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8884, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.9234, 'worst_acc': 0.7835, 'acc_0_0': 0.9552, 'acc_0_1': 0.8962, 'acc_1_0': 0.7835, 'acc_1_1': 0.8302, 'mean_acc': 0.8994}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9221, 'worst_acc': 0.785, 'acc_0_0': 0.9539, 'acc_0_1': 0.8967, 'acc_1_0': 0.785, 'acc_1_1': 0.8287, 'mean_acc': 0.899}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9218, 'worst_acc': 0.7866, 'acc_0_0': 0.9534, 'acc_0_1': 0.8962, 'acc_1_0': 0.7866, 'acc_1_1': 0.8287, 'mean_acc': 0.8989}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9851, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.924, 'worst_acc': 0.7804, 'acc_0_0': 0.9579, 'acc_0_1': 0.8993, 'acc_1_0': 0.7804, 'acc_1_1': 0.824, 'mean_acc': 0.9006}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9202, 'worst_acc': 0.7866, 'acc_0_0': 0.9525, 'acc_0_1': 0.8976, 'acc_1_0': 0.7866, 'acc_1_1': 0.824, 'mean_acc': 0.8985}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9212, 'worst_acc': 0.7835, 'acc_0_0': 0.9552, 'acc_0_1': 0.9007, 'acc_1_0': 0.7835, 'acc_1_1': 0.8193, 'mean_acc': 0.8999}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9205, 'worst_acc': 0.785, 'acc_0_0': 0.9539, 'acc_0_1': 0.8998, 'acc_1_0': 0.785, 'acc_1_1': 0.8209, 'mean_acc': 0.8994}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9196, 'worst_acc': 0.7835, 'acc_0_0': 0.9534, 'acc_0_1': 0.9038, 'acc_1_0': 0.7835, 'acc_1_1': 0.8178, 'mean_acc': 0.9002}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7819, 'acc_0_0': 0.9543, 'acc_0_1': 0.9047, 'acc_1_0': 0.7819, 'acc_1_1': 0.8162, 'mean_acc': 0.9006}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9209, 'worst_acc': 0.785, 'acc_0_0': 0.9539, 'acc_0_1': 0.9011, 'acc_1_0': 0.785, 'acc_1_1': 0.8224, 'mean_acc': 0.9001}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7788, 'acc_0_0': 0.9588, 'acc_0_1': 0.9051, 'acc_1_0': 0.7788, 'acc_1_1': 0.8178, 'mean_acc': 0.9023}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7788, 'acc_0_0': 0.9588, 'acc_0_1': 0.9051, 'acc_1_0': 0.7788, 'acc_1_1': 0.8193, 'mean_acc': 0.9025}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9228, 'worst_acc': 0.7819, 'acc_0_0': 0.957, 'acc_0_1': 0.9011, 'acc_1_0': 0.7819, 'acc_1_1': 0.8209, 'mean_acc': 0.9008}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9235, 'worst_acc': 0.7819, 'acc_0_0': 0.9583, 'acc_0_1': 0.9038, 'acc_1_0': 0.7819, 'acc_1_1': 0.8193, 'mean_acc': 0.9021}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.897, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.785, 'acc_0_0': 0.9548, 'acc_0_1': 0.9011, 'acc_1_0': 0.785, 'acc_1_1': 0.8224, 'mean_acc': 0.9004}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9106, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8788, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.92, 'worst_acc': 0.7866, 'acc_0_0': 0.9539, 'acc_0_1': 0.9047, 'acc_1_0': 0.7866, 'acc_1_1': 0.8178, 'mean_acc': 0.9011}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9213, 'worst_acc': 0.785, 'acc_0_0': 0.9548, 'acc_0_1': 0.9042, 'acc_1_0': 0.785, 'acc_1_1': 0.8209, 'mean_acc': 0.9014}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9545, 'acc_1_1': 0.9701, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9104, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7463, 'acc_1_1': 0.8788, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.922, 'worst_acc': 0.7819, 'acc_0_0': 0.957, 'acc_0_1': 0.9069, 'acc_1_0': 0.7819, 'acc_1_1': 0.8162, 'mean_acc': 0.9025}
========================================================================
> end of training. 

best epoch : 46
best training accuracy on [class]: {'worst_acc': 0.2836, 'acc_0_0': 0.8155, 'acc_0_1': 0.9571, 'acc_1_0': 0.8636, 'acc_1_1': 0.2836, 'mean_acc': 0.8164}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9212, 'worst_acc': 0.8507, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}
best test accuracy on [class]: {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8458, 'acc_0_0': 0.9353, 'acc_0_1': 0.9047, 'acc_1_0': 0.8458, 'acc_1_1': 0.8505, 'mean_acc': 0.904}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8458, 'acc_0_0': 0.9353, 'acc_0_1': 0.9047, 'acc_1_0': 0.8458, 'acc_1_1': 0.8505, 'mean_acc': 0.904}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.965, 'worst_acc': 0.4268, 'acc_0_0': 0.9738, 'acc_0_1': 0.8404, 'acc_1_0': 0.4268, 'acc_1_1': 0.986, 'mean_acc': 0.8626}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 46': {'Train': {'worst_acc': 0.2836, 'acc_0_0': 0.8155, 'acc_0_1': 0.9571, 'acc_1_0': 0.8636, 'acc_1_1': 0.2836, 'mean_acc': 0.8164}, 'Val': {'weighted_mean_acc': 0.9212, 'worst_acc': 0.8507, 'acc_0_0': 0.9316, 'acc_0_1': 0.9013, 'acc_1_0': 0.8507, 'acc_1_1': 0.8939, 'mean_acc': 0.9067}, 'Test': {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8458, 'acc_0_0': 0.9353, 'acc_0_1': 0.9047, 'acc_1_0': 0.8458, 'acc_1_1': 0.8505, 'mean_acc': 0.904}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.9143, 'worst_acc': 0.8458, 'acc_0_0': 0.9353, 'acc_0_1': 0.9047, 'acc_1_0': 0.8458, 'acc_1_1': 0.8505, 'mean_acc': 0.904}, 'spurious': {'weighted_mean_acc': 0.965, 'worst_acc': 0.4268, 'acc_0_0': 0.9738, 'acc_0_1': 0.8404, 'acc_1_0': 0.4268, 'acc_1_1': 0.986, 'mean_acc': 0.8626}}}
========================================================================
> end
f=============Iteration : 3/3=============
> Start Transfer Learning using [adapter_reg_seq_alter]
========================================================================
Load image embedding of Waterbirds: /home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Load Data Loader (train, validation, test)
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
/home/jinsu/workstation/project/debiasing-multi-modal/data/embeddings_unnormalized/waterbirds/RN50/clip.json
Training target : class (Land bird(0) / Water bird(1))
Off-the-shelf classifier : [Adapter + (temperatured) image-text jointly normalized prediction] with group regularized training
Set Optimizer: SGD (default)
========================================================================
--- Epoch 1 ---
Train-1 (Feature Learning): {'worst_acc': 0.0893, 'acc_0_0': 0.9182, 'acc_0_1': 0.8098, 'acc_1_0': 0.0893, 'acc_1_1': 0.211, 'mean_acc': 0.7485}
Val(class): {'weighted_mean_acc': 0.932, 'worst_acc': 0.1545, 'acc_0_0': 0.9615, 'acc_0_1': 0.1545, 'acc_1_0': 0.6418, 'acc_1_1': 0.9848, 'mean_acc': 0.615}
Test(class): {'weighted_mean_acc': 0.9329, 'worst_acc': 0.1397, 'acc_0_0': 0.9659, 'acc_0_1': 0.1397, 'acc_1_0': 0.6573, 'acc_1_1': 0.9766, 'mean_acc': 0.6113}
--- Epoch 2 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9917, 'acc_0_1': 0.4185, 'acc_1_0': 0.3393, 'acc_1_1': 0.8694, 'mean_acc': 0.9351}
Val(class): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.103, 'acc_0_0': 0.9188, 'acc_0_1': 0.103, 'acc_1_0': 0.6418, 'acc_1_1': 1.0, 'mean_acc': 0.58}
Test(class): {'weighted_mean_acc': 0.9081, 'worst_acc': 0.0847, 'acc_0_0': 0.9308, 'acc_0_1': 0.0847, 'acc_1_0': 0.7227, 'acc_1_1': 0.986, 'mean_acc': 0.5846}
--- Epoch 3 ---
Train-1 (Feature Learning): {'worst_acc': 0.2143, 'acc_0_0': 0.998, 'acc_0_1': 0.6033, 'acc_1_0': 0.2143, 'acc_1_1': 0.8288, 'mean_acc': 0.9364}
Val(class): {'weighted_mean_acc': 0.9524, 'worst_acc': 0.2017, 'acc_0_0': 0.9829, 'acc_0_1': 0.2017, 'acc_1_0': 0.6119, 'acc_1_1': 1.0, 'mean_acc': 0.64}
Test(class): {'weighted_mean_acc': 0.9407, 'worst_acc': 0.1703, 'acc_0_0': 0.9783, 'acc_0_1': 0.1703, 'acc_1_0': 0.5935, 'acc_1_1': 0.9688, 'mean_acc': 0.6201}
--- Epoch 4 ---
Train-1 (Feature Learning): {'worst_acc': 0.3214, 'acc_0_0': 0.9971, 'acc_0_1': 0.5272, 'acc_1_0': 0.3214, 'acc_1_1': 0.9167, 'mean_acc': 0.9535}
Val(class): {'weighted_mean_acc': 0.9657, 'worst_acc': 0.3348, 'acc_0_0': 1.0, 'acc_0_1': 0.3348, 'acc_1_0': 0.5373, 'acc_1_1': 0.9848, 'mean_acc': 0.6883}
Test(class): {'weighted_mean_acc': 0.9496, 'worst_acc': 0.2812, 'acc_0_0': 0.9863, 'acc_0_1': 0.2812, 'acc_1_0': 0.5234, 'acc_1_1': 0.9673, 'mean_acc': 0.6584}
--- Epoch 5 ---
Train-1 (Feature Learning): {'worst_acc': 0.3393, 'acc_0_0': 0.9954, 'acc_0_1': 0.4728, 'acc_1_0': 0.3393, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9695, 'worst_acc': 0.4506, 'acc_0_0': 1.0, 'acc_0_1': 0.4506, 'acc_1_0': 0.4776, 'acc_1_1': 0.9848, 'mean_acc': 0.7267}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.3969, 'acc_0_0': 0.9885, 'acc_0_1': 0.3969, 'acc_1_0': 0.4984, 'acc_1_1': 0.9595, 'mean_acc': 0.7007}
--- Epoch 6 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9937, 'acc_0_1': 0.4728, 'acc_1_0': 0.4464, 'acc_1_1': 0.947, 'mean_acc': 0.957}
Val(class): {'weighted_mean_acc': 0.9691, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.5322, 'acc_1_0': 0.4627, 'acc_1_1': 0.9697, 'mean_acc': 0.755}
Test(class): {'weighted_mean_acc': 0.956, 'worst_acc': 0.4807, 'acc_0_0': 0.9902, 'acc_0_1': 0.4807, 'acc_1_0': 0.4891, 'acc_1_1': 0.9502, 'mean_acc': 0.732}
--- Epoch 7 ---
Train-1 (Feature Learning): {'worst_acc': 0.5179, 'acc_0_0': 0.9937, 'acc_0_1': 0.5217, 'acc_1_0': 0.5179, 'acc_1_1': 0.9508, 'mean_acc': 0.9606}
Val(class): {'weighted_mean_acc': 0.9717, 'worst_acc': 0.4478, 'acc_0_0': 1.0, 'acc_0_1': 0.6052, 'acc_1_0': 0.4478, 'acc_1_1': 0.9697, 'mean_acc': 0.7817}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.4688, 'acc_0_0': 0.9911, 'acc_0_1': 0.5579, 'acc_1_0': 0.4688, 'acc_1_1': 0.9455, 'mean_acc': 0.7596}
--- Epoch 8 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9943, 'acc_0_1': 0.5924, 'acc_1_0': 0.4821, 'acc_1_1': 0.948, 'mean_acc': 0.9627}
Val(class): {'weighted_mean_acc': 0.97, 'worst_acc': 0.4179, 'acc_0_0': 1.0, 'acc_0_1': 0.6567, 'acc_1_0': 0.4179, 'acc_1_1': 0.9545, 'mean_acc': 0.7967}
Test(class): {'weighted_mean_acc': 0.96, 'worst_acc': 0.4579, 'acc_0_0': 0.9933, 'acc_0_1': 0.6257, 'acc_1_0': 0.4579, 'acc_1_1': 0.9346, 'mean_acc': 0.7844}
--- Epoch 9 ---
Train-1 (Feature Learning): {'worst_acc': 0.4464, 'acc_0_0': 0.9946, 'acc_0_1': 0.6522, 'acc_1_0': 0.4464, 'acc_1_1': 0.9404, 'mean_acc': 0.9631}
Val(class): {'weighted_mean_acc': 0.9723, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.721, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.82}
Test(class): {'weighted_mean_acc': 0.9616, 'worst_acc': 0.4439, 'acc_0_0': 0.9947, 'acc_0_1': 0.6825, 'acc_1_0': 0.4439, 'acc_1_1': 0.9283, 'mean_acc': 0.8048}
--- Epoch 10 ---
Train-1 (Feature Learning): {'worst_acc': 0.5, 'acc_0_0': 0.9954, 'acc_0_1': 0.6957, 'acc_1_0': 0.5, 'acc_1_1': 0.9347, 'mean_acc': 0.9648}
Val(class): {'weighted_mean_acc': 0.9735, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8317}
Test(class): {'weighted_mean_acc': 0.9611, 'worst_acc': 0.4424, 'acc_0_0': 0.9956, 'acc_0_1': 0.7055, 'acc_1_0': 0.4424, 'acc_1_1': 0.919, 'mean_acc': 0.8129}
--- Epoch 11 ---
Train-1 (Feature Learning): {'worst_acc': 0.4821, 'acc_0_0': 0.9954, 'acc_0_1': 0.7174, 'acc_1_0': 0.4821, 'acc_1_1': 0.9357, 'mean_acc': 0.9656}
Val(class): {'weighted_mean_acc': 0.9736, 'worst_acc': 0.403, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.403, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9609, 'worst_acc': 0.4595, 'acc_0_0': 0.9942, 'acc_0_1': 0.7038, 'acc_1_0': 0.4595, 'acc_1_1': 0.9221, 'mean_acc': 0.8139}
--- Epoch 12 ---
Train-1 (Feature Learning): {'worst_acc': 0.5536, 'acc_0_0': 0.994, 'acc_0_1': 0.712, 'acc_1_0': 0.5536, 'acc_1_1': 0.9442, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4627, 'acc_0_0': 1.0, 'acc_0_1': 0.7382, 'acc_1_0': 0.4627, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.486, 'acc_0_0': 0.9933, 'acc_0_1': 0.6914, 'acc_1_0': 0.486, 'acc_1_1': 0.9252, 'mean_acc': 0.812}
--- Epoch 13 ---
Train-1 (Feature Learning): {'worst_acc': 0.5893, 'acc_0_0': 0.9934, 'acc_0_1': 0.6902, 'acc_1_0': 0.5893, 'acc_1_1': 0.948, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.961, 'worst_acc': 0.5031, 'acc_0_0': 0.9929, 'acc_0_1': 0.6803, 'acc_1_0': 0.5031, 'acc_1_1': 0.9283, 'mean_acc': 0.8098}
--- Epoch 14 ---
Train-1 (Feature Learning): {'worst_acc': 0.6071, 'acc_0_0': 0.9934, 'acc_0_1': 0.7011, 'acc_1_0': 0.6071, 'acc_1_1': 0.9499, 'mean_acc': 0.9681}
Val(class): {'weighted_mean_acc': 0.9737, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7339, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8333}
Test(class): {'weighted_mean_acc': 0.9613, 'worst_acc': 0.5093, 'acc_0_0': 0.9925, 'acc_0_1': 0.6785, 'acc_1_0': 0.5093, 'acc_1_1': 0.9315, 'mean_acc': 0.81}
--- Epoch 15 ---
Train-1 (Feature Learning): {'worst_acc': 0.5714, 'acc_0_0': 0.9931, 'acc_0_1': 0.6848, 'acc_1_0': 0.5714, 'acc_1_1': 0.9518, 'mean_acc': 0.9673}
Val(class): {'weighted_mean_acc': 0.9743, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7511, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.84}
Test(class): {'weighted_mean_acc': 0.9618, 'worst_acc': 0.5156, 'acc_0_0': 0.9929, 'acc_0_1': 0.6807, 'acc_1_0': 0.5156, 'acc_1_1': 0.9315, 'mean_acc': 0.8117}
--- Epoch 16 ---
Train-1 (Feature Learning): {'worst_acc': 0.625, 'acc_0_0': 0.9923, 'acc_0_1': 0.7174, 'acc_1_0': 0.625, 'acc_1_1': 0.9451, 'mean_acc': 0.967}
Val(class): {'weighted_mean_acc': 0.9748, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9608, 'worst_acc': 0.5031, 'acc_0_0': 0.9933, 'acc_0_1': 0.6949, 'acc_1_0': 0.5031, 'acc_1_1': 0.9237, 'mean_acc': 0.8152}
--- Epoch 17 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6607, 'acc_1_1': 0.9451, 'mean_acc': 0.9679}
Val(class): {'weighted_mean_acc': 0.9745, 'worst_acc': 0.4776, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.4776, 'acc_1_1': 0.9545, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9603, 'worst_acc': 0.5062, 'acc_0_0': 0.992, 'acc_0_1': 0.6971, 'acc_1_0': 0.5062, 'acc_1_1': 0.9252, 'mean_acc': 0.816}
--- Epoch 18 ---
Train-1 (Feature Learning): {'worst_acc': 0.6429, 'acc_0_0': 0.9929, 'acc_0_1': 0.7391, 'acc_1_0': 0.6429, 'acc_1_1': 0.9451, 'mean_acc': 0.9685}
Val(class): {'weighted_mean_acc': 0.9753, 'worst_acc': 0.4925, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.4925, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9604, 'worst_acc': 0.5109, 'acc_0_0': 0.9929, 'acc_0_1': 0.7073, 'acc_1_0': 0.5109, 'acc_1_1': 0.9206, 'mean_acc': 0.8203}
--- Epoch 19 ---
Train-1 (Feature Learning): {'worst_acc': 0.6786, 'acc_0_0': 0.9923, 'acc_0_1': 0.7283, 'acc_1_0': 0.6786, 'acc_1_1': 0.9461, 'mean_acc': 0.9683}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7725, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9598, 'worst_acc': 0.5327, 'acc_0_0': 0.9916, 'acc_0_1': 0.702, 'acc_1_0': 0.5327, 'acc_1_1': 0.9221, 'mean_acc': 0.8203}
--- Epoch 20 ---
Train-1 (Feature Learning): {'worst_acc': 0.6607, 'acc_0_0': 0.9923, 'acc_0_1': 0.7446, 'acc_1_0': 0.6607, 'acc_1_1': 0.947, 'mean_acc': 0.9689}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.5224, 'acc_0_0': 1.0, 'acc_0_1': 0.7682, 'acc_1_0': 0.5224, 'acc_1_1': 0.9545, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9595, 'worst_acc': 0.5436, 'acc_0_0': 0.9907, 'acc_0_1': 0.7078, 'acc_1_0': 0.5436, 'acc_1_1': 0.9221, 'mean_acc': 0.8234}
--- Epoch 21 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.75, 'acc_1_0': 0.7143, 'acc_1_1': 0.9508, 'mean_acc': 0.971}
Val(class): {'weighted_mean_acc': 0.9757, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7639, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9593, 'worst_acc': 0.5514, 'acc_0_0': 0.9898, 'acc_0_1': 0.6891, 'acc_1_0': 0.5514, 'acc_1_1': 0.9268, 'mean_acc': 0.8172}
--- Epoch 22 ---
Train-1 (Feature Learning): {'worst_acc': 0.7143, 'acc_0_0': 0.9929, 'acc_0_1': 0.7554, 'acc_1_0': 0.7143, 'acc_1_1': 0.9536, 'mean_acc': 0.9718}
Val(class): {'weighted_mean_acc': 0.9754, 'worst_acc': 0.5522, 'acc_0_0': 1.0, 'acc_0_1': 0.7554, 'acc_1_0': 0.5522, 'acc_1_1': 0.9545, 'mean_acc': 0.85}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.5576, 'acc_0_0': 0.9898, 'acc_0_1': 0.6936, 'acc_1_0': 0.5576, 'acc_1_1': 0.9299, 'mean_acc': 0.82}
--- Epoch 23 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.788, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9756}
Val(class): {'weighted_mean_acc': 0.9721, 'worst_acc': 0.5821, 'acc_0_0': 0.9957, 'acc_0_1': 0.7425, 'acc_1_0': 0.5821, 'acc_1_1': 0.9545, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9599, 'worst_acc': 0.5872, 'acc_0_0': 0.9889, 'acc_0_1': 0.6763, 'acc_1_0': 0.5872, 'acc_1_1': 0.933, 'mean_acc': 0.8165}
--- Epoch 24 ---
Train-1 (Feature Learning): {'worst_acc': 0.7321, 'acc_0_0': 0.994, 'acc_0_1': 0.7772, 'acc_1_0': 0.7321, 'acc_1_1': 0.9603, 'mean_acc': 0.9752}
Val(class): {'weighted_mean_acc': 0.9751, 'worst_acc': 0.597, 'acc_0_0': 0.9957, 'acc_0_1': 0.7296, 'acc_1_0': 0.597, 'acc_1_1': 0.9697, 'mean_acc': 0.845}
Test(class): {'weighted_mean_acc': 0.9589, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6687, 'acc_1_0': 0.6059, 'acc_1_1': 0.9346, 'mean_acc': 0.8152}
--- Epoch 25 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.9931, 'acc_0_1': 0.8098, 'acc_1_0': 0.75, 'acc_1_1': 0.9612, 'mean_acc': 0.9762}
Val(class): {'weighted_mean_acc': 0.9733, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7597, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6028, 'acc_0_0': 0.9871, 'acc_0_1': 0.6825, 'acc_1_0': 0.6028, 'acc_1_1': 0.9315, 'mean_acc': 0.8198}
--- Epoch 26 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.994, 'acc_0_1': 0.8098, 'acc_1_0': 0.7679, 'acc_1_1': 0.964, 'mean_acc': 0.9777}
Val(class): {'weighted_mean_acc': 0.972, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7253, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8433}
Test(class): {'weighted_mean_acc': 0.9591, 'worst_acc': 0.6246, 'acc_0_0': 0.9863, 'acc_0_1': 0.6585, 'acc_1_0': 0.6246, 'acc_1_1': 0.9393, 'mean_acc': 0.8134}
--- Epoch 27 ---
Train-1 (Feature Learning): {'worst_acc': 0.7857, 'acc_0_0': 0.994, 'acc_0_1': 0.8043, 'acc_1_0': 0.7857, 'acc_1_1': 0.9688, 'mean_acc': 0.9787}
Val(class): {'weighted_mean_acc': 0.9725, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6119, 'acc_1_1': 0.9697, 'mean_acc': 0.8483}
Test(class): {'weighted_mean_acc': 0.9587, 'worst_acc': 0.6153, 'acc_0_0': 0.9867, 'acc_0_1': 0.6785, 'acc_1_0': 0.6153, 'acc_1_1': 0.933, 'mean_acc': 0.8196}
--- Epoch 28 ---
Train-1 (Feature Learning): {'worst_acc': 0.6964, 'acc_0_0': 0.9966, 'acc_0_1': 0.8261, 'acc_1_0': 0.6964, 'acc_1_1': 0.9593, 'mean_acc': 0.9783}
Val(class): {'weighted_mean_acc': 0.9698, 'worst_acc': 0.6119, 'acc_0_0': 0.9915, 'acc_0_1': 0.7554, 'acc_1_0': 0.6119, 'acc_1_1': 0.9545, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9605, 'worst_acc': 0.5919, 'acc_0_0': 0.9898, 'acc_0_1': 0.7273, 'acc_1_0': 0.5919, 'acc_1_1': 0.9237, 'mean_acc': 0.8362}
--- Epoch 29 ---
Train-1 (Feature Learning): {'worst_acc': 0.75, 'acc_0_0': 0.996, 'acc_0_1': 0.8315, 'acc_1_0': 0.75, 'acc_1_1': 0.9659, 'mean_acc': 0.9802}
Val(class): {'weighted_mean_acc': 0.975, 'worst_acc': 0.6269, 'acc_0_0': 0.9915, 'acc_0_1': 0.7124, 'acc_1_0': 0.6269, 'acc_1_1': 0.9848, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6059, 'acc_0_0': 0.9871, 'acc_0_1': 0.6727, 'acc_1_0': 0.6059, 'acc_1_1': 0.9361, 'mean_acc': 0.8169}
--- Epoch 30 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.9949, 'acc_0_1': 0.8098, 'acc_1_0': 0.8036, 'acc_1_1': 0.9811, 'mean_acc': 0.9825}
Val(class): {'weighted_mean_acc': 0.9689, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7082, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9588, 'worst_acc': 0.6199, 'acc_0_0': 0.9863, 'acc_0_1': 0.6789, 'acc_1_0': 0.6199, 'acc_1_1': 0.9346, 'mean_acc': 0.8203}
--- Epoch 31 ---
Train-1 (Feature Learning): {'worst_acc': 0.7679, 'acc_0_0': 0.996, 'acc_0_1': 0.8641, 'acc_1_0': 0.7679, 'acc_1_1': 0.9707, 'mean_acc': 0.9827}
Val(class): {'weighted_mean_acc': 0.9699, 'worst_acc': 0.6716, 'acc_0_0': 0.9872, 'acc_0_1': 0.7339, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8517}
Test(class): {'weighted_mean_acc': 0.9584, 'worst_acc': 0.6199, 'acc_0_0': 0.9867, 'acc_0_1': 0.7042, 'acc_1_0': 0.6199, 'acc_1_1': 0.9268, 'mean_acc': 0.8295}
--- Epoch 32 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9971, 'acc_0_1': 0.837, 'acc_1_0': 0.8214, 'acc_1_1': 0.9754, 'mean_acc': 0.9842}
Val(class): {'weighted_mean_acc': 0.9694, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7253, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9602, 'worst_acc': 0.6121, 'acc_0_0': 0.988, 'acc_0_1': 0.6931, 'acc_1_0': 0.6121, 'acc_1_1': 0.933, 'mean_acc': 0.8255}
--- Epoch 33 ---
Train-1 (Feature Learning): {'worst_acc': 0.8393, 'acc_0_0': 0.9969, 'acc_0_1': 0.8641, 'acc_1_0': 0.8393, 'acc_1_1': 0.9801, 'mean_acc': 0.9862}
Val(class): {'weighted_mean_acc': 0.9704, 'worst_acc': 0.6567, 'acc_0_0': 0.9872, 'acc_0_1': 0.7511, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8567}
Test(class): {'weighted_mean_acc': 0.9594, 'worst_acc': 0.6153, 'acc_0_0': 0.9871, 'acc_0_1': 0.7251, 'acc_1_0': 0.6153, 'acc_1_1': 0.9268, 'mean_acc': 0.8372}
--- Epoch 34 ---
Train-1 (Feature Learning): {'worst_acc': 0.8036, 'acc_0_0': 0.998, 'acc_0_1': 0.913, 'acc_1_0': 0.8036, 'acc_1_1': 0.9707, 'mean_acc': 0.9864}
Val(class): {'weighted_mean_acc': 0.973, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7382, 'acc_1_0': 0.6567, 'acc_1_1': 0.9697, 'mean_acc': 0.8533}
Test(class): {'weighted_mean_acc': 0.9597, 'worst_acc': 0.6168, 'acc_0_0': 0.9871, 'acc_0_1': 0.7033, 'acc_1_0': 0.6168, 'acc_1_1': 0.9315, 'mean_acc': 0.8295}
--- Epoch 35 ---
Train-1 (Feature Learning): {'worst_acc': 0.8214, 'acc_0_0': 0.9969, 'acc_0_1': 0.8424, 'acc_1_0': 0.8214, 'acc_1_1': 0.9839, 'mean_acc': 0.986}
Val(class): {'weighted_mean_acc': 0.971, 'worst_acc': 0.6695, 'acc_0_0': 0.9872, 'acc_0_1': 0.6695, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.83}
Test(class): {'weighted_mean_acc': 0.957, 'worst_acc': 0.6271, 'acc_0_0': 0.9827, 'acc_0_1': 0.6271, 'acc_1_0': 0.6558, 'acc_1_1': 0.9455, 'mean_acc': 0.8039}
--- Epoch 36 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9969, 'acc_0_1': 0.8859, 'acc_1_0': 0.8571, 'acc_1_1': 0.983, 'mean_acc': 0.9879}
Val(class): {'weighted_mean_acc': 0.9634, 'worst_acc': 0.6309, 'acc_0_0': 0.9786, 'acc_0_1': 0.6309, 'acc_1_0': 0.7015, 'acc_1_1': 0.9848, 'mean_acc': 0.8133}
Test(class): {'weighted_mean_acc': 0.9537, 'worst_acc': 0.6004, 'acc_0_0': 0.9796, 'acc_0_1': 0.6004, 'acc_1_0': 0.6822, 'acc_1_1': 0.9439, 'mean_acc': 0.7951}
--- Epoch 37 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9983, 'acc_0_1': 0.8913, 'acc_1_0': 0.8571, 'acc_1_1': 0.982, 'mean_acc': 0.9889}
Val(class): {'weighted_mean_acc': 0.9746, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.6867, 'acc_1_0': 0.6716, 'acc_1_1': 0.9848, 'mean_acc': 0.8367}
Test(class): {'weighted_mean_acc': 0.9583, 'worst_acc': 0.6402, 'acc_0_0': 0.9854, 'acc_0_1': 0.6576, 'acc_1_0': 0.6402, 'acc_1_1': 0.9377, 'mean_acc': 0.8143}
--- Epoch 38 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.998, 'acc_0_1': 0.9293, 'acc_1_0': 0.8929, 'acc_1_1': 0.9801, 'mean_acc': 0.9902}
Val(class): {'weighted_mean_acc': 0.9755, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.7167, 'acc_1_0': 0.6567, 'acc_1_1': 0.9848, 'mean_acc': 0.8467}
Test(class): {'weighted_mean_acc': 0.9581, 'worst_acc': 0.6262, 'acc_0_0': 0.9863, 'acc_0_1': 0.6776, 'acc_1_0': 0.6262, 'acc_1_1': 0.9315, 'mean_acc': 0.8202}
--- Epoch 39 ---
Train-1 (Feature Learning): {'worst_acc': 0.8929, 'acc_0_0': 0.9983, 'acc_0_1': 0.8967, 'acc_1_0': 0.8929, 'acc_1_1': 0.9868, 'mean_acc': 0.9906}
Val(class): {'weighted_mean_acc': 0.9719, 'worst_acc': 0.6716, 'acc_0_0': 0.9915, 'acc_0_1': 0.7039, 'acc_1_0': 0.6716, 'acc_1_1': 0.9697, 'mean_acc': 0.8417}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.6558, 'acc_0_0': 0.9854, 'acc_0_1': 0.6887, 'acc_1_0': 0.6558, 'acc_1_1': 0.9268, 'mean_acc': 0.8269}
--- Epoch 40 ---
Train-1 (Feature Learning): {'worst_acc': 0.8571, 'acc_0_0': 0.9989, 'acc_0_1': 0.9457, 'acc_1_0': 0.8571, 'acc_1_1': 0.9839, 'mean_acc': 0.9919}
Val(class): {'weighted_mean_acc': 0.968, 'worst_acc': 0.6567, 'acc_0_0': 0.9915, 'acc_0_1': 0.6953, 'acc_1_0': 0.6567, 'acc_1_1': 0.9545, 'mean_acc': 0.835}
Test(class): {'weighted_mean_acc': 0.9572, 'worst_acc': 0.634, 'acc_0_0': 0.9849, 'acc_0_1': 0.6687, 'acc_1_0': 0.634, 'acc_1_1': 0.933, 'mean_acc': 0.8172}
--- Epoch 41 ---
================== Stage 2) New adapter for Balanced-Text-Prompt ==================
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.4545, 'acc_0_0': 0.9957, 'acc_0_1': 0.8069, 'acc_1_0': 0.4545, 'acc_1_1': 0.9104, 'mean_acc': 0.8531}
Val(class)(new adapter): {'weighted_mean_acc': 0.9474, 'worst_acc': 0.7313, 'acc_0_0': 0.9786, 'acc_0_1': 0.9013, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.9083}
Test(class)(new adapter): {'weighted_mean_acc': 0.9432, 'worst_acc': 0.7009, 'acc_0_0': 0.9796, 'acc_0_1': 0.8758, 'acc_1_0': 0.7009, 'acc_1_1': 0.8474, 'mean_acc': 0.8937}
--- Epoch 42 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8884, 'acc_0_1': 0.103, 'acc_1_0': 0.0, 'acc_1_1': 0.6567, 'mean_acc': 0.4591}
Val(class)(new adapter): {'weighted_mean_acc': 0.9435, 'worst_acc': 0.279, 'acc_0_0': 0.9701, 'acc_0_1': 0.279, 'acc_1_0': 0.6866, 'acc_1_1': 0.9848, 'mean_acc': 0.6717}
Test(class)(new adapter): {'weighted_mean_acc': 0.944, 'worst_acc': 0.3122, 'acc_0_0': 0.9769, 'acc_0_1': 0.3122, 'acc_1_0': 0.6121, 'acc_1_1': 0.9626, 'mean_acc': 0.6762}
--- Epoch 43 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.197, 'acc_0_0': 1.0, 'acc_0_1': 0.618, 'acc_1_0': 0.197, 'acc_1_1': 0.7612, 'mean_acc': 0.7362}
Val(class)(new adapter): {'weighted_mean_acc': 0.7208, 'worst_acc': 0.3182, 'acc_0_0': 0.8291, 'acc_0_1': 0.927, 'acc_1_0': 0.8806, 'acc_1_1': 0.3182, 'mean_acc': 0.8167}
Test(class)(new adapter): {'weighted_mean_acc': 0.7283, 'worst_acc': 0.3505, 'acc_0_0': 0.8284, 'acc_0_1': 0.945, 'acc_1_0': 0.8925, 'acc_1_1': 0.3505, 'mean_acc': 0.8279}
--- Epoch 44 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0, 'acc_0_0': 0.8455, 'acc_0_1': 0.9485, 'acc_1_0': 0.7879, 'acc_1_1': 0.0, 'mean_acc': 0.7846}
Val(class)(new adapter): {'weighted_mean_acc': 0.6532, 'worst_acc': 0.4697, 'acc_0_0': 0.6923, 'acc_0_1': 0.8798, 'acc_1_0': 0.9254, 'acc_1_1': 0.4697, 'mean_acc': 0.7667}
Test(class)(new adapter): {'weighted_mean_acc': 0.6489, 'worst_acc': 0.4595, 'acc_0_0': 0.6896, 'acc_0_1': 0.8749, 'acc_1_0': 0.9408, 'acc_1_1': 0.4595, 'mean_acc': 0.7641}
--- Epoch 45 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.867, 'acc_0_1': 0.9442, 'acc_1_0': 0.9091, 'acc_1_1': 0.5522, 'mean_acc': 0.8664}
Val(class)(new adapter): {'weighted_mean_acc': 0.7597, 'worst_acc': 0.7436, 'acc_0_0': 0.7436, 'acc_0_1': 0.8541, 'acc_1_0': 0.9254, 'acc_1_1': 0.7879, 'mean_acc': 0.8117}
Test(class)(new adapter): {'weighted_mean_acc': 0.7354, 'worst_acc': 0.6745, 'acc_0_0': 0.745, 'acc_0_1': 0.8417, 'acc_1_0': 0.9377, 'acc_1_1': 0.6745, 'mean_acc': 0.7962}
--- Epoch 46 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.0149, 'acc_0_0': 0.867, 'acc_0_1': 0.9356, 'acc_1_0': 0.8939, 'acc_1_1': 0.0149, 'mean_acc': 0.8013}
Val(class)(new adapter): {'weighted_mean_acc': 0.8172, 'worst_acc': 0.7554, 'acc_0_0': 0.7821, 'acc_0_1': 0.7554, 'acc_1_0': 0.9104, 'acc_1_1': 0.9394, 'mean_acc': 0.8033}
Test(class)(new adapter): {'weighted_mean_acc': 0.8086, 'worst_acc': 0.733, 'acc_0_0': 0.7792, 'acc_0_1': 0.733, 'acc_1_0': 0.9283, 'acc_1_1': 0.9128, 'mean_acc': 0.7925}
--- Epoch 47 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8485, 'acc_0_0': 0.9056, 'acc_0_1': 0.8927, 'acc_1_0': 0.8485, 'acc_1_1': 0.9552, 'mean_acc': 0.8998}
Val(class)(new adapter): {'weighted_mean_acc': 0.8819, 'worst_acc': 0.7425, 'acc_0_0': 0.8675, 'acc_0_1': 0.7425, 'acc_1_0': 0.8657, 'acc_1_1': 0.9545, 'mean_acc': 0.8283}
Test(class)(new adapter): {'weighted_mean_acc': 0.8715, 'worst_acc': 0.733, 'acc_0_0': 0.8608, 'acc_0_1': 0.733, 'acc_1_0': 0.8941, 'acc_1_1': 0.9299, 'mean_acc': 0.8224}
--- Epoch 48 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.1642, 'acc_0_0': 0.9442, 'acc_0_1': 0.9614, 'acc_1_0': 0.697, 'acc_1_1': 0.1642, 'mean_acc': 0.8364}
Val(class)(new adapter): {'weighted_mean_acc': 0.8836, 'worst_acc': 0.618, 'acc_0_0': 0.8718, 'acc_0_1': 0.618, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7833}
Test(class)(new adapter): {'weighted_mean_acc': 0.8839, 'worst_acc': 0.6213, 'acc_0_0': 0.8772, 'acc_0_1': 0.6213, 'acc_1_0': 0.8879, 'acc_1_1': 0.9517, 'mean_acc': 0.787}
--- Epoch 49 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.7879, 'acc_0_0': 0.97, 'acc_0_1': 0.8498, 'acc_1_0': 0.7879, 'acc_1_1': 0.9701, 'mean_acc': 0.9032}
Val(class)(new adapter): {'weighted_mean_acc': 0.8932, 'worst_acc': 0.6266, 'acc_0_0': 0.8846, 'acc_0_1': 0.6266, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7917}
Test(class)(new adapter): {'weighted_mean_acc': 0.8936, 'worst_acc': 0.6408, 'acc_0_0': 0.8914, 'acc_0_1': 0.6408, 'acc_1_0': 0.8832, 'acc_1_1': 0.9455, 'mean_acc': 0.7989}
--- Epoch 50 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.4925, 'acc_0_0': 0.9399, 'acc_0_1': 0.9828, 'acc_1_0': 0.7273, 'acc_1_1': 0.4925, 'mean_acc': 0.8831}
Val(class)(new adapter): {'weighted_mean_acc': 0.8765, 'worst_acc': 0.5966, 'acc_0_0': 0.8632, 'acc_0_1': 0.5966, 'acc_1_0': 0.8657, 'acc_1_1': 0.9697, 'mean_acc': 0.7717}
Test(class)(new adapter): {'weighted_mean_acc': 0.8798, 'worst_acc': 0.6115, 'acc_0_0': 0.8718, 'acc_0_1': 0.6115, 'acc_1_0': 0.8972, 'acc_1_1': 0.9517, 'mean_acc': 0.7822}
--- Epoch 51 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8112, 'acc_0_0': 0.9571, 'acc_0_1': 0.8112, 'acc_1_0': 0.8939, 'acc_1_1': 0.9851, 'mean_acc': 0.8965}
Val(class)(new adapter): {'weighted_mean_acc': 0.8811, 'worst_acc': 0.7124, 'acc_0_0': 0.8632, 'acc_0_1': 0.7124, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.8183}
Test(class)(new adapter): {'weighted_mean_acc': 0.8791, 'worst_acc': 0.7322, 'acc_0_0': 0.8687, 'acc_0_1': 0.7322, 'acc_1_0': 0.905, 'acc_1_1': 0.9377, 'mean_acc': 0.8272}
--- Epoch 52 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5373, 'acc_0_0': 0.9485, 'acc_0_1': 0.9828, 'acc_1_0': 0.8182, 'acc_1_1': 0.5373, 'mean_acc': 0.9015}
Val(class)(new adapter): {'weighted_mean_acc': 0.8944, 'worst_acc': 0.8155, 'acc_0_0': 0.8761, 'acc_0_1': 0.8155, 'acc_1_0': 0.8806, 'acc_1_1': 0.9697, 'mean_acc': 0.8633}
Test(class)(new adapter): {'weighted_mean_acc': 0.8816, 'worst_acc': 0.7951, 'acc_0_0': 0.8736, 'acc_0_1': 0.7951, 'acc_1_0': 0.8972, 'acc_1_1': 0.9221, 'mean_acc': 0.8511}
--- Epoch 53 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.9742, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9022, 'worst_acc': 0.8358, 'acc_0_0': 0.8889, 'acc_0_1': 0.8755, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.885}
Test(class)(new adapter): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8572, 'acc_0_0': 0.898, 'acc_0_1': 0.8572, 'acc_1_0': 0.8801, 'acc_1_1': 0.8956, 'mean_acc': 0.8799}
--- Epoch 54 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.3731, 'acc_0_0': 0.9871, 'acc_0_1': 0.9313, 'acc_1_0': 0.8182, 'acc_1_1': 0.3731, 'mean_acc': 0.8781}
Val(class)(new adapter): {'weighted_mean_acc': 0.9083, 'worst_acc': 0.8209, 'acc_0_0': 0.8974, 'acc_0_1': 0.8755, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.8976, 'worst_acc': 0.8576, 'acc_0_0': 0.902, 'acc_0_1': 0.8576, 'acc_1_0': 0.8816, 'acc_1_1': 0.891, 'mean_acc': 0.8813}
--- Epoch 55 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.8939, 'acc_0_0': 0.9785, 'acc_0_1': 0.9828, 'acc_1_0': 0.8939, 'acc_1_1': 0.9403, 'mean_acc': 0.9666}
Val(class)(new adapter): {'weighted_mean_acc': 0.9116, 'worst_acc': 0.8209, 'acc_0_0': 0.9017, 'acc_0_1': 0.8798, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.8938, 'worst_acc': 0.8599, 'acc_0_0': 0.8976, 'acc_0_1': 0.8599, 'acc_1_0': 0.8847, 'acc_1_1': 0.8879, 'mean_acc': 0.8804}
--- Epoch 56 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.5522, 'acc_0_0': 0.9614, 'acc_0_1': 0.9828, 'acc_1_0': 0.8788, 'acc_1_1': 0.5522, 'mean_acc': 0.9149}
Val(class)(new adapter): {'weighted_mean_acc': 0.9078, 'worst_acc': 0.8358, 'acc_0_0': 0.8974, 'acc_0_1': 0.8584, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.8817}
Test(class)(new adapter): {'weighted_mean_acc': 0.8903, 'worst_acc': 0.8377, 'acc_0_0': 0.8891, 'acc_0_1': 0.8377, 'acc_1_0': 0.8894, 'acc_1_1': 0.9034, 'mean_acc': 0.8707}
--- Epoch 57 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9657, 'acc_0_1': 0.97, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9037, 'worst_acc': 0.8326, 'acc_0_0': 0.8932, 'acc_0_1': 0.8326, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.87}
Test(class)(new adapter): {'weighted_mean_acc': 0.89, 'worst_acc': 0.8306, 'acc_0_0': 0.8887, 'acc_0_1': 0.8306, 'acc_1_0': 0.8879, 'acc_1_1': 0.905, 'mean_acc': 0.8678}
--- Epoch 58 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.806, 'acc_0_0': 0.9099, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.806, 'mean_acc': 0.9299}
Val(class)(new adapter): {'weighted_mean_acc': 0.9032, 'worst_acc': 0.8209, 'acc_0_0': 0.8932, 'acc_0_1': 0.824, 'acc_1_0': 0.8209, 'acc_1_1': 0.9545, 'mean_acc': 0.865}
Test(class)(new adapter): {'weighted_mean_acc': 0.8935, 'worst_acc': 0.8279, 'acc_0_0': 0.8927, 'acc_0_1': 0.8279, 'acc_1_0': 0.8832, 'acc_1_1': 0.9081, 'mean_acc': 0.8681}
--- Epoch 59 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9528, 'acc_0_0': 0.9528, 'acc_0_1': 0.9657, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9616}
Val(class)(new adapter): {'weighted_mean_acc': 0.9173, 'worst_acc': 0.806, 'acc_0_0': 0.9103, 'acc_0_1': 0.8712, 'acc_1_0': 0.806, 'acc_1_1': 0.9545, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9065, 'worst_acc': 0.8585, 'acc_0_0': 0.9153, 'acc_0_1': 0.8585, 'acc_1_0': 0.8692, 'acc_1_1': 0.8879, 'mean_acc': 0.8851}
--- Epoch 60 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8358, 'acc_0_0': 0.9742, 'acc_0_1': 0.9828, 'acc_1_0': 0.9091, 'acc_1_1': 0.8358, 'mean_acc': 0.9549}
Val(class)(new adapter): {'weighted_mean_acc': 0.9182, 'worst_acc': 0.806, 'acc_0_0': 0.9188, 'acc_0_1': 0.9056, 'acc_1_0': 0.806, 'acc_1_1': 0.9242, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.8458, 'acc_0_0': 0.9322, 'acc_0_1': 0.8816, 'acc_1_0': 0.8458, 'acc_1_1': 0.8692, 'mean_acc': 0.8959}
--- Epoch 61 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 0.9785, 'acc_0_1': 0.9785, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.9766}
Val(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9099, 'acc_1_0': 0.7612, 'acc_1_1': 0.8939, 'mean_acc': 0.8967}
Test(class)(new adapter): {'weighted_mean_acc': 0.9208, 'worst_acc': 0.8287, 'acc_0_0': 0.9486, 'acc_0_1': 0.914, 'acc_1_0': 0.8287, 'acc_1_1': 0.8349, 'mean_acc': 0.9092}
--- Epoch 62 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8657, 'acc_0_0': 0.9871, 'acc_0_1': 0.9914, 'acc_1_0': 0.8788, 'acc_1_1': 0.8657, 'mean_acc': 0.9633}
Val(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9399, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.905}
Test(class)(new adapter): {'weighted_mean_acc': 0.9201, 'worst_acc': 0.7944, 'acc_0_0': 0.9592, 'acc_0_1': 0.9357, 'acc_1_0': 0.796, 'acc_1_1': 0.7944, 'mean_acc': 0.9137}
--- Epoch 63 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9091, 'acc_0_0': 0.9957, 'acc_0_1': 0.9914, 'acc_1_0': 0.9091, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9171, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.9067}
Test(class)(new adapter): {'weighted_mean_acc': 0.9216, 'worst_acc': 0.7726, 'acc_0_0': 0.9672, 'acc_0_1': 0.9468, 'acc_1_0': 0.7726, 'acc_1_1': 0.7741, 'mean_acc': 0.9163}
--- Epoch 64 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.8507, 'acc_0_0': 0.9828, 'acc_0_1': 0.9957, 'acc_1_0': 0.9091, 'acc_1_1': 0.8507, 'mean_acc': 0.9649}
Val(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7164, 'acc_0_0': 0.9487, 'acc_0_1': 0.9442, 'acc_1_0': 0.7164, 'acc_1_1': 0.8485, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.9237, 'worst_acc': 0.7679, 'acc_0_0': 0.9681, 'acc_0_1': 0.9424, 'acc_1_0': 0.7679, 'acc_1_1': 0.7819, 'mean_acc': 0.9153}
--- Epoch 65 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9242, 'acc_0_0': 0.9914, 'acc_0_1': 0.9914, 'acc_1_0': 0.9242, 'acc_1_1': 0.9851, 'mean_acc': 0.9833}
Val(class)(new adapter): {'weighted_mean_acc': 0.9269, 'worst_acc': 0.7313, 'acc_0_0': 0.9487, 'acc_0_1': 0.9356, 'acc_1_0': 0.7313, 'acc_1_1': 0.8636, 'mean_acc': 0.91}
Test(class)(new adapter): {'weighted_mean_acc': 0.926, 'worst_acc': 0.7679, 'acc_0_0': 0.9676, 'acc_0_1': 0.929, 'acc_1_0': 0.7679, 'acc_1_1': 0.796, 'mean_acc': 0.9115}
--- Epoch 66 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9394, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9394, 'acc_1_1': 0.9403, 'mean_acc': 0.985}
Val(class)(new adapter): {'weighted_mean_acc': 0.9259, 'worst_acc': 0.7313, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7313, 'acc_1_1': 0.8485, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.7555, 'acc_0_0': 0.9703, 'acc_0_1': 0.9237, 'acc_1_0': 0.7555, 'acc_1_1': 0.8022, 'mean_acc': 0.9097}
--- Epoch 67 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9545, 'acc_0_0': 1.0, 'acc_0_1': 0.9914, 'acc_1_0': 0.9545, 'acc_1_1': 0.9851, 'mean_acc': 0.99}
Val(class)(new adapter): {'weighted_mean_acc': 0.929, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9142, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.93, 'worst_acc': 0.7445, 'acc_0_0': 0.9712, 'acc_0_1': 0.9206, 'acc_1_0': 0.7445, 'acc_1_1': 0.8053, 'mean_acc': 0.908}
--- Epoch 68 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9552, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 0.9552, 'mean_acc': 0.9883}
Val(class)(new adapter): {'weighted_mean_acc': 0.9289, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9099, 'acc_1_0': 0.7164, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9304, 'worst_acc': 0.7445, 'acc_0_0': 0.9716, 'acc_0_1': 0.9135, 'acc_1_0': 0.7445, 'acc_1_1': 0.8069, 'mean_acc': 0.9056}
--- Epoch 69 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9871, 'acc_1_0': 0.9848, 'acc_1_1': 0.9851, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9318, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9099, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9}
Test(class)(new adapter): {'weighted_mean_acc': 0.9297, 'worst_acc': 0.7212, 'acc_0_0': 0.9738, 'acc_0_1': 0.9215, 'acc_1_0': 0.7212, 'acc_1_1': 0.796, 'mean_acc': 0.9058}
--- Epoch 70 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9321, 'worst_acc': 0.7015, 'acc_0_0': 0.9573, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8636, 'mean_acc': 0.9033}
Test(class)(new adapter): {'weighted_mean_acc': 0.9285, 'worst_acc': 0.7227, 'acc_0_0': 0.9738, 'acc_0_1': 0.9259, 'acc_1_0': 0.7227, 'acc_1_1': 0.7897, 'mean_acc': 0.907}
--- Epoch 71 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 0.9957, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9224, 'worst_acc': 0.7015, 'acc_0_0': 0.953, 'acc_0_1': 0.9185, 'acc_1_0': 0.7015, 'acc_1_1': 0.8333, 'mean_acc': 0.8983}
Test(class)(new adapter): {'weighted_mean_acc': 0.9239, 'worst_acc': 0.7508, 'acc_0_0': 0.969, 'acc_0_1': 0.9273, 'acc_1_0': 0.7508, 'acc_1_1': 0.7835, 'mean_acc': 0.908}
--- Epoch 72 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9933}
Val(class)(new adapter): {'weighted_mean_acc': 0.9227, 'worst_acc': 0.7164, 'acc_0_0': 0.953, 'acc_0_1': 0.9227, 'acc_1_0': 0.7164, 'acc_1_1': 0.8333, 'mean_acc': 0.9017}
Test(class)(new adapter): {'weighted_mean_acc': 0.9162, 'worst_acc': 0.7679, 'acc_0_0': 0.9614, 'acc_0_1': 0.9273, 'acc_1_0': 0.7679, 'acc_1_1': 0.7726, 'mean_acc': 0.9058}
--- Epoch 73 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9295, 'acc_1_0': 0.7773, 'acc_1_1': 0.757, 'mean_acc': 0.9042}
--- Epoch 74 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9871, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.91, 'worst_acc': 0.7313, 'acc_0_0': 0.9402, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9097, 'worst_acc': 0.757, 'acc_0_0': 0.957, 'acc_0_1': 0.9286, 'acc_1_0': 0.7773, 'acc_1_1': 0.757, 'mean_acc': 0.9039}
--- Epoch 75 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9137, 'worst_acc': 0.7492, 'acc_0_0': 0.965, 'acc_0_1': 0.9295, 'acc_1_0': 0.7679, 'acc_1_1': 0.7492, 'mean_acc': 0.9054}
--- Epoch 76 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7414, 'acc_0_0': 0.965, 'acc_0_1': 0.9299, 'acc_1_0': 0.7664, 'acc_1_1': 0.7414, 'mean_acc': 0.9046}
--- Epoch 77 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7523, 'acc_0_0': 0.9663, 'acc_0_1': 0.929, 'acc_1_0': 0.7648, 'acc_1_1': 0.7523, 'mean_acc': 0.9058}
--- Epoch 78 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9153, 'worst_acc': 0.7539, 'acc_0_0': 0.9659, 'acc_0_1': 0.9286, 'acc_1_0': 0.7632, 'acc_1_1': 0.7539, 'mean_acc': 0.9054}
--- Epoch 79 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9697, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9697, 'acc_1_1': 1.0, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.913, 'worst_acc': 0.7164, 'acc_0_0': 0.9444, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9144, 'worst_acc': 0.7461, 'acc_0_0': 0.9667, 'acc_0_1': 0.9304, 'acc_1_0': 0.7648, 'acc_1_1': 0.7461, 'mean_acc': 0.9058}
--- Epoch 80 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9067, 'worst_acc': 0.7164, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7164, 'acc_1_1': 0.8182, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7586, 'acc_0_0': 0.9627, 'acc_0_1': 0.9282, 'acc_1_0': 0.7695, 'acc_1_1': 0.7586, 'mean_acc': 0.9052}
--- Epoch 81 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9069, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8182, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9135, 'worst_acc': 0.7555, 'acc_0_0': 0.9627, 'acc_0_1': 0.9282, 'acc_1_0': 0.7695, 'acc_1_1': 0.7555, 'mean_acc': 0.9049}
--- Epoch 82 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9102, 'worst_acc': 0.7313, 'acc_0_0': 0.9359, 'acc_0_1': 0.9185, 'acc_1_0': 0.7313, 'acc_1_1': 0.8333, 'mean_acc': 0.895}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7632, 'acc_0_0': 0.9588, 'acc_0_1': 0.9273, 'acc_1_0': 0.7741, 'acc_1_1': 0.7632, 'mean_acc': 0.9044}
--- Epoch 83 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9101, 'worst_acc': 0.7463, 'acc_0_0': 0.9359, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9129, 'worst_acc': 0.771, 'acc_0_0': 0.9574, 'acc_0_1': 0.9224, 'acc_1_0': 0.7773, 'acc_1_1': 0.771, 'mean_acc': 0.9032}
--- Epoch 84 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7741, 'acc_0_0': 0.9552, 'acc_0_1': 0.9206, 'acc_1_0': 0.785, 'acc_1_1': 0.7741, 'mean_acc': 0.9028}
--- Epoch 85 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9068, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7757, 'acc_0_0': 0.9552, 'acc_0_1': 0.9197, 'acc_1_0': 0.785, 'acc_1_1': 0.7757, 'mean_acc': 0.9027}
--- Epoch 86 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9133, 'worst_acc': 0.7835, 'acc_0_0': 0.9543, 'acc_0_1': 0.918, 'acc_1_0': 0.785, 'acc_1_1': 0.7835, 'mean_acc': 0.9025}
--- Epoch 87 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 0.9848, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 1.0, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9038, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8333, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9123, 'worst_acc': 0.7773, 'acc_0_0': 0.9548, 'acc_0_1': 0.9184, 'acc_1_0': 0.785, 'acc_1_1': 0.7773, 'mean_acc': 0.9021}
--- Epoch 88 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9103, 'worst_acc': 0.7463, 'acc_0_0': 0.9316, 'acc_0_1': 0.9099, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8933}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.7773, 'acc_0_0': 0.9565, 'acc_0_1': 0.9188, 'acc_1_0': 0.785, 'acc_1_1': 0.7773, 'mean_acc': 0.903}
--- Epoch 89 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9156, 'worst_acc': 0.7866, 'acc_0_0': 0.9543, 'acc_0_1': 0.9157, 'acc_1_0': 0.7866, 'acc_1_1': 0.7944, 'mean_acc': 0.903}
--- Epoch 90 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9146, 'worst_acc': 0.7897, 'acc_0_0': 0.953, 'acc_0_1': 0.9131, 'acc_1_0': 0.7897, 'acc_1_1': 0.7944, 'mean_acc': 0.9018}
--- Epoch 91 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9142, 'worst_acc': 0.7897, 'acc_0_0': 0.9525, 'acc_0_1': 0.9122, 'acc_1_0': 0.7897, 'acc_1_1': 0.7944, 'mean_acc': 0.9013}
--- Epoch 92 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9914, 'acc_0_1': 1.0, 'acc_1_0': 0.9848, 'acc_1_1': 0.9701, 'mean_acc': 0.9917}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7463, 'acc_0_0': 0.9231, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.7975, 'acc_0_0': 0.9477, 'acc_0_1': 0.91, 'acc_1_0': 0.8006, 'acc_1_1': 0.7975, 'mean_acc': 0.9001}
--- Epoch 93 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.912, 'worst_acc': 0.7975, 'acc_0_0': 0.9486, 'acc_0_1': 0.9104, 'acc_1_0': 0.7975, 'acc_1_1': 0.7975, 'mean_acc': 0.9002}
--- Epoch 94 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.9136, 'worst_acc': 0.796, 'acc_0_0': 0.9499, 'acc_0_1': 0.9095, 'acc_1_0': 0.796, 'acc_1_1': 0.8006, 'mean_acc': 0.9006}
--- Epoch 95 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.907, 'worst_acc': 0.7463, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7463, 'acc_1_1': 0.8485, 'mean_acc': 0.89}
Test(class)(new adapter): {'weighted_mean_acc': 0.914, 'worst_acc': 0.8006, 'acc_0_0': 0.9499, 'acc_0_1': 0.9086, 'acc_1_0': 0.8006, 'acc_1_1': 0.8022, 'mean_acc': 0.9009}
--- Epoch 96 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 0.9957, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.995}
Val(class)(new adapter): {'weighted_mean_acc': 0.9069, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.8927, 'acc_1_0': 0.7612, 'acc_1_1': 0.8636, 'mean_acc': 0.8867}
Test(class)(new adapter): {'weighted_mean_acc': 0.9134, 'worst_acc': 0.8037, 'acc_0_0': 0.9455, 'acc_0_1': 0.9055, 'acc_1_0': 0.8037, 'acc_1_1': 0.8146, 'mean_acc': 0.8997}
--- Epoch 97 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9039, 'worst_acc': 0.7612, 'acc_0_0': 0.9231, 'acc_0_1': 0.9013, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8883}
Test(class)(new adapter): {'weighted_mean_acc': 0.9114, 'worst_acc': 0.8006, 'acc_0_0': 0.945, 'acc_0_1': 0.9069, 'acc_1_0': 0.8006, 'acc_1_1': 0.8069, 'mean_acc': 0.8989}
--- Epoch 98 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9851, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9851, 'mean_acc': 0.9983}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9139, 'worst_acc': 0.796, 'acc_0_0': 0.9503, 'acc_0_1': 0.9091, 'acc_1_0': 0.796, 'acc_1_1': 0.8006, 'mean_acc': 0.9006}
--- Epoch 99 ---
Train-2 (Balanced Learning)(new adapter)(Class prompt): {'worst_acc': 1.0, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 1.0, 'mean_acc': 1.0}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9143, 'worst_acc': 0.796, 'acc_0_0': 0.9512, 'acc_0_1': 0.9095, 'acc_1_0': 0.796, 'acc_1_1': 0.7991, 'mean_acc': 0.9009}
--- Epoch 100 ---
Train-2 (Balanced Learning)(new adapter)(Group prompt): {'worst_acc': 0.9701, 'acc_0_0': 1.0, 'acc_0_1': 1.0, 'acc_1_0': 1.0, 'acc_1_1': 0.9701, 'mean_acc': 0.9967}
Val(class)(new adapter): {'weighted_mean_acc': 0.9072, 'worst_acc': 0.7612, 'acc_0_0': 0.9274, 'acc_0_1': 0.9056, 'acc_1_0': 0.7612, 'acc_1_1': 0.8485, 'mean_acc': 0.8917}
Test(class)(new adapter): {'weighted_mean_acc': 0.9149, 'worst_acc': 0.7928, 'acc_0_0': 0.9508, 'acc_0_1': 0.9091, 'acc_1_0': 0.7928, 'acc_1_1': 0.8037, 'mean_acc': 0.9008}
========================================================================
> end of training. 

best epoch : 53
best training accuracy on [class]: {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.9742, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9616}
best validation accuracy on [class]: {'weighted_mean_acc': 0.9022, 'worst_acc': 0.8358, 'acc_0_0': 0.8889, 'acc_0_1': 0.8755, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.885}
best test accuracy on [class]: {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8572, 'acc_0_0': 0.898, 'acc_0_1': 0.8572, 'acc_1_0': 0.8801, 'acc_1_1': 0.8956, 'mean_acc': 0.8799}
========================================================================
> start evaluating feature quality of best model. (using zero-shot prediction)

zero-shot prediction (test) (class): {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8572, 'acc_0_0': 0.898, 'acc_0_1': 0.8572, 'acc_1_0': 0.8801, 'acc_1_1': 0.8956, 'mean_acc': 0.8799}
zero-shot prediction (test) (spurious): {'weighted_mean_acc': 0.9652, 'worst_acc': 0.3785, 'acc_0_0': 0.9778, 'acc_0_1': 0.8297, 'acc_1_0': 0.3785, 'acc_1_1': 0.9782, 'mean_acc': 0.8538}
 ㄴ Note that it is related to [richness of non-target (spurious) information] (-> 'mean_acc' is important)
========================================================================
> Save results

{'Final Results (best epoch)': {'Epoch 53': {'Train': {'worst_acc': 0.8636, 'acc_0_0': 0.9742, 'acc_0_1': 0.9742, 'acc_1_0': 0.8636, 'acc_1_1': 0.9701, 'mean_acc': 0.9616}, 'Val': {'weighted_mean_acc': 0.9022, 'worst_acc': 0.8358, 'acc_0_0': 0.8889, 'acc_0_1': 0.8755, 'acc_1_0': 0.8358, 'acc_1_1': 0.9545, 'mean_acc': 0.885}, 'Test': {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8572, 'acc_0_0': 0.898, 'acc_0_1': 0.8572, 'acc_1_0': 0.8801, 'acc_1_1': 0.8956, 'mean_acc': 0.8799}}}, 'Feature Quality (using zs)': {'class': {'weighted_mean_acc': 0.8957, 'worst_acc': 0.8572, 'acc_0_0': 0.898, 'acc_0_1': 0.8572, 'acc_1_0': 0.8801, 'acc_1_1': 0.8956, 'mean_acc': 0.8799}, 'spurious': {'weighted_mean_acc': 0.9652, 'worst_acc': 0.3785, 'acc_0_0': 0.9778, 'acc_0_1': 0.8297, 'acc_1_0': 0.3785, 'acc_1_1': 0.9782, 'mean_acc': 0.8538}}}
========================================================================
> end
Final Results:               weighted_mean_acc  worst_acc  acc_0_0  ...  acc_1_0  acc_1_1  mean_acc
1                       0.9235     0.8442   0.9490  ...   0.8442   0.8442    0.9134
2                       0.9143     0.8458   0.9353  ...   0.8458   0.8505    0.9040
3                       0.8957     0.8572   0.8980  ...   0.8801   0.8956    0.8799
test_mean               0.9112     0.8491   0.9274  ...   0.8567   0.8634    0.8991
test_std                0.0116     0.0058   0.0216  ...   0.0166   0.0229    0.0141
1                       0.9697     0.6589   0.9783  ...   0.6589   0.9735    0.9039
2                       0.9650     0.4268   0.9738  ...   0.4268   0.9860    0.8626
3                       0.9652     0.3785   0.9778  ...   0.3785   0.9782    0.8538
zs_spu_mean             0.9666     0.4881   0.9766  ...   0.4881   0.9792    0.8734
zs_spu_std              0.0022     0.1224   0.0020  ...   0.1224   0.0052    0.0218
1                          NaN     0.0299   0.9185  ...   0.7879   0.0299    0.8047
2                          NaN     0.2836   0.8155  ...   0.8636   0.2836    0.8164
3                          NaN     0.8636   0.9742  ...   0.8636   0.9701    0.9616
tr_mean                    NaN     0.3924   0.9027  ...   0.8384   0.4279    0.8609
tr_std                     NaN     0.3489   0.0657  ...   0.0357   0.3972    0.0714
1                       0.9214     0.8209   0.9402  ...   0.8209   0.8636    0.9133
2                       0.9212     0.8507   0.9316  ...   0.8507   0.8939    0.9067
3                       0.9022     0.8358   0.8889  ...   0.8358   0.9545    0.8850
val_mean                0.9149     0.8358   0.9202  ...   0.8358   0.9040    0.9017
val_std                 0.0090     0.0122   0.0224  ...   0.0122   0.0378    0.0121
1                       0.9235     0.8442   0.9490  ...   0.8442   0.8442    0.9134
2                       0.9143     0.8458   0.9353  ...   0.8458   0.8505    0.9040
3                       0.8957     0.8572   0.8980  ...   0.8801   0.8956    0.8799
zs_tg_mean              0.9112     0.8491   0.9274  ...   0.8567   0.8634    0.8991
zs_tg_std               0.0116     0.0058   0.0216  ...   0.0166   0.0229    0.0141

[25 rows x 7 columns]
Save to:  results_iterative/ds_waterbirds_tl_adapter_reg_seq_alter_bs_1024_lr_10.0_lrr10.0_bsr512_MA+rn.csv
